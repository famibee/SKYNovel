/*! For license information please see app.js.LICENSE.txt */
!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i=e();for(var r in i)("object"==typeof exports?exports:t)[r]=i[r]}}(this,(function(){return(()=>{var t={1680:(t,e,i)=>{"use strict";var r,n,s,o,a,h,u,c,l,p,d,f,g,m,_,v,y,b,x;i.d(e,{iw:()=>g,T$:()=>o,V0:()=>s,mr:()=>x,yl:()=>m,lg:()=>a,Vi:()=>r,I2:()=>h,UN:()=>_,A7:()=>y,WB:()=>f,G5:()=>b,cB:()=>v,N3:()=>n,oT:()=>l,aH:()=>p,sp:()=>u,vK:()=>c,Nt:()=>d}),function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(r||(r={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(n||(n={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL"}(s||(s={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(o||(o={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(a||(a={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(h||(h={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(u||(u={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(c||(c={})),function(t){t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT"}(l||(l={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(p||(p={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(d||(d={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL"}(f||(f={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(g||(g={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT"}(m||(m={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(_||(_={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(v||(v={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(y||(y={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH"}(b||(b={})),function(t){t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(x||(x={}))},2038:(t,e,i)=>{"use strict";i.d(e,{eo:()=>Ee,M4:()=>v,I8:()=>le,$N:()=>y,ah:()=>B,bg:()=>b,jd:()=>R,VL:()=>_,a$:()=>ye,JZ:()=>Se,TJ:()=>Ce,Bv:()=>Oe,Zk:()=>Te,Sj:()=>tt,Ie:()=>be,lW:()=>G,qm:()=>g,Y8:()=>x,lH:()=>it,TA:()=>E,wn:()=>Dt,jV:()=>q,kV:()=>J,AI:()=>I,WB:()=>st,tT:()=>rt,Ei:()=>te,fy:()=>ae,ZX:()=>H,TO:()=>at,W1:()=>Qt,e_:()=>u,_w:()=>A,PA:()=>T,HI:()=>ht,zj:()=>Gt,bO:()=>Q,$r:()=>Pt,NW:()=>zt,lD:()=>V,ud:()=>Y,TI:()=>D,uW:()=>k,J$:()=>Yt,Th:()=>fe,_z:()=>f,pX:()=>S,id:()=>jt,ex:()=>Nt,p:()=>ne,z9:()=>Ft,ZM:()=>Lt,zI:()=>se,Ld:()=>Xt,xP:()=>ve,xE:()=>N,wr:()=>oe,UX:()=>Bt,CT:()=>he,aF:()=>M,oo:()=>$,eH:()=>w,Rv:()=>xe,e6:()=>ge,pb:()=>c,a7:()=>It,TF:()=>Zt,Y9:()=>_e,kP:()=>me,qw:()=>ee,K0:()=>Jt,Kc:()=>mt,DL:()=>Kt,Jb:()=>Ie,eG:()=>Pe,sg:()=>St});var r=i(9319),n=i(1680),s=i(8942),o=i(1034),a=i(6679),h=i(9658);r.X.PREFER_ENV=s.isMobile.any?n.Vi.WEBGL:n.Vi.WEBGL2,r.X.STRICT_TEXTURE_CACHE=!1;var u=[];function c(t,e){if(!t)return null;var i="";if("string"==typeof t){var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(i=r[1].toLowerCase())}for(var n=u.length-1;n>=0;--n){var s=u[n];if(s.test&&s.test(t,i))return new s(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}var l=function(t,e){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},l(t,e)};function p(t,e){function i(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var d=function(){return d=Object.assign||function(t){for(var e,i=arguments,r=1,n=arguments.length;r<n;r++)for(var s in e=i[r])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t},d.apply(this,arguments)},f=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new o.R("setRealSize"),this.onUpdate=new o.R("update"),this.onError=new o.R("onError")}return t.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},t.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},t.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.emit(t,e))},Object.defineProperty(t.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),t.prototype.update=function(){this.destroyed||this.onUpdate.emit()},t.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),t.prototype.style=function(t,e,i){return!1},t.prototype.dispose=function(){},t.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},t.test=function(t,e){return!1},t}(),g=function(t){function e(e,i){var r=this,n=i||{},s=n.width,o=n.height;if(!s||!o)throw new Error("BufferResource width or height invalid");return(r=t.call(this,s,o)||this).data=e,r}return p(e,t),e.prototype.upload=function(t,e,i){var r=t.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===n.iw.UNPACK);var s=e.realWidth,o=e.realHeight;return i.width===s&&i.height===o?r.texSubImage2D(e.target,0,0,0,s,o,e.format,i.type,this.data):(i.width=s,i.height=o,r.texImage2D(e.target,0,i.internalFormat,s,o,0,e.format,i.type,this.data)),!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e}(f),m={scaleMode:n.aH.NEAREST,format:n.I2.RGBA,alphaMode:n.iw.NPM},_=function(t){function e(e,i){void 0===e&&(e=null),void 0===i&&(i=null);var o=t.call(this)||this,a=(i=i||{}).alphaMode,h=i.mipmap,u=i.anisotropicLevel,l=i.scaleMode,p=i.width,d=i.height,g=i.wrapMode,m=i.format,_=i.type,v=i.target,y=i.resolution,b=i.resourceOptions;return!e||e instanceof f||((e=c(e,b)).internal=!0),o.resolution=y||r.X.RESOLUTION,o.width=Math.round((p||0)*o.resolution)/o.resolution,o.height=Math.round((d||0)*o.resolution)/o.resolution,o._mipmap=void 0!==h?h:r.X.MIPMAP_TEXTURES,o.anisotropicLevel=void 0!==u?u:r.X.ANISOTROPIC_LEVEL,o._wrapMode=g||r.X.WRAP_MODE,o._scaleMode=void 0!==l?l:r.X.SCALE_MODE,o.format=m||n.I2.RGBA,o.type=_||n.vK.UNSIGNED_BYTE,o.target=v||n.sp.TEXTURE_2D,o.alphaMode=void 0!==a?a:n.iw.UNPACK,o.uid=(0,s.uid)(),o.touched=0,o.isPowerOfTwo=!1,o._refreshPOT(),o._glTextures={},o.dirtyId=0,o.dirtyStyleId=0,o.cacheId=null,o.valid=p>0&&d>0,o.textureCacheIds=[],o.destroyed=!1,o.resource=null,o._batchEnabled=0,o._batchLocation=0,o.parentTextureArray=null,o.setResource(e),o}return p(e,t),Object.defineProperty(e.prototype,"realWidth",{get:function(){return Math.round(this.width*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"realHeight",{get:function(){return Math.round(this.height*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mipmap",{get:function(){return this._mipmap},set:function(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wrapMode",{get:function(){return this._wrapMode},set:function(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),e.prototype.setStyle=function(t,e){var i;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,i=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,e,i){return i=i||this.resolution,this.setRealSize(t*i,e*i,i)},e.prototype.setRealSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=(0,s.isPow2)(this.realWidth)&&(0,s.isPow2)(this.realHeight)},e.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT()),this},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.onError=function(t){this.emit("error",this,t)},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete s.BaseTextureCache[this.cacheId],delete s.TextureCache[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.prototype.castToBaseTexture=function(){return this},e.from=function(t,i,n){void 0===n&&(n=r.X.STRICT_TEXTURE_CACHE);var o="string"==typeof t,a=null;if(o)a=t;else{if(!t._pixiId){var h=i&&i.pixiIdPrefix||"pixiid";t._pixiId=h+"_"+(0,s.uid)()}a=t._pixiId}var u=s.BaseTextureCache[a];if(o&&n&&!u)throw new Error('The cacheId "'+a+'" does not exist in BaseTextureCache.');return u||((u=new e(t,i)).cacheId=a,e.addToCache(u,a)),u},e.fromBuffer=function(t,i,r,s){t=t||new Float32Array(i*r*4);var o=new g(t,{width:i,height:r}),a=t instanceof Float32Array?n.vK.FLOAT:n.vK.UNSIGNED_BYTE;return new e(o,Object.assign(m,s||{width:i,height:r,type:a}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),s.BaseTextureCache[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),s.BaseTextureCache[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=s.BaseTextureCache[t];if(e){var i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete s.BaseTextureCache[t],e}}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete s.BaseTextureCache[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},e._globalBatch=0,e}(s.EventEmitter),v=function(t){function e(e,i){var r=this,n=i||{},s=n.width,o=n.height;(r=t.call(this,s,o)||this).items=[],r.itemDirtyIds=[];for(var a=0;a<e;a++){var h=new _;r.items.push(h),r.itemDirtyIds.push(-2)}return r.length=e,r._load=null,r.baseTexture=null,r}return p(e,t),e.prototype.initFromArray=function(t,e){for(var i=0;i<this.length;i++)t[i]&&(t[i].castToBaseTexture?this.addBaseTextureAt(t[i].castToBaseTexture(),i):t[i]instanceof f?this.addResourceAt(t[i],i):this.addResourceAt(c(t[i],e),i))},e.prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},e.prototype.bind=function(e){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");t.prototype.bind.call(this,e);for(var i=0;i<this.length;i++)this.items[i].parentTextureArray=e,this.items[i].on("update",e.update,e)},e.prototype.unbind=function(e){t.prototype.unbind.call(this,e);for(var i=0;i<this.length;i++)this.items[i].parentTextureArray=null,this.items[i].off("update",e.update,e)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.items.map((function(t){return t.resource})).filter((function(t){return t})).map((function(t){return t.load()}));return this._load=Promise.all(e).then((function(){var e=t.items[0],i=e.realWidth,r=e.realHeight;return t.resize(i,r),Promise.resolve(t)})),this._load},e}(f),y=function(t){function e(e,i){var r,n,s=this,o=i||{},a=o.width,h=o.height;return Array.isArray(e)?(r=e,n=e.length):n=e,s=t.call(this,n,{width:a,height:h})||this,r&&s.initFromArray(r,i),s}return p(e,t),e.prototype.addBaseTextureAt=function(t,e){if(!t.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(t.resource,e),this},e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=n.sp.TEXTURE_2D_ARRAY},e.prototype.upload=function(t,e,i){var r=this,n=r.length,s=r.itemDirtyIds,o=r.items,a=t.gl;i.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,n,0,e.format,i.type,null);for(var h=0;h<n;h++){var u=o[h];s[h]<u.dirtyId&&(s[h]=u.dirtyId,u.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,h,u.resource.width,u.resource.height,1,e.format,i.type,u.resource.source))}return!0},e}(v),b=function(t){function e(e){var i=this,r=e,n=r.naturalWidth||r.videoWidth||r.width,s=r.naturalHeight||r.videoHeight||r.height;return(i=t.call(this,n,s)||this).source=e,i.noSubImage=!1,i}return p(e,t),e.crossOrigin=function(t,e,i){void 0===i&&0!==e.indexOf("data:")?t.crossOrigin=(0,s.determineCrossOrigin)(e):!1!==i&&(t.crossOrigin="string"==typeof i?i:"anonymous")},e.prototype.upload=function(t,e,i,r){var s=t.gl,o=e.realWidth,a=e.realHeight;return r=r||this.source,s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===n.iw.UNPACK),this.noSubImage||e.target!==s.TEXTURE_2D||i.width!==o||i.height!==a?(i.width=o,i.height=a,s.texImage2D(e.target,0,i.internalFormat,e.format,i.type,r)):s.texSubImage2D(s.TEXTURE_2D,0,0,0,e.format,i.type,r),!0},e.prototype.update=function(){if(!this.destroyed){var e=this.source,i=e.naturalWidth||e.videoWidth||e.width,r=e.naturalHeight||e.videoHeight||e.height;this.resize(i,r),t.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e}(f),x=function(t){function e(e){return t.call(this,e)||this}return p(e,t),e.test=function(t){var e=self.OffscreenCanvas;return!!(e&&t instanceof e)||self.HTMLCanvasElement&&t instanceof HTMLCanvasElement},e}(b),E=function(t){function e(i,r){var s=this,o=r||{},a=o.width,h=o.height,u=o.autoLoad,c=o.linkBaseTexture;if(i&&i.length!==e.SIDES)throw new Error("Invalid length. Got "+i.length+", expected 6");s=t.call(this,6,{width:a,height:h})||this;for(var l=0;l<e.SIDES;l++)s.items[l].target=n.sp.TEXTURE_CUBE_MAP_POSITIVE_X+l;return s.linkBaseTexture=!1!==c,i&&s.initFromArray(i,r),!1!==u&&s.load(),s}return p(e,t),e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=n.sp.TEXTURE_CUBE_MAP},e.prototype.addBaseTextureAt=function(t,e,i){if(void 0===i&&(i=this.linkBaseTexture),!this.items[e])throw new Error("Index "+e+" is out of bounds");if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0){if(!t.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(t.resource,e)}else t.target=n.sp.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this},e.prototype.upload=function(t,i,r){for(var n=this.itemDirtyIds,s=0;s<e.SIDES;s++){var o=this.items[s];n[s]<o.dirtyId&&(o.valid&&o.resource?(o.resource.upload(t,o,r),n[s]=o.dirtyId):n[s]<-1&&(t.gl.texImage2D(o.target,0,r.internalFormat,i.realWidth,i.realHeight,0,i.format,r.type,null),n[s]=-1))}return!0},e.test=function(t){return Array.isArray(t)&&t.length===e.SIDES},e.SIDES=6,e}(v),T=function(t){function e(e,i){var n=this;if(i=i||{},!(e instanceof HTMLImageElement)){var s=new Image;b.crossOrigin(s,e,i.crossorigin),s.src=e,e=s}return n=t.call(this,e)||this,!e.complete&&n._width&&n._height&&(n._width=0,n._height=0),n.url=e.src,n._process=null,n.preserveBitmap=!1,n.createBitmap=(void 0!==i.createBitmap?i.createBitmap:r.X.CREATE_IMAGE_BITMAP)&&!!self.createImageBitmap,n.alphaMode="number"==typeof i.alphaMode?i.alphaMode:null,n.bitmap=null,n._load=null,!1!==i.autoLoad&&n.load(),n}return p(e,t),e.prototype.load=function(t){var e=this;return this._load||(void 0!==t&&(this.createBitmap=t),this._load=new Promise((function(t,i){var r=e.source;e.url=r.src;var n=function(){e.destroyed||(r.onload=null,r.onerror=null,e.resize(r.width,r.height),e._load=null,e.createBitmap?t(e.process()):t(e))};r.complete&&r.src?n():(r.onload=n,r.onerror=function(t){i(t),e.onError.emit(t)})}))),this._load},e.prototype.process=function(){var t=this,e=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!self.createImageBitmap)return Promise.resolve(this);var i=self.createImageBitmap,r=!e.crossOrigin||"anonymous"===e.crossOrigin;return this._process=fetch(e.src,{mode:r?"cors":"no-cors"}).then((function(t){return t.blob()})).then((function(r){return i(r,0,0,e.width,e.height,{premultiplyAlpha:t.alphaMode===n.iw.UNPACK?"premultiply":"none"})})).then((function(e){return t.destroyed?Promise.reject():(t.bitmap=e,t.update(),t._process=null,Promise.resolve(t))})),this._process},e.prototype.upload=function(e,i,r){if("number"==typeof this.alphaMode&&(i.alphaMode=this.alphaMode),!this.createBitmap)return t.prototype.upload.call(this,e,i,r);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(t.prototype.upload.call(this,e,i,r,this.bitmap),!this.preserveBitmap){var n=!0,s=i._glTextures;for(var o in s){var a=s[o];if(a!==r&&a.dirtyId!==i.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,t.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e.test=function(t){return"string"==typeof t||t instanceof HTMLImageElement},e}(b),S=function(t){function e(e,i){var r=this;return i=i||{},(r=t.call(this,document.createElement("canvas"))||this)._width=0,r._height=0,r.svg=e,r.scale=i.scale||1,r._overrideWidth=i.width,r._overrideHeight=i.height,r._resolve=null,r._crossorigin=i.crossorigin,r._load=null,!1!==i.autoLoad&&r.load(),r}return p(e,t),e.prototype.load=function(){var t=this;return this._load||(this._load=new Promise((function(e){if(t._resolve=function(){t.resize(t.source.width,t.source.height),e(t)},/^\<svg/.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()}))),this._load},e.prototype._loadSvg=function(){var t=this,e=new Image;b.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=function(i){t._resolve&&(e.onerror=null,t.onError.emit(i))},e.onload=function(){if(t._resolve){var i=e.width,r=e.height;if(!i||!r)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var n=i*t.scale,o=r*t.scale;(t._overrideWidth||t._overrideHeight)&&(n=t._overrideWidth||t._overrideHeight/r*i,o=t._overrideHeight||t._overrideWidth/i*r),n=Math.round(n),o=Math.round(o);var a=t.source;a.width=n,a.height=o,a._pixiId="canvas_"+(0,s.uid)(),a.getContext("2d").drawImage(e,0,0,i,r,0,0,n,o),t._resolve(),t._resolve=null}}},e.getSize=function(t){var i=e.SVG_SIZE.exec(t),r={};return i&&(r[i[1]]=Math.round(parseFloat(i[3])),r[i[5]]=Math.round(parseFloat(i[7]))),r},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,i){return"svg"===i||"string"==typeof t&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(t)||"string"==typeof t&&e.SVG_XML.test(t)},e.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,e.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,e}(b),w=function(t){function e(i,r){var n=this;if(r=r||{},!(i instanceof HTMLVideoElement)){var s=document.createElement("video");s.setAttribute("preload","auto"),s.setAttribute("webkit-playsinline",""),s.setAttribute("playsinline",""),"string"==typeof i&&(i=[i]);var o=i[0].src||i[0];b.crossOrigin(s,o,r.crossorigin);for(var a=0;a<i.length;++a){var h=document.createElement("source"),u=i[a],c=u.src,l=u.mime,p=(c=c||i[a]).split("?").shift().toLowerCase(),d=p.substr(p.lastIndexOf(".")+1);l=l||e.MIME_TYPES[d]||"video/"+d,h.src=c,h.type=l,s.appendChild(h)}i=s}return(n=t.call(this,i)||this).noSubImage=!0,n._autoUpdate=!0,n._isConnectedToTicker=!1,n._updateFPS=r.updateFPS||0,n._msToNextUpdate=0,n.autoPlay=!1!==r.autoPlay,n._load=null,n._resolve=null,n._onCanPlay=n._onCanPlay.bind(n),n._onError=n._onError.bind(n),!1!==r.autoLoad&&n.load(),n}return p(e,t),e.prototype.update=function(e){if(!this.destroyed){var i=a.vB.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-i),(!this._updateFPS||this._msToNextUpdate<=0)&&(t.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((function(i){t.valid?i(t):(t._resolve=i,e.load())})),this._load},e.prototype._onError=function(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t)},e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&!1===t.paused&&!1===t.ended&&t.readyState>2},e.prototype._isSourceReady=function(){var t=this.source;return 3===t.readyState||4===t.readyState},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(a.vB.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(a.vB.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&(a.vB.shared.remove(this.update,this),this._isConnectedToTicker=!1);var e=this.source;e&&(e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),t.prototype.dispose.call(this)},Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(a.vB.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(a.vB.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(t){t!==this._updateFPS&&(this._updateFPS=t)},enumerable:!1,configurable:!0}),e.test=function(t,i){return self.HTMLVideoElement&&t instanceof HTMLVideoElement||e.TYPES.indexOf(i)>-1},e.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],e.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},e}(b),A=function(t){function e(e){return t.call(this,e)||this}return p(e,t),e.test=function(t){return!!self.createImageBitmap&&t instanceof ImageBitmap},e}(b);u.push(T,A,x,w,S,g,E,y);var C={__proto__:null,Resource:f,BaseImageResource:b,INSTALLED:u,autoDetectResource:c,AbstractMultiResource:v,ArrayResource:y,BufferResource:g,CanvasResource:x,CubeResource:E,ImageResource:T,SVGResource:S,VideoResource:w,ImageBitmapResource:A},O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.upload=function(t,e,i){var r=t.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===n.iw.UNPACK);var s=e.realWidth,o=e.realHeight;return i.width===s&&i.height===o?r.texSubImage2D(e.target,0,0,0,s,o,e.format,i.type,this.data):(i.width=s,i.height=o,r.texImage2D(e.target,0,i.internalFormat,s,o,0,e.format,i.type,this.data)),!0},e}(g),I=function(){function t(t,e){this.width=Math.round(t||100),this.height=Math.round(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new o.R("disposeFramebuffer"),this.multisample=n.G5.NONE}return Object.defineProperty(t.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),t.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new _(null,{scaleMode:n.aH.NEAREST,resolution:1,mipmap:n.WB.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},t.prototype.addDepthTexture=function(t){return this.depthTexture=t||new _(new O(null,{width:this.width,height:this.height}),{scaleMode:n.aH.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:n.WB.OFF,format:n.I2.DEPTH_COMPONENT,type:n.vK.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},t.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},t.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},t.prototype.resize=function(t,e){if(t=Math.round(t),e=Math.round(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],n=r.resolution;r.setSize(t/n,e/n)}this.depthTexture&&(n=this.depthTexture.resolution,this.depthTexture.setSize(t/n,e/n))}},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},t}(),R=function(t){function e(e){var i=this;if("number"==typeof e){var r=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3];e={width:r,height:s,scaleMode:o,resolution:a}}return e.width=e.width||100,e.height=e.height||100,e.multisample=void 0!==e.multisample?e.multisample:n.G5.NONE,(i=t.call(this,null,e)||this).mipmap=n.WB.OFF,i.valid=!0,i.clearColor=[0,0,0,0],i.framebuffer=new I(i.realWidth,i.realHeight).addColorTexture(0,i),i.framebuffer.multisample=e.multisample,i.maskStack=[],i.filterStack=[{}],i}return p(e,t),e.prototype.resize=function(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)},e.prototype.dispose=function(){this.framebuffer.dispose(),t.prototype.dispose.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},e}(_),M=function(){function t(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return t.prototype.set=function(t,e,i){var r=e.width,n=e.height;if(i){var s=t.width/2/r,o=t.height/2/n,a=t.x/r+s,u=t.y/n+o;i=h.Lv.add(i,h.Lv.NW),this.x0=a+s*h.Lv.uX(i),this.y0=u+o*h.Lv.uY(i),i=h.Lv.add(i,2),this.x1=a+s*h.Lv.uX(i),this.y1=u+o*h.Lv.uY(i),i=h.Lv.add(i,2),this.x2=a+s*h.Lv.uX(i),this.y2=u+o*h.Lv.uY(i),i=h.Lv.add(i,2),this.x3=a+s*h.Lv.uX(i),this.y3=u+o*h.Lv.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},t.prototype.toString=function(){return"[@pixi/core:TextureUvs x0="+this.x0+" y0="+this.y0+" x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" y2="+this.y2+" x3="+this.x3+" y3="+this.y3+"]"},t}(),P=new M,N=function(t){function e(i,r,n,s,o,a){var u=t.call(this)||this;if(u.noFrame=!1,r||(u.noFrame=!0,r=new h.Ae(0,0,1,1)),i instanceof e&&(i=i.baseTexture),u.baseTexture=i,u._frame=r,u.trim=s,u.valid=!1,u._uvs=P,u.uvMatrix=null,u.orig=n||r,u._rotate=Number(o||0),!0===o)u._rotate=2;else if(u._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return u.defaultAnchor=a?new h.E9(a.x,a.y):new h.E9(0,0),u._updateID=0,u.textureCacheIds=[],i.valid?u.noFrame?i.valid&&u.onBaseTextureUpdated(i):u.frame=r:i.once("loaded",u.onBaseTextureUpdated,u),u.noFrame&&i.on("update",u.onBaseTextureUpdated,u),u}return p(e,t),e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var i=this.baseTexture.resource;i&&i.url&&s.TextureCache[i.url]&&e.removeFromCache(i.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){var t=this._frame.clone(),i=this._frame===this.orig?t:this.orig.clone(),r=new e(this.baseTexture,!this.noFrame&&t,i,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(r._frame=t),r},e.prototype.updateUvs=function(){this._uvs===P&&(this._uvs=new M),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,i,n){void 0===i&&(i={}),void 0===n&&(n=r.X.STRICT_TEXTURE_CACHE);var o="string"==typeof t,a=null;if(o)a=t;else{if(!t._pixiId){var h=i&&i.pixiIdPrefix||"pixiid";t._pixiId=h+"_"+(0,s.uid)()}a=t._pixiId}var u=s.TextureCache[a];if(o&&n&&!u)throw new Error('The cacheId "'+a+'" does not exist in TextureCache.');return u||(i.resolution||(i.resolution=(0,s.getResolutionOfUrl)(t)),(u=new e(new _(t,i))).baseTexture.cacheId=a,_.addToCache(u.baseTexture,a),e.addToCache(u,a)),u},e.fromURL=function(t,i){var r=Object.assign({autoLoad:!1},null==i?void 0:i.resourceOptions),n=e.from(t,Object.assign({resourceOptions:r},i),!1),s=n.baseTexture.resource;return n.baseTexture.valid?Promise.resolve(n):s.load().then((function(){return Promise.resolve(n)}))},e.fromBuffer=function(t,i,r,n){return new e(_.fromBuffer(t,i,r,n))},e.fromLoader=function(t,i,n,o){var a=new _(t,Object.assign({scaleMode:r.X.SCALE_MODE,resolution:(0,s.getResolutionOfUrl)(i)},o)),h=a.resource;h instanceof T&&(h.url=i);var u=new e(a);return n||(n=i),_.addToCache(u.baseTexture,n),e.addToCache(u,n),n!==i&&(_.addToCache(u.baseTexture,i),e.addToCache(u,i)),u.baseTexture.valid?Promise.resolve(u):new Promise((function(t){u.baseTexture.once("loaded",(function(){return t(u)}))}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),s.TextureCache[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),s.TextureCache[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=s.TextureCache[t];if(e){var i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete s.TextureCache[t],e}}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)s.TextureCache[t.textureCacheIds[r]]===t&&delete s.TextureCache[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperty(e.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame},set:function(t){this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,r=t.width,n=t.height,s=e+r>this.baseTexture.width,o=i+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+r+" = "+(e+r)+" > "+this.baseTexture.width,u="Y: "+i+" + "+n+" = "+(i+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=r&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotate",{get:function(){return this._rotate},set:function(t){this._rotate=t,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),e.prototype.castToBaseTexture=function(){return this.baseTexture},e}(s.EventEmitter);function L(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}N.EMPTY=new N(new _),L(N.EMPTY),L(N.EMPTY.baseTexture),N.WHITE=function(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new N(new _(new x(t)))}(),L(N.WHITE),L(N.WHITE.baseTexture);var D=function(t){function e(e,i){var r=t.call(this,e,i)||this;return r.valid=!0,r.filterFrame=null,r.filterPoolKey=null,r.updateUvs(),r}return p(e,t),Object.defineProperty(e.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"multisample",{get:function(){return this.framebuffer.multisample},set:function(t){this.framebuffer.multisample=t},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,e,i){void 0===i&&(i=!0);var r=this.baseTexture.resolution,n=Math.round(t*r)/r,s=Math.round(e*r)/r;this.valid=n>0&&s>0,this._frame.width=this.orig.width=n,this._frame.height=this.orig.height=s,i&&this.baseTexture.resize(n,s),this.updateUvs()},e.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},e.create=function(t){for(var i=arguments,r=[],n=1;n<arguments.length;n++)r[n-1]=i[n];return"number"==typeof t&&((0,s.deprecation)("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),t={width:t,height:r[0],scaleMode:r[1],resolution:r[2]}),new e(new R(t))},e}(N),k=function(){function t(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return t.prototype.createTexture=function(t,e,i){void 0===i&&(i=n.G5.NONE);var r=new R(Object.assign({width:t,height:e,resolution:1,multisample:i},this.textureOptions));return new D(r)},t.prototype.getOptimalTexture=function(t,e,i,r){var o;void 0===i&&(i=1),void 0===r&&(r=n.G5.NONE),t=Math.ceil(t*i),e=Math.ceil(e*i),this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight?o=r>1?-r:-1:(o=((65535&(t=(0,s.nextPow2)(t)))<<16|65535&(e=(0,s.nextPow2)(e)))>>>0,r>1&&(o+=4294967296*r)),this.texturePool[o]||(this.texturePool[o]=[]);var a=this.texturePool[o].pop();return a||(a=this.createTexture(t,e,r)),a.filterPoolKey=o,a.setResolution(i),a},t.prototype.getFilterTexture=function(t,e,i){var r=this.getOptimalTexture(t.width,t.height,e||t.resolution,i||n.G5.NONE);return r.filterFrame=t.filterFrame,r},t.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},t.prototype.returnFilterTexture=function(t){this.returnTexture(t)},t.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var i=this.texturePool[e];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}},t.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){for(var e in this.enableFullScreen=t.width>0&&t.height>0,this.texturePool)if(Number(e)<0){var i=this.texturePool[e];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}},t.SCREEN_KEY=-1,t}(),B=function(){function t(t,e,i,r,s,o,a){void 0===e&&(e=0),void 0===i&&(i=!1),void 0===r&&(r=n.vK.FLOAT),this.buffer=t,this.size=e,this.normalized=i,this.type=r,this.stride=s,this.start=o,this.instance=a}return t.prototype.destroy=function(){this.buffer=null},t.from=function(e,i,r,n,s){return new t(e,i,r,n,s)},t}(),F=0,G=function(){function t(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=F++,this.disposeRunner=new o.R("disposeBuffer")}return t.prototype.update=function(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroy=function(){this.dispose(),this.data=null},Object.defineProperty(t.prototype,"index",{get:function(){return this.type===n.mr.ELEMENT_ARRAY_BUFFER},set:function(t){this.type=t?n.mr.ELEMENT_ARRAY_BUFFER:n.mr.ARRAY_BUFFER},enumerable:!1,configurable:!0}),t.from=function(e){return e instanceof Array&&(e=new Float32Array(e)),new t(e)},t}(),U={Float32Array,Uint32Array,Int32Array,Uint8Array},j={5126:4,5123:2,5121:1},X=0,z={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},H=function(){function t(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=X++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new o.R("disposeGeometry"),this.refCount=0}return t.prototype.addAttribute=function(t,e,i,r,n,s,o,a){if(void 0===i&&(i=0),void 0===r&&(r=!1),void 0===a&&(a=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof G||(e instanceof Array&&(e=new Float32Array(e)),e=new G(e));var h=t.split("|");if(h.length>1){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,i,r,n);return this}var c=this.buffers.indexOf(e);return-1===c&&(this.buffers.push(e),c=this.buffers.length-1),this.attributes[t]=new B(c,i,r,n,s,o,a),this.instanced=this.instanced||a,this},t.prototype.getAttribute=function(t){return this.attributes[t]},t.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},t.prototype.addIndex=function(t){return t instanceof G||(t instanceof Array&&(t=new Uint16Array(t)),t=new G(t)),t.type=n.mr.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},t.prototype.getIndex=function(){return this.indexBuffer},t.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],i=[],r=new G;for(t in this.attributes){var n=this.attributes[t],o=this.buffers[n.buffer];e.push(o.data),i.push(n.size*j[n.type]/4),n.buffer=0}for(r.data=function(t,e){for(var i=0,r=0,n={},o=0;o<t.length;o++)r+=e[o],i+=t[o].length;var a=new ArrayBuffer(4*i),h=null,u=0;for(o=0;o<t.length;o++){var c=e[o],l=t[o],p=(0,s.getBufferType)(l);n[p]||(n[p]=new U[p](a)),h=n[p];for(var d=0;d<l.length;d++)h[(d/c|0)*r+u+d%c]=l[d];u+=c}return new Float32Array(a)}(e,i),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},t.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},t.prototype.clone=function(){for(var e=new t,i=0;i<this.buffers.length;i++)e.buffers[i]=new G(this.buffers[i].data.slice(0));for(var i in this.attributes){var r=this.attributes[i];e.attributes[i]=new B(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=n.mr.ELEMENT_ARRAY_BUFFER),e},t.merge=function(e){for(var i,r=new t,o=[],a=[],h=[],u=0;u<e.length;u++){i=e[u];for(var c=0;c<i.buffers.length;c++)a[c]=a[c]||0,a[c]+=i.buffers[c].data.length,h[c]=0}for(u=0;u<i.buffers.length;u++)o[u]=new(z[(0,s.getBufferType)(i.buffers[u].data)])(a[u]),r.buffers[u]=new G(o[u]);for(u=0;u<e.length;u++)for(i=e[u],c=0;c<i.buffers.length;c++)o[c].set(i.buffers[c].data,h[c]),h[c]+=i.buffers[c].data.length;if(r.attributes=i.attributes,i.indexBuffer){r.indexBuffer=r.buffers[i.buffers.indexOf(i.indexBuffer)],r.indexBuffer.type=n.mr.ELEMENT_ARRAY_BUFFER;var l=0,p=0,d=0,f=0;for(u=0;u<i.buffers.length;u++)if(i.buffers[u]!==i.indexBuffer){f=u;break}for(var u in i.attributes){var g=i.attributes[u];(0|g.buffer)===f&&(p+=g.size*j[g.type]/4)}for(u=0;u<e.length;u++){var m=e[u].indexBuffer.data;for(c=0;c<m.length;c++)r.indexBuffer.data[c+d]+=l;l+=e[u].buffers[f].data.length/p,d+=m.length}}return r},t}(),V=function(t){function e(){var e=t.call(this)||this;return e.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),e}return p(e,t),e}(H),Y=function(t){function e(){var e=t.call(this)||this;return e.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),e.uvs=new Float32Array([0,0,1,0,1,1,0,1]),e.vertexBuffer=new G(e.vertices),e.uvBuffer=new G(e.uvs),e.addAttribute("aVertexPosition",e.vertexBuffer).addAttribute("aTextureCoord",e.uvBuffer).addIndex([0,1,2,0,2,3]),e}return p(e,t),e.prototype.map=function(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(H),W=0,$=function(){function t(t,e,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=W++,this.static=!!e,this.ubo=!!i,t instanceof G?(this.buffer=t,this.buffer.type=n.mr.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new G(new Float32Array(1)),this.buffer.type=n.mr.UNIFORM_BUFFER,this.autoManage=!0))}return t.prototype.update=function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()},t.prototype.add=function(e,i,r){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[e]=new t(i,r)},t.from=function(e,i,r){return new t(e,i,r)},t.uboFrom=function(e,i){return new t(e,null==i||i,!0)},t}(),q=function(){function t(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=n.G5.NONE,this.sourceFrame=new h.Ae,this.destinationFrame=new h.Ae,this.bindingSourceFrame=new h.Ae,this.bindingDestinationFrame=new h.Ae,this.filters=[],this.transform=null}return t.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},t}(),Z=[new h.E9,new h.E9,new h.E9,new h.E9],K=new h.y3,J=function(){function t(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new k,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new V,this.quadUv=new Y,this.tempRect=new h.Ae,this.activeState={},this.globalUniforms=new $({outputFrame:new h.Ae,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return t.prototype.push=function(t,e){for(var i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new q,s=this.renderer.renderTexture,o=e[0].resolution,a=e[0].multisample,h=e[0].padding,u=e[0].autoFit,c=e[0].legacy,l=1;l<e.length;l++){var p=e[l];o=Math.min(o,p.resolution),a=Math.min(a,p.multisample),h=this.useMaxPadding?Math.max(h,p.padding):h+p.padding,u=u&&p.autoFit,c=c||p.legacy}if(1===r.length&&(this.defaultFilterStack[0].renderTexture=s.current),r.push(n),n.resolution=o,n.multisample=a,n.legacy=c,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(h),u){var d=this.tempRect.copyFrom(s.sourceFrame);i.projection.transform&&this.transformAABB(K.copyFrom(i.projection.transform).invert(),d),n.sourceFrame.fit(d)}this.roundFrame(n.sourceFrame,s.current?s.current.resolution:i.resolution,s.sourceFrame,s.destinationFrame,i.projection.transform),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,o,a),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height;var f=this.tempRect;f.x=0,f.y=0,f.width=n.sourceFrame.width,f.height=n.sourceFrame.height,n.renderTexture.filterFrame=n.sourceFrame,n.bindingSourceFrame.copyFrom(s.sourceFrame),n.bindingDestinationFrame.copyFrom(s.destinationFrame),n.transform=i.projection.transform,i.projection.transform=null,s.bind(n.renderTexture,n.sourceFrame,f),i.framebuffer.clear(0,0,0,0)},t.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var s=r.inputSize,o=r.inputPixel,a=r.inputClamp;if(s[0]=e.destinationFrame.width,s[1]=e.destinationFrame.height,s[2]=1/s[0],s[3]=1/s[1],o[0]=Math.round(s[0]*e.resolution),o[1]=Math.round(s[1]*e.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=e.sourceFrame.width*s[2]-.5*o[2],a[3]=e.sourceFrame.height*s[3]-.5*o[3],e.legacy){var h=r.filterArea;h[0]=e.destinationFrame.width,h[1]=e.destinationFrame.height,h[2]=e.sourceFrame.x,h[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var u=t[t.length-1];if(this.renderer.framebuffer.blit(),1===i.length)i[0].apply(this,e.renderTexture,u.renderTexture,n.yl.BLEND,e),this.returnFilterTexture(e.renderTexture);else{var c=e.renderTexture,l=this.getOptimalFilterTexture(c.width,c.height,e.resolution);l.filterFrame=c.filterFrame;var p=0;for(p=0;p<i.length-1;++p){1===p&&e.multisample>1&&((l=this.getOptimalFilterTexture(c.width,c.height,e.resolution)).filterFrame=c.filterFrame),i[p].apply(this,c,l,n.yl.CLEAR,e);var d=c;c=l,l=d}i[p].apply(this,c,u.renderTexture,n.yl.BLEND,e),p>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(c),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},t.prototype.bindAndClear=function(t,e){void 0===e&&(e=n.yl.CLEAR);var i=this.renderer,r=i.renderTexture,s=i.state;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t&&t.filterFrame){var o=this.tempRect;o.x=0,o.y=0,o.width=t.filterFrame.width,o.height=t.filterFrame.height,r.bind(t,t.filterFrame,o)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?r.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var a=1&s.stateId||this.forceClear;(e===n.yl.CLEAR||e===n.yl.BLIT&&a)&&this.renderer.framebuffer.clear(0,0,0,0)},t.prototype.applyFilter=function(t,e,i,r){var s=this.renderer;s.state.set(t.state),this.bindAndClear(i,r),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,s.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),s.geometry.bind(this.quadUv),s.geometry.draw(n.lg.TRIANGLES)):(s.geometry.bind(this.quad),s.geometry.draw(n.lg.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(t,e){var i=this.activeState,r=i.sourceFrame,n=i.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,r.x,r.y),a=e.worldTransform.copyTo(h.y3.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},t.prototype.destroy=function(){this.renderer=null,this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(t,e,i,r){return void 0===i&&(i=1),void 0===r&&(r=n.G5.NONE),this.texturePool.getOptimalTexture(t,e,i,r)},t.prototype.getFilterTexture=function(t,e,i){if("number"==typeof t){var r=t;t=e,e=r}t=t||this.activeState.renderTexture;var s=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,i||n.G5.NONE);return s.filterFrame=t.filterFrame,s},t.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},t.prototype.transformAABB=function(t,e){var i=Z[0],r=Z[1],n=Z[2],s=Z[3];i.set(e.left,e.top),r.set(e.left,e.bottom),n.set(e.right,e.top),s.set(e.right,e.bottom),t.apply(i,i),t.apply(r,r),t.apply(n,n),t.apply(s,s);var o=Math.min(i.x,r.x,n.x,s.x),a=Math.min(i.y,r.y,n.y,s.y),h=Math.max(i.x,r.x,n.x,s.x),u=Math.max(i.y,r.y,n.y,s.y);e.x=o,e.y=a,e.width=h-o,e.height=u-a},t.prototype.roundFrame=function(t,e,i,r,n){if(n){var s=n.a,o=n.b,a=n.c,h=n.d;if((Math.abs(o)>1e-4||Math.abs(a)>1e-4)&&(Math.abs(s)>1e-4||Math.abs(h)>1e-4))return}(n=n?K.copyFrom(n):K.identity()).translate(-i.x,-i.y).scale(r.width/i.width,r.height/i.height).translate(r.x,r.y),this.transformAABB(n,t),t.ceil(e),this.transformAABB(n.invert(),t)},t}(),Q=function(){function t(t){this.renderer=t}return t.prototype.flush=function(){},t.prototype.destroy=function(){this.renderer=null},t.prototype.start=function(){},t.prototype.stop=function(){this.flush()},t.prototype.render=function(t){},t}(),tt=function(){function t(t){this.renderer=t,this.emptyRenderer=new Q(t),this.currentRenderer=this.emptyRenderer}return t.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.copyBoundTextures=function(t,e){for(var i=this.renderer.texture.boundTextures,r=e-1;r>=0;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)},t.prototype.boundArray=function(t,e,i,r){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){var u=n[h],c=u._batchLocation;if(c>=0&&c<r&&e[c]===u)s[h]=c;else for(;a<r;){var l=e[a];if(!l||l._batchEnabled!==i||l._batchLocation!==a){s[h]=a,u._batchLocation=a,e[a]=u;break}a++}}},t.prototype.destroy=function(){this.renderer=null},t}(),et=0,it=function(){function t(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}return Object.defineProperty(t.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=et++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=et++,this.renderer.runners.contextChange.emit(t)},t.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},t.prototype.createContext=function(t,e){var i;if(r.X.PREFER_ENV>=n.Vi.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl},t.prototype.getExtensions=function(){var t=this.gl,e={anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};1===this.webGLVersion?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})},t.prototype.handleContextLost=function(t){t.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},t.prototype.destroy=function(){var t=this.renderer.view;this.renderer=null,t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},t.prototype.validateContext=function(t){var e=t.getContextAttributes(),i="WebGL2RenderingContext"in self&&t instanceof self.WebGL2RenderingContext;i&&(this.webGLVersion=2),e.stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var r=i||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=r,r||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},t}(),rt=function(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=n.G5.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0},nt=new h.Ae,st=function(){function t(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new I(10,10),this.msaaSamples=null}return t.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new h.Ae,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;r.X.PREFER_ENV===n.Vi.WEBGL_LEGACY&&(e=null,i=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)},t.prototype.bind=function(t,e,i){void 0===i&&(i=0);var r=this.gl;if(t){var n=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,n.framebuffer)),n.mipLevel!==i&&(t.dirtyId++,t.dirtyFormat++,n.mipLevel=i),n.dirtyId!==t.dirtyId&&(n.dirtyId=t.dirtyId,n.dirtyFormat!==t.dirtyFormat?(n.dirtyFormat=t.dirtyFormat,n.dirtySize=t.dirtySize,this.updateFramebuffer(t,i)):n.dirtySize!==t.dirtySize&&(n.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var s=0;s<t.colorTextures.length;s++){var o=t.colorTextures[s];this.renderer.texture.unbind(o.parentTextureArray||o)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){var a=e.width>>i,h=e.height>>i,u=a/e.width;this.setViewport(e.x*u,e.y*u,a,h)}else a=t.width>>i,h=t.height>>i,this.setViewport(0,0,a,h)}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},t.prototype.setViewport=function(t,e,i,r){var n=this.viewport;t=Math.round(t),e=Math.round(e),i=Math.round(i),r=Math.round(r),n.width===i&&n.height===r&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))},Object.defineProperty(t.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),t.prototype.clear=function(t,e,i,r,s){void 0===s&&(s=n.V0.COLOR|n.V0.DEPTH);var o=this.gl;o.clearColor(t,e,i,r),o.clear(s)},t.prototype.initFramebuffer=function(t){var e=this.gl,i=new rt(e.createFramebuffer());return i.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(t),t.disposeRunner.add(this),i},t.prototype.resizeFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,i.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,i.multisample,e.RGBA8,t.width,t.height)),i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),i.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,i.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));var r=t.colorTextures,n=r.length;e.drawBuffers||(n=Math.min(n,1));for(var s=0;s<n;s++){var o=r[s],a=o.parentTextureArray||o;this.renderer.texture.bind(a,0)}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)},t.prototype.updateFramebuffer=function(t,e){var i=this.gl,r=t.glFramebuffers[this.CONTEXT_UID],n=t.colorTextures,s=n.length;i.drawBuffers||(s=Math.min(s,1)),r.multisample>1&&this.canMultisampleFramebuffer(t)?(r.msaaBuffer=r.msaaBuffer||i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,r.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,r.multisample,i.RGBA8,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,r.msaaBuffer)):r.msaaBuffer&&(i.deleteRenderbuffer(r.msaaBuffer),r.msaaBuffer=null,r.blitFramebuffer&&(r.blitFramebuffer.dispose(),r.blitFramebuffer=null));for(var o=[],a=0;a<s;a++){var h=n[a],u=h.parentTextureArray||h;this.renderer.texture.bind(u,0),0===a&&r.msaaBuffer||(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+a,h.target,u._glTextures[this.CONTEXT_UID].texture,e),o.push(i.COLOR_ATTACHMENT0+a))}if(o.length>1&&i.drawBuffers(o),t.depthTexture&&this.writeDepthTexture){var c=t.depthTexture;this.renderer.texture.bind(c,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,c._glTextures[this.CONTEXT_UID].texture,e)}!t.stencil&&!t.depth||t.depthTexture&&this.writeDepthTexture?r.stencil&&(i.deleteRenderbuffer(r.stencil),r.stencil=null):(r.stencil=r.stencil||i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,r.stencil),r.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,r.multisample,i.DEPTH24_STENCIL8,t.width,t.height):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,r.stencil))},t.prototype.canMultisampleFramebuffer=function(t){return 1!==this.renderer.context.webGLVersion&&t.colorTextures.length<=1&&!t.depthTexture},t.prototype.detectSamples=function(t){var e=this.msaaSamples,i=n.G5.NONE;if(t<=1||null===e)return i;for(var r=0;r<e.length;r++)if(e[r]<=t){i=e[r];break}return 1===i&&(i=n.G5.NONE),i},t.prototype.blit=function(t,e,i){var r=this,n=r.current,s=r.renderer,o=r.gl,a=r.CONTEXT_UID;if(2===s.context.webGLVersion&&n){var h=n.glFramebuffers[a];if(h){if(!t){if(!h.msaaBuffer)return;var u=n.colorTextures[0];if(!u)return;h.blitFramebuffer||(h.blitFramebuffer=new I(n.width,n.height),h.blitFramebuffer.addColorTexture(0,u)),(t=h.blitFramebuffer).colorTextures[0]!==u&&(t.colorTextures[0]=u,t.dirtyId++,t.dirtyFormat++),t.width===n.width&&t.height===n.height||(t.width=n.width,t.height=n.height,t.dirtyId++,t.dirtySize++)}e||((e=nt).width=n.width,e.height=n.height),i||(i=e);var c=e.width===i.width&&e.height===i.height;this.bind(t),o.bindFramebuffer(o.READ_FRAMEBUFFER,h.framebuffer),o.blitFramebuffer(e.x,e.y,e.width,e.height,i.x,i.y,i.width,i.height,o.COLOR_BUFFER_BIT,c?o.NEAREST:o.LINEAR)}}},t.prototype.disposeFramebuffer=function(t,e){var i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&r.deleteRenderbuffer(i.msaaBuffer),i.stencil&&r.deleteRenderbuffer(i.stencil)),i.blitFramebuffer&&i.blitFramebuffer.dispose()}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)},t.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.stencil=!0;var i=t.width,r=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),e.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,e.multisample,n.DEPTH24_STENCIL8,i,r):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,i,r),e.stencil=s,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new h.Ae},t.prototype.destroy=function(){this.renderer=null},t}(),ot={5126:4,5123:2,5121:1},at=function(){function t(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}return t.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==e.webGLVersion){var i=this.renderer.context.extensions.vertexArrayObject;r.X.PREFER_ENV===n.Vi.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(t){return i.bindVertexArrayOES(t)},t.deleteVertexArray=function(t){return i.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){return null},t.bindVertexArray=function(){return null},t.deleteVertexArray=function(){return null})}if(2!==e.webGLVersion){var s=t.getExtension("ANGLE_instanced_arrays");s?(t.vertexAttribDivisor=function(t,e){return s.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,i,r,n){return s.drawElementsInstancedANGLE(t,e,i,r,n)},t.drawArraysInstanced=function(t,e,i,r){return s.drawArraysInstancedANGLE(t,e,i,r)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var i=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID],n=!1;r||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={},n=!0);var s=r[e.program.id]||this.initGeometryVao(t,e,n);this._activeGeometry=t,this._activeVao!==s&&(this._activeVao=s,this.hasVao?i.bindVertexArray(s):this.activateVao(t,e.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.renderer.buffer,i=0;i<t.buffers.length;i++){var r=t.buffers[i];e.update(r)}},t.prototype.checkCompatibility=function(t,e){var i=t.attributes,r=e.attributeData;for(var n in r)if(!i[n])throw new Error('shader and geometry incompatible, geometry missing the "'+n+'" attribute')},t.prototype.getSignature=function(t,e){var i=t.attributes,r=e.attributeData,n=["g",t.id];for(var s in i)r[s]&&n.push(s);return n.join("-")},t.prototype.initGeometryVao=function(t,e,i){void 0===i&&(i=!0);var r=this.gl,n=this.CONTEXT_UID,s=this.renderer.buffer,o=e.program;o.glPrograms[n]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,o);var a=this.getSignature(t,o),h=t.glVertexArrayObjects[this.CONTEXT_UID],u=h[a];if(u)return h[o.id]=u,u;var c=t.buffers,l=t.attributes,p={},d={};for(var f in c)p[f]=0,d[f]=0;for(var f in l)!l[f].size&&o.attributeData[f]?l[f].size=o.attributeData[f].size:l[f].size||console.warn("PIXI Geometry attribute '"+f+"' size cannot be determined (likely the bound shader does not have the attribute)"),p[l[f].buffer]+=l[f].size*ot[l[f].type];for(var f in l){var g=l[f],m=g.size;void 0===g.stride&&(p[g.buffer]===m*ot[g.type]?g.stride=0:g.stride=p[g.buffer]),void 0===g.start&&(g.start=d[g.buffer],d[g.buffer]+=m*ot[g.type])}u=r.createVertexArray(),r.bindVertexArray(u);for(var _=0;_<c.length;_++){var v=c[_];s.bind(v),i&&v._glBuffers[n].refCount++}return this.activateVao(t,o),this._activeVao=u,h[o.id]=u,h[a]=u,u},t.prototype.disposeGeometry=function(t,e){var i;if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var r=t.glVertexArrayObjects[this.CONTEXT_UID],n=this.gl,s=t.buffers,o=null===(i=this.renderer)||void 0===i?void 0:i.buffer;if(t.disposeRunner.remove(this),r){if(o)for(var a=0;a<s.length;a++){var h=s[a]._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,0!==h.refCount||e||o.dispose(s[a],e))}if(!e)for(var u in r)if("g"===u[0]){var c=r[u];this._activeVao===c&&this.unbind(),n.deleteVertexArray(c)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t)},t.prototype.activateVao=function(t,e){var i=this.gl,r=this.CONTEXT_UID,n=this.renderer.buffer,s=t.buffers,o=t.attributes;t.indexBuffer&&n.bind(t.indexBuffer);var a=null;for(var h in o){var u=o[h],c=s[u.buffer],l=c._glBuffers[r];if(e.attributeData[h]){a!==l&&(n.bind(c),a=l);var p=e.attributeData[h].location;if(i.enableVertexAttribArray(p),i.vertexAttribPointer(p,u.size,u.type||i.FLOAT,u.normalized,u.stride,u.start),u.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(p,1)}}}},t.prototype.draw=function(t,e,i,r){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(i||0)*o,r||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(i||0)*o):console.warn("unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,i,e||s.getSize(),r||1):n.drawArrays(t,i,e||s.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},t.prototype.destroy=function(){this.renderer=null},t}(),ht=function(){function t(t){void 0===t&&(t=null),this.type=n.A7.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=r.X.FILTER_MULTISAMPLE,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null}return t.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=n.A7.NONE,this.autoDetect=!0),this._target=null},t.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},t}();function ut(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),r}function ct(t,e){var i=t.getShaderSource(e).split("\n").map((function(t,e){return e+": "+t})),r=t.getShaderInfoLog(e),n=r.split("\n"),s={},o=n.map((function(t){return parseFloat(t.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))})).filter((function(t){return!(!t||s[t]||(s[t]=!0,0))})),a=[""];o.forEach((function(t){i[t-1]="%c"+i[t-1]+"%c",a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")}));var h=i.join("\n");a[0]=h,console.error(r),console.groupCollapsed("click to view full shader code"),console.warn.apply(console,a),console.groupEnd()}function lt(t){for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e}function pt(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return lt(2*e);case"bvec3":return lt(3*e);case"bvec4":return lt(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var dt,ft={},gt=ft;function mt(){if(gt===ft||gt&&gt.isContextLost()){var t=document.createElement("canvas"),e=void 0;r.X.PREFER_ENV>=n.Vi.WEBGL2&&(e=t.getContext("webgl2",{})),e||((e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}))?e.getExtension("WEBGL_draw_buffers"):e=null),gt=e}return gt}function _t(t,e,i){if("precision"!==t.substring(0,9)){var r=e;return e===n.cB.HIGH&&i!==n.cB.HIGH&&(r=n.cB.MEDIUM),"precision "+r+" float;\n"+t}return i!==n.cB.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}var vt={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function yt(t){return vt[t]}var bt=null,xt={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Et(t,e){if(!bt){var i=Object.keys(xt);bt={};for(var r=0;r<i.length;++r){var n=i[r];bt[t[n]]=xt[n]}}return bt[e]}var Tt,St=[{test:function(t){return"float"===t.type&&1===t.size},code:function(t){return'\n            if(uv["'+t+'"] !== ud["'+t+'"].value)\n            {\n                ud["'+t+'"].value = uv["'+t+'"]\n                gl.uniform1f(ud["'+t+'"].location, uv["'+t+'"])\n            }\n            '}},{test:function(t){return("sampler2D"===t.type||"samplerCube"===t.type||"sampler2DArray"===t.type)&&1===t.size&&!t.isArray},code:function(t){return't = syncData.textureCount++;\n\n            renderer.texture.bind(uv["'+t+'"], t);\n\n            if(ud["'+t+'"].value !== t)\n            {\n                ud["'+t+'"].value = t;\n                gl.uniform1i(ud["'+t+'"].location, t);\n; // eslint-disable-line max-len\n            }'}},{test:function(t,e){return"mat3"===t.type&&1===t.size&&void 0!==e.a},code:function(t){return'\n            gl.uniformMatrix3fv(ud["'+t+'"].location, false, uv["'+t+'"].toArray(true));\n            '},codeUbo:function(t){return"\n                var "+t+"_matrix = uv."+t+".toArray(true);\n\n                data[offset] = "+t+"_matrix[0];\n                data[offset+1] = "+t+"_matrix[1];\n                data[offset+2] = "+t+"_matrix[2];\n        \n                data[offset + 4] = "+t+"_matrix[3];\n                data[offset + 5] = "+t+"_matrix[4];\n                data[offset + 6] = "+t+"_matrix[5];\n        \n                data[offset + 8] = "+t+"_matrix[6];\n                data[offset + 9] = "+t+"_matrix[7];\n                data[offset + 10] = "+t+"_matrix[8];\n            "}},{test:function(t,e){return"vec2"===t.type&&1===t.size&&void 0!==e.x},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["'+t+'"].location, v.x, v.y);\n                }'},codeUbo:function(t){return"\n                v = uv."+t+";\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            "}},{test:function(t){return"vec2"===t.type&&1===t.size},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["'+t+'"].location, v[0], v[1]);\n                }\n            '}},{test:function(t,e){return"vec4"===t.type&&1===t.size&&void 0!==e.width},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["'+t+'"].location, v.x, v.y, v.width, v.height)\n                }'},codeUbo:function(t){return"\n                    v = uv."+t+";\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                "}},{test:function(t){return"vec4"===t.type&&1===t.size},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["'+t+'"].location, v[0], v[1], v[2], v[3])\n                }'}}],wt={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",uint:"gl.uniform1ui(location, v)",uvec2:"gl.uniform2ui(location, v[0], v[1])",uvec3:"gl.uniform3ui(location, v[0], v[1], v[2])",uvec4:"gl.uniform4ui(location, v[0], v[1], v[2], v[3])",bool:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1i(location, v)\n    }",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},At={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"},Ct=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function Ot(t){for(var e="",i=0;i<t;++i)i>0&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}function It(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var i=e.createShader(e.FRAGMENT_SHADER);;){var r=Ct.replace(/%forloop%/gi,Ot(t));if(e.shaderSource(i,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))break;t=t/2|0}return t}var Rt=0,Mt={},Pt=function(){function t(e,i,s){void 0===s&&(s="pixi-shader"),this.id=Rt++,this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=i||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(s=s.replace(/\s+/g,"-"),Mt[s]?(Mt[s]++,s+="-"+Mt[s]):Mt[s]=1,this.vertexSrc="#define SHADER_NAME "+s+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+s+"\n"+this.fragmentSrc,this.vertexSrc=_t(this.vertexSrc,r.X.PRECISION_VERTEX,n.cB.HIGH),this.fragmentSrc=_t(this.fragmentSrc,r.X.PRECISION_FRAGMENT,function(){if(!dt){dt=n.cB.MEDIUM;var t=mt();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);dt=e.precision?n.cB.HIGH:n.cB.MEDIUM}}return dt}())),this.glPrograms={},this.syncUniforms=null}return Object.defineProperty(t,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},enumerable:!1,configurable:!0}),t.from=function(e,i,r){var n=e+i,o=s.ProgramCache[n];return o||(s.ProgramCache[n]=o=new t(e,i,r)),o},t}(),Nt=function(){function t(t,e){this.uniformBindCount=0,this.program=t,this.uniformGroup=e?e instanceof $?e:new $(e):new $({})}return t.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var i in e.uniforms){var r=e.uniforms[i];if(r.group&&this.checkUniformExists(t,r))return!0}return!1},t.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(t.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),t.from=function(e,i,r){return new t(Pt.from(e,i),r)},t}(),Lt=function(){function t(){this.data=0,this.blendMode=n.T$.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(t.prototype,"blend",{get:function(){return!!(1&this.data)},set:function(t){!!(1&this.data)!==t&&(this.data^=1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offsets",{get:function(){return!!(2&this.data)},set:function(t){!!(2&this.data)!==t&&(this.data^=2)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"culling",{get:function(){return!!(4&this.data)},set:function(t){!!(4&this.data)!==t&&(this.data^=4)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"depthTest",{get:function(){return!!(8&this.data)},set:function(t){!!(8&this.data)!==t&&(this.data^=8)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"depthMask",{get:function(){return!!(32&this.data)},set:function(t){!!(32&this.data)!==t&&(this.data^=32)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clockwiseFrontFace",{get:function(){return!!(16&this.data)},set:function(t){!!(16&this.data)!==t&&(this.data^=16)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blendMode",{get:function(){return this._blendMode},set:function(t){this.blend=t!==n.T$.NONE,this._blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(t){this.offsets=!!t,this._polygonOffset=t},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return"[@pixi/core:State blendMode="+this.blendMode+" clockwiseFrontFace="+this.clockwiseFrontFace+" culling="+this.culling+" depthMask="+this.depthMask+" polygonOffset="+this.polygonOffset+"]"},t.for2d=function(){var e=new t;return e.depthTest=!1,e.blend=!0,e},t}(),Dt=function(t){function e(i,n,s){var o=this,a=Pt.from(i||e.defaultVertexSrc,n||e.defaultFragmentSrc);return(o=t.call(this,a,s)||this).padding=0,o.resolution=r.X.FILTER_RESOLUTION,o.multisample=r.X.FILTER_MULTISAMPLE,o.enabled=!0,o.autoFit=!0,o.state=new Lt,o}return p(e,t),e.prototype.apply=function(t,e,i,r,n){t.applyFilter(this,e,i,r)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._resolution=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},enumerable:!1,configurable:!0}),e}(Nt),kt=new h.y3,Bt=function(){function t(t,e){this._texture=t,this.mapCoord=new h.y3,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}return Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture=t,this._textureID=-1},enumerable:!1,configurable:!0}),t.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,r=0;r<t.length;r+=2){var n=t[r],s=t[r+1];e[r]=n*i.a+s*i.c+i.tx,e[r+1]=n*i.b+s*i.d+i.ty}return e},t.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;var i=e._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=e.orig,n=e.trim;n&&(kt.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(kt));var s=e.baseTexture,o=this.uClampFrame,a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},t}(),Ft=function(t){function e(e){var i=this,r=new h.y3;return i=t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n")||this,e.renderable=!1,i.maskSprite=e,i.maskMatrix=r,i}return p(e,t),e.prototype.apply=function(t,e,i,r){var n=this.maskSprite,s=n._texture;s.valid&&(s.uvMatrix||(s.uvMatrix=new Bt(s,0)),s.uvMatrix.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=s.uvMatrix.uClampFrame,t.applyFilter(this,e,i,r))},e}(Dt),Gt=function(){function t(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return t.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},t.prototype.push=function(t,e){var i=e;if(!i.isMaskData){var r=this.maskDataPool.pop()||new ht;r.pooled=!0,r.maskObject=e,i=r}switch(i.autoDetect&&this.detect(i),i.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),i._target=t,i.type){case n.A7.SCISSOR:this.maskStack.push(i),this.renderer.scissor.push(i);break;case n.A7.STENCIL:this.maskStack.push(i),this.renderer.stencil.push(i);break;case n.A7.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i),this.maskStack.push(i)}},t.prototype.pop=function(t){var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case n.A7.SCISSOR:this.renderer.scissor.pop();break;case n.A7.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case n.A7.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e)}},t.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=n.A7.SPRITE;else if(t.type=n.A7.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var i=e.worldTransform,r=Math.atan2(i.b,i.a),s=Math.atan2(i.d,i.c);r=Math.round(r*(180/Math.PI)*100),s=((s=Math.round(s*(180/Math.PI)*100)-r)%18e3+18e3)%18e3,0==(r=(r%9e3+9e3)%9e3)&&9e3===s&&(t.type=n.A7.SCISSOR)}},t.prototype.pushSpriteMask=function(t){var e,i,r=t.maskObject,n=t._target,s=this.alphaMaskPool[this.alphaMaskIndex];s||(s=this.alphaMaskPool[this.alphaMaskIndex]=[new Ft(r)]);var o,a,h=this.renderer,u=h.renderTexture;if(u.current){var c=u.current;o=t.resolution||c.resolution,a=null!==(e=t.multisample)&&void 0!==e?e:c.multisample}else o=t.resolution||h.resolution,a=null!==(i=t.multisample)&&void 0!==i?i:h.multisample;s[0].resolution=o,s[0].multisample=a,s[0].maskSprite=r;var l=n.filterArea;n.filterArea=r.getBounds(!0),h.filter.push(n,s),n.filterArea=l,this.alphaMaskIndex++},t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t.prototype.destroy=function(){this.renderer=null},t}(),Ut=function(){function t(t){this.renderer=t,this.maskStack=[],this.glConst=0}return t.prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,i=this.getStackLength();this.maskStack=t;var r=this.getStackLength();r!==i&&(0===r?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){this.renderer=null,this.maskStack=null},t}(),jt=function(t){function e(e){var i=t.call(this,e)||this;return i.glConst=WebGLRenderingContext.SCISSOR_TEST,i}return p(e,t),e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var i=t._scissorRect,r=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,i?r.fit(i):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=r,this._useCurrent()},e.prototype.pop=function(){var t=this.renderer.gl;this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,i=this.renderer.projection,r=i.transform,n=i.sourceFrame,s=i.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=s.width/n.width,h=s.height/n.height,u=((t.x-n.x)*a+s.x)*o,c=((t.y-n.y)*h+s.y)*o,l=t.width*a*o,p=t.height*h*o;r&&(u+=r.tx*o,c+=r.ty*o),e||(c=this.renderer.height-p-c),u=Math.round(u),c=Math.round(c),l=Math.round(l),p=Math.round(p),this.renderer.gl.scissor(u,c,l,p)},e}(Ut),Xt=function(t){function e(e){var i=t.call(this,e)||this;return i.glConst=WebGLRenderingContext.STENCIL_TEST,i}return p(e,t),e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var e=t.maskObject,i=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),i.enable(i.STENCIL_TEST)),t._stencilCounter++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,r,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},e.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clearStencil(0),e.clear(e.STENCIL_BUFFER_BIT)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e}(Ut),zt=function(){function t(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new h.y3,this.transform=null}return t.prototype.update=function(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,i,r){var n=this.projectionMatrix,s=r?-1:1;n.identity(),n.a=1/e.width*2,n.d=s*(1/e.height*2),n.tx=-1-e.x*n.a,n.ty=-s-e.y*n.d},t.prototype.setTransform=function(t){},t.prototype.destroy=function(){this.renderer=null},t}(),Ht=new h.Ae,Vt=new h.Ae,Yt=function(){function t(t){this.renderer=t,this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new h.Ae,this.destinationFrame=new h.Ae,this.viewportFrame=new h.Ae}return t.prototype.bind=function(t,e,i){void 0===t&&(t=null);var r,n,s,o=this.renderer;this.current=t,t?(s=(r=t.baseTexture).resolution,e||(Ht.width=t.frame.width,Ht.height=t.frame.height,e=Ht),i||(Vt.x=t.frame.x,Vt.y=t.frame.y,Vt.width=e.width,Vt.height=e.height,i=Vt),n=r.framebuffer):(s=o.resolution,e||(Ht.width=o.screen.width,Ht.height=o.screen.height,e=Ht),i||((i=Ht).width=e.width,i.height=e.height));var a=this.viewportFrame;a.x=i.x*s,a.y=i.y*s,a.width=i.width*s,a.height=i.height*s,t||(a.y=o.view.height-(a.y+a.height)),a.ceil(),this.renderer.framebuffer.bind(n,a),this.renderer.projection.update(i,e,s,!n),t?this.renderer.mask.setMaskStack(r.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(i)},t.prototype.clear=function(t,e){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor;var i=this.destinationFrame,r=this.current?this.current.baseTexture:this.renderer.screen,n=i.width!==r.width||i.height!==r.height;if(n){var s=this.viewportFrame,o=s.x,a=s.y,h=s.width,u=s.height;o=Math.round(o),a=Math.round(a),h=Math.round(h),u=Math.round(u),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(o,a,h,u)}this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],e),n&&this.renderer.scissor.pop()},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t.prototype.destroy=function(){this.renderer=null},t}();function Wt(t,e,i,r,n){i.buffer.update(n)}var $t={float:"\n        data[offset] = v;\n    ",vec2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    ",vec3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    ",vec4:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    ",mat2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    ",mat3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    ",mat4:"\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    "},qt={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function Zt(t){for(var e=t.map((function(t){return{data:t,offset:0,dataLen:0,dirty:0}})),i=0,r=0,n=0,s=0;s<e.length;s++){var o=e[s];if(i=qt[o.data.type],o.data.size>1&&(i=Math.max(i,16)*o.data.size),o.dataLen=i,r%i!=0&&r<16){var a=r%i%16;r+=a,n+=a}r+i>16?(n=16*Math.ceil(n/16),o.offset=n,n+=i,r=i):(o.offset=n,r+=i,n+=i)}return{uboElements:e,size:n=16*Math.ceil(n/16)}}function Kt(t,e){var i=[];for(var r in t)e[r]&&i.push(e[r]);return i.sort((function(t,e){return t.index-e.index})),i}function Jt(t,e){if(!t.autoManage)return{size:0,syncFunc:Wt};for(var i=Zt(Kt(t.uniforms,e)),r=i.uboElements,n=i.size,s=["\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    "],o=0;o<r.length;o++){for(var a=r[o],h=t.uniforms[a.data.name],u=a.data.name,c=!1,l=0;l<St.length;l++){var p=St[l];if(p.codeUbo&&p.test(a.data,h)){s.push("offset = "+a.offset/4+";",St[l].codeUbo(a.data.name,h)),c=!0;break}}if(!c)if(a.data.size>1){var d=yt(a.data.type),f=Math.max(qt[a.data.type]/16,1),g=d/f,m=(4-g%4)%4;s.push("\n                cv = ud."+u+".value;\n                v = uv."+u+";\n                offset = "+a.offset/4+";\n\n                t = 0;\n\n                for(var i=0; i < "+a.data.size*f+"; i++)\n                {\n                    for(var j = 0; j < "+g+"; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += "+m+";\n                }\n\n                ")}else{var _=$t[a.data.type];s.push("\n                cv = ud."+u+".value;\n                v = uv."+u+";\n                offset = "+a.offset/4+";\n                "+_+";\n                ")}}return s.push("\n       renderer.buffer.update(buffer);\n    "),{size:n,syncFunc:new Function("ud","uv","renderer","syncData","buffer",s.join("\n"))}}var Qt=function(){},te=function(){function t(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}return t.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null},t}();function ee(t,e){var i=ut(t,t.VERTEX_SHADER,e.vertexSrc),r=ut(t,t.FRAGMENT_SHADER,e.fragmentSrc),n=t.createProgram();t.attachShader(n,i),t.attachShader(n,r),t.linkProgram(n),t.getProgramParameter(n,t.LINK_STATUS)||function(t,e,i,r){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(i,t.COMPILE_STATUS)||ct(t,i),t.getShaderParameter(r,t.COMPILE_STATUS)||ct(t,r),console.error("PixiJS Error: Could not initialize shader."),""!==t.getProgramInfoLog(e)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}(t,n,i,r),e.attributeData=function(t,e){for(var i={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),n=0;n<r;n++){var s=e.getActiveAttrib(t,n);if(0!==s.name.indexOf("gl_")){var o=Et(e,s.type),a={type:o,name:s.name,size:yt(o),location:n};i[s.name]=a}}return i}(n,t),e.uniformData=function(t,e){for(var i={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<r;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]$/,""),a=!!s.name.match(/\[.*?\]$/),h=Et(e,s.type);i[o]={name:o,index:n,type:h,size:s.size,isArray:a,value:pt(h,s.size)}}return i}(n,t);var s=Object.keys(e.attributeData);s.sort((function(t,e){return t>e?1:-1}));for(var o=0;o<s.length;o++)e.attributeData[s[o]].location=o,t.bindAttribLocation(n,o,s[o]);t.linkProgram(n),t.deleteShader(i),t.deleteShader(r);var a={};for(var o in e.uniformData){var h=e.uniformData[o];a[o]={location:t.getUniformLocation(n,o),value:pt(h.type,h.size)}}return new te(n,a)}var ie=0,re={textureCount:0,uboCount:0},ne=function(){function t(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=ie++}return t.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof Tt)return Tt;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");Tt=!0===t({a:"b"},"a","b")}catch(t){Tt=!1}return Tt}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},t.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),e||(re.textureCount=0,re.uboCount=0,this.syncUniformGroup(t.uniformGroup,re)),r},t.prototype.setUniforms=function(t){var e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t,e){var i=this.getGlProgram();t.static&&t.dirtyId===i.uniformDirtyGroups[t.id]||(i.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,i,e))},t.prototype.syncUniforms=function(t,e,i){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,i)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=function(t,e){var i=["\n        var v = null;\n        var cv = null\n        var t = 0;\n        var gl = renderer.gl\n    "];for(var r in t.uniforms){var n=e[r];if(n){for(var s=t.uniforms[r],o=!1,a=0;a<St.length;a++)if(St[a].test(n,s)){i.push(St[a].code(r,s)),o=!0;break}if(!o){var h=(1===n.size?wt:At)[n.type].replace("location",'ud["'+r+'"].location');i.push('\n            cv = ud["'+r+'"].value;\n            v = uv["'+r+'"];\n            '+h+";")}}else t.uniforms[r].group&&(t.uniforms[r].ubo?i.push("\n                        renderer.shader.syncUniformBufferGroup(uv."+r+", '"+r+"');\n                    "):i.push("\n                        renderer.shader.syncUniformGroup(uv."+r+", syncData);\n                    "))}return new Function("ud","uv","renderer","syncData",i.join("\n"))}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},t.prototype.syncUniformBufferGroup=function(t,e){var i=this.getGlProgram();if(!t.static||0!==t.dirtyId||!i.uniformGroups[t.id]){t.dirtyId=0;var r=i.uniformGroups[t.id]||this.createSyncBufferGroup(t,i,e);t.buffer.update(),r(i.uniformData,t.uniforms,this.renderer,re,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,i.uniformBufferBindings[e])},t.prototype.createSyncBufferGroup=function(t,e,i){var r=this.renderer.gl;this.renderer.buffer.bind(t.buffer);var n=this.gl.getUniformBlockIndex(e.program,i);e.uniformBufferBindings[i]=this.shader.uniformBindCount,r.uniformBlockBinding(e.program,n,this.shader.uniformBindCount),this.shader.uniformBindCount++;var s=this.getSignature(t,this.shader.program.uniformData,"ubo"),o=this._uboCache[s];if(o||(o=this._uboCache[s]=Jt(t,this.shader.program.uniformData)),t.autoManage){var a=new Float32Array(o.size/4);t.buffer.update(a)}return e.uniformGroups[t.id]=o.syncFunc,e.uniformGroups[t.id]},t.prototype.getSignature=function(t,e,i){var r=t.uniforms,n=[i+"-"];for(var s in r)n.push(s),e[s]&&n.push(e[s].type);return n.join("-")},t.prototype.getGlProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateProgram=function(t){var e=this.gl,i=t.program,r=ee(e,i);return i.glPrograms[this.renderer.CONTEXT_UID]=r,r},t.prototype.reset=function(){this.program=null,this.shader=null},t.prototype.destroy=function(){this.renderer=null,this.destroyed=!0},t}(),se=function(){function t(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=n.T$.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new Lt,this.defaultState.blend=!0}return t.prototype.contextChange=function(t){this.gl=t,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[n.T$.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.T$.ADD]=[t.ONE,t.ONE],e[n.T$.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.T$.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.T$.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.T$.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.T$.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.T$.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.T$.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.T$.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.T$.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.T$.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.T$.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.T$.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.T$.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.T$.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.T$.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.T$.NONE]=[0,0],e[n.T$.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.T$.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[n.T$.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.T$.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[n.T$.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[n.T$.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[n.T$.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[n.T$.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[n.T$.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[n.T$.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[n.T$.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[n.T$.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},t.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,i=0;e;)1&e&&this.map[i].call(this,!!(t.data&1<<i)),e>>=1,i++;this.stateId=t.data}for(i=0;i<this.checks.length;i++)this.checks[i](this,t)},t.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data},t.prototype.setBlend=function(e){this.updateCheck(t.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)},t.prototype.setOffset=function(e){this.updateCheck(t.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},t.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},t.prototype.setDepthMask=function(t){this.gl.depthMask(t)},t.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},t.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},t.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],i=this.gl;2===e.length?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},t.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},t.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},t.prototype.updateCheck=function(t,e){var i=this.checks.indexOf(t);e&&-1===i?this.checks.push(t):e||-1===i||this.checks.splice(i,1)},t.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},t.checkPolygonOffset=function(t,e){t.setPolygonOffset(1,e.polygonOffset)},t.prototype.destroy=function(){this.gl=null},t}(),oe=function(){function t(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=r.X.GC_MAX_IDLE,this.checkCountMax=r.X.GC_MAX_CHECK_COUNT,this.mode=r.X.GC_MODE}return t.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==n.UN.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,i=!1,r=0;r<e.length;r++){var n=e[r];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[r]=null,i=!0)}if(i){var s=0;for(r=0;r<e.length;r++)null!==e[r]&&(e[s++]=e[r]);e.length=s}},t.prototype.unload=function(t){var e=this.renderer.texture,i=t._texture;i&&!i.framebuffer&&e.destroyTexture(i);for(var r=t.children.length-1;r>=0;r--)this.unload(t.children[r])},t.prototype.destroy=function(){this.renderer=null},t}(),ae=function(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=n.vK.UNSIGNED_BYTE,this.internalFormat=n.I2.RGBA,this.samplerType=0},he=function(){function t(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new _,this.hasIntegerTextures=!1}return t.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=function(t){var e,i,r,s,o,a,h,u,c,l,p,d,f,g,m,_,v,y,b,x,E,T,S;return"WebGL2RenderingContext"in self&&t instanceof self.WebGL2RenderingContext?((e={})[n.vK.UNSIGNED_BYTE]=((i={})[n.I2.RGBA]=t.RGBA8,i[n.I2.RGB]=t.RGB8,i[n.I2.RG]=t.RG8,i[n.I2.RED]=t.R8,i[n.I2.RGBA_INTEGER]=t.RGBA8UI,i[n.I2.RGB_INTEGER]=t.RGB8UI,i[n.I2.RG_INTEGER]=t.RG8UI,i[n.I2.RED_INTEGER]=t.R8UI,i[n.I2.ALPHA]=t.ALPHA,i[n.I2.LUMINANCE]=t.LUMINANCE,i[n.I2.LUMINANCE_ALPHA]=t.LUMINANCE_ALPHA,i),e[n.vK.BYTE]=((r={})[n.I2.RGBA]=t.RGBA8_SNORM,r[n.I2.RGB]=t.RGB8_SNORM,r[n.I2.RG]=t.RG8_SNORM,r[n.I2.RED]=t.R8_SNORM,r[n.I2.RGBA_INTEGER]=t.RGBA8I,r[n.I2.RGB_INTEGER]=t.RGB8I,r[n.I2.RG_INTEGER]=t.RG8I,r[n.I2.RED_INTEGER]=t.R8I,r),e[n.vK.UNSIGNED_SHORT]=((s={})[n.I2.RGBA_INTEGER]=t.RGBA16UI,s[n.I2.RGB_INTEGER]=t.RGB16UI,s[n.I2.RG_INTEGER]=t.RG16UI,s[n.I2.RED_INTEGER]=t.R16UI,s[n.I2.DEPTH_COMPONENT]=t.DEPTH_COMPONENT16,s),e[n.vK.SHORT]=((o={})[n.I2.RGBA_INTEGER]=t.RGBA16I,o[n.I2.RGB_INTEGER]=t.RGB16I,o[n.I2.RG_INTEGER]=t.RG16I,o[n.I2.RED_INTEGER]=t.R16I,o),e[n.vK.UNSIGNED_INT]=((a={})[n.I2.RGBA_INTEGER]=t.RGBA32UI,a[n.I2.RGB_INTEGER]=t.RGB32UI,a[n.I2.RG_INTEGER]=t.RG32UI,a[n.I2.RED_INTEGER]=t.R32UI,a[n.I2.DEPTH_COMPONENT]=t.DEPTH_COMPONENT24,a),e[n.vK.INT]=((h={})[n.I2.RGBA_INTEGER]=t.RGBA32I,h[n.I2.RGB_INTEGER]=t.RGB32I,h[n.I2.RG_INTEGER]=t.RG32I,h[n.I2.RED_INTEGER]=t.R32I,h),e[n.vK.FLOAT]=((u={})[n.I2.RGBA]=t.RGBA32F,u[n.I2.RGB]=t.RGB32F,u[n.I2.RG]=t.RG32F,u[n.I2.RED]=t.R32F,u[n.I2.DEPTH_COMPONENT]=t.DEPTH_COMPONENT32F,u),e[n.vK.HALF_FLOAT]=((c={})[n.I2.RGBA]=t.RGBA16F,c[n.I2.RGB]=t.RGB16F,c[n.I2.RG]=t.RG16F,c[n.I2.RED]=t.R16F,c),e[n.vK.UNSIGNED_SHORT_5_6_5]=((l={})[n.I2.RGB]=t.RGB565,l),e[n.vK.UNSIGNED_SHORT_4_4_4_4]=((p={})[n.I2.RGBA]=t.RGBA4,p),e[n.vK.UNSIGNED_SHORT_5_5_5_1]=((d={})[n.I2.RGBA]=t.RGB5_A1,d),e[n.vK.UNSIGNED_INT_2_10_10_10_REV]=((f={})[n.I2.RGBA]=t.RGB10_A2,f[n.I2.RGBA_INTEGER]=t.RGB10_A2UI,f),e[n.vK.UNSIGNED_INT_10F_11F_11F_REV]=((g={})[n.I2.RGB]=t.R11F_G11F_B10F,g),e[n.vK.UNSIGNED_INT_5_9_9_9_REV]=((m={})[n.I2.RGB]=t.RGB9_E5,m),e[n.vK.UNSIGNED_INT_24_8]=((_={})[n.I2.DEPTH_STENCIL]=t.DEPTH24_STENCIL8,_),e[n.vK.FLOAT_32_UNSIGNED_INT_24_8_REV]=((v={})[n.I2.DEPTH_STENCIL]=t.DEPTH32F_STENCIL8,v),S=e):((y={})[n.vK.UNSIGNED_BYTE]=((b={})[n.I2.RGBA]=t.RGBA,b[n.I2.RGB]=t.RGB,b[n.I2.ALPHA]=t.ALPHA,b[n.I2.LUMINANCE]=t.LUMINANCE,b[n.I2.LUMINANCE_ALPHA]=t.LUMINANCE_ALPHA,b),y[n.vK.UNSIGNED_SHORT_5_6_5]=((x={})[n.I2.RGB]=t.RGB,x),y[n.vK.UNSIGNED_SHORT_4_4_4_4]=((E={})[n.I2.RGBA]=t.RGBA,E),y[n.vK.UNSIGNED_SHORT_5_5_5_1]=((T={})[n.I2.RGBA]=t.RGBA,T),S=y),S}(t);var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var i=0;i<e;i++)this.boundTextures[i]=null;this.emptyTextures={};var r=new ae(t.createTexture());for(t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new ae(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture),i=0;i<6;i++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);for(t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR),i=0;i<this.boundTextures.length;i++)this.bind(null,i)},t.prototype.bind=function(t,e){void 0===e&&(e=0);var i=this.gl;if((t=null==t?void 0:t.castToBaseTexture())&&t.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null},t.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},t.prototype.unbind=function(t){var e=this.gl,i=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(r=0;r<i.length;r++)i[r]===t&&(this.currentLocation!==r&&(e.activeTexture(e.TEXTURE0+r),this.currentLocation=r),e.bindTexture(t.target,this.emptyTextures[t.target].texture),i[r]=null)},t.prototype.ensureSamplerType=function(t){var e=this,i=e.boundTextures,r=e.hasIntegerTextures,s=e.CONTEXT_UID;if(r)for(var o=t-1;o>=0;--o){var a=i[o];a&&a._glTextures[s].samplerType!==n.oT.FLOAT&&this.renderer.texture.unbind(a)}},t.prototype.initTexture=function(t){var e=new ae(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},t.prototype.initTextureType=function(t,e){var i,r;e.internalFormat=null!==(r=null===(i=this.internalFormats[t.type])||void 0===i?void 0:i[t.format])&&void 0!==r?r:t.format,2===this.webGLVersion&&t.type===n.vK.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var i=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(i,t,e))e.samplerType!==n.oT.FLOAT&&(this.hasIntegerTextures=!0);else{var r=t.realWidth,s=t.realHeight,o=i.gl;(e.width!==r||e.height!==s||e.dirtyId<0)&&(e.width=r,e.height=s,o.texImage2D(t.target,0,e.internalFormat,r,s,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},t.prototype.destroyTexture=function(t,e){var i=this.gl;if((t=t.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var r=this.managedTextures.indexOf(t);-1!==r&&(0,s.removeItems)(this.managedTextures,r,1)}},t.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==n.WB.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=t.mipmap>=1:e.mipmap=!1,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=n.Nt.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},t.prototype.setStyle=function(t,e){var i=this.gl;if(e.mipmap&&t.mipmap!==n.WB.ON_MANUAL&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===n.aH.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&t.anisotropicLevel>0&&t.scaleMode===n.aH.LINEAR){var s=Math.min(t.anisotropicLevel,i.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,s)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===n.aH.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode===n.aH.LINEAR?i.LINEAR:i.NEAREST)},t.prototype.destroy=function(){this.renderer=null},t}(),ue={__proto__:null,FilterSystem:J,BatchSystem:tt,ContextSystem:it,FramebufferSystem:st,GeometrySystem:at,MaskSystem:Gt,ScissorSystem:jt,StencilSystem:Xt,ProjectionSystem:zt,RenderTextureSystem:Yt,ShaderSystem:ne,StateSystem:se,TextureGCSystem:oe,TextureSystem:he},ce=new h.y3,le=function(t){function e(e,i){void 0===e&&(e=n.N3.UNKNOWN);var o=t.call(this)||this;return i=Object.assign({},r.X.RENDER_OPTIONS,i),o.options=i,o.type=e,o.screen=new h.Ae(0,0,i.width,i.height),o.view=i.view||document.createElement("canvas"),o.resolution=i.resolution||r.X.RESOLUTION,o.useContextAlpha=i.useContextAlpha,o.autoDensity=!!i.autoDensity,o.preserveDrawingBuffer=i.preserveDrawingBuffer,o.clearBeforeRender=i.clearBeforeRender,o._backgroundColor=0,o._backgroundColorRgba=[0,0,0,1],o._backgroundColorString="#000000",o.backgroundColor=i.backgroundColor||o._backgroundColor,o.backgroundAlpha=i.backgroundAlpha,void 0!==i.transparent&&((0,s.deprecation)("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),o.useContextAlpha=i.transparent,o.backgroundAlpha=i.transparent?0:1),o._lastObjectRendered=null,o.plugins={},o}return p(e,t),e.prototype.initPlugins=function(t){for(var e in t)this.plugins[e]=new t[e](this)},Object.defineProperty(e.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,e){this.view.width=Math.round(t*this.resolution),this.view.height=Math.round(e*this.resolution);var i=this.view.width/this.resolution,r=this.view.height/this.resolution;this.screen.width=i,this.screen.height=r,this.autoDensity&&(this.view.style.width=i+"px",this.view.style.height=r+"px"),this.emit("resize",i,r)},e.prototype.generateTexture=function(t,e,i,r){void 0===e&&(e={}),"number"==typeof e&&((0,s.deprecation)("6.1.0","generateTexture options (scaleMode, resolution, region) are now object options."),e={scaleMode:e,resolution:i,region:r});var n=e.region,o=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)e.indexOf(r[n])<0&&(i[r[n]]=t[r[n]])}return i}(e,["region"]);0===(r=n||t.getLocalBounds(null,!0)).width&&(r.width=1),0===r.height&&(r.height=1);var a=D.create(d({width:r.width,height:r.height},o));return ce.tx=-r.x,ce.ty=-r.y,this.render(t,{renderTexture:a,clear:!1,transform:ce,skipUpdateTransform:!!t.parent}),a},e.prototype.destroy=function(t){for(var e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null;t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);var i=this;i.plugins=null,i.type=n.N3.UNKNOWN,i.view=null,i.screen=null,i._tempDisplayObjectParent=null,i.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(e.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=(0,s.hex2string)(t),(0,s.hex2rgb)(t,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(t){this._backgroundColorRgba[3]=t},enumerable:!1,configurable:!0}),e}(s.EventEmitter),pe=function(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},de=function(){function t(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}return t.prototype.destroy=function(){this.renderer=null},t.prototype.contextChange=function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID},t.prototype.bind=function(t){var e=this.gl,i=this.CONTEXT_UID,r=t._glBuffers[i]||this.createGLBuffer(t);e.bindBuffer(t.type,r.buffer)},t.prototype.bindBufferBase=function(t,e){var i=this.gl,r=this.CONTEXT_UID;if(this.boundBufferBases[e]!==t){var n=t._glBuffers[r]||this.createGLBuffer(t);this.boundBufferBases[e]=t,i.bindBufferBase(i.UNIFORM_BUFFER,e,n.buffer)}},t.prototype.bindBufferRange=function(t,e,i){var r=this.gl,n=this.CONTEXT_UID;i=i||0;var s=t._glBuffers[n]||this.createGLBuffer(t);r.bindBufferRange(r.UNIFORM_BUFFER,e||0,s.buffer,256*i,256)},t.prototype.update=function(t){var e=this.gl,i=this.CONTEXT_UID,r=t._glBuffers[i];if(t._updateID!==r.updateID)if(r.updateID=t._updateID,e.bindBuffer(t.type,r.buffer),r.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{var n=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;r.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,n)}},t.prototype.dispose=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedBuffers),i=0;i<e.length;i++)this.dispose(this.managedBuffers[e[i]],t)},t.prototype.createGLBuffer=function(t){var e=this.CONTEXT_UID,i=this.gl;return t._glBuffers[e]=new pe(i.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]},t}(),fe=function(t){function e(i){var r=t.call(this,n.N3.WEBGL,i)||this;return i=r.options,r.gl=null,r.CONTEXT_UID=0,r.runners={destroy:new o.R("destroy"),contextChange:new o.R("contextChange"),reset:new o.R("reset"),update:new o.R("update"),postrender:new o.R("postrender"),prerender:new o.R("prerender"),resize:new o.R("resize")},r.runners.contextChange.add(r),r.globalUniforms=new $({projectionMatrix:new h.y3},!0),r.addSystem(Gt,"mask").addSystem(it,"context").addSystem(se,"state").addSystem(ne,"shader").addSystem(he,"texture").addSystem(de,"buffer").addSystem(at,"geometry").addSystem(st,"framebuffer").addSystem(jt,"scissor").addSystem(Xt,"stencil").addSystem(zt,"projection").addSystem(oe,"textureGC").addSystem(J,"filter").addSystem(Yt,"renderTexture").addSystem(tt,"batch"),r.initPlugins(e.__plugins),r.multisample=void 0,i.context?r.context.initFromContext(i.context):r.context.initFromOptions({alpha:!!r.useContextAlpha,antialias:i.antialias,premultipliedAlpha:r.useContextAlpha&&"notMultiplied"!==r.useContextAlpha,stencil:!0,preserveDrawingBuffer:i.preserveDrawingBuffer,powerPreference:r.options.powerPreference}),r.renderingToScreen=!0,(0,s.sayHello)(2===r.context.webGLVersion?"WebGL 2":"WebGL 1"),r.resize(r.options.width,r.options.height),r}return p(e,t),e.create=function(t){if((0,s.isWebGLSupported)())return new e(t);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},e.prototype.contextChange=function(){var t,e=this.gl;if(1===this.context.webGLVersion){var i=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,i)}else i=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,i);t>=n.G5.HIGH?this.multisample=n.G5.HIGH:t>=n.G5.MEDIUM?this.multisample=n.G5.MEDIUM:t>=n.G5.LOW?this.multisample=n.G5.LOW:this.multisample=n.G5.NONE},e.prototype.addSystem=function(t,e){var i=new t(this);if(this[e])throw new Error('Whoops! The name "'+e+'" is already in use');for(var r in this[e]=i,this.runners)this.runners[r].add(i);return this},e.prototype.render=function(t,e){var i,r,n,o;if(e&&(e instanceof D?((0,s.deprecation)("6.0.0","Renderer#render arguments changed, use options instead."),i=e,r=arguments[2],n=arguments[3],o=arguments[4]):(i=e.renderTexture,r=e.clear,n=e.transform,o=e.skipUpdateTransform)),this.renderingToScreen=!i,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=n,!this.context.isLost){if(i||(this._lastObjectRendered=t),!o){var a=t.enableTempParent();t.updateTransform(),t.disableTempParent(a)}this.renderTexture.bind(i),this.batch.currentRenderer.start(),(void 0!==r?r:this.clearBeforeRender)&&this.renderTexture.clear(),t.render(this),this.batch.currentRenderer.flush(),i&&i.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},e.prototype.generateTexture=function(e,i,r,n){void 0===i&&(i={});var s=t.prototype.generateTexture.call(this,e,i,r,n);return this.framebuffer.blit(),s},e.prototype.resize=function(e,i){t.prototype.resize.call(this,e,i),this.runners.resize.emit(this.screen.height,this.screen.width)},e.prototype.reset=function(){return this.runners.reset.emit(),this},e.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},e.prototype.destroy=function(e){for(var i in this.runners.destroy.emit(),this.runners)this.runners[i].destroy();t.prototype.destroy.call(this,e),this.gl=null},Object.defineProperty(e.prototype,"extract",{get:function(){return(0,s.deprecation)("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),e.registerPlugin=function(t,i){e.__plugins=e.__plugins||{},e.__plugins[t]=i},e}(le);function ge(t){return fe.create(t)}var me="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",_e="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",ve=function(){function t(t){(0,s.deprecation)("6.1.0","System class is deprecated, implemement ISystem interface instead."),this.renderer=t}return t.prototype.destroy=function(){this.renderer=null},t}(),ye=function(){this.texArray=null,this.blend=0,this.type=n.lg.TRIANGLES,this.start=0,this.size=0,this.data=null},be=function(){function t(){this.elements=[],this.ids=[],this.count=0}return t.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0},t}(),xe=function(){function t(t){"number"==typeof t?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(t.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),t.prototype.view=function(t){return this[t+"View"]},t.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},t.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},t}(),Ee=function(t){function e(e){var i=t.call(this,e)||this;return i.shaderGenerator=null,i.geometryClass=null,i.vertexSize=null,i.state=Lt.for2d(),i.size=4*r.X.SPRITE_BATCH_SIZE,i._vertexCount=0,i._indexCount=0,i._bufferedElements=[],i._bufferedTextures=[],i._bufferSize=0,i._shader=null,i._packedGeometries=[],i._packedGeometryPoolSize=2,i._flushId=0,i._aBuffers={},i._iBuffers={},i.MAX_TEXTURES=1,i.renderer.on("prerender",i.onPrerender,i),e.runners.contextChange.add(i),i._dcIndex=0,i._aIndex=0,i._iIndex=0,i._attributeBuffer=null,i._indexBuffer=null,i._tempBoundTextures=[],i}return p(e,t),e.prototype.contextChange=function(){var t=this.renderer.gl;r.X.PREFER_ENV===n.Vi.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),r.X.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=It(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},e.prototype.initFlushBuffers=function(){for(var t=e._drawCallPool,i=e._textureArrayPool,r=this.size/4,n=Math.floor(r/this.MAX_TEXTURES)+1;t.length<r;)t.push(new ye);for(;i.length<n;)i.push(new be);for(var s=0;s<this.MAX_TEXTURES;s++)this._tempBoundTextures[s]=null},e.prototype.onPrerender=function(){this._flushId=0},e.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},e.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,i=this.MAX_TEXTURES,r=e._textureArrayPool,n=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count,a=++_._globalBatch,h=0,u=r[0],c=0;n.copyBoundTextures(s,i);for(var l=0;l<this._bufferSize;++l){var p=t[l];t[l]=null,p._batchEnabled!==a&&(u.count>=i&&(n.boundArray(u,s,a,i),this.buildDrawCalls(u,c,l),c=l,u=r[++h],++a),p._batchEnabled=a,p.touched=o,u.elements[u.count++]=p)}for(u.count>0&&(n.boundArray(u,s,a,i),this.buildDrawCalls(u,c,this._bufferSize),++h,++a),l=0;l<s.length;l++)s[l]=null;_._globalBatch=a},e.prototype.buildDrawCalls=function(t,i,r){var n=this,o=n._bufferedElements,a=n._attributeBuffer,h=n._indexBuffer,u=n.vertexSize,c=e._drawCallPool,l=this._dcIndex,p=this._aIndex,d=this._iIndex,f=c[l];f.start=this._iIndex,f.texArray=t;for(var g=i;g<r;++g){var m=o[g],_=m._texture.baseTexture,v=s.premultiplyBlendMode[_.alphaMode?1:0][m.blendMode];o[g]=null,i<g&&f.blend!==v&&(f.size=d-f.start,i=g,(f=c[++l]).texArray=t,f.start=d),this.packInterleavedGeometry(m,a,h,p,d),p+=m.vertexData.length/2*u,d+=m.indices.length,f.blend=v}i<r&&(f.size=d-f.start,++l),this._dcIndex=l,this._aIndex=p,this._iIndex=d},e.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0},e.prototype.updateGeometry=function(){var t=this,e=t._packedGeometries,i=t._attributeBuffer,n=t._indexBuffer;r.X.CAN_UPLOAD_SAME_BUFFER?(e[this._flushId]._buffer.update(i.rawBinaryData),e[this._flushId]._indexBuffer.update(n),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(i.rawBinaryData),e[this._flushId]._indexBuffer.update(n),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},e.prototype.drawBatches=function(){for(var t=this._dcIndex,i=this.renderer,r=i.gl,n=i.state,s=e._drawCallPool,o=null,a=0;a<t;a++){var h=s[a],u=h.texArray,c=h.type,l=h.size,p=h.start,d=h.blend;o!==u&&(o=u,this.bindAndClearTexArray(u)),this.state.blendMode=d,n.set(this.state),r.drawElements(c,l,r.UNSIGNED_SHORT,2*p)}},e.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},e.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),r.X.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),t.prototype.destroy.call(this)},e.prototype.getAttributeBuffer=function(t){var e=(0,s.nextPow2)(Math.ceil(t/8)),i=(0,s.log2)(e),r=8*e;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var n=this._aBuffers[r];return n||(this._aBuffers[r]=n=new xe(r*this.vertexSize*4)),n},e.prototype.getIndexBuffer=function(t){var e=(0,s.nextPow2)(Math.ceil(t/12)),i=(0,s.log2)(e),r=12*e;this._iBuffers.length<=i&&(this._iBuffers.length=i+1);var n=this._iBuffers[i];return n||(this._iBuffers[i]=n=new Uint16Array(r)),n},e.prototype.packInterleavedGeometry=function(t,e,i,r,n){for(var o=e.uint32View,a=e.float32View,h=r/this.vertexSize,u=t.uvs,c=t.indices,l=t.vertexData,p=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),f=d<1&&t._texture.baseTexture.alphaMode?(0,s.premultiplyTint)(t._tintRGB,d):t._tintRGB+(255*d<<24),g=0;g<l.length;g+=2)a[r++]=l[g],a[r++]=l[g+1],a[r++]=u[g],a[r++]=u[g+1],o[r++]=f,a[r++]=p;for(g=0;g<c.length;g++)i[n++]=h+c[g]},e._drawCallPool=[],e._textureArrayPool=[],e}(Q),Te=function(){function t(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return t.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),i=0;i<t;i++)e[i]=i;this.defaultGroupCache[t]=$.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Pt(this.vertexSrc,r)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new h.y3,default:this.defaultGroupCache[t]};return new Nt(this.programCache[t],n)},t.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)i>0&&(e+="\nelse "),i<t-1&&(e+="if(vTextureId < "+i+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return(e+="\n")+"\n"},t}(),Se=function(t){function e(e){void 0===e&&(e=!1);var i=t.call(this)||this;return i._buffer=new G(null,e,!1),i._indexBuffer=new G(null,e,!0),i.addAttribute("aVertexPosition",i._buffer,2,!1,n.vK.FLOAT).addAttribute("aTextureCoord",i._buffer,2,!1,n.vK.FLOAT).addAttribute("aColor",i._buffer,4,!0,n.vK.UNSIGNED_BYTE).addAttribute("aTextureId",i._buffer,1,!0,n.vK.FLOAT).addIndex(i._indexBuffer),i}return p(e,t),e}(H),we="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",Ae="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",Ce=function(){function t(){}return t.create=function(t){var e=Object.assign({vertex:we,fragment:Ae,geometryClass:Se,vertexSize:6},t),i=e.vertex,r=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(t){function e(e){var o=t.call(this,e)||this;return o.shaderGenerator=new Te(i,r),o.geometryClass=s,o.vertexSize=n,o}return p(e,t),e}(Ee)},Object.defineProperty(t,"defaultVertexSrc",{get:function(){return we},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentTemplate",{get:function(){return Ae},enumerable:!1,configurable:!0}),t}(),Oe=Ce.create(),Ie={},Re=function(t){Object.defineProperty(Ie,t,{get:function(){return(0,s.deprecation)("6.0.0","PIXI.systems."+t+" has moved to PIXI."+t),C[t]}})};for(var Me in C)Re(Me);var Pe={},Ne=function(t){Object.defineProperty(Pe,t,{get:function(){return(0,s.deprecation)("6.0.0","PIXI.resources."+t+" has moved to PIXI."+t),ue[t]}})};for(var Me in ue)Ne(Me)},550:(t,e,i)=>{"use strict";i.d(e,{LP:()=>b,aN:()=>y,kC:()=>d,dp:()=>x});var r=i(2038),n=function(){function t(t,e,i){void 0===e&&(e=!1),this._fn=t,this._once=e,this._thisArg=i,this._next=this._prev=this._owner=null}return t.prototype.detach=function(){return null!==this._owner&&(this._owner.detach(this),!0)},t}();function s(t,e){return t._head?(t._tail._next=e,e._prev=t._tail,t._tail=e):(t._head=e,t._tail=e),e._owner=t,e}var o=function(){function t(){this._head=this._tail=void 0}return t.prototype.handlers=function(t){void 0===t&&(t=!1);var e=this._head;if(t)return!!e;for(var i=[];e;)i.push(e),e=e._next;return i},t.prototype.has=function(t){if(!(t instanceof n))throw new Error("MiniSignal#has(): First arg must be a SignalBinding object.");return t._owner===this},t.prototype.dispatch=function(){for(var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];var r=this._head;if(!r)return!1;for(;r;)r._once&&this.detach(r),r._fn.apply(r._thisArg,e),r=r._next;return!0},t.prototype.add=function(t,e){if(void 0===e&&(e=null),"function"!=typeof t)throw new Error("MiniSignal#add(): First arg must be a Function.");return s(this,new n(t,!1,e))},t.prototype.once=function(t,e){if(void 0===e&&(e=null),"function"!=typeof t)throw new Error("MiniSignal#once(): First arg must be a Function.");return s(this,new n(t,!0,e))},t.prototype.detach=function(t){if(!(t instanceof n))throw new Error("MiniSignal#detach(): First arg must be a SignalBinding object.");return t._owner!==this||(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,null===t._next&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null),this},t.prototype.detachAll=function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this},t}();function a(t,e){e=e||{};for(var i={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},r=i.parser[e.strictMode?"strict":"loose"].exec(t),n={},s=14;s--;)n[i.key[s]]=r[s]||"";return n[i.q.name]={},n[i.key[12]].replace(i.q.parser,(function(t,e,r){e&&(n[i.q.name][e]=r)})),n}var h=!(!self.XDomainRequest||"withCredentials"in new XMLHttpRequest),u=null;function c(){}function l(t,e,i){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=i)}function p(t){return t.toString().replace("object ","")}var d=function(){function t(e,i,r){if(this._dequeue=c,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=null,this._boundOnError=null,this._boundOnProgress=null,this._boundOnTimeout=null,this._boundXhrOnError=null,this._boundXhrOnTimeout=null,this._boundXhrOnAbort=null,this._boundXhrOnLoad=null,"string"!=typeof e||"string"!=typeof i)throw new Error("Both name and url are required for constructing a resource.");r=r||{},this._flags=0,this._setFlag(t.STATUS_FLAGS.DATA_URL,0===i.indexOf("data:")),this.name=e,this.url=i,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===r.crossOrigin?"anonymous":r.crossOrigin,this.timeout=r.timeout||0,this.loadType=r.loadType||this._determineLoadType(),this.xhrType=r.xhrType,this.metadata=r.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=t.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=c,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new o,this.onProgress=new o,this.onComplete=new o,this.onAfterMiddleware=new o}return t.setExtensionLoadType=function(e,i){l(t._loadTypeMap,e,i)},t.setExtensionXhrType=function(e,i){l(t._xhrTypeMap,e,i)},Object.defineProperty(t.prototype,"isDataUrl",{get:function(){return this._hasFlag(t.STATUS_FLAGS.DATA_URL)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isComplete",{get:function(){return this._hasFlag(t.STATUS_FLAGS.COMPLETE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLoading",{get:function(){return this._hasFlag(t.STATUS_FLAGS.LOADING)},enumerable:!1,configurable:!0}),t.prototype.complete=function(){this._clearEvents(),this._finish()},t.prototype.abort=function(e){if(!this.error){if(this.error=new Error(e),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=t.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},t.prototype.load=function(e){var i=this;if(!this.isLoading)if(this.isComplete)e&&setTimeout((function(){return e(i)}),1);else switch(e&&this.onComplete.once(e),this._setFlag(t.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case t.LOAD_TYPE.IMAGE:this.type=t.TYPE.IMAGE,this._loadElement("image");break;case t.LOAD_TYPE.AUDIO:this.type=t.TYPE.AUDIO,this._loadSourceElement("audio");break;case t.LOAD_TYPE.VIDEO:this.type=t.TYPE.VIDEO,this._loadSourceElement("video");break;case t.LOAD_TYPE.XHR:default:h&&this.crossOrigin?this._loadXdr():this._loadXhr()}},t.prototype._hasFlag=function(t){return 0!=(this._flags&t)},t.prototype._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},t.prototype._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},t.prototype._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(t.STATUS_FLAGS.COMPLETE,!0),this._setFlag(t.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},t.prototype._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===t&&void 0!==self.Image?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},t.prototype._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===t&&void 0!==self.Audio?this.data=new Audio:this.data=document.createElement(t),null!==this.data){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,i=0;i<this.url.length;++i)this.data.appendChild(this._createSource(t,this.url[i],Array.isArray(e)?e[i]:e));else e=this.metadata.mimeType,this.data.appendChild(this._createSource(t,this.url,Array.isArray(e)?e[0]:e));this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+t)},t.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;e.open("GET",this.url,!0),e.timeout=this.timeout,this.xhrType===t.XHR_RESPONSE_TYPE.JSON||this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=t.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("timeout",this._boundXhrOnTimeout,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},t.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new self.XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout((function(){return t.send()}),1)},t.prototype._createSource=function(t,e,i){i||(i=t+"/"+this._getExtension(e));var r=document.createElement("source");return r.src=e,r.type=i,r},t.prototype._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},t.prototype._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},t.prototype._onTimeout=function(){this.abort("Load timed out.")},t.prototype._xhrOnError=function(){var t=this.xhr;this.abort(p(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},t.prototype._xhrOnTimeout=function(){var t=this.xhr;this.abort(p(t)+" Request timed out.")},t.prototype._xhrOnAbort=function(){var t=this.xhr;this.abort(p(t)+" Request was aborted by the user.")},t.prototype._xhrOnLoad=function(){var e=this.xhr,i="",r=void 0===e.status?200:e.status;if(""!==e.responseType&&"text"!==e.responseType&&void 0!==e.responseType||(i=e.responseText),0===r&&(i.length>0||e.responseType===t.XHR_RESPONSE_TYPE.BUFFER)?r=200:1223===r&&(r=204),2==(r/100|0)){if(this.xhrType===t.XHR_RESPONSE_TYPE.TEXT)this.data=i,this.type=t.TYPE.TEXT;else if(this.xhrType===t.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(i),this.type=t.TYPE.JSON}catch(t){return void this.abort("Error trying to parse loaded json: "+t)}else if(this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT)try{if(self.DOMParser){var n=new DOMParser;this.data=n.parseFromString(i,"text/xml")}else{var s=document.createElement("div");s.innerHTML=i,this.data=s}this.type=t.TYPE.XML}catch(t){return void this.abort("Error trying to parse loaded xml: "+t)}else this.data=e.response||i;this.complete()}else this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL)},t.prototype._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";if(self.origin!==self.location.origin)return"anonymous";e=e||self.location,u||(u=document.createElement("a")),u.href=t;var i=a(u.href,{strictMode:!0}),r=!i.port&&""===e.port||i.port===e.port,n=i.protocol?i.protocol+":":"";return i.host===e.hostname&&r&&n===e.protocol?"":"anonymous"},t.prototype._determineXhrType=function(){return t._xhrTypeMap[this.extension]||t.XHR_RESPONSE_TYPE.TEXT},t.prototype._determineLoadType=function(){return t._loadTypeMap[this.extension]||t.LOAD_TYPE.XHR},t.prototype._getExtension=function(t){void 0===t&&(t=this.url);var e="";if(this.isDataUrl){var i=t.indexOf("/");e=t.substring(i+1,t.indexOf(";",i))}else{var r=t.indexOf("?"),n=t.indexOf("#"),s=Math.min(r>-1?r:t.length,n>-1?n:t.length);e=(t=t.substring(0,s)).substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},t.prototype._getMimeFromXhrType=function(e){switch(e){case t.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case t.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case t.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case t.XHR_RESPONSE_TYPE.JSON:return"application/json";case t.XHR_RESPONSE_TYPE.DEFAULT:case t.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},t}();function f(){}function g(t){return function(){for(var e=arguments,i=[],r=0;r<arguments.length;r++)i[r]=e[r];if(null===t)throw new Error("Callback was already called.");var n=t;t=null,n.apply(this,i)}}!function(t){var e,i,r,n;(n=t.STATUS_FLAGS||(t.STATUS_FLAGS={}))[n.NONE=0]="NONE",n[n.DATA_URL=1]="DATA_URL",n[n.COMPLETE=2]="COMPLETE",n[n.LOADING=4]="LOADING",(r=t.TYPE||(t.TYPE={}))[r.UNKNOWN=0]="UNKNOWN",r[r.JSON=1]="JSON",r[r.XML=2]="XML",r[r.IMAGE=3]="IMAGE",r[r.AUDIO=4]="AUDIO",r[r.VIDEO=5]="VIDEO",r[r.TEXT=6]="TEXT",(i=t.LOAD_TYPE||(t.LOAD_TYPE={}))[i.XHR=1]="XHR",i[i.IMAGE=2]="IMAGE",i[i.AUDIO=3]="AUDIO",i[i.VIDEO=4]="VIDEO",(e=t.XHR_RESPONSE_TYPE||(t.XHR_RESPONSE_TYPE={})).DEFAULT="text",e.BUFFER="arraybuffer",e.BLOB="blob",e.DOCUMENT="document",e.JSON="json",e.TEXT="text",t._loadTypeMap={gif:t.LOAD_TYPE.IMAGE,png:t.LOAD_TYPE.IMAGE,bmp:t.LOAD_TYPE.IMAGE,jpg:t.LOAD_TYPE.IMAGE,jpeg:t.LOAD_TYPE.IMAGE,tif:t.LOAD_TYPE.IMAGE,tiff:t.LOAD_TYPE.IMAGE,webp:t.LOAD_TYPE.IMAGE,tga:t.LOAD_TYPE.IMAGE,svg:t.LOAD_TYPE.IMAGE,"svg+xml":t.LOAD_TYPE.IMAGE,mp3:t.LOAD_TYPE.AUDIO,ogg:t.LOAD_TYPE.AUDIO,wav:t.LOAD_TYPE.AUDIO,mp4:t.LOAD_TYPE.VIDEO,webm:t.LOAD_TYPE.VIDEO},t._xhrTypeMap={xhtml:t.XHR_RESPONSE_TYPE.DOCUMENT,html:t.XHR_RESPONSE_TYPE.DOCUMENT,htm:t.XHR_RESPONSE_TYPE.DOCUMENT,xml:t.XHR_RESPONSE_TYPE.DOCUMENT,tmx:t.XHR_RESPONSE_TYPE.DOCUMENT,svg:t.XHR_RESPONSE_TYPE.DOCUMENT,tsx:t.XHR_RESPONSE_TYPE.DOCUMENT,gif:t.XHR_RESPONSE_TYPE.BLOB,png:t.XHR_RESPONSE_TYPE.BLOB,bmp:t.XHR_RESPONSE_TYPE.BLOB,jpg:t.XHR_RESPONSE_TYPE.BLOB,jpeg:t.XHR_RESPONSE_TYPE.BLOB,tif:t.XHR_RESPONSE_TYPE.BLOB,tiff:t.XHR_RESPONSE_TYPE.BLOB,webp:t.XHR_RESPONSE_TYPE.BLOB,tga:t.XHR_RESPONSE_TYPE.BLOB,json:t.XHR_RESPONSE_TYPE.JSON,text:t.XHR_RESPONSE_TYPE.TEXT,txt:t.XHR_RESPONSE_TYPE.TEXT,ttf:t.XHR_RESPONSE_TYPE.BUFFER,otf:t.XHR_RESPONSE_TYPE.BUFFER},t.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="}(d||(d={}));var m=function(t,e){this.data=t,this.callback=e},_=function(){function t(t,e){var i=this;if(void 0===e&&(e=1),this.workers=0,this.saturated=f,this.unsaturated=f,this.empty=f,this.drain=f,this.error=f,this.started=!1,this.paused=!1,this._tasks=[],this._insert=function(t,e,r){if(r&&"function"!=typeof r)throw new Error("task callback must be a function");if(i.started=!0,null==t&&i.idle())setTimeout((function(){return i.drain()}),1);else{var n=new m(t,"function"==typeof r?r:f);e?i._tasks.unshift(n):i._tasks.push(n),setTimeout(i.process,1)}},this.process=function(){for(;!i.paused&&i.workers<i.concurrency&&i._tasks.length;){var t=i._tasks.shift();0===i._tasks.length&&i.empty(),i.workers+=1,i.workers===i.concurrency&&i.saturated(),i._worker(t.data,g(i._next(t)))}},this._worker=t,0===e)throw new Error("Concurrency must not be zero");this.concurrency=e,this.buffer=e/4}return t.prototype._next=function(t){var e=this;return function(){for(var i=arguments,r=[],n=0;n<arguments.length;n++)r[n]=i[n];e.workers-=1,t.callback.apply(t,r),null!=r[0]&&e.error(r[0],t.data),e.workers<=e.concurrency-e.buffer&&e.unsaturated(),e.idle()&&e.drain(),e.process()}},t.prototype.push=function(t,e){this._insert(t,!1,e)},t.prototype.kill=function(){this.workers=0,this.drain=f,this.started=!1,this._tasks=[]},t.prototype.unshift=function(t,e){this._insert(t,!0,e)},t.prototype.length=function(){return this._tasks.length},t.prototype.running=function(){return this.workers},t.prototype.idle=function(){return this._tasks.length+this.workers===0},t.prototype.pause=function(){!0!==this.paused&&(this.paused=!0)},t.prototype.resume=function(){if(!1!==this.paused){this.paused=!1;for(var t=1;t<=this.concurrency;t++)this.process()}},t.eachSeries=function(t,e,i,r){var n=0,s=t.length;!function o(a){a||n===s?i&&i(a):r?setTimeout((function(){e(t[n++],o)}),1):e(t[n++],o)}()},t.queue=function(e,i){return new t(e,i)},t}(),v=/(#[\w-]+)?$/,y=function(){function t(e,i){var r=this;void 0===e&&(e=""),void 0===i&&(i=10),this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,e){return r._loadResource(t,e)},this.resources={},this.baseUrl=e,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,e){return r._loadResource(t,e)},this._queue=_.queue(this._boundLoadResource,i),this._queue.pause(),this.resources={},this.onProgress=new o,this.onError=new o,this.onLoad=new o,this.onStart=new o,this.onComplete=new o;for(var n=0;n<t._plugins.length;++n){var s=t._plugins[n],a=s.pre,h=s.use;a&&this.pre(a),h&&this.use(h)}this._protected=!1}return t.prototype._add=function(t,e,i,r){if(this.loading&&(!i||!i.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new d(t,e,i),"function"==typeof r&&this.resources[t].onAfterMiddleware.once(r),this.loading){for(var n=i.parentResource,s=[],o=0;o<n.children.length;++o)n.children[o].isComplete||s.push(n.children[o]);var a=n.progressChunk*(s.length+1)/(s.length+2);for(n.children.push(this.resources[t]),n.progressChunk=a,o=0;o<s.length;++o)s[o].progressChunk=a;this.resources[t].progressChunk=a}return this._queue.push(this.resources[t]),this},t.prototype.pre=function(t){return this._beforeMiddleware.push(t),this},t.prototype.use=function(t){return this._afterMiddleware.push(t),this},t.prototype.reset=function(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort("loader reset")}return this.resources={},this},t.prototype.load=function(t){if("function"==typeof t&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var e=100/this._queue._tasks.length,i=0;i<this._queue._tasks.length;++i)this._queue._tasks[i].data.progressChunk=e;this._onStart(),this._queue.resume()}return this},Object.defineProperty(t.prototype,"concurrency",{get:function(){return this._queue.concurrency},set:function(t){this._queue.concurrency=t},enumerable:!1,configurable:!0}),t.prototype._prepareUrl=function(t){var e,i=a(t,{strictMode:!0});if(e=i.protocol||!i.path||0===t.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var r=v.exec(e)[0];-1!==(e=e.substr(0,e.length-r.length)).indexOf("?")?e+="&"+this.defaultQueryString:e+="?"+this.defaultQueryString,e+=r}return e},t.prototype._loadResource=function(t,e){var i=this;t._dequeue=e,_.eachSeries(this._beforeMiddleware,(function(e,r){e.call(i,t,(function(){r(t.isComplete?{}:null)}))}),(function(){t.isComplete?i._onLoad(t):(t._onLoadBinding=t.onComplete.once(i._onLoad,i),t.load())}),!0)},t.prototype._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},t.prototype._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},t.prototype._onLoad=function(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),_.eachSeries(this._afterMiddleware,(function(i,r){i.call(e,t,r)}),(function(){t.onAfterMiddleware.dispatch(t),e.progress=Math.min(100,e.progress+t.progressChunk),e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&0===e._resourcesParsing.length&&e._onComplete()}),!0)},t.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(t,"shared",{get:function(){var e=t._shared;return e||((e=new t)._protected=!0,t._shared=e),e},enumerable:!1,configurable:!0}),t.registerPlugin=function(e){return t._plugins.push(e),e.add&&e.add(),t},t._plugins=[],t}();y.prototype.add=function(t,e,i,r){if(Array.isArray(t)){for(var n=0;n<t.length;++n)this.add(t[n]);return this}if("object"==typeof t&&(i=t,r=e||i.callback||i.onComplete,e=i.url,t=i.name||i.key||i.url),"string"!=typeof e&&(r=i,i=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");return"function"==typeof i&&(r=i,i=null),this._add(t,e,i,r)};var b=function(){function t(){}return t.init=function(t){t=Object.assign({sharedLoader:!1},t),this.loader=t.sharedLoader?y.shared:new y},t.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},t}(),x=function(){function t(){}return t.add=function(){d.setExtensionLoadType("svg",d.LOAD_TYPE.XHR),d.setExtensionXhrType("svg",d.XHR_RESPONSE_TYPE.TEXT)},t.use=function(t,e){if(!t.data||t.type!==d.TYPE.IMAGE&&"svg"!==t.extension)e();else{var i=t.data,n=t.url,s=t.name,o=t.metadata;r.xE.fromLoader(i,n,s,o).then((function(i){t.texture=i,e()})).catch(e)}},t}(),E=self.URL||self.webkitURL;y.registerPlugin({use:function(t,e){if(t.data){if(t.xhr&&t.xhrType===d.XHR_RESPONSE_TYPE.BLOB)if(self.Blob&&"string"!=typeof t.data){if(0===t.data.type.indexOf("image")){var i=E.createObjectURL(t.data);return t.blob=t.data,t.data=new Image,t.data.src=i,t.type=d.TYPE.IMAGE,void(t.data.onload=function(){E.revokeObjectURL(i),t.data.onload=null,e()})}}else{var r=t.xhr.getResponseHeader("content-type");if(r&&0===r.indexOf("image"))return t.data=new Image,t.data.src="data:"+r+";base64,"+function(t){for(var e="",i=0;i<t.length;){for(var r=[0,0,0],n=[0,0,0,0],s=0;s<r.length;++s)i<t.length?r[s]=255&t.charCodeAt(i++):r[s]=0;switch(n[0]=r[0]>>2,n[1]=(3&r[0])<<4|r[1]>>4,n[2]=(15&r[1])<<2|r[2]>>6,n[3]=63&r[2],i-(t.length-1)){case 2:n[3]=64,n[2]=64;break;case 1:n[3]=64}for(s=0;s<n.length;++s)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(n[s])}return e}(t.xhr.responseText),t.type=d.TYPE.IMAGE,void(t.data.onload=function(){t.data.onload=null,e()})}e()}else e()}}),y.registerPlugin(x)},9658:(t,e,i)=>{"use strict";i.d(e,{Cd:()=>h,ZX:()=>o,Pj:()=>u,y3:()=>f,AB:()=>d,_b:()=>n,E9:()=>p,mg:()=>c,jl:()=>s,Ae:()=>a,c9:()=>l,HS:()=>r,wx:()=>T,Lv:()=>E});var r,n=2*Math.PI,s=180/Math.PI,o=Math.PI/180;!function(t){t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC"}(r||(r={}));var a=function(){function t(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(n),this.type=r.RECT}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(t,"EMPTY",{get:function(){return new t(0,0,0,0)},enumerable:!1,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},t.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},t.prototype.fit=function(t){var e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this},t.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this},t.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},t}(),h=function(){function t(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i,this.type=r.CIRC}return t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e;return(r*=r)+(n*=n)<=i},t.prototype.getBounds=function(){return new a(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},t.prototype.toString=function(){return"[@pixi/math:Circle x="+this.x+" y="+this.y+" radius="+this.radius+"]"},t}(),u=function(){function t(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.x=t,this.y=e,this.width=i,this.height=n,this.type=r.ELIP}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1},t.prototype.getBounds=function(){return new a(this.x-this.width,this.y-this.height,this.width,this.height)},t.prototype.toString=function(){return"[@pixi/math:Ellipse x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},t}(),c=function(){function t(){for(var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];var n=Array.isArray(e[0])?e[0]:e;if("number"!=typeof n[0]){for(var s=[],o=0,a=n.length;o<a;o++)s.push(n[o].x,n[o].y);n=s}this.points=n,this.type=r.POLY,this.closeStroke=!0}return t.prototype.clone=function(){var e=new t(this.points.slice());return e.closeStroke=this.closeStroke,e},t.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];a>e!=u>e&&t<(e-a)/(u-a)*(h-o)+o&&(i=!i)}return i},t.prototype.toString=function(){return"[@pixi/math:PolygoncloseStroke="+this.closeStroke+"points="+this.points.reduce((function(t,e){return t+", "+e}),"")+"]"},t}(),l=function(){function t(t,e,i,n,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=20),this.x=t,this.y=e,this.width=i,this.height=n,this.radius=s,this.type=r.RREC}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1},t.prototype.toString=function(){return"[@pixi/math:RoundedRectangle x="+this.x+" y="+this.y+"width="+this.width+" height="+this.height+" radius="+this.radius+"]"},t}(),p=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=0,this.y=0,this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},t.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]"},t}(),d=function(){function t(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e}return t.prototype.clone=function(e,i){return void 0===e&&(e=this.cb),void 0===i&&(i=this.scope),new t(e,i,this._x,this._y)},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},t.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=0 y=0 scope="+this.scope+"]"},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),t}(),f=function(){function t(t,e,i,r,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i},t.prototype.apply=function(t,e){e=e||new p;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new p;var i=1/(this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},t.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},t.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(i*this.a+r*this.c),this.ty=e-(i*this.b+r*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,s=this.d,o=t.pivot,a=-Math.atan2(-r,s),h=Math.atan2(i,e),u=Math.abs(a+h);return u<1e-5||Math.abs(n-u)<1e-5?(t.rotation=h,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=h),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+s*s),t.position.x=this.tx+(o.x*e+o.y*r),t.position.y=this.ty+(o.x*i+o.y*s),t},t.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},t.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},Object.defineProperty(t,"IDENTITY",{get:function(){return new t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t},enumerable:!1,configurable:!0}),t}(),g=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],m=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],_=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],v=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],y=[],b=[],x=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];y.push(e);for(var i=0;i<16;i++)for(var r=x(g[t]*g[i]+_[t]*m[i]),n=x(m[t]*g[i]+v[t]*m[i]),s=x(g[t]*_[i]+_[t]*v[i]),o=x(m[t]*_[i]+v[t]*v[i]),a=0;a<16;a++)if(g[a]===r&&m[a]===n&&_[a]===s&&v[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new f;h.set(g[t],m[t],_[t],v[t],0,0),b.push(h)}}();var E={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return g[t]},uY:function(t){return m[t]},vX:function(t){return _[t]},vY:function(t){return v[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return y[t][e]},sub:function(t,e){return y[t][E.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?E.S:E.N:2*Math.abs(e)<=Math.abs(t)?t>0?E.E:E.W:e>0?t>0?E.SE:E.SW:t>0?E.NE:E.NW},matrixAppendRotationInv:function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=b[E.inv(e)];n.tx=i,n.ty=r,t.append(n)}},T=function(){function t(){this.worldTransform=new f,this.localTransform=new f,this.position=new d(this.onChange,this,0,0),this.scale=new d(this.onChange,this,1,1),this.pivot=new d(this.onChange,this,0,0),this.skew=new d(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.toString=function(){return"[@pixi/math:Transform position=("+this.position.x+", "+this.position.y+") rotation="+this.rotation+" scale=("+this.scale.x+", "+this.scale.y+") skew=("+this.skew.x+", "+this.skew.y+") ]"},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!1,configurable:!0}),t.IDENTITY=new t,t}()},1034:(t,e,i)=>{"use strict";i.d(e,{R:()=>r});var r=function(){function t(t){this.items=[],this._name=t,this._aliasCount=0}return t.prototype.emit=function(t,e,i,r,n,s,o,a){if(arguments.length>8)throw new Error("max arguments reached");var h=this,u=h.name,c=h.items;this._aliasCount++;for(var l=0,p=c.length;l<p;l++)c[l][u](t,e,i,r,n,s,o,a);return c===this.items&&this._aliasCount--,this},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},t.prototype.contains=function(t){return-1!==this.items.indexOf(t)},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),t}();Object.defineProperties(r.prototype,{dispatch:{value:r.prototype.emit},run:{value:r.prototype.emit}})},9319:(t,e,i)=>{"use strict";i.d(e,{t:()=>F,X:()=>G});var r,n,s,o,a,h,u,c,l,p,d,f,g,m,_,v,y,b,x,E=/iPhone/i,T=/iPod/i,S=/iPad/i,w=/\biOS-universal(?:.+)Mac\b/i,A=/\bAndroid(?:.+)Mobile\b/i,C=/Android/i,O=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,I=/Silk/i,R=/Windows Phone/i,M=/\bWindows(?:.+)ARM\b/i,P=/BlackBerry/i,N=/BB10/i,L=/Opera Mini/i,D=/\b(CriOS|Chrome)(?:.+)Mobile/i,k=/Mobile(?:.+)Firefox\b/i,B=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream},F=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var i=e.userAgent,r=i.split("[FBAN");void 0!==r[1]&&(i=r[0]),void 0!==(r=i.split("Twitter"))[1]&&(i=r[0]);var n=function(t){return function(e){return e.test(t)}}(i),s={apple:{phone:n(E)&&!n(R),ipod:n(T),tablet:!n(E)&&(n(S)||B(e))&&!n(R),universal:n(w),device:(n(E)||n(T)||n(S)||n(w)||B(e))&&!n(R)},amazon:{phone:n(O),tablet:!n(O)&&n(I),device:n(O)||n(I)},android:{phone:!n(R)&&n(O)||!n(R)&&n(A),tablet:!n(R)&&!n(O)&&!n(A)&&(n(I)||n(C)),device:!n(R)&&(n(O)||n(I)||n(A)||n(C))||n(/\bokhttp\b/i)},windows:{phone:n(R),tablet:n(M),device:n(R)||n(M)},other:{blackberry:n(P),blackberry10:n(N),opera:n(L),firefox:n(k),chrome:n(D),device:n(P)||n(N)||n(L)||n(k)||n(D)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}(self.navigator);!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(r||(r={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(n||(n={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL"}(s||(s={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(o||(o={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(a||(a={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(h||(h={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(u||(u={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(c||(c={})),function(t){t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT"}(l||(l={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(p||(p={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(d||(d={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL"}(f||(f={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(g||(g={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT"}(m||(m={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(_||(_={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(v||(v={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(y||(y={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH"}(b||(b={})),function(t){t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(x||(x={}));var G={MIPMAP_TEXTURES:f.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,FILTER_MULTISAMPLE:b.NONE,SPRITE_MAX_TEXTURES:function(t){var e,i=!0;(F.tablet||F.phone)&&(F.apple.device&&(e=navigator.userAgent.match(/OS (\d+)_(\d+)?/))&&parseInt(e[1],10)<11&&(i=!1),F.android.device&&(e=navigator.userAgent.match(/Android\s([0-9.]*)/))&&parseInt(e[1],10)<7&&(i=!1));return i?32:4}(),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:_.AUTO,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:d.CLAMP,SCALE_MODE:p.LINEAR,PRECISION_VERTEX:v.HIGH,PRECISION_FRAGMENT:F.apple.device?v.HIGH:v.MEDIUM,CAN_UPLOAD_SAME_BUFFER:!F.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1}},2292:(t,e,i)=>{"use strict";i.r(e),i.d(e,{Filter:()=>L,Filterable:()=>A,Sound:()=>I,SoundLibrary:()=>P,SoundLoader:()=>v,SoundSprite:()=>E,filters:()=>D,htmlaudio:()=>N,sound:()=>G,utils:()=>F,webaudio:()=>k});var r,n=i(550),s=i(8942),o=i(6679),a=i(2038);function h(){return r}var u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)};function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var l=function(){return(l=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},p=["mp3","ogg","oga","opus","mpeg","wav","m4a","aiff","wma","mid","caf"],d={};function f(t){var e=l({m4a:"audio/mp4",oga:"audio/ogg",opus:'audio/ogg; codecs="opus"',caf:'audio/x-caf; codecs="opus"'},t||{}),i=document.createElement("audio"),r={},n=/^no$/;p.forEach((function(t){var s=i.canPlayType("audio/"+t).replace(n,""),o=e[t]?i.canPlayType(e[t]).replace(n,""):"";r[t]=!!s||!!o})),Object.assign(d,r)}f();var g=/\.(\{([^\}]+)\})(\?.*)?$/;function m(t){var e=g,i="string"==typeof t?t:t.url;if(!e.test(i))return i;for(var r=e.exec(i),n=r[2].split(","),s=n[n.length-1],o=0,a=n.length;o<a;o++){var h=n[o];if(d[h]){s=h;break}}var u=i.replace(r[1],s);if("string"!=typeof t){var c=t;c.extension=s,c.url=u}return u}var _,v=function(){function t(){}return t.add=function(){t.setLegacy(h().useLegacy)},t.setLegacy=function(t){var e=p;t?e.forEach((function(t){n.kC.setExtensionXhrType(t,n.kC.XHR_RESPONSE_TYPE.DEFAULT),n.kC.setExtensionLoadType(t,n.kC.LOAD_TYPE.AUDIO)})):e.forEach((function(t){n.kC.setExtensionXhrType(t,n.kC.XHR_RESPONSE_TYPE.BUFFER),n.kC.setExtensionLoadType(t,n.kC.LOAD_TYPE.XHR)}))},t.pre=function(t,e){m(t),e()},t.use=function(t,e){t.data&&p.indexOf(t.extension)>-1?t.sound=h().add(t.name,{loaded:e,preload:!0,url:t.url,source:t.data}):e()},t}(),y=0,b=function(t){function e(e){var i=t.call(this)||this;return i.id=y++,i.init(e),i}return c(e,t),e.prototype.set=function(t,e){if(void 0===this[t])throw new Error("Property with name "+t+" does not exist.");switch(t){case"speed":this.speed=e;break;case"volume":this.volume=e;break;case"paused":this.paused=e;break;case"loop":this.loop=e;break;case"muted":this.muted=e}return this},Object.defineProperty(e.prototype,"progress",{get:function(){return this._source.currentTime/this._duration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},set:function(t){this._paused=t,this.refreshPaused()},enumerable:!1,configurable:!0}),e.prototype._onPlay=function(){this._playing=!0},e.prototype._onPause=function(){this._playing=!1},e.prototype.init=function(t){this._playing=!1,this._duration=t.source.duration;var e=this._source=t.source.cloneNode(!1);e.src=t.parent.url,e.onplay=this._onPlay.bind(this),e.onpause=this._onPause.bind(this),t.context.on("refresh",this.refresh,this),t.context.on("refreshPaused",this.refreshPaused,this),this._media=t},e.prototype._internalStop=function(){this._source&&this._playing&&(this._source.onended=null,this._source.pause())},e.prototype.stop=function(){this._internalStop(),this._source&&this.emit("stop")},Object.defineProperty(e.prototype,"speed",{get:function(){return this._speed},set:function(t){this._speed=t,this.refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=t,this.refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this.refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this._muted},set:function(t){this._muted=t,this.refresh()},enumerable:!1,configurable:!0}),e.prototype.refresh=function(){var t=this._media.context,e=this._media.parent;this._source.loop=this._loop||e.loop;var i=t.volume*(t.muted?0:1),r=e.volume*(e.muted?0:1),n=this._volume*(this._muted?0:1);this._source.volume=n*i*r,this._source.playbackRate=this._speed*t.speed*e.speed},e.prototype.refreshPaused=function(){var t=this._media.context,e=this._media.parent,i=this._paused||e.paused||t.paused;i!==this._pausedReal&&(this._pausedReal=i,i?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._source.currentTime,end:this._end,volume:this._volume,speed:this._speed,loop:this._loop})),this.emit("pause",i))},e.prototype.play=function(t){var i=this,r=t.start,n=t.end,s=t.speed,a=t.loop,h=t.volume,u=t.muted;this._speed=s,this._volume=h,this._loop=!!a,this._muted=u,this.refresh(),this.loop&&null!==n&&(this.loop=!1),this._start=r,this._end=n||this._duration,this._start=Math.max(0,this._start-e.PADDING),this._end=Math.min(this._end+e.PADDING,this._duration),this._source.onloadedmetadata=function(){i._source&&(i._source.currentTime=r,i._source.onloadedmetadata=null,i.emit("progress",r,i._duration),o.vB.shared.add(i._onUpdate,i))},this._source.onended=this._onComplete.bind(this),this._source.play(),this.emit("start")},e.prototype._onUpdate=function(){this.emit("progress",this.progress,this._duration),this._source.currentTime>=this._end&&!this._source.loop&&this._onComplete()},e.prototype._onComplete=function(){o.vB.shared.remove(this._onUpdate,this),this._internalStop(),this.emit("progress",1,this._duration),this.emit("end",this)},e.prototype.destroy=function(){o.vB.shared.remove(this._onUpdate,this),this.removeAllListeners();var t=this._source;t&&(t.onended=null,t.onplay=null,t.onpause=null,this._internalStop()),this._source=null,this._speed=1,this._volume=1,this._loop=!1,this._end=null,this._start=0,this._duration=0,this._playing=!1,this._pausedReal=!1,this._paused=!1,this._muted=!1,this._media&&(this._media.context.off("refresh",this.refresh,this),this._media.context.off("refreshPaused",this.refreshPaused,this),this._media=null)},e.prototype.toString=function(){return"[HTMLAudioInstance id="+this.id+"]"},e.PADDING=.1,e}(s.EventEmitter),x=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.prototype.init=function(t){this.parent=t,this._source=t.options.source||new Audio,t.url&&(this._source.src=t.url)},e.prototype.create=function(){return new b(this)},Object.defineProperty(e.prototype,"isPlayable",{get:function(){return!!this._source&&4===this._source.readyState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._source.duration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){return this.parent.context},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"filters",{get:function(){return null},set:function(t){},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){this.removeAllListeners(),this.parent=null,this._source&&(this._source.src="",this._source.load(),this._source=null)},Object.defineProperty(e.prototype,"source",{get:function(){return this._source},enumerable:!1,configurable:!0}),e.prototype.load=function(t){var e=this._source,i=this.parent;if(4!==e.readyState)if(i.url){e.src=i.url;var r=function(){o(),i.isLoaded=!0;var e=i.autoPlayStart();t&&t(null,i,e)},n=function(){o(),t&&t(new Error("Sound loading has been aborted"))},s=function(){o();var i="Failed to load audio element (code: "+e.error.code+")";t&&t(new Error(i))},o=function(){e.removeEventListener("canplaythrough",r),e.removeEventListener("load",r),e.removeEventListener("abort",n),e.removeEventListener("error",s)};e.addEventListener("canplaythrough",r,!1),e.addEventListener("load",r,!1),e.addEventListener("abort",n,!1),e.addEventListener("error",s,!1),e.load()}else t(new Error("sound.url or sound.source must be set"));else{i.isLoaded=!0;var a=i.autoPlayStart();t&&setTimeout((function(){t(null,i,a)}),0)}},e}(s.EventEmitter),E=function(){function t(t,e){this.parent=t,Object.assign(this,e),this.duration=this.end-this.start}return t.prototype.play=function(t){return this.parent.play({complete:t,speed:this.speed||this.parent.speed,end:this.end,start:this.start,loop:this.loop})},t.prototype.destroy=function(){this.parent=null},t}(),T=function(){function t(){}return t.setParamValue=function(t,e){if(t.setValueAtTime){var i=h().context;t.setValueAtTime(e,i.audioContext.currentTime)}else t.value=e;return e},t}(),S=0,w=function(t){function e(e){var i=t.call(this)||this;return i.id=S++,i._media=null,i._paused=!1,i._muted=!1,i._elapsed=0,i.init(e),i}return c(e,t),e.prototype.set=function(t,e){if(void 0===this[t])throw new Error("Property with name "+t+" does not exist.");switch(t){case"speed":this.speed=e;break;case"volume":this.volume=e;break;case"muted":this.muted=e;break;case"loop":this.loop=e;break;case"paused":this.paused=e}return this},e.prototype.stop=function(){this._source&&(this._internalStop(),this.emit("stop"))},Object.defineProperty(e.prototype,"speed",{get:function(){return this._speed},set:function(t){this._speed=t,this.refresh(),this._update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=t,this.refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this._muted},set:function(t){this._muted=t,this.refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this.refresh()},enumerable:!1,configurable:!0}),e.prototype.refresh=function(){if(this._source){var t=this._media.context,e=this._media.parent;this._source.loop=this._loop||e.loop;var i=t.volume*(t.muted?0:1),r=e.volume*(e.muted?0:1),n=this._volume*(this._muted?0:1);T.setParamValue(this._gain.gain,n*r*i),T.setParamValue(this._source.playbackRate,this._speed*e.speed*t.speed)}},e.prototype.refreshPaused=function(){var t=this._media.context,e=this._media.parent,i=this._paused||e.paused||t.paused;i!==this._pausedReal&&(this._pausedReal=i,i?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._elapsed%this._duration,end:this._end,speed:this._speed,loop:this._loop,volume:this._volume})),this.emit("pause",i))},e.prototype.play=function(t){var e=t.start,i=t.end,r=t.speed,n=t.loop,s=t.volume,o=t.muted;this._paused=!1;var a=this._media.nodes.cloneBufferSource(),h=a.source,u=a.gain;this._source=h,this._gain=u,this._speed=r,this._volume=s,this._loop=!!n,this._muted=o,this.refresh();var c=this._source.buffer.duration;this._duration=c,this._end=i,this._lastUpdate=this._now(),this._elapsed=e,this._source.onended=this._onComplete.bind(this),this._loop?(this._source.loopEnd=i,this._source.loopStart=e,this._source.start(0,e)):i?this._source.start(0,e,i-e):this._source.start(0,e),this.emit("start"),this._update(!0),this.enableTicker(!0)},e.prototype.enableTicker=function(t){o.vB.shared.remove(this._updateListener,this),t&&o.vB.shared.add(this._updateListener,this)},Object.defineProperty(e.prototype,"progress",{get:function(){return this._progress},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},set:function(t){this._paused=t,this.refreshPaused()},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){this.removeAllListeners(),this._internalStop(),this._gain&&(this._gain.disconnect(),this._gain=null),this._media&&(this._media.context.events.off("refresh",this.refresh,this),this._media.context.events.off("refreshPaused",this.refreshPaused,this),this._media=null),this._end=null,this._speed=1,this._volume=1,this._loop=!1,this._elapsed=0,this._duration=0,this._paused=!1,this._muted=!1,this._pausedReal=!1},e.prototype.toString=function(){return"[WebAudioInstance id="+this.id+"]"},e.prototype._now=function(){return this._media.context.audioContext.currentTime},e.prototype._updateListener=function(){this._update()},e.prototype._update=function(t){if(void 0===t&&(t=!1),this._source){var e=this._now(),i=e-this._lastUpdate;if(i>0||t){var r=this._source.playbackRate.value;this._elapsed+=i*r,this._lastUpdate=e;var n=this._duration,s=void 0;if(this._source.loopStart){var o=this._source.loopEnd-this._source.loopStart;s=(this._source.loopStart+this._elapsed%o)/n}else s=this._elapsed%n/n;this._progress=s,this.emit("progress",this._progress,n)}}},e.prototype.init=function(t){this._media=t,t.context.events.on("refresh",this.refresh,this),t.context.events.on("refreshPaused",this.refreshPaused,this)},e.prototype._internalStop=function(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.stop(0),this._source.disconnect();try{this._source.buffer=null}catch(t){}this._source=null}},e.prototype._onComplete=function(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.disconnect();try{this._source.buffer=null}catch(t){}}this._source=null,this._progress=1,this.emit("progress",1,this._duration),this.emit("end",this)},e}(s.EventEmitter),A=function(){function t(t,e){this._output=e,this._input=t}return Object.defineProperty(t.prototype,"destination",{get:function(){return this._input},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"filters",{get:function(){return this._filters},set:function(t){var e=this;if(this._filters&&(this._filters.forEach((function(t){t&&t.disconnect()})),this._filters=null,this._input.connect(this._output)),t&&t.length){this._filters=t.slice(0),this._input.disconnect();var i=null;t.forEach((function(t){null===i?e._input.connect(t.destination):i.connect(t.destination),i=t})),i.connect(this._output)}},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){this.filters=null,this._input=null,this._output=null},t}(),C=function(t){function e(e){var i=this,r=e.audioContext,n=r.createBufferSource(),s=r.createGain(),o=r.createAnalyser();return n.connect(o),o.connect(s),s.connect(e.destination),(i=t.call(this,o,s)||this).context=e,i.bufferSource=n,i.gain=s,i.analyser=o,i}return c(e,t),Object.defineProperty(e.prototype,"script",{get:function(){return this._script||(this._script=this.context.audioContext.createScriptProcessor(e.BUFFER_SIZE),this._script.connect(this.context.destination)),this._script},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){t.prototype.destroy.call(this),this.bufferSource.disconnect(),this._script&&this._script.disconnect(),this.gain.disconnect(),this.analyser.disconnect(),this.bufferSource=null,this._script=null,this.gain=null,this.analyser=null,this.context=null},e.prototype.cloneBufferSource=function(){var t=this.bufferSource,e=this.context.audioContext.createBufferSource();e.buffer=t.buffer,T.setParamValue(e.playbackRate,t.playbackRate.value),e.loop=t.loop;var i=this.context.audioContext.createGain();return e.connect(i),i.connect(this.destination),{source:e,gain:i}},Object.defineProperty(e.prototype,"bufferSize",{get:function(){return this.script.bufferSize},enumerable:!1,configurable:!0}),e.BUFFER_SIZE=0,e}(A),O=function(){function t(){}return t.prototype.init=function(t){this.parent=t,this._nodes=new C(this.context),this._source=this._nodes.bufferSource,this.source=t.options.source},t.prototype.destroy=function(){this.parent=null,this._nodes.destroy(),this._nodes=null;try{this._source.buffer=null}catch(t){}this._source=null,this.source=null},t.prototype.create=function(){return new w(this)},Object.defineProperty(t.prototype,"context",{get:function(){return this.parent.context},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPlayable",{get:function(){return!!this._source&&!!this._source.buffer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"filters",{get:function(){return this._nodes.filters},set:function(t){this._nodes.filters=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return this._source.buffer.duration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"buffer",{get:function(){return this._source.buffer},set:function(t){this._source.buffer=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nodes",{get:function(){return this._nodes},enumerable:!1,configurable:!0}),t.prototype.load=function(t){this.source?this._decode(this.source,t):this.parent.url?this._loadUrl(t):t&&t(new Error("sound.url or sound.source must be set"))},t.prototype._loadUrl=function(t){var e=this,i=new XMLHttpRequest,r=this.parent.url;i.open("GET",r,!0),i.responseType="arraybuffer",i.onload=function(){e.source=i.response,e._decode(i.response,t)},i.send()},t.prototype._decode=function(t,e){var i=this;this.parent.context.decode(t,(function(t,r){if(t)e&&e(t);else{i.parent.isLoaded=!0,i.buffer=r;var n=i.parent.autoPlayStart();e&&e(null,i.parent,n)}}))},t}(),I=function(){function t(t,e){this.media=t,this.options=e,this._instances=[],this._sprites={},this.media.init(this);var i=e.complete;this._autoPlayOptions=i?{complete:i}:null,this.isLoaded=!1,this.isPlaying=!1,this.autoPlay=e.autoPlay,this.singleInstance=e.singleInstance,this.preload=e.preload||this.autoPlay,this.url=e.url,this.speed=e.speed,this.volume=e.volume,this.loop=e.loop,e.sprites&&this.addSprites(e.sprites),this.preload&&this._preload(e.loaded)}return t.from=function(e){var i={};return"string"==typeof e?i.url=e:e instanceof ArrayBuffer||e instanceof HTMLAudioElement?i.source=e:i=e,(i=l({autoPlay:!1,singleInstance:!1,url:null,source:null,preload:!1,volume:1,speed:1,complete:null,loaded:null,loop:!1},i)).url&&(i.url=m(i.url)),Object.freeze(i),new t(h().useLegacy?new x:new O,i)},Object.defineProperty(t.prototype,"context",{get:function(){return h().context},enumerable:!1,configurable:!0}),t.prototype.pause=function(){return this.isPlaying=!1,this.paused=!0,this},t.prototype.resume=function(){return this.isPlaying=this._instances.length>0,this.paused=!1,this},Object.defineProperty(t.prototype,"paused",{get:function(){return this._paused},set:function(t){this._paused=t,this.refreshPaused()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"speed",{get:function(){return this._speed},set:function(t){this._speed=t,this.refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"filters",{get:function(){return this.media.filters},set:function(t){this.media.filters=t},enumerable:!1,configurable:!0}),t.prototype.addSprites=function(t,e){if("object"==typeof t){var i={};for(var r in t)i[r]=this.addSprites(r,t[r]);return i}var n=new E(this,e);return this._sprites[t]=n,n},t.prototype.destroy=function(){this._removeInstances(),this.removeSprites(),this.media.destroy(),this.media=null,this._sprites=null,this._instances=null},t.prototype.removeSprites=function(t){if(t){var e=this._sprites[t];void 0!==e&&(e.destroy(),delete this._sprites[t])}else for(var i in this._sprites)this.removeSprites(i);return this},Object.defineProperty(t.prototype,"isPlayable",{get:function(){return this.isLoaded&&this.media&&this.media.isPlayable},enumerable:!1,configurable:!0}),t.prototype.stop=function(){if(!this.isPlayable)return this.autoPlay=!1,this._autoPlayOptions=null,this;this.isPlaying=!1;for(var t=this._instances.length-1;t>=0;t--)this._instances[t].stop();return this},t.prototype.play=function(t,e){var i,r=this;if("string"==typeof t?i={sprite:s=t,loop:this.loop,complete:e}:"function"==typeof t?(i={}).complete=t:i=t,(i=l({complete:null,loaded:null,sprite:null,end:null,start:0,volume:1,speed:1,muted:!1,loop:!1},i||{})).sprite){var n=i.sprite,s=this._sprites[n];i.start=s.start+(i.start||0),i.end=s.end,i.speed=s.speed||1,i.loop=s.loop||i.loop,delete i.sprite}if(i.offset&&(i.start=i.offset),!this.isLoaded)return new Promise((function(t,e){r.autoPlay=!0,r._autoPlayOptions=i,r._preload((function(r,n,s){r?e(r):(i.loaded&&i.loaded(r,n,s),t(s))}))}));this.singleInstance&&this._removeInstances();var o=this._createInstance();return this._instances.push(o),this.isPlaying=!0,o.once("end",(function(){i.complete&&i.complete(r),r._onComplete(o)})),o.once("stop",(function(){r._onComplete(o)})),o.play(i),o},t.prototype.refresh=function(){for(var t=this._instances.length,e=0;e<t;e++)this._instances[e].refresh()},t.prototype.refreshPaused=function(){for(var t=this._instances.length,e=0;e<t;e++)this._instances[e].refreshPaused()},Object.defineProperty(t.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=t,this.refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"muted",{get:function(){return this._muted},set:function(t){this._muted=t,this.refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this.refresh()},enumerable:!1,configurable:!0}),t.prototype._preload=function(t){this.media.load(t)},Object.defineProperty(t.prototype,"instances",{get:function(){return this._instances},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sprites",{get:function(){return this._sprites},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return this.media.duration},enumerable:!1,configurable:!0}),t.prototype.autoPlayStart=function(){var t;return this.autoPlay&&(t=this.play(this._autoPlayOptions)),t},t.prototype._removeInstances=function(){for(var t=this._instances.length-1;t>=0;t--)this._poolInstance(this._instances[t]);this._instances.length=0},t.prototype._onComplete=function(t){if(this._instances){var e=this._instances.indexOf(t);e>-1&&this._instances.splice(e,1),this.isPlaying=this._instances.length>0}this._poolInstance(t)},t.prototype._createInstance=function(){if(t._pool.length>0){var e=t._pool.pop();return e.init(this.media),e}return this.media.create()},t.prototype._poolInstance=function(e){e.destroy(),t._pool.indexOf(e)<0&&t._pool.push(e)},t._pool=[],t}(),R=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.speed=1,e.muted=!1,e.volume=1,e.paused=!1,e}return c(e,t),e.prototype.refresh=function(){this.emit("refresh")},e.prototype.refreshPaused=function(){this.emit("refreshPaused")},Object.defineProperty(e.prototype,"filters",{get:function(){return null},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"audioContext",{get:function(){return null},enumerable:!1,configurable:!0}),e.prototype.toggleMute=function(){return this.muted=!this.muted,this.refresh(),this.muted},e.prototype.togglePause=function(){return this.paused=!this.paused,this.refreshPaused(),this.paused},e.prototype.destroy=function(){this.removeAllListeners()},e}(s.EventEmitter),M=function(t){function e(){var i=this,r=window,n=new e.AudioContext,o=n.createDynamicsCompressor(),a=n.createAnalyser();return a.connect(o),o.connect(n.destination),(i=t.call(this,a,o)||this)._ctx=n,i._offlineCtx=new e.OfflineAudioContext(1,2,r.OfflineAudioContext?n.sampleRate:44100),i._unlocked=!1,i.compressor=o,i.analyser=a,i.events=new s.EventEmitter,i.volume=1,i.speed=1,i.muted=!1,i.paused=!1,"running"!==n.state&&(i._unlock(),i._unlock=i._unlock.bind(i),document.addEventListener("mousedown",i._unlock,!0),document.addEventListener("touchstart",i._unlock,!0),document.addEventListener("touchend",i._unlock,!0)),i}return c(e,t),e.prototype._unlock=function(){this._unlocked||(this.playEmptySound(),"running"===this._ctx.state&&(document.removeEventListener("mousedown",this._unlock,!0),document.removeEventListener("touchend",this._unlock,!0),document.removeEventListener("touchstart",this._unlock,!0),this._unlocked=!0))},e.prototype.playEmptySound=function(){var t=this._ctx.createBufferSource();t.buffer=this._ctx.createBuffer(1,1,22050),t.connect(this._ctx.destination),t.start(0,0,0),"suspended"===t.context.state&&t.context.resume()},Object.defineProperty(e,"AudioContext",{get:function(){var t=window;return t.AudioContext||t.webkitAudioContext||null},enumerable:!1,configurable:!0}),Object.defineProperty(e,"OfflineAudioContext",{get:function(){var t=window;return t.OfflineAudioContext||t.webkitOfflineAudioContext||null},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){t.prototype.destroy.call(this);var e=this._ctx;void 0!==e.close&&e.close(),this.events.removeAllListeners(),this.analyser.disconnect(),this.compressor.disconnect(),this.analyser=null,this.compressor=null,this.events=null,this._offlineCtx=null,this._ctx=null},Object.defineProperty(e.prototype,"audioContext",{get:function(){return this._ctx},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offlineContext",{get:function(){return this._offlineCtx},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},set:function(t){t&&"running"===this._ctx.state?this._ctx.suspend():t||"suspended"!==this._ctx.state||this._ctx.resume(),this._paused=t},enumerable:!1,configurable:!0}),e.prototype.refresh=function(){this.events.emit("refresh")},e.prototype.refreshPaused=function(){this.events.emit("refreshPaused")},e.prototype.toggleMute=function(){return this.muted=!this.muted,this.refresh(),this.muted},e.prototype.togglePause=function(){return this.paused=!this.paused,this.refreshPaused(),this._paused},e.prototype.decode=function(t,e){var i=function(t){e(new Error(t.message||"Unable to decode file"))},r=this._offlineCtx.decodeAudioData(t,(function(t){e(null,t)}),i);r&&r.catch(i)},e}(A),P=function(){function t(){this.init()}return t.prototype.init=function(){return this.supported&&(this._webAudioContext=new M),this._htmlAudioContext=new R,this._sounds={},this.useLegacy=!this.supported,this},Object.defineProperty(t.prototype,"context",{get:function(){return this._context},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"filtersAll",{get:function(){return this.useLegacy?[]:this._context.filters},set:function(t){this.useLegacy||(this._context.filters=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supported",{get:function(){return null!==M.AudioContext},enumerable:!1,configurable:!0}),t.prototype.add=function(t,e){if("object"==typeof t){var i={};for(var r in t){var n=this._getOptions(t[r],e);i[r]=this.add(r,n)}return i}if(e instanceof I)return this._sounds[t]=e,e;var s=this._getOptions(e),o=I.from(s);return this._sounds[t]=o,o},t.prototype._getOptions=function(t,e){var i;return i="string"==typeof t?{url:t}:t instanceof ArrayBuffer||t instanceof HTMLAudioElement?{source:t}:t,l(l({},i),e||{})},Object.defineProperty(t.prototype,"useLegacy",{get:function(){return this._useLegacy},set:function(t){v.setLegacy(t),this._useLegacy=t,this._context=!t&&this.supported?this._webAudioContext:this._htmlAudioContext},enumerable:!1,configurable:!0}),t.prototype.remove=function(t){return this.exists(t,!0),this._sounds[t].destroy(),delete this._sounds[t],this},Object.defineProperty(t.prototype,"volumeAll",{get:function(){return this._context.volume},set:function(t){this._context.volume=t,this._context.refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"speedAll",{get:function(){return this._context.speed},set:function(t){this._context.speed=t,this._context.refresh()},enumerable:!1,configurable:!0}),t.prototype.togglePauseAll=function(){return this._context.togglePause()},t.prototype.pauseAll=function(){return this._context.paused=!0,this._context.refreshPaused(),this},t.prototype.resumeAll=function(){return this._context.paused=!1,this._context.refreshPaused(),this},t.prototype.toggleMuteAll=function(){return this._context.toggleMute()},t.prototype.muteAll=function(){return this._context.muted=!0,this._context.refresh(),this},t.prototype.unmuteAll=function(){return this._context.muted=!1,this._context.refresh(),this},t.prototype.removeAll=function(){for(var t in this._sounds)this._sounds[t].destroy(),delete this._sounds[t];return this},t.prototype.stopAll=function(){for(var t in this._sounds)this._sounds[t].stop();return this},t.prototype.exists=function(t,e){return void 0===e&&(e=!1),!!this._sounds[t]},t.prototype.find=function(t){return this.exists(t,!0),this._sounds[t]},t.prototype.play=function(t,e){return this.find(t).play(e)},t.prototype.stop=function(t){return this.find(t).stop()},t.prototype.pause=function(t){return this.find(t).pause()},t.prototype.resume=function(t){return this.find(t).resume()},t.prototype.volume=function(t,e){var i=this.find(t);return void 0!==e&&(i.volume=e),i.volume},t.prototype.speed=function(t,e){var i=this.find(t);return void 0!==e&&(i.speed=e),i.speed},t.prototype.duration=function(t){return this.find(t).duration},t.prototype.close=function(){return this.removeAll(),this._sounds=null,this._webAudioContext&&(this._webAudioContext.destroy(),this._webAudioContext=null),this._htmlAudioContext&&(this._htmlAudioContext.destroy(),this._htmlAudioContext=null),this._context=null,this},t}(),N={HTMLAudioContext:R,HTMLAudioMedia:x,HTMLAudioInstance:b},L=function(){function t(t,e){this.init(t,e)}return t.prototype.init=function(t,e){this.destination=t,this.source=e||t},t.prototype.connect=function(t){this.source.connect(t)},t.prototype.disconnect=function(){this.source.disconnect()},t.prototype.destroy=function(){this.disconnect(),this.destination=null,this.source=null},t}(),D={Filter:L,EqualizerFilter:function(t){function e(i,r,n,s,o,a,u,c,l,p){void 0===i&&(i=0),void 0===r&&(r=0),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===u&&(u=0),void 0===c&&(c=0),void 0===l&&(l=0),void 0===p&&(p=0);var d=this;if(!h().useLegacy){var f=[{f:e.F32,type:"lowshelf",gain:i},{f:e.F64,type:"peaking",gain:r},{f:e.F125,type:"peaking",gain:n},{f:e.F250,type:"peaking",gain:s},{f:e.F500,type:"peaking",gain:o},{f:e.F1K,type:"peaking",gain:a},{f:e.F2K,type:"peaking",gain:u},{f:e.F4K,type:"peaking",gain:c},{f:e.F8K,type:"peaking",gain:l},{f:e.F16K,type:"highshelf",gain:p}].map((function(t){var e=h().context.audioContext.createBiquadFilter();return e.type=t.type,T.setParamValue(e.Q,1),e.frequency.value=t.f,T.setParamValue(e.gain,t.gain),e}));(d=t.call(this,f[0],f[f.length-1])||this).bands=f,d.bandsMap={};for(var g=0;g<d.bands.length;g++){var m=d.bands[g];g>0&&d.bands[g-1].connect(m),d.bandsMap[m.frequency.value]=m}return d}d=t.call(this,null)||this}return c(e,t),e.prototype.setGain=function(t,e){if(void 0===e&&(e=0),!this.bandsMap[t])throw new Error("No band found for frequency "+t);T.setParamValue(this.bandsMap[t].gain,e)},e.prototype.getGain=function(t){if(!this.bandsMap[t])throw new Error("No band found for frequency "+t);return this.bandsMap[t].gain.value},Object.defineProperty(e.prototype,"f32",{get:function(){return this.getGain(e.F32)},set:function(t){this.setGain(e.F32,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"f64",{get:function(){return this.getGain(e.F64)},set:function(t){this.setGain(e.F64,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"f125",{get:function(){return this.getGain(e.F125)},set:function(t){this.setGain(e.F125,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"f250",{get:function(){return this.getGain(e.F250)},set:function(t){this.setGain(e.F250,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"f500",{get:function(){return this.getGain(e.F500)},set:function(t){this.setGain(e.F500,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"f1k",{get:function(){return this.getGain(e.F1K)},set:function(t){this.setGain(e.F1K,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"f2k",{get:function(){return this.getGain(e.F2K)},set:function(t){this.setGain(e.F2K,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"f4k",{get:function(){return this.getGain(e.F4K)},set:function(t){this.setGain(e.F4K,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"f8k",{get:function(){return this.getGain(e.F8K)},set:function(t){this.setGain(e.F8K,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"f16k",{get:function(){return this.getGain(e.F16K)},set:function(t){this.setGain(e.F16K,t)},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this.bands.forEach((function(t){T.setParamValue(t.gain,0)}))},e.prototype.destroy=function(){this.bands.forEach((function(t){t.disconnect()})),this.bands=null,this.bandsMap=null},e.F32=32,e.F64=64,e.F125=125,e.F250=250,e.F500=500,e.F1K=1e3,e.F2K=2e3,e.F4K=4e3,e.F8K=8e3,e.F16K=16e3,e}(L),DistortionFilter:function(t){function e(e){void 0===e&&(e=0);var i=this;if(!h().useLegacy){var r=h().context.audioContext.createWaveShaper();return(i=t.call(this,r)||this)._distortion=r,i.amount=e,i}i=t.call(this,null)||this}return c(e,t),Object.defineProperty(e.prototype,"amount",{get:function(){return this._amount},set:function(t){t*=1e3,this._amount=t;for(var e,i=44100,r=new Float32Array(i),n=Math.PI/180,s=0;s<i;++s)e=2*s/i-1,r[s]=(3+t)*e*20*n/(Math.PI+t*Math.abs(e));this._distortion.curve=r,this._distortion.oversample="4x"},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){this._distortion=null,t.prototype.destroy.call(this)},e}(L),StereoFilter:function(t){function e(e){void 0===e&&(e=0);var i=this;if(!h().useLegacy){var r,n,s,o=h().context.audioContext;return o.createStereoPanner?s=r=o.createStereoPanner():((n=o.createPanner()).panningModel="equalpower",s=n),(i=t.call(this,s)||this)._stereo=r,i._panner=n,i.pan=e,i}i=t.call(this,null)||this}return c(e,t),Object.defineProperty(e.prototype,"pan",{get:function(){return this._pan},set:function(t){this._pan=t,this._stereo?T.setParamValue(this._stereo.pan,t):this._panner.setPosition(t,0,1-Math.abs(t))},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){t.prototype.destroy.call(this),this._stereo=null,this._panner=null},e}(L),ReverbFilter:function(t){function e(e,i,r){void 0===e&&(e=3),void 0===i&&(i=2),void 0===r&&(r=!1);var n=this;if(!h().useLegacy)return(n=t.call(this,null)||this)._seconds=n._clamp(e,1,50),n._decay=n._clamp(i,0,100),n._reverse=r,n._rebuild(),n;n=t.call(this,null)||this}return c(e,t),e.prototype._clamp=function(t,e,i){return Math.min(i,Math.max(e,t))},Object.defineProperty(e.prototype,"seconds",{get:function(){return this._seconds},set:function(t){this._seconds=this._clamp(t,1,50),this._rebuild()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"decay",{get:function(){return this._decay},set:function(t){this._decay=this._clamp(t,0,100),this._rebuild()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reverse",{get:function(){return this._reverse},set:function(t){this._reverse=t,this._rebuild()},enumerable:!1,configurable:!0}),e.prototype._rebuild=function(){for(var t,e=h().context.audioContext,i=e.sampleRate,r=i*this._seconds,n=e.createBuffer(2,r,i),s=n.getChannelData(0),o=n.getChannelData(1),a=0;a<r;a++)t=this._reverse?r-a:a,s[a]=(2*Math.random()-1)*Math.pow(1-t/r,this._decay),o[a]=(2*Math.random()-1)*Math.pow(1-t/r,this._decay);var u=h().context.audioContext.createConvolver();u.buffer=n,this.init(u)},e}(L),MonoFilter:function(t){function e(){var e=this;if(!h().useLegacy){var i=h().context.audioContext,r=i.createChannelSplitter(),n=i.createChannelMerger();return n.connect(r),(e=t.call(this,n,r)||this)._merger=n,e}e=t.call(this,null)||this}return c(e,t),e.prototype.destroy=function(){this._merger.disconnect(),this._merger=null,t.prototype.destroy.call(this)},e}(L),TelephoneFilter:function(t){function e(){if(!h().useLegacy){var e=h().context.audioContext,i=e.createBiquadFilter(),r=e.createBiquadFilter(),n=e.createBiquadFilter(),s=e.createBiquadFilter();return i.type="lowpass",T.setParamValue(i.frequency,2e3),r.type="lowpass",T.setParamValue(r.frequency,2e3),n.type="highpass",T.setParamValue(n.frequency,500),s.type="highpass",T.setParamValue(s.frequency,500),i.connect(r),r.connect(n),n.connect(s),t.call(this,i,s)||this}t.call(this,null)}return c(e,t),e}(L)},k={WebAudioMedia:O,WebAudioInstance:w,WebAudioNodes:C,WebAudioContext:M,WebAudioUtils:T},B=0,F={playOnce:function(t,e){var i="alias"+B++;return h().add(i,{url:t,preload:!0,autoPlay:!0,loaded:function(t){t&&(h().remove(i),e&&e(t))},complete:function(){h().remove(i),e&&e(null)}}),i},render:function(t,e){var i=document.createElement("canvas");e=l({width:512,height:128,fill:"black"},e||{}),i.width=e.width,i.height=e.height;var r=a.VL.from(i);if(!(t.media instanceof O))return r;var n=t.media,s=i.getContext("2d");s.fillStyle=e.fill;for(var o=n.buffer.getChannelData(0),h=Math.ceil(o.length/e.width),u=e.height/2,c=0;c<e.width;c++){for(var p=1,d=-1,f=0;f<h;f++){var g=o[c*h+f];g<p&&(p=g),g>d&&(d=g)}s.fillRect(c,(1+p)*u,1,Math.max(1,(d-p)*u))}return r},resolveUrl:m,sineTone:function(t,e){void 0===t&&(t=200),void 0===e&&(e=1);var i=I.from({singleInstance:!0});if(!(i.media instanceof O))return i;for(var r=i.media,n=i.context.audioContext.createBuffer(1,48e3*e,48e3),s=n.getChannelData(0),o=0;o<s.length;o++){var a=t*(o/n.sampleRate)*Math.PI;s[o]=2*Math.sin(a)}return r.buffer=n,i.isLoaded=!0,i},supported:d,extensions:p,validateFormats:f},G=(_=new P,r=_,_);n.aN.registerPlugin(v)},6679:(t,e,i)=>{"use strict";i.d(e,{vB:()=>o,Sb:()=>a,uF:()=>r});var r,n=i(9319);n.X.TARGET_FPMS=.06,function(t){t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY"}(r||(r={}));var s=function(){function t(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=i,this.once=r}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),o=function(){function t(){var t=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new s(null,null,1/0),this.deltaMS=1/n.X.TARGET_FPMS,this.elapsedMS=1/n.X.TARGET_FPMS,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e,i){return void 0===i&&(i=r.NORMAL),this._addListener(new s(t,e,i))},t.prototype.addOnce=function(t,e,i){return void 0===i&&(i=r.NORMAL),this._addListener(new s(t,e,i,!0))},t.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(t.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},t.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*n.X.TARGET_FPMS;for(var r=this._head,s=r.next;s;)s=s.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(t.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,n.X.TARGET_FPMS);this._maxElapsedMS=1/i},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"shared",{get:function(){if(!t._shared){var e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared},enumerable:!1,configurable:!0}),Object.defineProperty(t,"system",{get:function(){if(!t._system){var e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system},enumerable:!1,configurable:!0}),t}(),a=function(){function t(){}return t.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,r.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?o.shared:new o,t.autoStart&&this.start()},t.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}},t}()},8942:(t,e,i)=>{"use strict";i.r(e),i.d(e,{isMobile:()=>r.t,EventEmitter:()=>s.a,earcut:()=>a.a,BaseTextureCache:()=>j,CanvasRenderTarget:()=>H,DATA_URI:()=>W,ProgramCache:()=>G,TextureCache:()=>U,clearTextureCache:()=>z,correctBlendMode:()=>E,createIndicesForQuads:()=>A,decomposeDataUri:()=>$,deprecation:()=>F,destroyTextureCache:()=>X,determineCrossOrigin:()=>q,getBufferType:()=>C,getResolutionOfUrl:()=>Z,hex2rgb:()=>_,hex2string:()=>v,interleaveTypedArrays:()=>I,isPow2:()=>M,isWebGLSupported:()=>g,log2:()=>P,nextPow2:()=>R,premultiplyBlendMode:()=>x,premultiplyRgba:()=>T,premultiplyTint:()=>S,premultiplyTintToRgba:()=>w,removeItems:()=>N,rgb2hex:()=>b,sayHello:()=>f,sign:()=>L,skipHello:()=>d,string2hex:()=>y,trimCanvas:()=>V,uid:()=>k,url:()=>c});var r=i(9319),n=i(6729),s=i.n(n),o=i(9187),a=i.n(o),h=i(8575),u=i(1680),c={parse:h.Qc,format:h.WU,resolve:h.DB};r.X.RETINA_PREFIX=/@([0-9\.]+)x/,r.X.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var l,p=!1;function d(){p=!0}function f(t){var e;if(!p){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var i=["\n %c %c %c PixiJS 6.1.3 -  "+t+"   %c  %c  http://www.pixijs.com/  %c %c %c%c \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(e=self.console).log.apply(e,i)}else self.console&&self.console.log("PixiJS 6.1.3 - "+t+" - http://www.pixijs.com/");p=!0}}function g(){return void 0===l&&(l=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:r.X.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!self.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),i=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),n=!(!i||!i.getContextAttributes().stencil);if(i){var s=i.getExtension("WEBGL_lose_context");s&&s.loseContext()}return i=null,n}catch(t){return!1}}()),l}var m={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function _(t,e){return void 0===e&&(e=[]),e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}function v(t){var e=t.toString(16);return"#"+("000000".substr(0,6-e.length)+e)}function y(t){return"string"==typeof t&&"#"===(t=m[t.toLowerCase()]||t)[0]&&(t=t.substr(1)),parseInt(t,16)}function b(t){return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)}var x=function(){for(var t=[],e=[],i=0;i<32;i++)t[i]=i,e[i]=i;t[u.T$.NORMAL_NPM]=u.T$.NORMAL,t[u.T$.ADD_NPM]=u.T$.ADD,t[u.T$.SCREEN_NPM]=u.T$.SCREEN,e[u.T$.NORMAL]=u.T$.NORMAL_NPM,e[u.T$.ADD]=u.T$.ADD_NPM,e[u.T$.SCREEN]=u.T$.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}();function E(t,e){return x[e?1:0][t]}function T(t,e,i,r){return i=i||new Float32Array(4),r||void 0===r?(i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e):(i[0]=t[0],i[1]=t[1],i[2]=t[2]),i[3]=e,i}function S(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255,n=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((r=r*e+.5|0)<<8)+(n*e+.5|0)}function w(t,e,i,r){return(i=i||new Float32Array(4))[0]=(t>>16&255)/255,i[1]=(t>>8&255)/255,i[2]=(255&t)/255,(r||void 0===r)&&(i[0]*=e,i[1]*=e,i[2]*=e),i[3]=e,i}function A(t,e){void 0===e&&(e=null);var i=6*t;if((e=e||new Uint16Array(i)).length!==i)throw new Error("Out buffer length is incorrect, got "+e.length+" and expected "+i);for(var r=0,n=0;r<i;r+=6,n+=4)e[r+0]=n+0,e[r+1]=n+1,e[r+2]=n+2,e[r+3]=n+0,e[r+4]=n+2,e[r+5]=n+3;return e}function C(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}var O={Float32Array,Uint32Array,Int32Array,Uint8Array};function I(t,e){for(var i=0,r=0,n={},s=0;s<t.length;s++)r+=e[s],i+=t[s].length;var o=new ArrayBuffer(4*i),a=null,h=0;for(s=0;s<t.length;s++){var u=e[s],c=t[s],l=C(c);n[l]||(n[l]=new O[l](o)),a=n[l];for(var p=0;p<c.length;p++)a[(p/u|0)*r+h+p%u]=c[p];h+=u}return new Float32Array(o)}function R(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,1+(t|=t>>>16)}function M(t){return!(t&t-1||!t)}function P(t){var e=(t>65535?1:0)<<4,i=((t>>>=e)>255?1:0)<<3;return e|=i,e|=i=((t>>>=i)>15?1:0)<<2,(e|=i=((t>>>=i)>3?1:0)<<1)|(t>>>=i)>>1}function N(t,e,i){var r,n=t.length;if(!(e>=n||0===i)){var s=n-(i=e+i>n?n-e:i);for(r=e;r<s;++r)t[r]=t[r+i];t.length=s}}function L(t){return 0===t?0:t<0?-1:1}var D=0;function k(){return++D}var B={};function F(t,e,i){if(void 0===i&&(i=3),!B[e]){var r=(new Error).stack;void 0===r?console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t):(r=r.split("\n").splice(i).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+"\nDeprecated since v"+t),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t),console.warn(r))),B[e]=!0}}var G={},U=Object.create(null),j=Object.create(null);function X(){var t;for(t in U)U[t].destroy();for(t in j)j[t].destroy()}function z(){var t;for(t in U)delete U[t];for(t in j)delete j[t]}var H=function(){function t(t,e,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||r.X.RESOLUTION,this.resize(t,e)}return t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=Math.round(t*this.resolution),this.canvas.height=Math.round(e*this.resolution)},t.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=Math.round(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=Math.round(t)},enumerable:!1,configurable:!0}),t}();function V(t){var e,i,r,n=t.width,s=t.height,o=t.getContext("2d"),a=o.getImageData(0,0,n,s).data,h=a.length,u={top:null,left:null,right:null,bottom:null},c=null;for(e=0;e<h;e+=4)0!==a[e+3]&&(i=e/4%n,r=~~(e/4/n),null===u.top&&(u.top=r),(null===u.left||i<u.left)&&(u.left=i),(null===u.right||u.right<i)&&(u.right=i+1),(null===u.bottom||u.bottom<r)&&(u.bottom=r));return null!==u.top&&(n=u.right-u.left,s=u.bottom-u.top+1,c=o.getImageData(u.left,u.top,n,s)),{height:s,width:n,data:c}}var Y,W=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function $(t){var e=W.exec(t);if(e)return{mediaType:e[1]?e[1].toLowerCase():void 0,subType:e[2]?e[2].toLowerCase():void 0,charset:e[3]?e[3].toLowerCase():void 0,encoding:e[4]?e[4].toLowerCase():void 0,data:e[5]}}function q(t,e){if(void 0===e&&(e=self.location),0===t.indexOf("data:"))return"";e=e||self.location,Y||(Y=document.createElement("a")),Y.href=t;var i=c.parse(Y.href),r=!i.port&&""===e.port||i.port===e.port;return i.hostname===e.hostname&&r&&i.protocol===e.protocol?"":"anonymous"}function Z(t,e){var i=r.X.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]):void 0!==e?e:1}},6194:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>y,Easing:()=>n,Group:()=>o,Interpolation:()=>a,Sequence:()=>h,Tween:()=>c,VERSION:()=>l,add:()=>m,getAll:()=>f,nextId:()=>p,now:()=>s,remove:()=>_,removeAll:()=>g,update:()=>v});var r,n={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-n.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*n.Bounce.In(2*t):.5*n.Bounce.Out(2*t-1)+.5}}},s="undefined"==typeof self&&"undefined"!=typeof process&&process.hrtime?function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof self&&void 0!==self.performance&&void 0!==self.performance.now?self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()},o=function(){function t(){this._tweens={},this._tweensAddedDuringUpdate={}}return t.prototype.getAll=function(){var t=this;return Object.keys(this._tweens).map((function(e){return t._tweens[e]}))},t.prototype.removeAll=function(){this._tweens={}},t.prototype.add=function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},t.prototype.remove=function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},t.prototype.update=function(t,e){void 0===t&&(t=s()),void 0===e&&(e=!1);var i=Object.keys(this._tweens);if(0===i.length)return!1;for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<i.length;r++){var n=this._tweens[i[r]],o=!e;n&&!1===n.update(t,o)&&!e&&delete this._tweens[i[r]]}i=Object.keys(this._tweensAddedDuringUpdate)}return!0},t}(),a={Linear:function(t,e){var i=t.length-1,r=i*e,n=Math.floor(r),s=a.Utils.Linear;return e<0?s(t[0],t[1],r):e>1?s(t[i],t[i-1],i-r):s(t[n],t[n+1>i?i:n+1],r-n)},Bezier:function(t,e){for(var i=0,r=t.length-1,n=Math.pow,s=a.Utils.Bernstein,o=0;o<=r;o++)i+=n(1-e,r-o)*n(e,o)*t[o]*s(r,o);return i},CatmullRom:function(t,e){var i=t.length-1,r=i*e,n=Math.floor(r),s=a.Utils.CatmullRom;return t[0]===t[i]?(e<0&&(n=Math.floor(r=i*(1+e))),s(t[(n-1+i)%i],t[n],t[(n+1)%i],t[(n+2)%i],r-n)):e<0?t[0]-(s(t[0],t[0],t[1],t[1],-r)-t[0]):e>1?t[i]-(s(t[i],t[i],t[i-1],t[i-1],r-i)-t[i]):s(t[n?n-1:0],t[n],t[i<n+1?i:n+1],t[i<n+2?i:n+2],r-n)},Utils:{Linear:function(t,e,i){return(e-t)*i+t},Bernstein:function(t,e){var i=a.Utils.Factorial;return i(t)/i(e)/i(t-e)},Factorial:(r=[1],function(t){var e=1;if(r[t])return r[t];for(var i=t;i>1;i--)e*=i;return r[t]=e,e}),CatmullRom:function(t,e,i,r,n){var s=.5*(i-t),o=.5*(r-e),a=n*n;return(2*e-2*i+s+o)*(n*a)+(-3*e+3*i-2*s-o)*a+s*n+e}}},h=function(){function t(){}return t.nextId=function(){return t._nextId++},t._nextId=0,t}(),u=new o,c=function(){function t(t,e){void 0===e&&(e=u),this._object=t,this._group=e,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=n.Linear.None,this._interpolationFunction=a.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=h.nextId(),this._isChainStopped=!1,this._goToEnd=!1}return t.prototype.getId=function(){return this._id},t.prototype.isPlaying=function(){return this._isPlaying},t.prototype.isPaused=function(){return this._isPaused},t.prototype.to=function(t,e){return this._valuesEnd=Object.create(t),void 0!==e&&(this._duration=e),this},t.prototype.duration=function(t){return this._duration=t,this},t.prototype.start=function(t){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var e in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(e),this._valuesStart[e]=this._valuesStartRepeat[e];return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=void 0!==t?"string"==typeof t?s()+parseFloat(t):t:s(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},t.prototype._setupProperties=function(t,e,i,r){for(var n in i){var s=t[n],o=Array.isArray(s),a=o?"array":typeof s,h=!o&&Array.isArray(i[n]);if("undefined"!==a&&"function"!==a){if(h){var u=i[n];if(0===u.length)continue;u=u.map(this._handleRelativeValue.bind(this,s)),i[n]=[s].concat(u)}if("object"!==a&&!o||!s||h)void 0===e[n]&&(e[n]=s),o||(e[n]*=1),r[n]=h?i[n].slice().reverse():e[n]||0;else{for(var c in e[n]=o?[]:{},s)e[n][c]=s[c];r[n]=o?[]:{},this._setupProperties(s,e[n],i[n],r[n])}}}},t.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},t.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},t.prototype.pause=function(t){return void 0===t&&(t=s()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=t,this._group&&this._group.remove(this)),this},t.prototype.resume=function(t){return void 0===t&&(t=s()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=t-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},t.prototype.stopChainedTweens=function(){for(var t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop();return this},t.prototype.group=function(t){return this._group=t,this},t.prototype.delay=function(t){return this._delayTime=t,this},t.prototype.repeat=function(t){return this._initialRepeat=t,this._repeat=t,this},t.prototype.repeatDelay=function(t){return this._repeatDelayTime=t,this},t.prototype.yoyo=function(t){return this._yoyo=t,this},t.prototype.easing=function(t){return this._easingFunction=t,this},t.prototype.interpolation=function(t){return this._interpolationFunction=t,this},t.prototype.chain=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._chainedTweens=t,this},t.prototype.onStart=function(t){return this._onStartCallback=t,this},t.prototype.onUpdate=function(t){return this._onUpdateCallback=t,this},t.prototype.onRepeat=function(t){return this._onRepeatCallback=t,this},t.prototype.onComplete=function(t){return this._onCompleteCallback=t,this},t.prototype.onStop=function(t){return this._onStopCallback=t,this},t.prototype.update=function(t,e){if(void 0===t&&(t=s()),void 0===e&&(e=!0),this._isPaused)return!0;var i,r,n=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(t>n)return!1;e&&this.start(t)}if(this._goToEnd=!1,t<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),r=(t-this._startTime)/this._duration,r=0===this._duration||r>1?1:r;var o=this._easingFunction(r);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,o),this._onUpdateCallback&&this._onUpdateCallback(this._object,r),1===r){if(this._repeat>0){for(i in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)this._yoyo||"string"!=typeof this._valuesEnd[i]||(this._valuesStartRepeat[i]=this._valuesStartRepeat[i]+parseFloat(this._valuesEnd[i])),this._yoyo&&this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=t+this._repeatDelayTime:this._startTime=t+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var a=0,h=this._chainedTweens.length;a<h;a++)this._chainedTweens[a].start(this._startTime+this._duration);return this._isPlaying=!1,!1}return!0},t.prototype._updateProperties=function(t,e,i,r){for(var n in i)if(void 0!==e[n]){var s=e[n]||0,o=i[n],a=Array.isArray(t[n]),h=Array.isArray(o);!a&&h?t[n]=this._interpolationFunction(o,r):"object"==typeof o&&o?this._updateProperties(t[n],s,o,r):"number"==typeof(o=this._handleRelativeValue(s,o))&&(t[n]=s+(o-s)*r)}},t.prototype._handleRelativeValue=function(t,e){return"string"!=typeof e?e:"+"===e.charAt(0)||"-"===e.charAt(0)?t+parseFloat(e):parseFloat(e)},t.prototype._swapEndStartRepeatValues=function(t){var e=this._valuesStartRepeat[t],i=this._valuesEnd[t];this._valuesStartRepeat[t]="string"==typeof i?this._valuesStartRepeat[t]+parseFloat(i):this._valuesEnd[t],this._valuesEnd[t]=e},t}(),l="18.6.4",p=h.nextId,d=u,f=d.getAll.bind(d),g=d.removeAll.bind(d),m=d.add.bind(d),_=d.remove.bind(d),v=d.update.bind(d);const y={Easing:n,Group:o,Interpolation:a,now:s,Sequence:h,nextId:p,Tween:c,VERSION:l,getAll:f,removeAll:g,add:m,remove:_,update:v}},3010:t=>{function e(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}t.exports=e,e.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),i=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-i:t+i}return 0|Math.min(t,this.max)},e.prototype.reset=function(){this.attempts=0},e.prototype.setMin=function(t){this.ms=t},e.prototype.setMax=function(t){this.max=t},e.prototype.setJitter=function(t){this.jitter=t}},3704:(t,e)=>{!function(t){"use strict";e.encode=function(e){var i,r=new Uint8Array(e),n=r.length,s="";for(i=0;i<n;i+=3)s+=t[r[i]>>2],s+=t[(3&r[i])<<4|r[i+1]>>4],s+=t[(15&r[i+1])<<2|r[i+2]>>6],s+=t[63&r[i+2]];return n%3==2?s=s.substring(0,s.length-1)+"=":n%3==1&&(s=s.substring(0,s.length-2)+"=="),s},e.decode=function(e){var i,r,n,s,o,a=.75*e.length,h=e.length,u=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var c=new ArrayBuffer(a),l=new Uint8Array(c);for(i=0;i<h;i+=4)r=t.indexOf(e[i]),n=t.indexOf(e[i+1]),s=t.indexOf(e[i+2]),o=t.indexOf(e[i+3]),l[u++]=r<<2|n>>4,l[u++]=(15&n)<<4|s>>2,l[u++]=(3&s)<<6|63&o;return c}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},8767:t=>{function e(t){if(t)return function(t){for(var i in e.prototype)t[i]=e.prototype[i];return t}(t)}t.exports=e,e.prototype.on=e.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},e.prototype.once=function(t,e){function i(){this.off(t,i),e.apply(this,arguments)}return i.fn=e,this.on(t,i),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i,r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var n=0;n<r.length;n++)if((i=r[n])===e||i.fn===e){r.splice(n,1);break}return 0===r.length&&delete this._callbacks["$"+t],this},e.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),i=this._callbacks["$"+t],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(i){r=0;for(var n=(i=i.slice(0)).length;r<n;++r)i[r].apply(this,e)}return this},e.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},e.prototype.hasListeners=function(t){return!!this.listeners(t).length}},1227:(t,e,i)=>{e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const i="color: "+this.color;e.splice(1,0,i,"color: inherit");let r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,(t=>{"%%"!==t&&(r++,"%c"===t&&(n=r))})),e.splice(n,0,i)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){let t;try{t=e.storage.getItem("debug")}catch(t){}return!t&&"undefined"!=typeof process&&"env"in process&&(t=process.env.DEBUG),t},e.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},e.storage=function(){try{return localStorage}catch(t){}}(),e.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.log=console.debug||console.log||(()=>{}),t.exports=i(2447)(e);const{formatters:r}=t.exports;r.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},2447:(t,e,i)=>{t.exports=function(t){function e(t){let i,n,s,o=null;function a(...t){if(!a.enabled)return;const r=a,n=Number(new Date),s=n-(i||n);r.diff=s,r.prev=i,r.curr=n,i=n,t[0]=e.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let o=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,((i,n)=>{if("%%"===i)return"%";o++;const s=e.formatters[n];if("function"==typeof s){const e=t[o];i=s.call(r,e),t.splice(o,1),o--}return i})),e.formatArgs.call(r,t),(r.log||e.log).apply(r,t)}return a.namespace=t,a.useColors=e.useColors(),a.color=e.selectColor(t),a.extend=r,a.destroy=e.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(n!==e.namespaces&&(n=e.namespaces,s=e.enabled(t)),s),set:t=>{o=t}}),"function"==typeof e.init&&e.init(a),a}function r(t,i){const r=e(this.namespace+(void 0===i?":":i)+t);return r.log=this.log,r}function n(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return e.debug=e,e.default=e,e.coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){const t=[...e.names.map(n),...e.skips.map(n).map((t=>"-"+t))].join(",");return e.enable(""),t},e.enable=function(t){let i;e.save(t),e.namespaces=t,e.names=[],e.skips=[];const r=("string"==typeof t?t:"").split(/[\s,]+/),n=r.length;for(i=0;i<n;i++)r[i]&&("-"===(t=r[i].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")))},e.enabled=function(t){if("*"===t[t.length-1])return!0;let i,r;for(i=0,r=e.skips.length;i<r;i++)if(e.skips[i].test(t))return!1;for(i=0,r=e.names.length;i<r;i++)if(e.names[i].test(t))return!0;return!1},e.humanize=i(7824),e.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach((i=>{e[i]=t[i]})),e.names=[],e.skips=[],e.formatters={},e.selectColor=function(t){let i=0;for(let e=0;e<t.length;e++)i=(i<<5)-i+t.charCodeAt(e),i|=0;return e.colors[Math.abs(i)%e.colors.length]},e.enable(e.load()),e}},9187:t=>{"use strict";function e(t,e,s){s=s||2;var o,a,h,l,p,f,g,m=e&&e.length,_=m?e[0]*s:t.length,v=i(t,0,_,s,!0),y=[];if(!v||v.next===v.prev)return y;if(m&&(v=function(t,e,n,s){var o,a,h,l=[];for(o=0,a=e.length;o<a;o++)(h=i(t,e[o]*s,o<a-1?e[o+1]*s:t.length,s,!1))===h.next&&(h.steiner=!0),l.push(d(h));for(l.sort(u),o=0;o<l.length;o++)n=r(n=c(l[o],n),n.next);return n}(t,e,v,s)),t.length>80*s){o=h=t[0],a=l=t[1];for(var b=s;b<_;b+=s)(p=t[b])<o&&(o=p),(f=t[b+1])<a&&(a=f),p>h&&(h=p),f>l&&(l=f);g=0!==(g=Math.max(h-o,l-a))?1/g:0}return n(v,y,s,o,a,g),y}function i(t,e,i,r,n){var s,o;if(n===A(t,e,i,r)>0)for(s=e;s<i;s+=r)o=T(s,t[s],t[s+1],o);else for(s=i-r;s>=e;s-=r)o=T(s,t[s],t[s+1],o);return o&&_(o,o.next)&&(S(o),o=o.next),o}function r(t,e){if(!t)return t;e||(e=t);var i,r=t;do{if(i=!1,r.steiner||!_(r,r.next)&&0!==m(r.prev,r,r.next))r=r.next;else{if(S(r),(r=e=r.prev)===r.next)break;i=!0}}while(i||r!==e);return e}function n(t,e,i,u,c,l,d){if(t){!d&&l&&function(t,e,i,r){var n=t;do{null===n.z&&(n.z=p(n.x,n.y,e,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,function(t){var e,i,r,n,s,o,a,h,u=1;do{for(i=t,t=null,s=null,o=0;i;){for(o++,r=i,a=0,e=0;e<u&&(a++,r=r.nextZ);e++);for(h=u;a>0||h>0&&r;)0!==a&&(0===h||!r||i.z<=r.z)?(n=i,i=i.nextZ,a--):(n=r,r=r.nextZ,h--),s?s.nextZ=n:t=n,n.prevZ=s,s=n;i=r}s.nextZ=null,u*=2}while(o>1)}(n)}(t,u,c,l);for(var f,g,m=t;t.prev!==t.next;)if(f=t.prev,g=t.next,l?o(t,u,c,l):s(t))e.push(f.i/i),e.push(t.i/i),e.push(g.i/i),S(t),t=g.next,m=g.next;else if((t=g)===m){d?1===d?n(t=a(r(t),e,i),e,i,u,c,l,2):2===d&&h(t,e,i,u,c,l):n(r(t),e,i,u,c,l,1);break}}}function s(t){var e=t.prev,i=t,r=t.next;if(m(e,i,r)>=0)return!1;for(var n=t.next.next;n!==t.prev;){if(f(e.x,e.y,i.x,i.y,r.x,r.y,n.x,n.y)&&m(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function o(t,e,i,r){var n=t.prev,s=t,o=t.next;if(m(n,s,o)>=0)return!1;for(var a=n.x<s.x?n.x<o.x?n.x:o.x:s.x<o.x?s.x:o.x,h=n.y<s.y?n.y<o.y?n.y:o.y:s.y<o.y?s.y:o.y,u=n.x>s.x?n.x>o.x?n.x:o.x:s.x>o.x?s.x:o.x,c=n.y>s.y?n.y>o.y?n.y:o.y:s.y>o.y?s.y:o.y,l=p(a,h,e,i,r),d=p(u,c,e,i,r),g=t.prevZ,_=t.nextZ;g&&g.z>=l&&_&&_.z<=d;){if(g!==t.prev&&g!==t.next&&f(n.x,n.y,s.x,s.y,o.x,o.y,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;if(g=g.prevZ,_!==t.prev&&_!==t.next&&f(n.x,n.y,s.x,s.y,o.x,o.y,_.x,_.y)&&m(_.prev,_,_.next)>=0)return!1;_=_.nextZ}for(;g&&g.z>=l;){if(g!==t.prev&&g!==t.next&&f(n.x,n.y,s.x,s.y,o.x,o.y,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;g=g.prevZ}for(;_&&_.z<=d;){if(_!==t.prev&&_!==t.next&&f(n.x,n.y,s.x,s.y,o.x,o.y,_.x,_.y)&&m(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function a(t,e,i){var n=t;do{var s=n.prev,o=n.next.next;!_(s,o)&&v(s,n,n.next,o)&&x(s,o)&&x(o,s)&&(e.push(s.i/i),e.push(n.i/i),e.push(o.i/i),S(n),S(n.next),n=t=o),n=n.next}while(n!==t);return r(n)}function h(t,e,i,s,o,a){var h=t;do{for(var u=h.next.next;u!==h.prev;){if(h.i!==u.i&&g(h,u)){var c=E(h,u);return h=r(h,h.next),c=r(c,c.next),n(h,e,i,s,o,a),void n(c,e,i,s,o,a)}u=u.next}h=h.next}while(h!==t)}function u(t,e){return t.x-e.x}function c(t,e){var i=function(t,e){var i,r=e,n=t.x,s=t.y,o=-1/0;do{if(s<=r.y&&s>=r.next.y&&r.next.y!==r.y){var a=r.x+(s-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=n&&a>o){if(o=a,a===n){if(s===r.y)return r;if(s===r.next.y)return r.next}i=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!i)return null;if(n===o)return i;var h,u=i,c=i.x,p=i.y,d=1/0;r=i;do{n>=r.x&&r.x>=c&&n!==r.x&&f(s<p?n:o,s,c,p,s<p?o:n,s,r.x,r.y)&&(h=Math.abs(s-r.y)/(n-r.x),x(r,t)&&(h<d||h===d&&(r.x>i.x||r.x===i.x&&l(i,r)))&&(i=r,d=h)),r=r.next}while(r!==u);return i}(t,e);if(!i)return e;var n=E(i,t),s=r(i,i.next);return r(n,n.next),e===i?s:e}function l(t,e){return m(t.prev,t,e.prev)<0&&m(e.next,t,t.next)<0}function p(t,e,i,r,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*n)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*n)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function d(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function f(t,e,i,r,n,s,o,a){return(n-o)*(e-a)-(t-o)*(s-a)>=0&&(t-o)*(r-a)-(i-o)*(e-a)>=0&&(i-o)*(s-a)-(n-o)*(r-a)>=0}function g(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&v(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&(x(t,e)&&x(e,t)&&function(t,e){var i=t,r=!1,n=(t.x+e.x)/2,s=(t.y+e.y)/2;do{i.y>s!=i.next.y>s&&i.next.y!==i.y&&n<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next}while(i!==t);return r}(t,e)&&(m(t.prev,t,e.prev)||m(t,e.prev,e))||_(t,e)&&m(t.prev,t,t.next)>0&&m(e.prev,e,e.next)>0)}function m(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function _(t,e){return t.x===e.x&&t.y===e.y}function v(t,e,i,r){var n=b(m(t,e,i)),s=b(m(t,e,r)),o=b(m(i,r,t)),a=b(m(i,r,e));return n!==s&&o!==a||!(0!==n||!y(t,i,e))||!(0!==s||!y(t,r,e))||!(0!==o||!y(i,t,r))||!(0!==a||!y(i,e,r))}function y(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function b(t){return t>0?1:t<0?-1:0}function x(t,e){return m(t.prev,t,t.next)<0?m(t,e,t.next)>=0&&m(t,t.prev,e)>=0:m(t,e,t.prev)<0||m(t,t.next,e)<0}function E(t,e){var i=new w(t.i,t.x,t.y),r=new w(e.i,e.x,e.y),n=t.next,s=e.prev;return t.next=e,e.prev=t,i.next=n,n.prev=i,r.next=i,i.prev=r,s.next=r,r.prev=s,r}function T(t,e,i,r){var n=new w(t,e,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function S(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function w(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function A(t,e,i,r){for(var n=0,s=e,o=i-r;s<i;s+=r)n+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return n}t.exports=e,t.exports.default=e,e.deviation=function(t,e,i,r){var n=e&&e.length,s=n?e[0]*i:t.length,o=Math.abs(A(t,0,s,i));if(n)for(var a=0,h=e.length;a<h;a++){var u=e[a]*i,c=a<h-1?e[a+1]*i:t.length;o-=Math.abs(A(t,u,c,i))}var l=0;for(a=0;a<r.length;a+=3){var p=r[a]*i,d=r[a+1]*i,f=r[a+2]*i;l+=Math.abs((t[p]-t[f])*(t[d+1]-t[p+1])-(t[p]-t[d])*(t[f+1]-t[p+1]))}return 0===o&&0===l?0:Math.abs((l-o)/o)},e.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},r=0,n=0;n<t.length;n++){for(var s=0;s<t[n].length;s++)for(var o=0;o<e;o++)i.vertices.push(t[n][s][o]);n>0&&(r+=t[n-1].length,i.holes.push(r))}return i}},3549:t=>{t.exports="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")()},5983:(t,e,i)=>{const r=i(2192);t.exports=(t,e)=>new r(t,e),t.exports.Socket=r,t.exports.protocol=r.protocol,t.exports.Transport=i(6496),t.exports.transports=i(3352),t.exports.parser=i(9743)},2192:(t,e,i)=>{const r=i(3352),n=i(8767),s=i(1227)("engine.io-client:socket"),o=i(9743),a=i(4187),h=i(1830),{installTimerFunctions:u}=i(6839);class c extends n{constructor(t,e={}){super(),t&&"object"==typeof t&&(e=t,t=null),t?(t=a(t),e.hostname=t.host,e.secure="https"===t.protocol||"wss"===t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=a(e.host).host),u(this,e),this.secure=null!=e.secure?e.secure:"undefined"!=typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.transports=e.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,jsonp:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},e),this.opts.path=this.opts.path.replace(/\/$/,"")+"/","string"==typeof this.opts.query&&(this.opts.query=h.decode(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",(()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())}),!1),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close")},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){s('creating transport "%s"',t);const e=function(t){const e={};for(let i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}(this.opts.query);e.EIO=o.protocol,e.transport=t,this.id&&(e.sid=this.id);const i=Object.assign({},this.opts.transportOptions[t],this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return s("options: %j",i),new r[t](i)}open(){let t;if(this.opts.rememberUpgrade&&c.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emit("error","No transports available")}),0);t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return s("error while creating transport: %s",t),this.transports.shift(),void this.open()}t.open(),this.setTransport(t)}setTransport(t){s("setting transport %s",t.name),this.transport&&(s("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(()=>{this.onClose("transport close")}))}probe(t){s('probing transport "%s"',t);let e=this.createTransport(t,{probe:1}),i=!1;c.priorWebsocketSuccess=!1;const r=()=>{i||(s('probe transport "%s" opened',t),e.send([{type:"ping",data:"probe"}]),e.once("packet",(r=>{if(!i)if("pong"===r.type&&"probe"===r.data){if(s('probe transport "%s" pong',t),this.upgrading=!0,this.emit("upgrading",e),!e)return;c.priorWebsocketSuccess="websocket"===e.name,s('pausing current transport "%s"',this.transport.name),this.transport.pause((()=>{i||"closed"!==this.readyState&&(s("changing transport and sending upgrade packet"),l(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emit("upgrade",e),e=null,this.upgrading=!1,this.flush())}))}else{s('probe transport "%s" failed',t);const i=new Error("probe error");i.transport=e.name,this.emit("upgradeError",i)}})))};function n(){i||(i=!0,l(),e.close(),e=null)}const o=i=>{const r=new Error("probe error: "+i);r.transport=e.name,n(),s('probe transport "%s" failed because of error: %s',t,i),this.emit("upgradeError",r)};function a(){o("transport closed")}function h(){o("socket closed")}function u(t){e&&t.name!==e.name&&(s('"%s" works - aborting "%s"',t.name,e.name),n())}const l=()=>{e.removeListener("open",r),e.removeListener("error",o),e.removeListener("close",a),this.removeListener("close",h),this.removeListener("upgrading",u)};e.once("open",r),e.once("error",o),e.once("close",a),this.once("close",h),this.once("upgrading",u),e.open()}onOpen(){if(s("socket open"),this.readyState="open",c.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause){s("starting upgrade probes");let t=0;const e=this.upgrades.length;for(;t<e;t++)this.probe(this.upgrades[t])}}onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(s('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emit("ping"),this.emit("pong");break;case"error":const e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else s('packet received with socket readyState "%s"',this.readyState)}onHandshake(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()}flush(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(s("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))}write(t,e,i){return this.sendPacket("message",t,e,i),this}send(t,e,i){return this.sendPacket("message",t,e,i),this}sendPacket(t,e,i,r){if("function"==typeof e&&(r=e,e=void 0),"function"==typeof i&&(r=i,i=null),"closing"===this.readyState||"closed"===this.readyState)return;(i=i||{}).compress=!1!==i.compress;const n={type:t,data:e,options:i};this.emit("packetCreate",n),this.writeBuffer.push(n),r&&this.once("flush",r),this.flush()}close(){const t=()=>{this.onClose("forced close"),s("socket closing - telling transport to close"),this.transport.close()},e=()=>{this.removeListener("upgrade",e),this.removeListener("upgradeError",e),t()},i=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?i():t()})):this.upgrading?i():t()),this}onError(t){s("socket error %j",t),c.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)}onClose(t,e){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(s('socket close with reason: "%s"',t),this.clearTimeoutFn(this.pingIntervalTimer),this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emit("close",t,e),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){const e=[];let i=0;const r=t.length;for(;i<r;i++)~this.transports.indexOf(t[i])&&e.push(t[i]);return e}}c.priorWebsocketSuccess=!1,c.protocol=o.protocol,t.exports=c},6496:(t,e,i)=>{const r=i(9743),n=i(8767),{installTimerFunctions:s}=i(6839),o=i(1227)("engine.io-client:transport");t.exports=class extends n{constructor(t){super(),s(this,t),this.opts=t,this.query=t.query,this.readyState="",this.socket=t.socket}onError(t,e){const i=new Error(t);return i.type="TransportError",i.description=e,this.emit("error",i),this}open(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(t){"open"===this.readyState?this.write(t):o("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,this.emit("open")}onData(t){const e=r.decodePacket(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){this.emit("packet",t)}onClose(){this.readyState="closed",this.emit("close")}}},3352:(t,e,i)=>{const r=i(2777),n=i(3416),s=i(9785),o=i(4442);e.polling=function(t){let e,i=!1,o=!1;const a=!1!==t.jsonp;if("undefined"!=typeof location){const e="https:"===location.protocol;let r=location.port;r||(r=e?443:80),i=t.hostname!==location.hostname||r!==t.port,o=t.secure!==e}if(t.xdomain=i,t.xscheme=o,e=new r(t),"open"in e&&!t.forceJSONP)return new n(t);if(!a)throw new Error("JSONP disabled");return new s(t)},e.websocket=o},9785:(t,e,i)=>{const r=i(9015),n=i(3549),s=/\n/g,o=/\\n/g;let a;t.exports=class extends r{constructor(t){super(t),this.query=this.query||{},a||(a=n.___eio=n.___eio||[]),this.index=a.length,a.push(this.onData.bind(this)),this.query.j=this.index}get supportsBinary(){return!1}doClose(){this.script&&(this.script.onerror=()=>{},this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),super.doClose()}doPoll(){const t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=t=>{this.onError("jsonp poll error",t)};const e=document.getElementsByTagName("script")[0];e?e.parentNode.insertBefore(t,e):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&this.setTimeoutFn((function(){const t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)}),100)}doWrite(t,e){let i;if(!this.form){const t=document.createElement("form"),e=document.createElement("textarea"),i=this.iframeId="eio_iframe_"+this.index;t.className="socketio",t.style.position="absolute",t.style.top="-1000px",t.style.left="-1000px",t.target=i,t.method="POST",t.setAttribute("accept-charset","utf-8"),e.name="d",t.appendChild(e),document.body.appendChild(t),this.form=t,this.area=e}function r(){n(),e()}this.form.action=this.uri();const n=()=>{if(this.iframe)try{this.form.removeChild(this.iframe)}catch(t){this.onError("jsonp polling iframe removal error",t)}try{const t='<iframe src="javascript:0" name="'+this.iframeId+'">';i=document.createElement(t)}catch(t){i=document.createElement("iframe"),i.name=this.iframeId,i.src="javascript:0"}i.id=this.iframeId,this.form.appendChild(i),this.iframe=i};n(),t=t.replace(o,"\\\n"),this.area.value=t.replace(s,"\\n");try{this.form.submit()}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=()=>{"complete"===this.iframe.readyState&&r()}:this.iframe.onload=r}}},3416:(t,e,i)=>{const r=i(2777),n=i(9015),s=i(8767),{pick:o,installTimerFunctions:a}=i(6839),h=i(3549),u=i(1227)("engine.io-client:polling-xhr");function c(){}const l=null!=new r({xdomain:!1}).responseType;class p extends s{constructor(t,e){super(),a(this,e),this.opts=e,this.method=e.method||"GET",this.uri=t,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.create()}create(){const t=o(this.opts,"agent","enablesXDR","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;const e=this.xhr=new r(t);try{u("xhr open %s: %s",this.method,this.uri),e.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){e.setDisableHeaderCheck&&e.setDisableHeaderCheck(!0);for(let t in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(t)&&e.setRequestHeader(t,this.opts.extraHeaders[t])}}catch(t){}if("POST"===this.method)try{e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{e.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in e&&(e.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(e.timeout=this.opts.requestTimeout),this.hasXDR()?(e.onload=()=>{this.onLoad()},e.onerror=()=>{this.onError(e.responseText)}):e.onreadystatechange=()=>{4===e.readyState&&(200===e.status||1223===e.status?this.onLoad():this.setTimeoutFn((()=>{this.onError("number"==typeof e.status?e.status:0)}),0))},u("xhr data %s",this.data),e.send(this.data)}catch(t){return void this.setTimeoutFn((()=>{this.onError(t)}),0)}"undefined"!=typeof document&&(this.index=p.requestsCount++,p.requests[this.index]=this)}onSuccess(){this.emit("success"),this.cleanup()}onData(t){this.emit("data",t),this.onSuccess()}onError(t){this.emit("error",t),this.cleanup(!0)}cleanup(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=c:this.xhr.onreadystatechange=c,t)try{this.xhr.abort()}catch(t){}"undefined"!=typeof document&&delete p.requests[this.index],this.xhr=null}}onLoad(){const t=this.xhr.responseText;null!==t&&this.onData(t)}hasXDR(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR}abort(){this.cleanup()}}function d(){for(let t in p.requests)p.requests.hasOwnProperty(t)&&p.requests[t].abort()}p.requestsCount=0,p.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",d):"function"==typeof addEventListener&&addEventListener("onpagehide"in h?"pagehide":"unload",d,!1)),t.exports=class extends n{constructor(t){if(super(t),"undefined"!=typeof location){const e="https:"===location.protocol;let i=location.port;i||(i=e?443:80),this.xd="undefined"!=typeof location&&t.hostname!==location.hostname||i!==t.port,this.xs=t.secure!==e}const e=t&&t.forceBase64;this.supportsBinary=l&&!e}request(t={}){return Object.assign(t,{xd:this.xd,xs:this.xs},this.opts),new p(this.uri(),t)}doWrite(t,e){const i=this.request({method:"POST",data:t});i.on("success",e),i.on("error",(t=>{this.onError("xhr post error",t)}))}doPoll(){u("xhr poll");const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(t=>{this.onError("xhr poll error",t)})),this.pollXhr=t}},t.exports.Request=p},9015:(t,e,i)=>{const r=i(6496),n=i(1830),s=i(9743),o=i(2281),a=i(1227)("engine.io-client:polling");t.exports=class extends r{get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";const e=()=>{a("paused"),this.readyState="paused",t()};if(this.polling||!this.writable){let t=0;this.polling&&(a("we are currently polling - waiting to pause"),t++,this.once("pollComplete",(function(){a("pre-pause polling complete"),--t||e()}))),this.writable||(a("we are currently writing - waiting to pause"),t++,this.once("drain",(function(){a("pre-pause writing complete"),--t||e()})))}else e()}poll(){a("polling"),this.polling=!0,this.doPoll(),this.emit("poll")}onData(t){a("polling got data %s",t),s.decodePayload(t,this.socket.binaryType).forEach((t=>{if("opening"===this.readyState&&"open"===t.type&&this.onOpen(),"close"===t.type)return this.onClose(),!1;this.onPacket(t)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():a('ignoring poll - transport state "%s"',this.readyState))}doClose(){const t=()=>{a("writing close packet"),this.write([{type:"close"}])};"open"===this.readyState?(a("transport open - closing"),t()):(a("transport not open - deferring close"),this.once("open",t))}write(t){this.writable=!1,s.encodePayload(t,(t=>{this.doWrite(t,(()=>{this.writable=!0,this.emit("drain")}))}))}uri(){let t=this.query||{};const e=this.opts.secure?"https":"http";let i="";return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=o()),this.supportsBinary||t.sid||(t.b64=1),t=n.encode(t),this.opts.port&&("https"===e&&443!==Number(this.opts.port)||"http"===e&&80!==Number(this.opts.port))&&(i=":"+this.opts.port),t.length&&(t="?"+t),e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+t}}},866:(t,e,i)=>{const r=i(3549),n="function"==typeof Promise&&"function"==typeof Promise.resolve?t=>Promise.resolve().then(t):(t,e)=>e(t,0);t.exports={WebSocket:r.WebSocket||r.MozWebSocket,usingBrowserWebSocket:!0,defaultBinaryType:"arraybuffer",nextTick:n}},4442:(t,e,i)=>{const r=i(6496),n=i(9743),s=i(1830),o=i(2281),{pick:a}=i(6839),{WebSocket:h,usingBrowserWebSocket:u,defaultBinaryType:c,nextTick:l}=i(866),p=i(1227)("engine.io-client:websocket"),d="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class f extends r{constructor(t){super(t),this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const t=this.uri(),e=this.opts.protocols,i=d?{}:a(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=u&&!d?e?new h(t,e):new h(t):new h(t,e,i)}catch(t){return this.emit("error",t)}this.ws.binaryType=this.socket.binaryType||c,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=this.onClose.bind(this),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const i=t[e],r=e===t.length-1;n.encodePacket(i,this.supportsBinary,(t=>{const e={};!u&&(i.options&&(e.compress=i.options.compress),this.opts.perMessageDeflate)&&("string"==typeof t?Buffer.byteLength(t):t.length)<this.opts.perMessageDeflate.threshold&&(e.compress=!1);try{u?this.ws.send(t):this.ws.send(t,e)}catch(t){p("websocket closed before onclose event")}r&&l((()=>{this.writable=!0,this.emit("drain")}),this.setTimeoutFn)}))}}onClose(){r.prototype.onClose.call(this)}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){let t=this.query||{};const e=this.opts.secure?"wss":"ws";let i="";return this.opts.port&&("wss"===e&&443!==Number(this.opts.port)||"ws"===e&&80!==Number(this.opts.port))&&(i=":"+this.opts.port),this.opts.timestampRequests&&(t[this.opts.timestampParam]=o()),this.supportsBinary||(t.b64=1),t=s.encode(t),t.length&&(t="?"+t),e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+t}check(){return!(!h||"__initialize"in h&&this.name===f.prototype.name)}}t.exports=f},6839:(t,e,i)=>{const r=i(3549);t.exports.pick=(t,...e)=>e.reduce(((e,i)=>(t.hasOwnProperty(i)&&(e[i]=t[i]),e)),{});const n=setTimeout,s=clearTimeout;t.exports.installTimerFunctions=(t,e)=>{e.useNativeTimers?(t.setTimeoutFn=n.bind(r),t.clearTimeoutFn=s.bind(r)):(t.setTimeoutFn=setTimeout.bind(r),t.clearTimeoutFn=clearTimeout.bind(r))}},2777:(t,e,i)=>{const r=i(8058),n=i(3549);t.exports=function(t){const e=t.xdomain,i=t.xscheme,s=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!e||r))return new XMLHttpRequest}catch(t){}try{if("undefined"!=typeof XDomainRequest&&!i&&s)return new XDomainRequest}catch(t){}if(!e)try{return new(n[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}},1712:t=>{const e=Object.create(null);e.open="0",e.close="1",e.ping="2",e.pong="3",e.message="4",e.upgrade="5",e.noop="6";const i=Object.create(null);Object.keys(e).forEach((t=>{i[e[t]]=t})),t.exports={PACKET_TYPES:e,PACKET_TYPES_REVERSE:i,ERROR_PACKET:{type:"error",data:"parser error"}}},9137:(t,e,i)=>{const{PACKET_TYPES_REVERSE:r,ERROR_PACKET:n}=i(1712);let s;"function"==typeof ArrayBuffer&&(s=i(3704));const o=(t,e)=>{if(s){const i=s.decode(t);return a(i,e)}return{base64:!0,data:t}},a=(t,e)=>"blob"===e&&t instanceof ArrayBuffer?new Blob([t]):t;t.exports=(t,e)=>{if("string"!=typeof t)return{type:"message",data:a(t,e)};const i=t.charAt(0);return"b"===i?{type:"message",data:o(t.substring(1),e)}:r[i]?t.length>1?{type:r[i],data:t.substring(1)}:{type:r[i]}:n}},2929:(t,e,i)=>{const{PACKET_TYPES:r}=i(1712),n="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),s="function"==typeof ArrayBuffer,o=(t,e)=>{const i=new FileReader;return i.onload=function(){const t=i.result.split(",")[1];e("b"+t)},i.readAsDataURL(t)};t.exports=({type:t,data:e},i,a)=>{return n&&e instanceof Blob?i?a(e):o(e,a):s&&(e instanceof ArrayBuffer||(h=e,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(h):h&&h.buffer instanceof ArrayBuffer))?i?a(e):o(new Blob([e]),a):a(r[t]+(e||""));var h}},9743:(t,e,i)=>{const r=i(2929),n=i(9137),s=String.fromCharCode(30);t.exports={protocol:4,encodePacket:r,encodePayload:(t,e)=>{const i=t.length,n=new Array(i);let o=0;t.forEach(((t,a)=>{r(t,!1,(t=>{n[a]=t,++o===i&&e(n.join(s))}))}))},decodePacket:n,decodePayload:(t,e)=>{const i=t.split(s),r=[];for(let t=0;t<i.length;t++){const s=n(i[t],e);if(r.push(s),"error"===s.type)break}return r}}},6729:t=>{"use strict";var e=Object.prototype.hasOwnProperty,i="~";function r(){}function n(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function s(t,e,r,s,o){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new n(r,s||t,o),h=i?i+e:e;return t._events[h]?t._events[h].fn?t._events[h]=[t._events[h],a]:t._events[h].push(a):(t._events[h]=a,t._eventsCount++),t}function o(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(i=!1)),a.prototype.eventNames=function(){var t,r,n=[];if(0===this._eventsCount)return n;for(r in t=this._events)e.call(t,r)&&n.push(i?r.slice(1):r);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},a.prototype.listeners=function(t){var e=i?i+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,s=r.length,o=new Array(s);n<s;n++)o[n]=r[n].fn;return o},a.prototype.listenerCount=function(t){var e=i?i+t:t,r=this._events[e];return r?r.fn?1:r.length:0},a.prototype.emit=function(t,e,r,n,s,o){var a=i?i+t:t;if(!this._events[a])return!1;var h,u,c=this._events[a],l=arguments.length;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),l){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,r),!0;case 4:return c.fn.call(c.context,e,r,n),!0;case 5:return c.fn.call(c.context,e,r,n,s),!0;case 6:return c.fn.call(c.context,e,r,n,s,o),!0}for(u=1,h=new Array(l-1);u<l;u++)h[u-1]=arguments[u];c.fn.apply(c.context,h)}else{var p,d=c.length;for(u=0;u<d;u++)switch(c[u].once&&this.removeListener(t,c[u].fn,void 0,!0),l){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,e);break;case 3:c[u].fn.call(c[u].context,e,r);break;case 4:c[u].fn.call(c[u].context,e,r,n);break;default:if(!h)for(p=1,h=new Array(l-1);p<l;p++)h[p-1]=arguments[p];c[u].fn.apply(c[u].context,h)}}return!0},a.prototype.on=function(t,e,i){return s(this,t,e,i,!1)},a.prototype.once=function(t,e,i){return s(this,t,e,i,!0)},a.prototype.removeListener=function(t,e,r,n){var s=i?i+t:t;if(!this._events[s])return this;if(!e)return o(this,s),this;var a=this._events[s];if(a.fn)a.fn!==e||n&&!a.once||r&&a.context!==r||o(this,s);else{for(var h=0,u=[],c=a.length;h<c;h++)(a[h].fn!==e||n&&!a[h].once||r&&a[h].context!==r)&&u.push(a[h]);u.length?this._events[s]=1===u.length?u[0]:u:o(this,s)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&o(this,e)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=i,a.EventEmitter=a,t.exports=a},7042:function(t){t.exports=(()=>{var t={944:function(t){t.exports=(()=>{"use strict";var t={d:(e,i)=>{for(var r in i)t.o(i,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:i[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=s(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var r=0,n=function(){};return{s:n,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,h=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return a=t.done,t},e:function(t){h=!0,o=t},f:function(){try{a||null==i.return||i.return()}finally{if(h)throw o}}}}function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null!=i){var r,n,s=[],o=!0,a=!1;try{for(i=i.call(t);!(o=(r=i.next()).done)&&(s.push(r.value),!e||s.length!==e);o=!0);}catch(t){a=!0,n=t}finally{try{o||null==i.return||i.return()}finally{if(a)throw n}}return s}}(t,e)||s(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){if(t){if("string"==typeof t)return o(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}t.d(e,{default:()=>h});var h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];a(this,t),this.allowExtra=e,this.defaults=new Map,this.types=new Map,this.optional=new Set,this.required=new Set}var e;return(e=[{key:"setDefaults",value:function(t){var e=this;return Object.entries(t).forEach((function(t){var i=n(t,2),r=i[0],s=i[1];return e.defaults.set(r,s)})),this}},{key:"setTypes",value:function(t){var e=this;return Object.entries(t).forEach((function(t){var i=n(t,2),r=i[0],s=i[1];return e.types.set(r,s)})),this}},{key:"setOptional",value:function(t){var e=this;return t.forEach((function(t){return e.optional.add(t)})),this}},{key:"setRequired",value:function(t){var e=this;return t.forEach((function(t){return e.required.add(t)})),this}},{key:"resolve",value:function(t){var e=Object.assign(this.getDefaults(),t);return this.validate(e),e}},{key:"getDefaults",value:function(){var t,e={},i=r(this.defaults);try{for(i.s();!(t=i.n()).done;){var s=n(t.value,2),o=s[0],a=s[1];e[o]=a}}catch(t){i.e(t)}finally{i.f()}return e}},{key:"validate",value:function(t){for(var e in t){if(!this.optionExists(e))throw new Error('Unkown option "'.concat(e,'".'));this.checkType(e,t[e])}var i,n=r(this.required.values());try{for(n.s();!(i=n.n()).done;){var s=i.value;if(void 0===t[s])throw new Error('Option "'.concat(s,'" is required.'))}}catch(t){n.e(t)}finally{n.f()}}},{key:"checkType",value:function(t,e){if(this.types.has(t)){var r=this.types.get(t),n=i(e);if(n!==r)throw new Error('Wrong value for option "'.concat(t,'". Expected type "').concat(r,'" but got "').concat(n,'".'))}}},{key:"optionExists",value:function(t){return!!this.allowExtra||this.defaults.has(t)||this.optional.has(t)||this.required.has(t)||this.types.has(t)}}])&&function(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(t.prototype,e),t}();return e.default})()},162:function(t){t.exports=(()=>{"use strict";var t={d:(e,i)=>{for(var r in i)t.o(i,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:i[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{default:()=>i});var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._events={},this.on=this.addEventListener,this.off=this.removeEventListener}var e;return(e=[{key:"emit",value:function(t,e){if(Object.prototype.hasOwnProperty.call(this._events,t))for(var i=this._events[t],r={type:t,detail:e},n=i.length,s=0;s<n;s++)this.handle(i[s],r)}},{key:"handle",value:function(t,e){t(e)}},{key:"addEventListener",value:function(t,e){Object.prototype.hasOwnProperty.call(this._events,t)||(this._events[t]=[]),this._events[t].indexOf(e)<0&&this._events[t].push(e)}},{key:"removeEventListener",value:function(t,e){if(Object.prototype.hasOwnProperty.call(this._events,t)){var i=this._events[t],r=i.indexOf(e);r>=0&&i.splice(r,1),0===i.length&&delete this._events[t]}}}])&&function(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(t.prototype,e),t}();return e.default})()}},e={};function i(r){var n=e[r];if(void 0!==n)return n.exports;var s=e[r]={exports:{}};return t[r].call(s.exports,s,s.exports,i),s.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var r in e)i.o(e,r)&&!i.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};return(()=>{"use strict";i.r(r),i.d(r,{GamepadHandler:()=>d,GamepadListener:()=>x});var t=i(162),e=i.n(t),n=i(944),s=i.n(n);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?l(t):e}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(d,t);var e,i,r,n,s,o=(n=d,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=p(n);if(s){var i=p(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return c(this,t)});function d(t,e){var i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a(this,d),(i=o.call(this)).index=t,i.options=i.constructor.resolveOptions(r),i.sticks=new Array(e.axes.length/2).fill(null).map((function(){return[null,null]})),i.buttons=new Array(e.buttons.length).fill(null),i.updateStick=i.updateStick.bind(l(i)),i.updateButton=i.updateButton.bind(l(i)),i}return e=d,r=[{key:"resolveOptions",value:function(t){var e=void 0!==t.stick,i=void 0!==t.button,r={stick:this.optionResolver.resolve(e?t.stick:i?{}:t),button:this.optionResolver.resolve(i?t.button:e?{}:t)};return r.stick.deadZone=Math.max(Math.min(r.stick.deadZone,1),0),r.button.deadZone=Math.max(Math.min(r.button.deadZone,1),0),r.stick.precision=r.stick.precision?Math.pow(10,r.stick.precision):0,r.button.precision=r.button.precision?Math.pow(10,r.button.precision):0,r}}],(i=[{key:"update",value:function(t){for(var e=0,i=this.sticks.length,r=0;r<i;r++)for(var n=0;n<2;n++)this.updateStick(t,r,n,t.axes[e++]);var s=this.buttons.length;for(e=0;e<s;e++)this.updateButton(t,t.buttons[e],e)}},{key:"updateStick",value:function(t,e,i,r){var n=this.options.stick,s=n.deadZone,o=n.analog,a=n.precision;s&&r<s&&r>-s&&(r=0),o?a&&(r=Math.round(r*a)/a):r=r>0?1:r<0?-1:0,this.sticks[e][i]!==r&&(this.sticks[e][i]=r,this.emit("axis",{gamepad:t,stick:e,axis:i,value:r,index:this.index}))}},{key:"updateButton",value:function(t,e,i){var r=this.options.button,n=r.deadZone,s=r.analog,o=r.precision,a=e.value,h=e.pressed,u=a;n&&e.value<n&&e.value>-n&&(u=0),s?o&&(u=Math.round(u*o)/o):u=h?1:0,this.buttons[i]!==u&&(this.buttons[i]=u,this.emit("button",{gamepad:t,button:i,pressed:h,value:u,index:this.index}))}}])&&h(e.prototype,i),r&&h(e,r),d}(e());d.optionResolver=(new(s())).setDefaults({analog:!0,deadZone:0,precision:0}).setTypes({analog:"boolean",deadZone:"number",precision:"number"});var f=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.callback=e,this.frame=null,this.update=this.update.bind(this)}var e;return(e=[{key:"setCallback",value:function(t){this.callback=t}},{key:"start",value:function(){this.frame||(this.frame=window.requestAnimationFrame(this.update))}},{key:"stop",value:function(){this.frame&&(window.cancelAnimationFrame(this.frame),this.frame=null)}},{key:"update",value:function(){this.frame=window.requestAnimationFrame(this.update),this.callback()}}])&&function(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(t.prototype,e),t}();function g(t){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _(t,e){return(_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function v(t,e){return!e||"object"!==g(e)&&"function"!=typeof e?y(t):e}function y(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var x=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_(t,e)}(s,t);var e,i,r,n=(i=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=b(i);if(r){var n=b(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return v(this,t)});function s(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(m(this,s),t=n.call(this),"function"!=typeof navigator.getGamepads)throw new Error("This browser does not support gamepad API.");return t.options=e,t.onAxis=t.onAxis.bind(y(t)),t.update=t.update.bind(y(t)),t.start=t.start.bind(y(t)),t.stop=t.stop.bind(y(t)),t.discover=t.discover.bind(y(t)),t.onButton=t.onButton.bind(y(t)),t.handlers=new Array(4).fill(null),t.loop=new f(t.update),window.addEventListener("error",t.stop),t}return(e=[{key:"start",value:function(){this.loop.start()}},{key:"stop",value:function(){this.loop.stop()}},{key:"update",value:function(){var t=navigator.getGamepads();this.discover(t[0],0),this.discover(t[1],1),this.discover(t[2],2),this.discover(t[3],3)}},{key:"discover",value:function(t,e){t?(this.handlers[e]||this.registerHandler(e,t),this.handlers[e].update(t)):this.handlers[e]&&this.removeGamepad(e)}},{key:"registerHandler",value:function(t,e){if(this.handlers[t])throw new Error("Gamepad #".concat(t," is already registered."));var i=new d(t,e,this.options);this.handlers[t]=i,i.addEventListener("axis",this.onAxis),i.addEventListener("button",this.onButton),this.emit("gamepad:connected",{index:t,gamepad:e}),this.emit("gamepad:".concat(t,":connected"),{index:t,gamepad:e})}},{key:"removeGamepad",value:function(t){if(!this.handlers[t])throw new Error("Gamepad #".concat(t," is not registered."));this.handlers[t].removeEventListener("axis",this.onAxis),this.handlers[t].removeEventListener("button",this.onButton),this.handlers[t]=null,this.emit("gamepad:disconnected",{index:t}),this.emit("gamepad:".concat(t,":disconnected"),{index:t})}},{key:"onAxis",value:function(t){var e=t.detail.index;this.emit("gamepad:axis",t.detail),this.emit("gamepad:".concat(e,":axis"),t.detail),this.emit("gamepad:".concat(e,":axis:").concat(t.detail.axis),t.detail)}},{key:"onButton",value:function(t){var e=t.detail.index;this.emit("gamepad:button",t.detail),this.emit("gamepad:".concat(e,":button"),t.detail),this.emit("gamepad:".concat(e,":button:").concat(t.detail.button),t.detail)}}])&&function(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(s.prototype,e),s}(e())})(),r})()},8058:t=>{try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){t.exports=!1}},5586:(t,e,i)=>{"use strict";function r(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return e.map((function(e){return e.split(" ").map((function(e){return e?""+t+e:""})).join(" ")})).join(" ")}function n(t,e){return function(i){i&&(t[e]=i)}}function s(t,e,i){return function(r){r&&(t[e][i]=r)}}function o(t,e){return function(i){var r=i.prototype;t.forEach((function(t){e(r,t)}))}}i.r(e),i.d(e,{EVENTS:()=>Js,METHODS:()=>Ks,PROPERTIES:()=>Zs,PROPS_MAP:()=>Qs,default:()=>oo,getElementInfo:()=>no,makeAble:()=>so});var a=function(){function t(){this.keys=[],this.values=[]}var e=t.prototype;return e.get=function(t){return this.values[this.keys.indexOf(t)]},e.set=function(t,e){var i=this.keys,r=this.values,n=i.indexOf(t),s=-1===n?i.length:n;i[s]=t,r[s]=e},t}(),h=function(){function t(){this.object={}}var e=t.prototype;return e.get=function(t){return this.object[t]},e.set=function(t,e){this.object[t]=e},t}(),u="function"==typeof Map,c=function(){function t(){}var e=t.prototype;return e.connect=function(t,e){this.prev=t,this.next=e,t&&(t.next=this),e&&(e.prev=this)},e.disconnect=function(){var t=this.prev,e=this.next;t&&(t.next=e),e&&(e.prev=t)},e.getIndex=function(){for(var t=this,e=-1;t;)t=t.prev,++e;return e},t}(),l=function(){function t(t,e,i,r,n,s,o,a){this.prevList=t,this.list=e,this.added=i,this.removed=r,this.changed=n,this.maintained=s,this.changedBeforeAdded=o,this.fixed=a}var e=t.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){var t=function(t,e){var i=[],r=[];return t.forEach((function(t){var e=t[0],n=t[1],s=new c;i[e]=s,r[n]=s})),i.forEach((function(t,e){t.connect(i[e-1])})),t.filter((function(t,i){return!e[i]})).map((function(t,e){var n=t[0],s=t[1];if(n===s)return[0,0];var o=i[n],a=r[s-1],h=o.getIndex();return o.disconnect(),a?o.connect(a,a.next):o.connect(void 0,i[0]),[h,o.getIndex()]}))}(this.changedBeforeAdded,this.fixed),e=this.changed,i=[];this.cacheOrdered=t.filter((function(t,r){var n=t[0],s=t[1],o=e[r],a=o[0],h=o[1];if(n!==s)return i.push([a,h]),!0})),this.cachePureChanged=i},t}();function p(t,e,i){var r=u?Map:i?h:a,n=i||function(t){return t},s=[],o=[],c=[],p=t.map(n),d=e.map(n),f=new r,g=new r,m=[],_=[],v={},y=[],b=0,x=0;return p.forEach((function(t,e){f.set(t,e)})),d.forEach((function(t,e){g.set(t,e)})),p.forEach((function(t,e){var i=g.get(t);void 0===i?(++x,o.push(e)):v[i]=x})),d.forEach((function(t,e){var i=f.get(t);void 0===i?(s.push(e),++b):(c.push([i,e]),x=v[e]||0,m.push([i-x,e-b]),_.push(e===i),i!==e&&y.push([i,e]))})),o.reverse(),new l(t,e,s,o,y,c,m,_)}var d=function(){function t(t,e){void 0===t&&(t=[]),this.findKeyCallback=e,this.list=[].slice.call(t)}return t.prototype.update=function(t){var e=[].slice.call(t),i=p(this.list,e,this.findKeyCallback);return this.list=e,i},t}();const f=d;var g="undefined",m=(typeof document!==g&&document,[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}]),_=1e-7,v={cm:function(t){return 96*t/2.54},mm:function(t){return 96*t/254},in:function(t){return 96*t},pt:function(t){return 96*t/72},pc:function(t){return 96*t/6},"%":function(t,e){return t*e/100},vw:function(t,e){return void 0===e&&(e=window.innerWidth),t/100*e},vh:function(t,e){return void 0===e&&(e=window.innerHeight),t/100*e},vmax:function(t,e){return void 0===e&&(e=Math.max(window.innerWidth,window.innerHeight)),t/100*e},vmin:function(t,e){return void 0===e&&(e=Math.min(window.innerWidth,window.innerHeight)),t/100*e}};function y(t){return typeof t===g}function b(t){return t&&"object"==typeof t}function x(t){return Array.isArray(t)}function E(t){return"string"==typeof t}function T(t){return"function"==typeof t}function S(t,e,i,r,n){return w(t,e,i)?i:function(t,e,i,r,n){for(var s,o=function(i){var o=e[i].trim();if(o===t.close&&!w(t,e,i))return{value:i};var a=i,h=L(n,(function(t){return t.open===o}));if(h&&(a=S(h,e,i,r,n)),-1===a)return s=i,"break";s=i=a},a=i;a<r;++a){var h=o(a);if(a=s,"object"==typeof h)return h.value;if("break"===h)break}return-1}(t,e,i+1,r,n)}function w(t,e,i){if(!t.ignore)return null;var r=e.slice(Math.max(i-3,0),i+3).join("");return new RegExp(t.ignore).exec(r)}function A(t,e){var i=E(e)?{separator:e}:e,r=i.separator,n=void 0===r?",":r,s=i.isSeparateFirst,o=i.isSeparateOnlyOpenClose,a=i.isSeparateOpenClose,h=void 0===a?o:a,u=i.openCloseCharacters,c=void 0===u?m:u,l=c.map((function(t){var e=t.open,i=t.close;return e===i?e:e+"|"+i})).join("|"),p=new RegExp("(\\s*"+n+"\\s*|"+l+"|\\s+)","g"),d=t.split(p).filter(Boolean),f=d.length,g=[],_=[];function v(){return!!_.length&&(g.push(_.join("")),_=[],!0)}for(var y,b=function(t){var e=d[t].trim(),i=t,r=L(c,(function(t){return t.open===e})),a=L(c,(function(t){return t.close===e}));if(r){if(-1!==(i=S(r,d,t,f,c))&&h)return v()&&s?(y=t,"break"):(g.push(d.slice(t,i+1).join("")),t=i,s?(y=t,"break"):(y=t,"continue"))}else{if(a&&!w(a,d,t))throw new Error("invalid format: "+a.close);if(function(t,e){return(""===e||" "==e)&&(""===t||" "==t)||t===e}(e,n)&&!o)return v(),s?(y=t,"break"):(y=t,"continue")}-1===i&&(i=f-1),_.push(d.slice(t,i+1).join("")),y=t=i},x=0;x<f;++x){var T=b(x);if(x=y,"break"===T)break}return _.length&&g.push(_.join("")),g}function C(t){return A(t,"")}function O(t){return A(t,",")}function I(t){var e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(t);return!e||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}}function R(t){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(t);if(!e)return{prefix:"",unit:"",value:NaN};var i=e[1],r=e[2];return{prefix:i,unit:e[3],value:parseFloat(r)}}function M(t,e){return void 0===e&&(e="-"),t.replace(/([a-z])([A-Z])/g,(function(t,i,r){return""+i+e+r.toLowerCase()}))}function P(){return Date.now?Date.now():(new Date).getTime()}function N(t,e,i){void 0===i&&(i=-1);for(var r=t.length,n=0;n<r;++n)if(e(t[n],n,t))return n;return i}function L(t,e,i){var r=N(t,e);return r>-1?t[r]:i}function D(t){if(Object.keys)return Object.keys(t);var e=[];for(var i in e)e.push(i);return e}function k(t,e){var i=R(t),r=i.value,n=i.unit;if(b(e)){var s=e[n];if(s){if(T(s))return s(r);if(v[n])return v[n](r,s)}}else if("%"===n)return r*e/100;return v[n]?v[n](r):r}function B(t,e,i){return[[X(e[0],_),X(e[0]*t[1]/t[0],_)],[X(e[1]*t[0]/t[1],_),X(e[1],_)]].filter((function(t){return t.every((function(t,r){return i?t<=e[r]:t>=e[r]}))}))[0]||t}function F(t){for(var e=t.length,i=0,r=e-1;r>=0;--r)i+=t[r];return e?i/e:0}function G(t,e){var i=e[0]-t[0],r=e[1]-t[1],n=Math.atan2(r,i);return n>=0?n:n+2*Math.PI}function U(t){var e=function(t){return[0,1].map((function(e){return F(t.map((function(t){return t[e]})))}))}(t),i=G(e,t[0]),r=G(e,t[1]);return i<r&&r-i<Math.PI||i>r&&r-i<-Math.PI?1:-1}function j(t,e){return Math.sqrt(Math.pow((e?e[0]:0)-t[0],2)+Math.pow((e?e[1]:0)-t[1],2))}function X(t,e){return e?Math.round(t/e)*e:t}function z(t,e){return t.forEach((function(i,r){t[r]=X(t[r],e)})),t}function H(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function V(t,e,i,r){t.addEventListener(e,i,r)}function Y(t,e,i,r){t.removeEventListener(e,i,r)}var W=function(t,e){return W=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},W(t,e)};function $(t,e){function i(){this.constructor=t}W(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var q=function(){return q=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},q.apply(this,arguments)};function Z(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i}function K(t,e){if(t===e)return!1;for(var i in t)if(!(i in e))return!0;for(var i in e)if(t[i]!==e[i])return!0;return!1}function J(t,e){var i=Object.keys(t),r=Object.keys(e),n=p(i,r,(function(t){return t})),s={},o={},a={};return n.added.forEach((function(t){var i=r[t];s[i]=e[i]})),n.removed.forEach((function(e){var r=i[e];o[r]=t[r]})),n.maintained.forEach((function(r){var n=r[0],s=i[n],o=[t[s],e[s]];t[s]!==e[s]&&(a[s]=o)})),{added:s,removed:o,changed:a}}function Q(t){t.forEach((function(t){t()}))}function tt(t){var e=0;return t.map((function(t){return null==t?"$compat"+ ++e:""+t}))}function et(t,e,i,r){return E(t)||"number"==typeof t?new ht("text_"+t,e,i,r,null,{}):new("string"==typeof t.type?ut:t.type.prototype.render?ft:pt)(t.type,e,i,r,t.ref,t.props)}function it(t){var e=[];return t.forEach((function(t){e=e.concat(x(t)?it(t):t)})),e}function rt(t){var e=t.className,i=Z(t,["className"]);return null!=e&&(i.class=e),delete i.style,delete i.children,i}function nt(t,e){if(!e)return t;for(var i in e)y(t[i])&&(t[i]=e[i]);return t}function st(t,e){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];var n=e||{},s=n.key,o=n.ref,a=Z(n,["key","ref"]);return{type:t,key:s,ref:o,props:q(q({},a),{children:it(i).filter((function(t){return null!=t&&!1!==t}))})}}var ot=function(){function t(t,e,i,r,n,s){void 0===s&&(s={}),this.type=t,this.key=e,this.index=i,this.container=r,this.ref=n,this.props=s,this._providers=[]}var e=t.prototype;return e._should=function(t,e){return!0},e._update=function(t,e,i,r){if(this.base&&!E(e)&&!r&&!this._should(e.props,i))return!1;this.original=e,this._setState(i);var n=this.props;return E(e)||(this.props=e.props,this.ref=e.ref),this._render(t,this.base?n:{},i),!0},e._mounted=function(){var t=this.ref;t&&t(this.base)},e._setState=function(t){},e._updated=function(){var t=this.ref;t&&t(this.base)},e._destroy=function(){var t=this.ref;t&&t(null)},t}();function at(t){var e={},i={};for(var r in t)0===r.indexOf("on")?i[r.replace("on","").toLowerCase()]=t[r]:e[r]=t[r];return{attributes:e,events:i}}var ht=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}$(e,t);var i=e.prototype;return i._render=function(t){var e=this,i=!this.base;return i&&(this.base=document.createTextNode(this.type.replace("text_",""))),t.push((function(){i?e._mounted():e._updated()})),!0},i._unmount=function(){this.base.parentNode.removeChild(this.base)},e}(ot),ut=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.events={},e._isSVG=!1,e}$(e,t);var i=e.prototype;return i.addEventListener=function(t,e){var i=this.events;i[t]=function(t){t.nativeEvent=t,e(t)},this.base.addEventListener(t,i[t])},i.removeEventListener=function(t){var e=this.events;this.base.removeEventListener(t,e[t]),delete e[t]},i._should=function(t){return K(this.props,t)},i._render=function(t,e){var i=this,r=!this.base;if(r){var n=this._hasSVG();this._isSVG=n;var s=this.props.portalContainer;if(!s){var o=this.type;s=n?document.createElementNS("http://www.w3.org/2000/svg",o):document.createElement(o)}this.base=s}vt(this,this._providers,this.props.children,t,null);var a=this.base,h=at(e),u=h.attributes,c=h.events,l=at(this.props),p=l.attributes,d=l.events;return function(t,e,i){var r=J(t,e),n=r.added,s=r.removed,o=r.changed;for(var a in n)i.setAttribute(a,n[a]);for(var a in o)i.setAttribute(a,o[a][1]);for(var a in s)i.removeAttribute(a)}(rt(u),rt(p),a),function(t,e,i){var r=J(t,e),n=r.added,s=r.removed,o=r.changed;for(var a in s)i.removeEventListener(a);for(var a in n)i.addEventListener(a,n[a]);for(var a in o)i.removeEventListener(a),i.addEventListener(a,o[a][1]);for(var a in s)i.removeEventListener(a)}(c,d,this),function(t,e,i){var r=i.style,n=J(t,e),s=n.added,o=n.removed,a=n.changed;for(var h in s){var u=M(h,"-");r.setProperty?r.setProperty(u,s[h]):r[u]=s[h]}for(var h in a)u=M(h,"-"),r.setProperty?r.setProperty(u,a[h][1]):r[u]=a[h][1];for(var h in o)u=M(h,"-"),r.removeProperty?r.removeProperty(u):r[u]=""}(e.style||{},this.props.style||{},a),t.push((function(){r?i._mounted():i._updated()})),!0},i._unmount=function(){var t=this.events,e=this.base;for(var i in t)e.removeEventListener(i,t[i]);this._providers.forEach((function(t){t._unmount()})),this.events={},this.props.portalContainer||e.parentNode.removeChild(e)},i._hasSVG=function(){if(this._isSVG||"svg"===this.type)return!0;var t=ct(this.container);return t&&"ownerSVGElement"in t},e}(ot);function ct(t){if(!t)return null;var e=t.base;return e instanceof Node?e:ct(t.container)}function lt(t){if(!t)return null;if(t instanceof Node)return t;var e=t.$_provider._providers;return e.length?lt(e[0].base):null}var pt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}$(e,t);var i=e.prototype;return i._render=function(t){var e=this.type(this.props);return vt(this,this._providers,e?[e]:[],t),!0},i._unmount=function(){this._providers.forEach((function(t){t._unmount()}))},e}(ot),dt=function(t){function e(e){var i=t.call(this,"container","container",0,null)||this;return i.base=e,i}$(e,t);var i=e.prototype;return i._render=function(){return!0},i._unmount=function(){},e}(ot),ft=function(t){function e(e,i,r,n,s,o){return void 0===o&&(o={}),t.call(this,e,i,r,n,s,nt(o,e.defaultProps))||this}$(e,t);var i=e.prototype;return i._should=function(t,e){return this.base.shouldComponentUpdate(nt(t,this.type.defaultProps),e||this.base.state)},i._render=function(t,e,i){var r=this;this.props=nt(this.props,this.type.defaultProps);var n=!this.base;n?(this.base=new this.type(this.props),this.base.$_provider=this):this.base.props=this.props;var s=this.base,o=s.state,a=s.render();a&&a.props&&!a.props.children.length&&(a.props.children=this.props.children),vt(this,this._providers,a?[a]:[],t,i,null),t.push((function(){n?(r._mounted(),s.componentDidMount()):(r._updated(),s.componentDidUpdate(e,o))}))},i._setState=function(t){t&&(this.base.state=t)},i._unmount=function(){this._providers.forEach((function(t){t._unmount()})),clearTimeout(this.base.$_timer),this.base.componentWillUnmount()},e}(ot),gt=function(){function t(t){void 0===t&&(t={}),this.props=t,this.state={},this.$_timer=0,this.$_state={}}var e=t.prototype;return e.shouldComponentUpdate=function(t,e){return!0},e.render=function(){return null},e.setState=function(t,e,i){var r=this;this.$_timer||(this.$_state={}),clearTimeout(this.$_timer),this.$_timer=0,this.$_state=q(q({},this.$_state),t),i?this.$_setState(e,i):this.$_timer=setTimeout((function(){r.$_timer=0,r.$_setState(e,i)}))},e.forceUpdate=function(t){this.setState({},t,!0)},e.componentDidMount=function(){},e.componentDidUpdate=function(t,e){},e.componentWillUnmount=function(){},e.$_setState=function(t,e){var i=[],r=this.$_provider;vt(r.container,[r],[r.original],i,q(q({},this.state),this.$_state),e)&&(t&&i.push(t),Q(i))},t}(),mt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $(e,t),e.prototype.shouldComponentUpdate=function(t,e){return K(this.props,t)||K(this.state,e)},e}(gt),_t=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}$(e,t);var i=e.prototype;return i.componentDidMount=function(){var t=this.props,e=t.element,i=t.container;this._portalProvider=new dt(i),yt(e,i,this._portalProvider)},i.componentDidUpdate=function(){var t=this.props;yt(t.element,t.container,this._portalProvider)},i.componentWillUnmount=function(){yt(null,this.props.container,this._portalProvider),this._portalProvider=null},e}(mt);function vt(t,e,i,r,n,s){var o=function(t,e,i){var r=i.map((function(t){return E(t)?null:t.key})),n=p(tt(e.map((function(t){return t.key}))),tt(r),(function(t){return t}));n.removed.forEach((function(t){e.splice(t,1)[0]._unmount()})),n.ordered.forEach((function(t){var i=t[0],r=t[1],n=e.splice(i,1)[0];e.splice(r,0,n);var s=lt(n.base),o=lt(e[r+1]&&e[r+1].base);s&&s.parentNode.insertBefore(s,o)})),n.added.forEach((function(n){e.splice(n,0,et(i[n],r[n],n,t))}));var s=n.maintained.filter((function(n){n[0];var s=n[1],o=i[s],a=e[s];return(E(o)?"text_"+o:o.type)!==a.type?(a._unmount(),e.splice(s,1,et(o,r[s],s,t)),!0):(a.index=s,!1)}));return function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var r=Array(t),n=0;for(e=0;e<i;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,n++)r[n]=s[o];return r}(n.added,s.map((function(t){return t[0],t[1]})))}(t,e,i),a=e.filter((function(t,e){return t._update(r,i[e],n,s)})),h=ct(t);return h&&o.reverse().forEach((function(i){var r=e[i],n=lt(r.base);if(n&&h!==n&&!n.parentNode){var s=function(t,e){for(var i=t._providers,r=i.length,n=e.index+1;n<r;++n){var s=lt(i[n].base);if(s)return s}return null}(t,r);h.insertBefore(n,s)}})),a.length>0}function yt(t,e,i){void 0===i&&(i=e.__REACT_COMPAT__);var r=!!i;return i||(i=new dt(e)),function(t,e,i){var r=[];vt(t,t._providers,e,r,void 0),Q(r)}(i,t?[t]:[]),r||(e.__REACT_COMPAT__=i),i}function bt(t,e,i){var r=e.__REACT_COMPAT__;t&&!r&&(e.innerHTML=""),yt(t,e,r),i&&i()}function xt(t,e){for(var i=t.length,r=0;r<i;++r)if(e(t[r],r))return!0;return!1}function Et(t,e){for(var i=t.length,r=0;r<i;++r)if(e(t[r],r))return t[r];return null}function Tt(t,e){try{return new RegExp(t,"g").exec(e)}catch(t){return null}}function St(t){return t.replace(/_/g,".")}function wt(t,e){var i=null,r="-1";return xt(t,(function(t){var n=Tt("("+t.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",e);return!(!n||t.brand||(i=t,r=n[3]||"-1",t.versionAlias?r=t.versionAlias:t.versionTest&&(r=function(t,e){var i=Tt("("+t+")((?:\\/|\\s|:)([0-9|\\.|_]+))",e);return i?i[3]:""}(t.versionTest.toLowerCase(),e)||r),r=St(r),0))})),{preset:i,version:r}}function At(t,e){var i={brand:"",version:"-1"};return xt(t,(function(t){var r=Ct(e,t);return!!r&&(i.brand=t.id,i.version=t.versionAlias||r.version,"-1"!==i.version)})),i}function Ct(t,e){return Et(t,(function(t){var i=t.brand;return Tt(""+e.test,i.toLowerCase())}))}var Ot=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],It=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],Rt=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],Mt=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],Pt=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"mac os x",id:"mac"},{test:"android",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];const Nt=function(t){return void 0===t&&function(){if("undefined"==typeof navigator||!navigator||!navigator.userAgentData)return!1;var t=navigator.userAgentData,e=t.brands||t.uaList;return!(!e||!e.length)}()?function(t){var e=navigator.userAgentData,i=(e.uaList||e.brands).slice(),r=e.mobile||!1,n=i[0],s={name:n.brand,version:n.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!At(Mt,i).brand},o={name:"unknown",version:"-1",majorVersion:-1};s.webkit=!s.chromium&&xt(Rt,(function(t){return Ct(i,t)}));var a=At(It,i);if(s.chromium=!!a.brand,s.chromiumVersion=a.version,!s.chromium){var h=At(Rt,i);s.webkit=!!h.brand,s.webkitVersion=h.version}if(t){var u=t.platform.toLowerCase(),c=Et(Pt,(function(t){return new RegExp(""+t.test,"g").exec(u)}));o.name=c?c.id:u,o.version=t.platformVersion}var l=At(Ot,i);return l.brand&&(s.name=l.brand,s.version=t?t.uaFullVersion:l.version),"Linux armv8l"===navigator.platform?o.name="android":s.webkit&&(o.name=r?"ios":"mac"),"ios"===o.name&&s.webview&&(s.version="-1"),o.version=St(o.version),s.version=St(s.version),o.majorVersion=parseInt(o.version,10),s.majorVersion=parseInt(s.version,10),{browser:s,os:o,isMobile:r,isHints:!0}}():function(t){var e=function(t){var e=t;if(void 0===e){if("undefined"==typeof navigator||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}(t),i=!!/mobi/g.exec(e),r={name:"unknown",version:"-1",majorVersion:-1,webview:!!wt(Mt,e).preset,chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},n={name:"unknown",version:"-1",majorVersion:-1},s=wt(Ot,e),o=s.preset,a=s.version,h=wt(Pt,e),u=h.preset,c=h.version,l=wt(It,e);if(r.chromium=!!l.preset,r.chromiumVersion=l.version,!r.chromium){var p=wt(Rt,e);r.webkit=!!p.preset,r.webkitVersion=p.version}return u&&(n.name=u.id,n.version=c,n.majorVersion=parseInt(c,10)),o&&(r.name=o.id,r.version=a,r.webview&&"ios"===n.name&&"safari"!==r.name&&(r.webview=!1)),r.majorVersion=parseInt(r.version,10),{browser:r,os:n,isMobile:i,isHints:!1}}(t)};function Lt(t,e,i,r,n,s){for(var o=0;o<n;++o){var a=i+o*n,h=r+o*n;t[a]+=t[h]*s,e[a]+=e[h]*s}}function Dt(t,e,i,r,n){for(var s=0;s<n;++s){var o=i+s*n,a=r+s*n,h=t[o],u=e[o];t[o]=t[a],t[a]=h,e[o]=e[a],e[a]=u}}function kt(t,e,i,r,n){for(var s=0;s<r;++s){var o=i+s*r;t[o]/=n,e[o]/=n}}function Bt(t,e,i){void 0===i&&(i=Math.sqrt(t.length));for(var r=t.slice(),n=0;n<i;++n)r[n*i+e-1]=0,r[(e-1)*i+n]=0;return r[(e-1)*(i+1)]=1,r}function Ft(t,e){void 0===e&&(e=Math.sqrt(t.length));for(var i=t.slice(),r=ee(e),n=0;n<e;++n){var s=e*n+n;if(!X(i[s],_))for(var o=n+1;o<e;++o)if(i[e*n+o]){Dt(i,r,n,o,e);break}if(!X(i[s],_))return[];for(kt(i,r,n,e,i[s]),o=0;o<e;++o){var a=o,h=i[o+n*e];X(h,_)&&n!==o&&Lt(i,r,a,n,e,-h)}}return r}function Gt(t,e){for(var i=t.slice(),r=t.length;r<e-1;++r)i[r]=0;return i[e-1]=1,i}function Ut(t,e,i){if(void 0===e&&(e=Math.sqrt(t.length)),e===i)return t;for(var r=ee(i),n=Math.min(e,i),s=0;s<n-1;++s){for(var o=0;o<n-1;++o)r[s*i+o]=t[s*e+o];r[(s+1)*i-1]=t[(s+1)*e-1],r[(i-1)*i+s]=t[(e-1)*e+s]}return r[i*i-1]=t[e*e-1],r}function jt(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var r=ee(t);return e.forEach((function(e){r=Xt(r,e,t)})),r}function Xt(t,e,i){void 0===i&&(i=Math.sqrt(t.length));var r=[],n=t.length/i,s=e.length/n;if(!n)return e;if(!s)return t;for(var o=0;o<i;++o)for(var a=0;a<s;++a){r[a*i+o]=0;for(var h=0;h<n;++h)r[a*i+o]+=t[h*i+o]*e[a*n+h]}return r}function zt(t,e){for(var i=Math.min(t.length,e.length),r=t.slice(),n=0;n<i;++n)r[n]=r[n]+e[n];return r}function Ht(t,e){for(var i=Math.min(t.length,e.length),r=t.slice(),n=0;n<i;++n)r[n]=r[n]-e[n];return r}function Vt(t,e){return void 0===e&&(e=9===t.length),e?[t[0],t[1],t[3],t[4],t[6],t[7]]:t}function Yt(t,e,i){void 0===i&&(i=e.length);var r=Xt(t,e,i),n=r[i-1];return r.map((function(t){return t/n}))}function Wt(t,e){return Xt(t,[1,0,0,0,0,Math.cos(e),Math.sin(e),0,0,-Math.sin(e),Math.cos(e),0,0,0,0,1],4)}function $t(t,e){return Xt(t,[Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1],4)}function qt(t,e){return Xt(t,te(e,4))}function Zt(t,e){var i=e[0],r=void 0===i?1:i,n=e[1],s=void 0===n?1:n,o=e[2];return Xt(t,[r,0,0,0,0,s,0,0,0,0,void 0===o?1:o,0,0,0,0,1],4)}function Kt(t,e){return Yt(te(e,3),Gt(t,3))}function Jt(t,e){var i=e[0],r=void 0===i?0:i,n=e[1],s=void 0===n?0:n,o=e[2];return Xt(t,[1,0,0,0,0,1,0,0,0,0,1,0,r,s,void 0===o?0:o,1],4)}function Qt(t,e){return Xt(t,e,4)}function te(t,e){var i=Math.cos(t),r=Math.sin(t),n=ee(e);return n[0]=i,n[1]=r,n[e]=-r,n[e+1]=i,n}function ee(t){for(var e=t*t,i=[],r=0;r<e;++r)i[r]=r%(t+1)?0:1;return i}function ie(t,e){for(var i=ee(e),r=Math.min(t.length,e-1),n=0;n<r;++n)i[(e+1)*n]=t[n];return i}function re(t,e){for(var i=ee(e),r=Math.min(t.length,e-1),n=0;n<r;++n)i[e*(e-1)+n]=t[n];return i}function ne(t,e,i,r,n,s,o,a){var h=t[0],u=t[1],c=e[0],l=e[1],p=i[0],d=i[1],f=r[0],g=r[1],m=n[0],_=n[1],v=s[0],y=s[1],b=o[0],x=o[1],E=a[0],T=a[1],S=Ft([h,0,c,0,p,0,f,0,u,0,l,0,d,0,g,0,1,0,1,0,1,0,1,0,0,h,0,c,0,p,0,f,0,u,0,l,0,d,0,g,0,1,0,1,0,1,0,1,-m*h,-_*h,-v*c,-y*c,-b*p,-x*p,-E*f,-T*f,-m*u,-_*u,-v*l,-y*l,-b*d,-x*d,-E*g,-T*g],8);if(!S.length)return[];var w=Xt(S,[m,_,v,y,b,x,E,T],8);return w[8]=1,Ut(function(t,e){void 0===e&&(e=Math.sqrt(t.length));for(var i=[],r=0;r<e;++r)for(var n=0;n<e;++n)i[n*e+r]=t[e*r+n];return i}(w),3,4)}function se(t){var e=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return t.forEach((function(t){var i=t.matrixFunction,r=t.functionValue;i&&(e=i(e,r))})),e}function oe(t){return(x(t)?t:C(t)).map((function(t){var e=I(t),i=e.prefix,r=e.value,n=null,s=i,o="";if("translate"===i||"translateX"===i||"translate3d"===i){var a=O(r).map((function(t){return parseFloat(t)})),h=a[0],u=a[1],c=void 0===u?0:u,l=a[2];n=Jt,o=[h,c,void 0===l?0:l]}else if("translateY"===i)n=Jt,o=[0,c=parseFloat(r),0];else if("translateZ"===i)n=Jt,o=[0,0,parseFloat(r)];else if("scale"===i||"scale3d"===i){var p=O(r).map((function(t){return parseFloat(t)})),d=p[0],f=p[1],g=void 0===f?d:f,m=p[2];n=Zt,o=[d,g,void 0===m?1:m]}else if("scaleX"===i)n=Zt,o=[d=parseFloat(r),1,1];else if("scaleY"===i)n=Zt,o=[1,g=parseFloat(r),1];else if("scaleZ"===i)n=Zt,o=[1,1,parseFloat(r)];else if("rotate"===i||"rotateZ"===i||"rotateX"===i||"rotateY"===i){var _=R(r),v=_.unit,y=_.value;"rotate"===i||"rotateZ"===i?(s="rotateZ",n=qt):"rotateX"===i?n=Wt:"rotateY"===i&&(n=$t),o="rad"===v?y:y*Math.PI/180}else if("matrix3d"===i)n=Qt,o=O(r).map((function(t){return parseFloat(t)}));else if("matrix"===i){var b=O(r).map((function(t){return parseFloat(t)}));n=Qt,o=[b[0],b[1],0,0,b[2],b[3],0,0,0,0,1,0,b[4],b[5],0,1]}else s="";return{name:i,functionName:s,value:r,matrixFunction:n,functionValue:o}}))}function ae(t){return t.length<3?0:Math.abs(function(t){for(var e=0,i=t.length-1;i>=0;--i)e+=t[i];return e}(t.map((function(e,i){var r=t[i+1]||t[0];return e[0]*r[1]-r[0]*e[1]}))))/2}function he(t,e){var i=e.width,r=e.height,n=e.left,s=e.top,o=ue(t),a=o.minX,h=o.minY,u=o.maxX,c=o.maxY,l=i/(u-a),p=r/(c-h);return t.map((function(t){return[n+(t[0]-a)*l,s+(t[1]-h)*p]}))}function ue(t){var e=t.map((function(t){return t[0]})),i=t.map((function(t){return t[1]}));return{minX:Math.min.apply(Math,e),minY:Math.min.apply(Math,i),maxX:Math.max.apply(Math,e),maxY:Math.max.apply(Math,i)}}function ce(t,e,i){var r=t[0],n=t[1],s=ue(e),o=s.minX,a=s.minY,h=s.maxX,u=s.maxY,c=[[o,n],[h,n]],l=[[r,a],[r,u]],p=le(c[0],c[1]),d=le(l[0],l[1]),f=fe(e),g=[],m=[];return f.forEach((function(t){var e=le(t[0],t[1]),i=de(pe(p,e),[c,t]),s=de(pe(d,e),[l,t]);1===i.length&&t[0][1]===n||g.push.apply(g,i),1===s.length&&t[0][0]===r||m.push.apply(m,s),e[0]||g.push.apply(g,i),e[1]||m.push.apply(m,s)})),!i&&(N(g,(function(t){return t[0]===r}))>-1||N(m,(function(t){return t[1]===n}))>-1)||!!(g.filter((function(t){return t[0]>r})).length%2&&m.filter((function(t){return t[1]>n})).length%2)}function le(t,e){var i=t[0],r=t[1],n=e[0],s=e[1];if(i===n&&r===s)return[0,0,0];if(i===n)return[1,0,-i];if(r===s)return[0,1,-r];var o=(n-i)/(r-s);return[1,o,-i-o*r]}function pe(t,e){var i,r,n=t[0],s=t[1],o=t[2],a=e[0],h=e[1],u=e[2],c=0===n&&0===a,l=0===s&&0===h;if(c&&l)return[];if(c){var p=-o/s;return p!==-u/h?[]:[[-1/0,p],[1/0,p]]}if(l){var d=-o/n;return d!==-u/a?[]:[[d,-1/0],[d,1/0]]}return 0===n?[[i=-(h*(r=-o/s)+u)/a,r]]:0===a?[[i=-(s*(r=-u/h)+o)/n,r]]:0===s?[[i=-o/n,r=-(a*i+u)/h]]:0===h?[[i=-u/a,r=-(n*i+o)/s]]:[[i=(s*u-h*o)/(h*n-s*a),r=-(n*i+o)/s]]}function de(t,e){var i=e.map((function(t){return[0,1].map((function(e){return[Math.min(t[0][e],t[1][e]),Math.max(t[0][e],t[1][e])]}))}));if(2===t.length){var r=t[0],n=r[0],s=r[1];if(n===t[1][0]){var o=Math.max.apply(Math,i.map((function(t){return t[1][0]}))),a=Math.min.apply(Math,i.map((function(t){return t[1][1]})));return o>a?[]:[[n,o],[n,a]]}if(s===t[1][1]){var h=Math.max.apply(Math,i.map((function(t){return t[0][0]}))),u=Math.min.apply(Math,i.map((function(t){return t[0][1]})));return h>u?[]:[[h,s],[u,s]]}}return t.filter((function(t){return i.every((function(e){return e[0][0]<=t[0]&&t[0]<=e[0][1]&&e[1][0]<=t[1]&&t[1]<=e[1][1]}))}))}function fe(t){return function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var r=Array(t),n=0;for(e=0;e<i;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,n++)r[n]=s[o];return r}(t.slice(1),[t[0]]).map((function(e,i){return[t[i],e]}))}var ge,me=function(t,e){return me=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},me(t,e)},_e="function"==typeof Map?void 0:(ge=0,function(t){return t.__DIFF_KEY__||(t.__DIFF_KEY__=++ge)});const ve=function(t){function e(e){return void 0===e&&(e=[]),t.call(this,e,_e)||this}return function(t,e){function i(){this.constructor=t}me(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}(e,t),e}(f);var ye=function(){return ye=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},ye.apply(this,arguments)},be=function(){function t(){this._events={}}var e=t.prototype;return e.on=function(t,e){if(b(t))for(var i in t)this.on(i,t[i]);else this._addEvent(t,e,{});return this},e.off=function(t,e){if(t)if(b(t))for(var i in t)this.off(i);else if(e){var r=this._events[t];if(r){var n=N(r,(function(t){return t.listener===e}));n>-1&&r.splice(n,1)}}else this._events[t]=[];else this._events={};return this},e.once=function(t,e){var i=this;return e&&this._addEvent(t,e,{once:!0}),new Promise((function(e){i._addEvent(t,e,{once:!0})}))},e.emit=function(t,e){var i=this;void 0===e&&(e={});var r=this._events[t];if(!t||!r)return!0;var n=!1;return e.eventType=t,e.stop=function(){n=!0},e.currentTarget=this,function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var r=Array(t),n=0;for(e=0;e<i;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,n++)r[n]=s[o];return r}(r).forEach((function(r){r.listener(e),r.once&&i.off(t,r.listener)})),!n},e.trigger=function(t,e){return void 0===e&&(e={}),this.emit(t,e)},e._addEvent=function(t,e,i){var r=this._events;r[t]=r[t]||[],r[t].push(ye({listener:e},i))},t}();const xe=be;var Ee=function(t,e){return Ee=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},Ee(t,e)};function Te(t){var e=t.container;return e===document.body?[e.scrollLeft||document.documentElement.scrollLeft,e.scrollTop||document.documentElement.scrollTop]:[e.scrollLeft,e.scrollTop]}var Se=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.startRect=null,e.startPos=[],e.prevTime=0,e.timer=0,e}!function(t,e){function i(){this.constructor=t}Ee(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}(e,t);var i=e.prototype;return i.dragStart=function(t,e){var i=e.container,r=0,n=0,s=0,o=0;if(i===document.body)s=window.innerWidth,o=window.innerHeight;else{var a=i.getBoundingClientRect();r=a.top,n=a.left,s=a.width,o=a.height}this.startPos=[t.clientX,t.clientY],this.startRect={top:r,left:n,width:s,height:o}},i.drag=function(t,e){var i=this,r=t.clientX,n=t.clientY,s=e.container,o=e.threshold,a=void 0===o?0:o,h=e.throttleTime,u=void 0===h?0:h,c=e.getScrollPosition,l=void 0===c?Te:c,p=this.startRect,d=this.startPos,f=P(),g=Math.max(u+this.prevTime-f,0),m=[0,0];if(p.top>n-a?(d[1]>p.top||n<d[1])&&(m[1]=-1):p.top+p.height<n+a&&(d[1]<p.top+p.height||n>d[1])&&(m[1]=1),p.left>r-a?(d[0]>p.left||r<d[0])&&(m[0]=-1):p.left+p.width<r+a&&(d[0]<p.left+p.width||r>d[0])&&(m[0]=1),clearTimeout(this.timer),!m[0]&&!m[1])return!1;if(g>0)return this.timer=window.setTimeout((function(){i.drag(t,e)}),g),!1;this.prevTime=f;var _=l({container:s,direction:m});this.trigger("scroll",{container:s,direction:m,inputEvent:t});var v=l({container:s,direction:m}),y=v[0]-_[0],b=v[1]-_[1];return!(!y&&!b||(this.trigger("move",{offsetX:m[0]?y:0,offsetY:m[1]?b:0,inputEvent:t}),u&&(this.timer=window.setTimeout((function(){i.drag(t,e)}),u)),0))},i.dragEnd=function(){clearTimeout(this.timer)},e}(xe);const we=Se;var Ae=function(t,e){return Ae=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},Ae(t,e)},Ce=function(){return Ce=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},Ce.apply(this,arguments)};function Oe(t){return 180*(e=[t[0].clientX,t[0].clientY],r=(i=[t[1].clientX,t[1].clientY])[0]-e[0],n=i[1]-e[1],((s=Math.atan2(n,r))>=0?s:s+2*Math.PI)/Math.PI);var e,i,r,n,s}function Ie(t){return t.touches?function(t){for(var e=Math.min(t.length,2),i=[],r=0;r<e;++r)i.push(Pe(t[r]));return i}(t.touches):[Pe(t)]}function Re(t,e,i){var r=i.length,n=Ne(t,r),s=n.clientX,o=n.clientY,a=n.originalClientX,h=n.originalClientY,u=Ne(e,r),c=u.clientX,l=u.clientY,p=Ne(i,r);return{clientX:a,clientY:h,deltaX:s-c,deltaY:o-l,distX:s-p.clientX,distY:o-p.clientY}}function Me(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function Pe(t){return{clientX:t.clientX,clientY:t.clientY}}function Ne(t,e){void 0===e&&(e=t.length);for(var i={clientX:0,clientY:0,originalClientX:0,originalClientY:0},r=0;r<e;++r){var n=t[r];i.originalClientX+="originalClientX"in n?n.originalClientX:n.clientX,i.originalClientY+="originalClientY"in n?n.originalClientY:n.clientY,i.clientX+=n.clientX,i.clientY+=n.clientY}return e?{clientX:i.clientX/e,clientY:i.clientY/e,originalClientX:i.originalClientX/e,originalClientY:i.originalClientY/e}:i}var Le=function(){function t(t){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=t,this.prevClients=t,this.length=t.length}var e=t.prototype;return e.addClients=function(t){void 0===t&&(t=this.prevClients);var e=this.getPosition(t),i=e.deltaX,r=e.deltaY;return this.movement+=Math.sqrt(i*i+r*r),this.prevClients=t,e},e.getAngle=function(t){return void 0===t&&(t=this.prevClients),Oe(t)},e.getRotation=function(t){return void 0===t&&(t=this.prevClients),Oe(t)-Oe(this.startClients)},e.getPosition=function(t){return Re(t||this.prevClients,this.prevClients,this.startClients)},e.getPositions=function(t){void 0===t&&(t=this.prevClients);var e=this.prevClients;return this.startClients.map((function(i,r){return Re([t[r]],[e[r]],[i])}))},e.getMovement=function(t){var e=this.movement;if(!t)return e;var i=Ne(t,this.length),r=Ne(this.prevClients,this.length),n=i.clientX-r.clientX,s=i.clientY-r.clientY;return Math.sqrt(n*n+s*s)+e},e.getDistance=function(t){return void 0===t&&(t=this.prevClients),Me(t)},e.getScale=function(t){return void 0===t&&(t=this.prevClients),Me(t)/Me(this.startClients)},e.move=function(t,e){this.startClients.forEach((function(i){i.clientX-=t,i.clientY-=e})),this.prevClients.forEach((function(i){i.clientX-=t,i.clientY-=e}))},t}(),De=["textarea","input"];const ke=function(t){function e(e,i){void 0===i&&(i={});var r=t.call(this)||this;r.options={},r.flag=!1,r.pinchFlag=!1,r.datas={},r.isDrag=!1,r.isPinch=!1,r.isMouse=!1,r.isTouch=!1,r.clientStores=[],r.targets=[],r.prevTime=0,r.doubleFlag=!1,r.onDragStart=function(t,e){if(void 0===e&&(e=!0),r.flag||!1!==t.cancelable){var i=r.options,n=i.container,s=i.pinchOutside,o=i.preventRightClick,a=i.preventDefault,h=i.checkInput,u=r.isTouch,c=!r.flag;if(c){var l=document.activeElement,p=t.target,d=p.tagName.toLowerCase(),f=De.indexOf(d)>-1,g=p.isContentEditable;if(f||g){if(h||l===p)return!1;if(l&&g&&l.isContentEditable&&l.contains(p))return!1}else if((a||"touchstart"===t.type)&&l){var m=l.tagName;(l.isContentEditable||De.indexOf(m)>-1)&&l.blur()}if(r.clientStores=[new Le(Ie(t))],r.flag=!0,r.isDrag=!1,r.datas={},o&&(3===t.which||2===t.button))return r.initDrag(),!1;r.doubleFlag=P()-r.prevTime<200,!1===r.emit("dragStart",Ce({datas:r.datas,inputEvent:t,isTrusted:e,isDouble:r.doubleFlag},r.getCurrentStore().getPosition()))&&r.initDrag(),r.flag&&a&&t.preventDefault()}if(!r.flag)return!1;var _=0;if(c&&u&&s&&(_=setTimeout((function(){V(n,"touchstart",r.onDragStart,{passive:!1})}))),!c&&u&&s&&Y(n,"touchstart",r.onDragStart),r.flag&&function(t){return t.touches&&t.touches.length>=2}(t)){if(clearTimeout(_),c&&t.touches.length!==t.changedTouches.length)return;r.pinchFlag||r.onPinchStart(t)}}},r.onDrag=function(t,e){if(r.flag){var i=Ie(t),n=r.moveClients(i,t,!1);(r.pinchFlag||n.deltaX||n.deltaY)&&r.emit("drag",Ce({},n,{isScroll:!!e,inputEvent:t})),r.pinchFlag&&r.onPinch(t,i),r.getCurrentStore().addClients(i)}},r.onDragEnd=function(t){if(r.flag){var e=r.options,i=e.pinchOutside,n=e.container;r.isTouch&&i&&Y(n,"touchstart",r.onDragStart),r.flag=!1;var s=r.getCurrentStore().getPosition(),o=P(),a=!r.isDrag&&r.doubleFlag;r.prevTime=r.isDrag||a?0:o,r.emit("dragEnd",Ce({datas:r.datas,isDouble:a,isDrag:r.isDrag,isClick:!r.isDrag,inputEvent:t},s)),r.pinchFlag&&r.onPinchEnd(t),r.clientStores=[]}},r.onBlur=function(){r.onDragEnd()};var n=[].concat(e);r.options=Ce({checkInput:!1,container:n.length>1?window:n[0],preventRightClick:!0,preventDefault:!0,checkWindowBlur:!1,pinchThreshold:0,events:["touch","mouse"]},i);var s=r.options,o=s.container,a=s.events,h=s.checkWindowBlur;if(r.isTouch=a.indexOf("touch")>-1,r.isMouse=a.indexOf("mouse")>-1,r.targets=n,r.isMouse&&(n.forEach((function(t){V(t,"mousedown",r.onDragStart)})),V(o,"mousemove",r.onDrag),V(o,"mouseup",r.onDragEnd),V(o,"contextmenu",r.onDragEnd)),h&&V(window,"blur",r.onBlur),r.isTouch){var u={passive:!1};n.forEach((function(t){V(t,"touchstart",r.onDragStart,u)})),V(o,"touchmove",r.onDrag,u),V(o,"touchend",r.onDragEnd,u),V(o,"touchcancel",r.onDragEnd,u)}return r}!function(t,e){function i(){this.constructor=t}Ae(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}(e,t);var i=e.prototype;return i.getMovement=function(t){return this.getCurrentStore().getMovement(t)+this.clientStores.slice(1).reduce((function(t,e){return t+e.movement}),0)},i.isDragging=function(){return this.isDrag},i.isFlag=function(){return this.flag},i.isPinchFlag=function(){return this.pinchFlag},i.isDoubleFlag=function(){return this.doubleFlag},i.isPinching=function(){return this.isPinch},i.scrollBy=function(t,e,i,r){void 0===r&&(r=!0),this.flag&&(this.clientStores[0].move(t,e),r&&this.onDrag(i,!0))},i.move=function(t,e){var i=t[0],r=t[1],n=this.getCurrentStore().prevClients;return this.moveClients(n.map((function(t){var e=t.clientX,n=t.clientY;return{clientX:e+i,clientY:n+r,originalClientX:e,originalClientY:n}})),e,!0)},i.triggerDragStart=function(t){this.onDragStart(t,!1)},i.setEventDatas=function(t){var e=this.datas;for(var i in t)e[i]=t[i];return this},i.getEventDatas=function(){return this.datas},i.unset=function(){var t=this,e=this.targets,i=this.options.container;this.off(),Y(window,"blur",this.onBlur),this.isMouse&&(e.forEach((function(e){Y(e,"mousedown",t.onDragStart)})),Y(i,"mousemove",this.onDrag),Y(i,"mouseup",this.onDragEnd),Y(i,"contextmenu",this.onDragEnd)),this.isTouch&&(e.forEach((function(e){Y(e,"touchstart",t.onDragStart)})),Y(i,"touchstart",this.onDragStart),Y(i,"touchmove",this.onDrag),Y(i,"touchend",this.onDragEnd),Y(i,"touchcancel",this.onDragEnd))},i.onPinchStart=function(t){var e=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>e)){var i=new Le(Ie(t));this.pinchFlag=!0,this.clientStores.splice(0,0,i),!1===this.emit("pinchStart",Ce({datas:this.datas,angle:i.getAngle(),touches:this.getCurrentStore().getPositions()},i.getPosition(),{inputEvent:t}))&&(this.pinchFlag=!1)}},i.onPinch=function(t,e){if(this.flag&&this.pinchFlag&&!(e.length<2)){var i=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",Ce({datas:this.datas,movement:this.getMovement(e),angle:i.getAngle(e),rotation:i.getRotation(e),touches:i.getPositions(e),scale:i.getScale(e),distance:i.getDistance(e)},i.getPosition(e),{inputEvent:t}))}},i.onPinchEnd=function(t){if(this.pinchFlag){var e=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var i=this.getCurrentStore();this.emit("pinchEnd",Ce({datas:this.datas,isPinch:e,touches:i.getPositions()},i.getPosition(),{inputEvent:t})),this.isPinch=!1,this.pinchFlag=!1}},i.initDrag=function(){this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1},i.getCurrentStore=function(){return this.clientStores[0]},i.moveClients=function(t,e,i){var r=this.getCurrentStore()[i?"addClients":"getPosition"](t);return this.isDrag=!0,Ce({datas:this.datas},r,{movement:this.getMovement(t),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:e})},e}(xe);const Be=function(t){var e,i="rCS"+function(t){for(var e=5381,i=t.length;i;)e=33*e^t.charCodeAt(--i);return e>>>0}(t).toString(36),r=0;return{className:i,inject:function(n,s){void 0===s&&(s={});var o,a=function(t){if(t&&t.getRootNode){var e=t.getRootNode();if(11===e.nodeType)return e}}(n),h=0===r;return(a||h)&&(o=function(t,e,i,r){var n=document.createElement("style");return n.setAttribute("type","text/css"),n.setAttribute("data-styled-id",t),i.nonce&&n.setAttribute("nonce",i.nonce),n.innerHTML=function(t,e,i){return i.original?e:e.replace(/([^};{\s}][^};{]*|^\s*){/gm,(function(e,i){var r=i.trim();return(r?O(r):[""]).map((function(e){var i=e.trim();return 0===i.indexOf("@")?i:i.indexOf(":global")>-1?i.replace(/\:global/g,""):i.indexOf(":host")>-1?""+i.replace(/\:host/g,"."+t):i?"."+t+" "+i:"."+t})).join(", ")+" {"}))}(t,e,i),(r||document.head||document.body).appendChild(n),n}(i,t,s,a)),h&&(e=o),a||++r,{destroy:function(){a?(n.removeChild(o),o=null):(r>0&&--r,0===r&&e&&(e.parentNode.removeChild(e),e=null))}}}}};var Fe=function(t,e){return Fe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},Fe(t,e)};function Ge(t,e){function i(){this.constructor=t}Fe(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var Ue=function(){return Ue=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},Ue.apply(this,arguments)},je=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.injectResult=null,e.tag="div",e}Ge(e,t);var i=e.prototype;return i.render=function(){var t=this.props,e=t.className,i=void 0===e?"":e,r=(t.cspNonce,t.portalContainer),s=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i}(t,["className","cspNonce","portalContainer"]),o=this.injector.className,a=this.tag,h={};return"simple-1.1.0".indexOf("simple")>-1&&r&&(h={portalContainer:r}),st(a,Ue({ref:n(this,"element"),"data-styled-id":o,className:i+" "+o},h,s))},i.componentDidMount=function(){this.injectResult=this.injector.inject(this.element,{nonce:this.props.cspNonce})},i.componentWillUnmount=function(){this.injectResult.destroy(),this.injectResult=null},i.getElement=function(){return this.element},e}(gt);const Xe=function(t,e){var i=Be(e);return function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.injector=i,r.tag=t,r}return Ge(r,e),r}(je)};var ze=function(t,e){return ze=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},ze(t,e)};function He(t,e){function i(){this.constructor=t}ze(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var Ve=function(){return Ve=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},Ve.apply(this,arguments)};function Ye(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var r=Array(t),n=0;for(e=0;e<i;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,n++)r[n]=s[o];return r}function We(t,e){var i;return Ve({events:{},props:(i={},i[t]=Boolean,i),name:t},e)}function $e(t,e){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'+32*t+'px" height="'+32*t+'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate('+e+'deg);transform-origin: 16px 16px"></path></svg>'}var qe,Ze=Nt().browser.webkit,Ke=Ze&&!!(qe=/applewebkit\/([^\s]+)/g.exec(navigator.userAgent.toLowerCase()))&&parseFloat(qe[1])<605,Je="moveable-",Qe="\n{\n\tposition: absolute;\n\twidth: 1px;\n\theight: 1px;\n\tleft: 0;\n\ttop: 0;\n    z-index: 3000;\n    --moveable-color: #4af;\n    --zoom: 1;\n    --zoompx: 1px;\n    will-change: transform;\n}\n.control-box {\n    z-index: 0;\n}\n.line, .control {\n    position: absolute;\n\tleft: 0;\n    top: 0;\n    will-change: transform;\n}\n.control {\n\twidth: 14px;\n\theight: 14px;\n\tborder-radius: 50%;\n\tborder: 2px solid #fff;\n\tbox-sizing: border-box;\n    background: #4af;\n    background: var(--moveable-color);\n\tmargin-top: -7px;\n    margin-left: -7px;\n    border: 2px solid #fff;\n    z-index: 10;\n}\n.padding {\n    position: absolute;\n    top: 0px;\n    left: 0px;\n    width: 100px;\n    height: 100px;\n    transform-origin: 0 0;\n}\n.line {\n\twidth: 1px;\n    height: 1px;\n    background: #4af;\n    background: var(--moveable-color);\n\ttransform-origin: 0px 50%;\n}\n.line.dashed {\n    box-sizing: border-box;\n    background: transparent;\n}\n.line.dashed.horizontal {\n    border-top: 1px dashed #4af;\n    border-top-color: #4af;\n    border-top-color: var(--moveable-color);\n}\n.line.dashed.vertical {\n    border-left: 1px dashed #4af;\n    border-left-color: #4af;\n    border-left-color: var(--moveable-color);\n}\n.line.vertical {\n    transform: translateX(-50%);\n}\n.line.horizontal {\n    transform: translateY(-50%);\n}\n.line.vertical.bold {\n    width: 2px;\n}\n.line.horizontal.bold {\n    height: 2px;\n}\n\n.control.origin {\n\tborder-color: #f55;\n\tbackground: #fff;\n\twidth: 12px;\n\theight: 12px;\n\tmargin-top: -6px;\n    margin-left: -6px;\n\tpointer-events: none;\n}\n"+[0,15,30,45,60,75,90,105,120,135,150,165].map((function(t){return'\n.direction[data-rotation="'+t+'"] {\n\t'+function(t){var e=$e(1,t),i=$e(2,t),r=45*Math.round(t/45)%180,n="ns-resize";return 135===r?n="nwse-resize":45===r?n="nesw-resize":90===r&&(n="ew-resize"),"cursor:"+n+";cursor: url('"+e+"') 16 16, "+n+";cursor: -webkit-image-set(url('"+e+"') 1x, url('"+i+"') 2x) 16 16, "+n+";"}(t)+"\n}\n"})).join("\n")+"\n.group {\n    z-index: -1;\n}\n.area {\n    position: absolute;\n}\n.area-pieces {\n    position: absolute;\n    top: 0;\n    left: 0;\n    display: none;\n}\n.area.avoid, .area.pass {\n    pointer-events: none;\n}\n.area.avoid+.area-pieces {\n    display: block;\n}\n.area-piece {\n    position: absolute;\n}\n\n"+(Ke?':global svg *:before {\n\tcontent:"";\n\ttransform-origin: inherit;\n}':"")+"\n",ti=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],ei=1e-4,ii=1e-7,ri=1e-9,ni=Math.pow(10,10),si=-ni,oi=["n","w","s","e","nw","ne","sw","se"],ai={n:[0,1],s:[2,3],w:[2,0],e:[1,3],nw:[0],ne:[1],sw:[2],se:[3]},hi={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},ui=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager"];function ci(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r.apply(void 0,Ye([Je],t))}function li(t,e,i){return jt(e,re(i,e),t,re(i.map((function(t){return-t})),e))}function pi(t){var e=t.transformOrigin;return e?e.split(" "):["0","0"]}function di(t,e,i){for(var r=document.body,n=!t||i?t:t.parentElement,s=t===e||n===e,o="relative";n&&n!==r;){e===n&&(s=!0);var a=Xi(n),h=a.transform;if(o=a.position,"svg"===n.tagName.toLowerCase()||"static"!==o||h&&"none"!==h)break;n=n.parentElement,o="relative"}return{isStatic:"static"===o,isEnd:s||!n||n===r,offsetParent:n||r}}function fi(t,e,i,r){var n,s=t.tagName.toLowerCase(),o=t.offsetLeft,a=t.offsetTop;if(r){var h=(e||document.documentElement).getBoundingClientRect();o-=h.left,a-=h.top}var u,c,l=y(o),p=!l;return p||"svg"===s?c=(u=pi(i).map((function(t){return parseFloat(t)}))).slice():(c=(u=Ke?function(t){return pi(Xi(t,":before")).map((function(e,i){var r=R(e),n=r.value,s=r.unit;return n*function(t,e,i){return"%"===e?bi(t.ownerSVGElement)[i?"width":"height"]/100:1}(t,s,0===i)}))}(t):pi(i).map((function(t){return parseFloat(t)}))).slice(),p=!0,n=function(t,e){if(!t.getBBox)return[0,0];var i=t.getBBox(),r=bi(t.ownerSVGElement),n=i.x-r.x,s=i.y-r.y;return[n,s,e[0]-n,e[1]-s]}(t,u),o=n[0],a=n[1],u[0]=n[2],u[1]=n[3]),{tagName:s,isSVG:l,hasOffset:p,offset:[o||0,a||0],origin:u,targetOrigin:c}}function gi(t,e,i){void 0===i&&(i=Xi(t));var r=Xi(document.body),n=r.position;if(!(e||n&&"static"!==n))return[0,0];var s=parseInt(r.marginLeft,10),o=parseInt(r.marginTop,10);return"absolute"===i.position&&("auto"===i.top&&"auto"===i.bottom||(o=0),"auto"===i.left&&"auto"===i.right||(s=0)),[s,o]}function mi(t){t.forEach((function(t){var e=t.matrix;e&&(t.matrix=Ut(e,3,4))}))}function _i(t,e){for(var i,r,n,s,o,a,h=t,u=[],c=t===e,l=!1,p=3,d=di(e,e,!0).offsetParent;h&&!c;){var f=Xi(h),g=f.position,m="fixed"===g,_=(s=(a=f.transform)&&"none"!==a?b(a)?a:I(a).value.split(/s*,\s*/g).map((function(t){return parseFloat(t)})):[1,0,0,1,0,0],void 0===(o=void 0)&&(o=6===s.length),o?[s[0],s[1],0,s[2],s[3],0,s[4],s[5],1]:s),v=_.length;l||16!==v||(l=!0,p=4,mi(u)),l&&9===v&&(_=Ut(_,3,4));var y=fi(h,e,f,m),x=y.tagName,E=y.hasOffset,T=y.isSVG,S=y.origin,w=y.targetOrigin,A=y.offset,C=A[0],O=A[1];"svg"===x&&n?(u.push({type:"target",target:h,matrix:xi(h,p)}),u.push({type:"offset",target:h,matrix:ee(p)})):"g"===x&&t!==h&&(C=0,O=0);var R=di(h,e),M=R.offsetParent,P=R.isEnd,N=R.isStatic;Ze&&E&&!T&&N&&("relative"===g||"static"===g)&&(C-=M.offsetLeft,O-=M.offsetTop,c=c||P);var L=0,D=0;if(E&&d!==M&&(L=M.clientLeft,D=M.clientTop),E&&M===document.body){var k=gi(h,!1,f);C+=k[0],O+=k[1]}if(u.push({type:"target",target:h,matrix:li(_,p,S)}),E?u.push({type:"offset",target:h,matrix:re([C-h.scrollLeft+L,O-h.scrollTop+D],p)}):u.push({type:"offset",target:h,origin:S}),n||(n=_),i||(i=S),r||(r=w),c||m)break;h=M,c=P}return n||(n=ee(p)),i||(i=[0,0]),r||(r=[0,0]),{offsetContainer:d,matrixes:u,targetMatrix:n,transformOrigin:i,targetOrigin:r,is3d:l}}function vi(t,e,i,r){var n;void 0===i&&(i=e);var s=0,o=0,a=0,h={};if(t){var u=Xi(t);s=t.offsetWidth,o=t.offsetHeight,y(s)&&(s=(n=Mi(t,u,!0))[0],o=n[1])}if(t){var c=function(t,e,i,r){void 0===i&&(i=e);var n=_i(t,e),s=n.matrixes,o=n.is3d,a=n.targetMatrix,h=n.transformOrigin,u=n.targetOrigin,c=_i(n.offsetContainer,i),l=c.matrixes,p=c.is3d,d=r||p||o,f=d?4:3,g="svg"!==t.tagName.toLowerCase()&&"ownerSVGElement"in t,m=a,_=ee(f),v=ee(f),y=ee(f),b=ee(f),x=s.length,E=i||document.body,T=di(E,E,!0).offsetParent;l.reverse(),s.reverse(),!o&&d&&(m=Ut(m,3,4),mi(s)),!p&&d&&mi(l),l.forEach((function(t){v=Xt(v,t.matrix,f)})),s.forEach((function(t,e){if(x-2===e&&(y=_.slice()),x-1===e&&(b=_.slice()),!t.matrix){var i=function(t,e,i,r,n){var s,o=t.target,a=t.origin,h=e.matrix,u=Mi(o,void 0,!0),c=u[0],l=u[1],p=i.getBoundingClientRect(),d=[0,0];i===document.body&&(d=gi(o,!0));for(var f=o.getBoundingClientRect(),g=f.left-p.left+i.scrollLeft-(i.clientLeft||0)+d[0],m=f.top-p.top+i.scrollTop-(i.clientTop||0)+d[1],_=f.width,v=f.height,y=jt(r,n,h),b=wi(y,c,l,r),x=b.left,E=b.top,T=b.width,S=b.height,w=Ei(y,a,r),A=Ht(w,[x,E]),C=[g+A[0]*_/T,m+A[1]*v/S],O=[0,0],I=0;++I<10;){var R=Ft(n,r);s=Ht(Ei(R,C,r),Ei(R,w,r)),O[0]=s[0],O[1]=s[1];var M=wi(jt(r,n,re(O,r),h),c,l,r),P=M.left-g,N=M.top-m;if(Math.abs(P)<2&&Math.abs(N)<2)break;C[0]-=P,C[1]-=N}return O.map((function(t){return Math.round(t)}))}(t,s[e+1],T,f,Xt(v,_,f));t.matrix=re(i,f)}_=Xt(_,t.matrix,f)}));var S=!g&&o;m||(m=ee(S?4:3));var w=yi(g&&16===m.length?Ut(m,4,3):m,S);return{rootMatrix:v=Bt(v,f,f),beforeMatrix:y,offsetMatrix:b,allMatrix:_,targetMatrix:m,targetTransform:w,transformOrigin:h,targetOrigin:u,is3d:d}}(t,e,i,r),l=Ai(c.allMatrix,c.transformOrigin,s,o);h=Ve(Ve({},c),l);var p=Ai(c.allMatrix,[50,50],100,100);a=Pi([p.pos1,p.pos2],p.direction)}var d=r?4:3;return Ve({width:s,height:o,rotation:a,rootMatrix:ee(d),beforeMatrix:ee(d),offsetMatrix:ee(d),allMatrix:ee(d),targetMatrix:ee(d),targetTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!!r,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1},h)}function yi(t,e){return void 0===e&&(e=t.length>9),(e?"matrix3d":"matrix")+"("+Vt(t,!e).join(",")+")"}function bi(t){var e=t.clientWidth,i=t.clientHeight;if(!t)return{x:0,y:0,width:0,height:0,clientWidth:e,clientHeight:i};var r=t.viewBox,n=r&&r.baseVal||{x:0,y:0,width:0,height:0};return{x:n.x,y:n.y,width:n.width||e,height:n.height||i,clientWidth:e,clientHeight:i}}function xi(t,e){var i=bi(t),r=i.width,n=i.height,s=i.clientWidth,o=i.clientHeight,a=s/r,h=o/n,u=t.preserveAspectRatio.baseVal,c=u.align,l=u.meetOrSlice,p=[0,0],d=[a,h],f=[0,0];if(1!==c){var g=(c-2)%3,m=Math.floor((c-2)/3);p[0]=r*g/2,p[1]=n*m/2;var _=2===l?Math.max(h,a):Math.min(a,h);d[0]=_,d[1]=_,f[0]=(s-r)/2*g,f[1]=(o-n)/2*m}var v=ie(d,e);return v[e*(e-1)]=f[0],v[e*(e-1)+1]=f[1],li(v,e,p)}function Ei(t,e,i){return Yt(t,Gt(e,i),i)}function Ti(t,e,i,r){return[[0,0],[e,0],[0,i],[e,i]].map((function(e){return Ei(t,e,r)}))}function Si(t){var e=t.map((function(t){return t[0]})),i=t.map((function(t){return t[1]})),r=Math.min.apply(Math,e),n=Math.min.apply(Math,i),s=Math.max.apply(Math,e),o=Math.max.apply(Math,i);return{left:r,top:n,right:s,bottom:o,width:s-r,height:o-n}}function wi(t,e,i,r){return Si(Ti(t,e,i,r))}function Ai(t,e,i,r){var n=16===t.length?4:3,s=Ti(t,i,r,n),o=s[0],a=o[0],h=o[1],u=s[1],c=u[0],l=u[1],p=s[2],d=p[0],f=p[1],g=s[3],m=g[0],_=g[1],v=Ei(t,e,n),y=v[0],b=v[1],x=Math.min(a,c,d,m),E=Math.min(h,l,f,_),T=Math.max(a,c,d,m);return a=a-x||0,{left:x,top:E,right:T,bottom:Math.max(h,l,f,_),origin:[y=y-x||0,b=b-E||0],pos1:[a,h=h-E||0],pos2:[c=c-x||0,l=l-E||0],pos3:[d=d-x||0,f=f-E||0],pos4:[m=m-x||0,_=_-E||0],direction:U(s)}}function Ci(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Oi(t,e){return Ci([e[0]-t[0],e[1]-t[1]])}function Ii(t,e,i,r){void 0===i&&(i=1),void 0===r&&(r=G(t,e));var n=Oi(t,e);return{transform:"translateY(-50%) translate("+t[0]+"px, "+t[1]+"px) rotate("+r+"rad) scaleY("+i+")",width:n+"px"}}function Ri(t,e){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];var n=i.length,s=i.reduce((function(t,e){return t+e[0]}),0)/n,o=i.reduce((function(t,e){return t+e[1]}),0)/n;return{transform:"translateZ(0px) translate("+s+"px, "+o+"px) rotate("+t+"rad) scale("+e+")"}}function Mi(t,e,i,r){void 0===e&&(e=Xi(t)),void 0===r&&(r=i||"border-box"===e.boxSizing);var n=t.offsetWidth,s=t.offsetHeight,o=!y(n);if((i||r)&&o)return[n,s];if(!o&&"svg"!==t.tagName.toLowerCase()){var a=t.getBBox();return[a.width,a.height]}return n=t.clientWidth,s=t.clientHeight,i||r?[n+(parseFloat(e.borderLeftWidth)||0)+(parseFloat(e.borderRightWidth)||0),s+(parseFloat(e.borderTopWidth)||0)+(parseFloat(e.borderBottomWidth)||0)]:[n-(parseFloat(e.paddingLeft)||0)-(parseFloat(e.paddingRight)||0),s-(parseFloat(e.paddingTop)||0)-(parseFloat(e.paddingBottom)||0)]}function Pi(t,e){return G(e>0?t[0]:t[1],e>0?t[1]:t[0])}function Ni(t,e,i,r,n){var s=1,o=[0,0],a={left:0,right:0,top:0,bottom:0,width:0,height:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},h={left:0,right:0,top:0,bottom:0,width:0,height:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},u={left:0,right:0,top:0,bottom:0,width:0,height:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},c=vi(e,i,n,!1);if(e){var l=c.is3d?4:3,p=Ai(c.offsetMatrix,zt(c.transformOrigin,function(t,e){void 0===e&&(e=Math.sqrt(t.length));for(var i=[],r=t[e*e-1],n=0;n<e-1;++n)i[n]=t[e*(e-1)+n]/r;return i[e-1]=0,i}(c.targetMatrix,l)),c.width,c.height);s=p.direction,o=zt(p.origin,[p.left-c.left,p.top-c.top]),a=Li(e),h=Li(di(r,r,!0).offsetParent||document.body,!0),t&&(u=Li(t))}return Ve({targetClientRect:a,containerClientRect:h,moveableClientRect:u,beforeDirection:s,beforeOrigin:o,originalBeforeOrigin:o,target:e},c)}function Li(t,e){var i=0,r=0,n=0,s=0;if(t===document.body||t===document.documentElement)n=window.innerWidth,s=window.innerHeight,i=-(document.documentElement.scrollLeft||document.body.scrollLeft),r=-(document.documentElement.scrollTop||document.body.scrollTop);else{var o=t.getBoundingClientRect();i=o.left,r=o.top,n=o.width,s=o.height}var a={left:i,right:i+n,top:r,bottom:r+s,width:n,height:s};return e&&(a.clientLeft=t.clientLeft,a.clientTop=t.clientTop,a.clientWidth=t.clientWidth,a.clientHeight=t.clientHeight,a.scrollWidth=t.scrollWidth,a.scrollHeight=t.scrollHeight,a.overflow="visible"!==Xi(t).overflow),a}function Di(t){if(t){var e=t.getAttribute("data-direction");if(e){var i=[0,0];return e.indexOf("w")>-1&&(i[0]=-1),e.indexOf("e")>-1&&(i[0]=1),e.indexOf("n")>-1&&(i[1]=-1),e.indexOf("s")>-1&&(i[1]=1),i}}}function ki(t,e){return[zt(e,t[0]),zt(e,t[1]),zt(e,t[2]),zt(e,t[3])]}function Bi(t){var e=t.left,i=t.top;return ki([t.pos1,t.pos2,t.pos3,t.pos4],[e,i])}function Fi(t,e){t[e]&&(t[e].unset(),t[e]=null)}function Gi(t,e,i){var r=e.datas;r.datas||(r.datas={});var n=Ve(Ve({},i),{target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,moveable:t,datas:r.datas});return r.isStartEvent?r.lastEvent=n:r.isStartEvent=!0,n}function Ui(t,e,i){var r=e.datas,n="isDrag"in i?i.isDrag:e.isDrag;return r.datas||(r.datas={}),Ve(Ve({isDrag:n},i),{moveable:t,target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,lastEvent:r.lastEvent,isDouble:e.isDouble,datas:r.datas})}function ji(t,e,i,r){return t.triggerEvent(e,i,r)}function Xi(t,e){return window.getComputedStyle(t,e)}function zi(t,e,i){var r={},n={};return t.filter((function(t){var s=t.name;if(r[s]||!e.some((function(e){return t[e]})))return!1;if(!i&&t.ableGroup){if(n[t.ableGroup])return!1;n[t.ableGroup]=!0}return r[s]=!0,!0}))}function Hi(t,e){return t===e||null==t&&null==e}function Vi(t,e){var i=[],r=[];return t.forEach((function(n,s){var o=e(n,s,t),a=r.indexOf(o),h=i[a]||[];-1===a&&(r.push(o),i.push(h)),h.push(n)})),i}function Yi(t){return t.reduce((function(t,e){return t.concat(e)}),[])}function Wi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.sort((function(t,e){return Math.abs(e)-Math.abs(t)})),t[0]}function $i(t,e,i){return Yt(Ft(t,i),Gt(e,i),i)}function qi(t,e){var i,r=t.is3d?4:3;return i=$i(t.rootMatrix,[e.distX,e.distY],r),e.distX=i[0],e.distY=i[1],e}function Zi(t,e,i,r,n){return Ht(Ei(t,zt(i,e),n),r)}function Ki(t,e,i){return i?t/e*100+"%":t+"px"}function Ji(t){return Math.abs(t)<=ii?0:t}function Qi(t,e){return e.isRequest?("resizable"===e.requestAble||"scalable"===e.requestAble)&&e.parentDirection:H(e.inputEvent.target,ci("direction"))}function tr(t){var e={};for(var i in t)e[t[i]]=i;return e}function er(t,e){return t?E(t)?e?document.querySelector(t):t:T(t)?t():"current"in t?t.current:t:null}function ir(t,e){return t?((i=t)&&b(i)&&(x(i)||"length"in i)?[].slice.call(t):[t]).reduce((function(t,i){return E(i)&&e?Ye(t,[].slice.call(document.querySelectorAll(i))):(t.push(er(i,e)),t)}),[]):[];var i}function rr(t,e){var i=t.rootMatrix,r=t.is3d,n=Ft(i,r?4:3);return r||(n=Ut(n,3,4)),n[12]=0,n[13]=0,n[14]=0,function(t,e){var i=Yt(t,[e[0],e[1]||0,e[2]||0,1],4),r=i[3]||1;return[i[0]/r,i[1]/r,i[2]/r]}(n,e)}var nr=We("pinchable",{events:{onPinchStart:"pinchStart",onPinch:"pinch",onPinchEnd:"pinchEnd",onPinchGroupStart:"pinchGroupStart",onPinchGroup:"pinchGroup",onPinchGroupEnd:"pinchGroupEnd"},dragStart:function(){return!0},pinchStart:function(t,e){var i=e.datas,r=e.targets,n=e.angle,s=e.originalDatas,o=t.props,a=o.pinchable,h=o.ables;if(!a)return!1;var u="onPinch"+(r?"Group":"")+"Start",c="drag"+(r?"Group":"")+"ControlStart",l=(!0===a?t.controlAbles:h.filter((function(t){return a.indexOf(t.name)>-1}))).filter((function(t){return t.canPinch&&t[c]})),p=Gi(t,e,{});r&&(p.targets=r);var d=ji(t,u,p);i.isPinch=!1!==d,i.ables=l;var f=i.isPinch;return!!f&&(l.forEach((function(i){if(s[i.name]=s[i.name]||{},i[c]){var r=Ve(Ve({},e),{datas:s[i.name],parentRotate:n,isPinch:!0});i[c](t,r)}})),t.state.snapRenderInfo={request:e.isRequest,direction:[0,0]},f)},pinch:function(t,e){var i=e.datas,r=e.scale,n=e.distance,s=e.originalDatas,o=e.inputEvent,a=e.targets,h=e.angle;if(i.isPinch){var u=n*(1-1/r),c=Gi(t,e,{});a&&(c.targets=a),ji(t,"onPinch"+(a?"Group":""),c);var l=i.ables,p="drag"+(a?"Group":"")+"Control";return l.forEach((function(i){i[p]&&i[p](t,Ve(Ve({},e),{datas:s[i.name],inputEvent:o,parentDistance:u,parentRotate:h,isPinch:!0}))})),c}},pinchEnd:function(t,e){var i=e.datas,r=e.isPinch,n=e.inputEvent,s=e.targets,o=e.originalDatas;if(i.isPinch){var a="onPinch"+(s?"Group":"")+"End",h=Ui(t,e,{isDrag:r});s&&(h.targets=s),ji(t,a,h);var u=i.ables,c="drag"+(s?"Group":"")+"ControlEnd";return u.forEach((function(i){i[c]&&i[c](t,Ve(Ve({},e),{isDrag:r,datas:o[i.name],inputEvent:n,isPinch:!0}))})),r}},pinchGroupStart:function(t,e){return this.pinchStart(t,Ve(Ve({},e),{targets:t.props.targets}))},pinchGroup:function(t,e){return this.pinch(t,Ve(Ve({},e),{targets:t.props.targets}))},pinchGroupEnd:function(t,e){return this.pinchEnd(t,Ve(Ve({},e),{targets:t.props.targets}))}});function sr(t,e,i,r,n){var s=e.gesto.move(i,t.inputEvent),o=s.originalDatas||s.datas,a=o.draggable||(o.draggable={});return Ve(Ve({},n?qi(e,s):s),{isDrag:!0,isPinch:!!r,parentEvent:!0,datas:a,originalDatas:t.originalDatas})}var or=function(){function t(){this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}}}var e=t.prototype;return e.dragStart=function(t,e){this.isDrag=!1,this.isFlag=!1;var i=e.originalDatas;return this.datas=i,i.draggable||(i.draggable={}),Ve(Ve({},this.move(t,e.inputEvent)),{type:"dragstart"})},e.drag=function(t,e){return this.move([t[0]-this.prevX,t[1]-this.prevY],e)},e.move=function(t,e){var i,r;return this.isFlag?(i=this.prevX+t[0],r=this.prevY+t[1],this.isDrag=!0):(this.prevX=t[0],this.prevY=t[1],this.startX=t[0],this.startY=t[1],i=t[0],r=t[1],this.isFlag=!0),this.prevX=i,this.prevY=r,{type:"drag",clientX:i,clientY:r,inputEvent:e,isDrag:this.isDrag,distX:i-this.startX,distY:r-this.startY,deltaX:t[0],deltaY:t[1],datas:this.datas.draggable,originalDatas:this.datas,parentEvent:!0,parentGesto:this}},t}();function ar(t,e,i){var r=i.originalDatas;r.groupable=r.groupable||{};var n=r.groupable;n.childDatas=n.childDatas||[];var s=n.childDatas;return t.moveables.map((function(t,r){return s[r]=s[r]||{},s[r][e]=s[r][e]||{},Ve(Ve({},i),{datas:s[r][e],originalDatas:s[r]})}))}function hr(t,e,i,r,n,s){var o=!!i.match(/Start$/g),a=!!i.match(/End$/g),h=n.isPinch,u=n.datas,c=ar(t,e.name,n),l=t.moveables,p=c.map((function(t,n){var c=l[n],p=t;o?p=(new or).dragStart(r,t):(c.state.gesto||(c.state.gesto=u.childGestos[n]),p=sr(t,c.state,r,h,s));var d=e[i](c,Ve(Ve({},p),{parentFlag:!0}));return a&&(c.state.gesto=null),d}));return o&&(u.childGestos=l.map((function(t){return t.state.gesto}))),p}function ur(t,e,i,r,n,s){void 0===n&&(n=function(t,e){return e});var o=!!i.match(/End$/g),a=ar(t,e.name,r),h=t.moveables;return a.map((function(t,r){var a,u=h[r];a=n(u,t);var c=e[i](u,Ve(Ve({},a),{parentFlag:!0}));return c&&s&&s(u,t,c,r),o&&(u.state.gesto=null),c}))}function cr(t,e){var i=e.clientX,r=e.clientY,n=e.datas,s=t.state,o=s.moveableClientRect,a=s.rootMatrix,h=s.is3d,u=s.pos1,c=Ht($i(a,[i-o.left,r-o.top],h?4:3),u),l=mr({datas:n,distX:c[0],distY:c[1]});return[l[0],l[1]]}function lr(t,e){var i=e.datas,r=t.state,n=r.allMatrix,s=r.beforeMatrix,o=r.is3d,a=r.left,h=r.top,u=r.origin,c=r.offsetMatrix,l=r.targetMatrix,p=r.transformOrigin,d=o?4:3;i.is3d=o,i.matrix=n,i.targetMatrix=l,i.beforeMatrix=s,i.offsetMatrix=c,i.transformOrigin=p,i.inverseMatrix=Ft(n,d),i.inverseBeforeMatrix=Ft(s,d),i.absoluteOrigin=Gt(zt([a,h],u),d),i.startDragBeforeDist=Yt(i.inverseBeforeMatrix,i.absoluteOrigin,d),i.startDragDist=Yt(i.inverseMatrix,i.absoluteOrigin,d)}function pr(t,e){var i=t.datas,r=t.originalDatas.beforeRenderable,n=i.transformIndex,s=r.nextTransforms,o=r.nextTransformAppendedIndexes,a=-1===n?s.length:n+o.filter((function(t){return t<n})).length,h=function(t,e){var i=t.slice(0,e<0?void 0:e),r=t.slice(0,e<0?void 0:e+1),n=t[e]||"",s=e<0?[]:t.slice(e),o=e<0?[]:t.slice(e+1),a=oe(i),h=oe(r),u=oe([n]),c=oe(s),l=oe(o),p=se(a),d=se(h),f=se(c),g=se(l),m=Xt(p,f,4);return{transforms:t,beforeFunctionMatrix:p,beforeFunctionMatrix2:d,targetFunctionMatrix:se(u),afterFunctionMatrix:f,afterFunctionMatrix2:g,allFunctionMatrix:m,beforeFunctions:a,beforeFunctions2:h,targetFunction:u[0],afterFunctions:c,afterFunctions2:l,beforeFunctionTexts:i,beforeFunctionTexts2:r,targetFunctionText:n,afterFunctionTexts:s,afterFunctionTexts2:o}}(s,a),u=h.targetFunction,c="rotate"===e?"rotateZ":e;i.beforeFunctionTexts=h.beforeFunctionTexts,i.afterFunctionTexts=h.afterFunctionTexts,i.beforeTransform=h.beforeFunctionMatrix,i.beforeTransform2=h.beforeFunctionMatrix2,i.targetTansform=h.targetFunctionMatrix,i.afterTransform=h.afterFunctionMatrix,i.afterTransform2=h.afterFunctionMatrix2,i.targetAllTransform=h.allFunctionMatrix,u.functionName===c?(i.afterFunctionTexts.splice(0,1),i.isAppendTransform=!1):(i.isAppendTransform=!0,r.nextTransformAppendedIndexes=Ye(o,[a]))}function dr(t,e,i){return t.beforeFunctionTexts.join(" ")+" "+(t.isAppendTransform?i:e)+" "+t.afterFunctionTexts.join(" ")}function fr(t,e,i){var r=t.beforeTransform,n=t.afterTransform,s=t.beforeTransform2,o=t.afterTransform2,a=t.targetAllTransform,h=i?Xt(a,e,4):Xt(e,a,4),u=Xt(Ft(i?s:r,4),h,4);return Xt(u,Ft(i?o:n,4),4)}function gr(t){var e=t.datas,i=t.distX,r=t.distY,n=e.inverseBeforeMatrix,s=e.is3d,o=e.startDragBeforeDist,a=s?4:3;return Ht(Yt(n,zt(e.absoluteOrigin,[i,r]),a),o)}function mr(t,e){var i=t.datas,r=t.distX,n=t.distY,s=i.inverseBeforeMatrix,o=i.inverseMatrix,a=i.is3d,h=i.startDragBeforeDist,u=i.startDragDist,c=a?4:3;return Ht(Yt(e?s:o,zt(i.absoluteOrigin,[r,n]),c),e?h:u)}function _r(t){var e=[];return t[1]>=0&&(t[0]>=0&&e.push(3),t[0]<=0&&e.push(2)),t[1]<=0&&(t[0]>=0&&e.push(1),t[0]<=0&&e.push(0)),e}function vr(t,e){return _r(e).map((function(e){return t[e]}))}function yr(t,e){var i=vr(t,e);return[F(i.map((function(t){return t[0]}))),F(i.map((function(t){return t[1]})))]}function br(t,e,i,r){return Xt(t,li(e,r,i),r)}function xr(t){var e=t.originalDatas.beforeRenderable;return{setTransform:function(i,r){void 0===r&&(r=-1),e.startTransforms=x(i)?i:C(i),Tr(t,r)},setTransformIndex:function(e){Tr(t,e)}}}function Er(t,e){Tr(t,N(t.originalDatas.beforeRenderable.startTransforms,(function(t){return 0===t.indexOf(e+"(")})))}function Tr(t,e){var i=t.originalDatas.beforeRenderable,r=t.datas;if(r.transformIndex=e,-1!==e){var n=i.startTransforms[e];if(n){var s=oe([n]);r.startValue=s[0].functionValue}}}function Sr(t,e){t.originalDatas.beforeRenderable.nextTransforms=C(e)}function wr(t,e,i,r,n){return Sr(n,e),{transform:e,drag:An.drag(t,sr(n,t.state,i,r,!1))}}function Ar(t,e,i,r,n){var s=t.state,o=s.left,a=s.top,h=t.props.groupable,u=function(t,e,i){var r=t.transformOrigin,n=t.offsetMatrix,s=t.is3d,o=e.beforeTransform,a=e.afterTransform,h=s?4:3;return br(n,Ut(Xt(Xt(o,function(t){return se(oe(t))}([i]),4),a,4),4,h),r,h)}(t.state,n,e),c=h?o:0,l=h?a:0,p=Ht(r,Or(t,i,u));return Ht(p,[c,l])}function Cr(t){var e=t.state,i=e.width,r=e.height,n=e.transformOrigin;return[n[0]/(i/2)-1,n[1]/(r/2)-1]}function Or(t,e,i){void 0===i&&(i=t.state.allMatrix);var r=t.state,n=r.width,s=r.height,o=r.is3d?4:3;return Ei(i,[n/2*(1+e[0]),s/2*(1+e[1])],o)}function Ir(t,e){return yr(Bi(t.state),e)}function Rr(t,e,i){var r=Ei(t,[e.clientLeft,e.clientTop],i);return[e.left+r[0],e.top+r[1]]}function Mr(t,e,i,r,n,s){var o=n[0],a=n[1],h=s[0],u=s[1],c=[],l=r?0:1,p="vertical"===e?"horizontal":"vertical",d=Vi(t.filter((function(t){return t.type===e})),(function(t){return t.element})).map((function(t){return t[0]})).filter((function(t){var e=t.pos,i=t.sizes;return e[l]<=u&&h<=e[l]+i[l]}));return d.forEach((function(t){var e=t.pos[r],n=e+t.sizes[r];d.forEach((function(t){var s=t.pos,h=t.sizes,u=t.element,l=t.className,f=s[r],g=f+h[r],m=0,_=0,v=!0;if(n<=f)o<(m=g-(_=n-f))-i&&(v=!1);else{if(!(g<=e))return;a>(m=f-(_=e-g))+i&&(v=!1)}if(v&&c.push({pos:"vertical"===p?[m,s[1]]:[s[0],m],element:u,sizes:h,size:0,type:p,gap:_,className:l,gapGuidelines:d}),n<=o&&a<=f){var y=(f+n-(a-o))/2;X(o-(y-i),.1)>=0&&c.push({pos:"vertical"===p?[y,s[1]]:[s[0],y],className:l,element:u,sizes:h,size:0,type:p,gap:n-o,gapGuidelines:d})}}))})),c}function Pr(t,e,i,r,n,s,o){void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o={left:0,top:0,right:0,bottom:0});var a=[],h=o.left,u=o.top,c=o.bottom,l=i+o.right-h,p=r+c-u;return t&&t.forEach((function(t){a.push({type:"horizontal",pos:[h,X(t-s+u,.1)],size:l})})),e&&e.forEach((function(t){a.push({type:"vertical",pos:[X(t-n+h,.1),u],size:p})})),a}function Nr(t,e,i){void 0===i&&(i=[]);var r=[],n=t.state;if(e&&n.guidelines&&n.guidelines.length)return r;var s=t.props.elementGuidelines,o=void 0===s?[]:s;if(!o.length)return r;var a=n.elementGuidelineValues||[],h=o.map((function(t){return b(t)&&"element"in t?t:{element:er(t,!0)}})).filter((function(t){return t.element}));n.elementGuidelineValues=h;var u=p(a.map((function(t){return t.element})),h.map((function(t){return t.element})),_e),c=u.added,l=u.removed.map((function(t){return a[t].element})),d=function(t,e){var i=[];if(!e.length)return i;var r=t.state,n=t.props.snapCenter,s=r.containerClientRect,o=r.targetClientRect,a=o.top,h=o.left,u=r.rootMatrix,c=r.is3d?4:3,l=Rr(u,s,c),p=l[0],d=l[1],f=ue(Bi(r)),g=Ht([f.minX,f.minY],$i(u,[h-p,a-d],c)).map((function(t){return e=t,Math.round(e%1==-.5?e-1:e);var e})),m=g[0],_=g[1];return e.forEach((function(t){var e=t.element,r=t.top,s=t.left,o=t.right,a=t.bottom,h=t.className,l=e.getBoundingClientRect(),f=l.left-p,g=l.top-d,v=g+l.height,y=f+l.width,b=$i(u,[f,g],c),x=b[0],E=b[1],T=$i(u,[y,v],c),S=T[0],w=T[1],A=S-x,C=w-E,O=[A,C];!1!==r&&i.push({type:"vertical",element:e,pos:[X(x+m,.1),E],size:C,sizes:O,className:h}),!1!==a&&i.push({type:"vertical",element:e,pos:[X(S+m,.1),E],size:C,sizes:O,className:h}),!1!==s&&i.push({type:"horizontal",element:e,pos:[x,X(E+_,.1)],size:A,sizes:O,className:h}),!1!==o&&i.push({type:"horizontal",element:e,pos:[x,X(w+_,.1)],size:A,sizes:O,className:h}),n&&(i.push({type:"vertical",element:e,pos:[X((x+S)/2+m,.1),E],size:C,sizes:O,center:!0,className:h}),i.push({type:"horizontal",element:e,pos:[x,X((E+w)/2+_,.1)],size:A,sizes:O,center:!0,className:h}))})),i}(t,c.map((function(t){return h[t]})).filter((function(t){return t.refresh&&e||!t.refresh&&!e})));return Ye(i.filter((function(t){return-1===l.indexOf(t.element)})),d)}function Lr(t){var e=t.state,i=e.snapOffset,r=e.staticGuidelines,n=e.containerClientRect,s=n.overflow,o=n.scrollHeight,a=n.scrollWidth,h=n.clientHeight,u=n.clientWidth,c=n.clientLeft,l=n.clientTop,p=t.props,d=p.snapHorizontal,f=void 0===d||d,g=p.snapVertical,m=void 0===g||g,_=p.snapGap,v=void 0===_||_,y=p.verticalGuidelines,b=p.horizontalGuidelines,x=p.snapThreshold,E=void 0===x?5:x,T=p.snapGridWidth,S=void 0===T?0:T,w=p.snapGridHeight,A=void 0===w?0:w,C=Ye(r,Nr(t,!0));if(v){var O=Si(Bi(t.state)),I=O.top,R=O.left,M=O.bottom,P=O.right,N=r.filter((function(t){return t.element}));C.push.apply(C,Ye(Mr(N,"horizontal",E,0,[R,P],[I,M]),Mr(N,"vertical",E,1,[I,M],[R,P])))}return C.push.apply(C,function(t,e,i,r,n,s){void 0===n&&(n=0),void 0===s&&(s=0);var o=[];if(e)for(var a=0;a<=r;a+=e)o.push({type:"horizontal",pos:[0,X(a-s,.1)],size:i,hide:!0});if(t)for(a=0;a<=i;a+=t)o.push({type:"vertical",pos:[X(a-n,.1),0],size:r,hide:!0});return o}(S,A,s?a:u,s?o:h,c,l)),C.push.apply(C,Pr(f&&b||!1,m&&y||!1,s?a:u,s?o:h,c,l,i)),C}function Dr(t,e,i,r,n){var s=t.props,o=s.snapElement,a=void 0===o||o,h=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=t.length-1,r=0;r<i;++r){var n=t[r];if(!y(n))return n}return t[i]}(n,s.snapThreshold,5);return kr(t.state.guidelines,e,i,{snapThreshold:h,snapCenter:r,snapElement:a})}function kr(t,e,i,r){return{vertical:Gr(t,"vertical",e,r),horizontal:Gr(t,"horizontal",i,r)}}function Br(t,e,i,r){var n=t.props.snapCenter&&i,s=["left","right"],o=["top","bottom"];return n&&(s.push("center"),o.push("middle")),s=s.filter((function(t){return t in e})),o=o.filter((function(t){return t in e})),Dr(t,s.map((function(t){return e[t]})),o.map((function(t){return e[t]})),n,r)}function Fr(t){var e=t.isSnap;if(!e)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var i=t.posInfos[0],r=i.guidelineInfos[0],n=r.offset,s=r.dist,o=r.guideline;return{isSnap:e,offset:n,dist:s,pos:i.pos,guideline:o}}function Gr(t,e,i,r){var n=void 0===r?{}:r,s=n.snapThreshold,o=void 0===s?5:s,a=n.snapElement,h=n.snapCenter;if(!t||!t.length)return{isSnap:!1,index:-1,posInfos:[]};var u="vertical"===e?0:1,c=i.map((function(i,r){var n=t.map((function(t){var e=t.pos,r=i-e[u];return{offset:r,dist:Math.abs(r),guideline:t}})).filter((function(t){var i=t.guideline,r=t.dist,n=i.type,s=i.center,u=i.element;return!(!a&&u||!h&&s||n!==e||r>o)})).sort((function(t,e){return t.dist-e.dist}));return{pos:i,index:r,guidelineInfos:n}})).filter((function(t){return t.guidelineInfos.length>0})).sort((function(t,e){return t.guidelineInfos[0].dist-e.guidelineInfos[0].dist})),l=c.length>0;return{isSnap:l,index:l?c[0].index:-1,posInfos:c}}function Ur(t,e){var i=Math.abs(t.offset),r=Math.abs(e.offset);return t.isBound&&e.isBound?r-i:t.isBound?-1:e.isBound?1:t.isSnap&&e.isSnap?r-i:t.isSnap?-1:e.isSnap||i<ii?1:r<ii?-1:i-r}function jr(t,e){return t.slice().sort((function(t,i){var r=t.sign[e],n=i.sign[e],s=t.offset[e],o=i.offset[e];return r?n?Ur({isBound:t.isBound,isSnap:t.isSnap,offset:s},{isBound:i.isBound,isSnap:i.isSnap,offset:o}):-1:1}))[0]}function Xr(t,e){var i=F([e[0][0],e[1][0]]),r=F([e[0][1],e[1][1]]);return{vertical:i<=t[0],horizontal:r<=t[1]}}function zr(t,e){var i,r,n=e[0],s=e[1],o=s[0]-n[0],a=s[1]-n[1];return Math.abs(o)<ii&&(o=0),Math.abs(a)<ii&&(a=0),o?a?(i=a/o*(t[0]-n[0])+n[1],r=t[1]):(i=n[1],r=t[1]):(i=n[0],r=t[0]),i-r}function Hr(t,e,i){void 0===i&&(i=ii);var r=zr(t[0],e)<=0;return t.slice(1).every((function(t){var n=zr(t,e);return n<=0===r||Math.abs(n)<=i}))}function Vr(t,e,i,r,n){return void 0===n&&(n=0),r&&e-n<=t||!r&&t<=i+n?{isBound:!0,offset:r?e-t:i-t}:{isBound:!1,offset:0}}function Yr(t,e,i,r,n){var s,o=t[0],a=t[1],h=e[0],u=e[1],c=Ji(a[1]-o[1]),l=Ji(a[0]-o[0]),p=Ji(u[1]-h[1]);if(!Ji(u[0]-h[0])){if(n&&!c)return{isBound:!1,offset:0};if(l)return Vr(c/l*(h[0]-o[0])+o[1],h[1],u[1],i,r);var d=h[0]-o[0];return{isBound:s=Math.abs(d)<=(r||0),offset:s?d:0}}return p||n&&!l?{isBound:!1,offset:0}:c?Vr((h[1]-o[1])/(c/l)+o[0],h[0],u[0],i,r):(d=h[1]-o[1],{isBound:s=Math.abs(d)<=(r||0),offset:s?d:0})}function Wr(t,e,i,r){return e.map((function(e){var n=e[0],s=e[1],o=e[2],a=function(t,e,i){var r=t.props.innerBounds;if(!r)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var n=r.left,s=r.top,o=r.width,a=r.height,h=[[n,s],[n,s+a]],u=[[n,s],[n+o,s]],c=[[n+o,s],[n+o,s+a]],l=[[n,s+a],[n+o,s+a]],p=Xr(i,e),d=p.horizontal,f=p.vertical;if(Hr([i,[n,s],[n+o,s],[n,s+a],[n+o,s+a]],e))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var g=Yr(e,u,f),m=Yr(e,l,f),_=Yr(e,h,d),v=Yr(e,c,d),y=g.isBound&&m.isBound,b=g.isBound||m.isBound,x=_.isBound&&v.isBound,E=_.isBound||v.isBound,T=Wi(g.offset,m.offset),S=Wi(_.offset,v.offset),w=[0,0],A=!1,C=!1;return Math.abs(S)<Math.abs(T)?(w=[T,0],A=b,C=y):(w=[0,S],A=E,C=x),{isAllBound:C,isVerticalBound:b,isHorizontalBound:E,isBound:A,offset:w}}(t,[s,o],i),h=a.isBound,u=a.offset,c=a.isVerticalBound,l=a.isHorizontalBound,p=mr({datas:r,distX:u[0],distY:u[1]}).map((function(t,e){return t*(n[e]?2/n[e]:0)}));return{sign:n,isBound:h,isVerticalBound:c,isHorizontalBound:l,isSnap:!1,offset:p}}))}function $r(t,e,i){return function(t,e){var i=[],r=t[0],n=t[1];return r&&n?i.push([[0,2*n],t,[-r,n]],[[2*r,0],t,[r,-n]]):r?(i.push([[2*r,0],[r,1],[r,-1]]),e&&i.push([[0,-1],[r,-1],[-r,-1]],[[0,1],[r,1],[-r,1]])):n?(i.push([[0,2*n],[1,n],[-1,n]]),e&&i.push([[-1,0],[-1,n],[-1,-n]],[[1,0],[1,n],[1,-n]])):i.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),i}(e,i).map((function(e){var i=e[0],r=e[1],n=e[2];return[i,yr(t,r),yr(t,n)]}))}function qr(t,e,i,r){var n=r?t.map((function(t){return Kt(t,r)})):t,s=Ye([i],e);return[[n[0],n[1]],[n[1],n[3]],[n[3],n[2]],[n[2],n[0]]].some((function(t){return!Hr(s,t)}))}function Zr(t,e,i){var r=t||{},n=r.position,s=void 0===n?"client":n,o=r.left,a=void 0===o?-1/0:o,h=r.top,u=void 0===h?-1/0:h,c=r.right,l=void 0===c?1/0:c,p=r.bottom,d={position:s,left:a,top:u,right:l,bottom:void 0===p?1/0:p};return{vertical:Jr(d,e,!0),horizontal:Jr(d,i,!1)}}function Kr(t,e){var i=t.state,r=i.containerClientRect,n=r.clientHeight,s=r.clientWidth,o=r.clientLeft,a=r.clientTop,h=i.snapOffset,u=h.left,c=h.top,l=h.right,p=h.bottom,d=e||t.props.bounds||{},f="css"===(d.position||"client"),g=d.left,m=void 0===g?-1/0:g,_=d.top,v=void 0===_?-1/0:_,y=d.right,b=void 0===y?f?-1/0:1/0:y,x=d.bottom,E=void 0===x?f?-1/0:1/0:x;return f&&(b=s+l-u-b,E=n+p-c-E),{left:m+u-o,right:b+u-o,top:v+c-a,bottom:E+c-a}}function Jr(t,e,i){var r=t[i?"left":"top"],n=t[i?"right":"bottom"],s=Math.min.apply(Math,e),o=Math.max.apply(Math,e),a=[];return r+1>s&&a.push({isBound:!0,offset:s-r,pos:r}),n-1<o&&a.push({isBound:!0,offset:o-n,pos:n}),a.length||a.push({isBound:!1,offset:0,pos:0}),a.sort((function(t,e){return Math.abs(e.offset)-Math.abs(t.offset)}))}function Qr(t,e,i){return(i?t.map((function(t){return Kt(t,i)})):t).some((function(t){return t[0]<e.left&&Math.abs(t[0]-e.left)>.1||t[0]>e.right&&Math.abs(t[0]-e.right)>.1||t[1]<e.top&&Math.abs(t[1]-e.top)>.1||t[1]>e.bottom&&Math.abs(t[1]-e.bottom)>.1}))}var tn={horizontal:["left","top","width","Y","X"],vertical:["top","left","height","X","Y"]};function en(t,e,i,r){var n=t-i,s=n<0?n+e:r;return{size:(n<0?0:n)-s,pos:s}}function rn(t,e){return function(t,e){var i,r=t.direction,n=t.classNames,s=t.size,o=t.pos,a=t.zoom,h=t.key,u="horizontal"===r,c=u?"Y":"X";return e.createElement("div",{key:h,className:n.join(" "),style:(i={},i[u?"width":"height"]=""+s,i.transform="translate("+o[0]+", "+o[1]+") translate"+c+"(-50%) scale"+c+"("+a+")",i)})}(Ve(Ve({},t),{classNames:Ye([ci("line","guideline",t.direction)],t.classNames).filter((function(t){return t})),size:t.size||t.sizeValue+"px",pos:t.pos||t.posValue.map((function(t){return X(t,.1)+"px"}))}),e)}function nn(t,e,i,r,n,s,o,a,h,u,c,l){var p=t.props,d=p.zoom,f=p.isDisplaySnapDigit,g=void 0===f||f,m=tn[e],_=m[0],v=m[1],y=m[2],b=m[4];return Yi(i.map((function(t,i){var p=!0;return t.map((function(t,f){var m,x=t.pos,E=t.size,T=en(x[u],E,n,s),S=T.pos,w=T.size;if(w<a)return null;var A=p;p=!1;var C=g&&A?parseFloat(w.toFixed(h)):0;return l.createElement("div",{key:e+"LinkGuideline"+i+"-"+f,className:ci("guideline-group",e),style:(m={},m[_]=r+S+"px",m[v]=-o+x[u?0:1]+"px",m[y]=w+"px",m)},rn({direction:e,classNames:[ci("dashed")],size:"100%",posValue:[0,0],sizeValue:w,zoom:d},l),l.createElement("div",{className:ci("size-value"),style:{transform:"translate"+b+"(-50%) scale("+d+")"}},C>0?c(C):""))}))})))}function sn(t,e,i,r,n,s,o,a){var h=t.props.zoom;return i.map((function(t,i){var u=t.type,c=t.pos,l=[0,0];return l[o]=r,l[o?0:1]=-n+c,rn({key:e+"TargetGuideline"+i,classNames:[ci("target","bold",u)],posValue:l,sizeValue:s,zoom:h,direction:e},a)}))}function on(t,e,i,r,n,s){var o=t.props.isDisplayInnerSnapDigit,a=i?0:1,h=r[i],u=s[i],c=[],l=e.filter((function(t){var e=t.element,n=t.pos,s=t.size;if(o&&e&&n[i]<h&&h+u<n[i]+s){var l=n[i]-h,p=n[a]-r[a];return c.push(Ve(Ve({},t),{inner:!0,gap:l,renderPos:i?[p,l]:[l,p]})),c.push(Ve(Ve({},t),{inner:!0,gap:n[i]+s-h-u,renderPos:i?[p,u]:[u,p]})),!1}return!0})),p=function(t,e,i,r){var n=[],s=Vi(t.filter((function(t){var e=t.element,i=t.gap;return e&&!i})),(function(t){var i=t.element,s=t.pos,o=s[r],a=(Math.min(0,o-e)<0?-1:1)+"_"+s[r?0:1],h=L(n,(function(t){var e=t[0],r=t[1];return i===e&&o===r}));return h?h[2]:(n.push([i,o,a]),a)}));return s.forEach((function(t){t.sort((function(t,n){return en(t.pos[r],t.size,e,i).size-en(n.pos[r],t.size,e,i).size||t.pos[r?0:1]-n.pos[r?0:1]}))})),s}(l=l.filter((function(t){var e=t.element,r=t.pos,n=t.size,s=r[i];return!e||l.every((function(e){var r=e.element,o=e.pos,a=e.size,h=o[i];return!r||t===e||s+n<=h||h+a<=s||s<h&&h+a<s+n}))})),n[i],u,i);return c=c.filter((function(t){var e=t.gap,r=t.pos[a];return p.every((function(t){return t.every((function(t){var n=t.pos,o=-h+n[i];return!(n[a]===r&&(e<0&&o<0||e>0&&o>s[i]))}))}))})),{guidelines:l,groups:p,gapGuidelines:c}}function an(t,e,i,r,n){var s=t.props.zoom;return i.filter((function(t){return!t.hide})).map((function(t,i){var o=t.pos,a=t.size,h=t.element,u=[-r[0]+o[0],-r[1]+o[1]];return rn({key:e+"Guideline"+i,classNames:h?[ci("bold")]:[],direction:e,posValue:u,sizeValue:a,zoom:s},n)}))}function hn(t,e,i,r,n){var s=t.props,o=s.snapDigit,a=void 0===o?0:o,h=s.isDisplaySnapDigit,u=void 0===h||h,c=s.zoom,l="horizontal"===e?"X":"Y",p="horizontal"===e?"width":"height";return i.map((function(t,i){var s,o=t.renderPos,h=t.gap,d=t.className,f=t.inner,g=Math.abs(h),m=u?parseFloat(g.toFixed(a)):0;return n.createElement("div",{key:e+"GapGuideline"+i,className:ci("guideline-group",e),style:(s={left:o[0]+"px",top:o[1]+"px"},s[p]=g+"px",s)},rn({direction:e,classNames:[ci(f?"dashed":"gap"),d],size:"100%",posValue:[0,0],sizeValue:g,zoom:c},n),n.createElement("div",{className:ci("size-value","gap"),style:{transform:"translate"+l+"(-50%) scale("+c+")"}},m>0?r(m):""))}))}function un(t){var e=t.state;if(!e.guidelines||!e.guidelines.length){var i=t.state.container,r=t.props.snapContainer||i,n=e.containerClientRect,s={left:0,top:0,bottom:0,right:0};if(i!==r){var o=er(r,!0);if(o){var a=Li(o),h=rr(e,[a.left-n.left,a.top-n.top]),u=rr(e,[a.right-n.right,a.bottom-n.bottom]);s.left=X(h[0],.1),s.top=X(h[1],.1),s.right=X(u[0],.1),s.bottom=X(u[1],.1)}}e.snapOffset=s,e.elementGuidelineValues=[],e.staticGuidelines=Nr(t,!1),e.guidelines=Lr(t),e.enableSnap=!0}}function cn(t,e){var i=t.props,r=i.snappable,n=i.bounds,s=i.innerBounds,o=i.verticalGuidelines,a=i.horizontalGuidelines,h=i.snapGridWidth,u=i.snapGridHeight,c=t.state,l=c.guidelines,p=c.enableSnap;return!(!r||!p||e&&!0!==r&&r.indexOf(e)<0||!(h||u||n||s||l&&l.length||o&&o.length||a&&a.length))}function ln(t,e,i,r,n){var s=function(t,e,i,r){var n=e[0]-t[0],s=e[1]-t[1];if(Math.abs(n)<ii&&(n=0),Math.abs(s)<ii&&(s=0),!n)return r?[0,0]:[0,i];if(!s)return r?[i,0]:[0,0];var o=s/n,a=t[1]-o*t[0];return r?[i,o*(e[0]+i)+a-e[1]]:[(e[1]+i-a)/o-e[0],i]}(t,e,i,r);if(!s)return{isOutside:!1,offset:[0,0]};var o=j(t,e),a=j(s,t),h=j(s,e),u=a>o||h>o,c=mr({datas:n,distX:s[0],distY:s[1]});return{offset:[c[0],c[1]],isOutside:u}}function pn(t,e,i,r,n,s){var o=Ti(t,e,i,s?4:3),a=function(t,e){return yr(t,e.map((function(t){return-t})))}(o,n);return ki(o,Ht(r,a))}function dn(t,e){return t.isBound?t.offset:e.isSnap?e.offset:0}function fn(t,e){return t.isBound?t.offset:e.isSnap?Fr(e).offset:0}function gn(t,e,i,r){void 0===r&&(r=i);var n=Zr(Kr(t),r.map((function(t){return t[0]})),r.map((function(t){return t[1]}))),s=n.horizontal,o=n.vertical,a=e?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:Dr(t,i.map((function(t){return t[0]})),i.map((function(t){return t[1]})),t.props.snapCenter),h=a.horizontal,u=a.vertical,c=fn(s[0],h),l=fn(o[0],u),p=Math.abs(c),d=Math.abs(l);return{horizontal:{isBound:s[0].isBound,isSnap:h.isSnap,snapIndex:h.index,offset:c,dist:p,bounds:s,snap:h},vertical:{isBound:o[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:l,dist:d,bounds:o,snap:u}}}function mn(t,e,i,r,n){void 0===n&&(n={});var s=Zr(e,i,r),o=s.horizontal,a=s.vertical,h=n.isRequest?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:kr(t,i,r,n),u=h.horizontal,c=h.vertical,l=fn(o[0],u),p=fn(a[0],c),d=Math.abs(l),f=Math.abs(p);return{horizontal:{isBound:o[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:l,dist:d,bounds:o,snap:u},vertical:{isBound:a[0].isBound,isSnap:c.isSnap,snapIndex:c.index,offset:p,dist:f,bounds:a,snap:c}}}function _n(t,e,i,r,n,s){return i.map((function(i){var o=i[0],a=i[1],h=yr(e,o),u=yr(e,a),c=r?function(t,e,i,r){var n=function(t,e,i){var r=Kr(t),n=r.left,s=r.top,o=r.right,a=r.bottom,h=i[0],u=i[1],c=Ht(i,e),l=c[0],p=c[1];Math.abs(l)<ii&&(l=0),Math.abs(p)<ii&&(p=0);var d=p>0,f=l>0,g={isBound:!1,offset:0,pos:0},m={isBound:!1,offset:0,pos:0};if(0===l&&0===p)return{vertical:g,horizontal:m};if(0===l)d?a<u&&(m.pos=a,m.offset=u-a):s>u&&(m.pos=s,m.offset=u-s);else if(0===p)f?o<h&&(g.pos=o,g.offset=h-o):n>h&&(g.pos=n,g.offset=h-n);else{var _=p/l,v=i[1]-_*h,y=0,b=0,x=!1;f&&o<=h?(y=_*o+v,b=o,x=!0):!f&&h<=n&&(y=_*n+v,b=n,x=!0),x&&(y<s||y>a)&&(x=!1),x||(d&&a<=u?(b=((y=a)-v)/_,x=!0):!d&&u<=s&&(b=((y=s)-v)/_,x=!0)),x&&(g.isBound=!0,g.pos=b,g.offset=h-b,m.isBound=!0,m.pos=y,m.offset=u-y)}return{vertical:g,horizontal:m}}(t,e,i),s=n.horizontal,o=n.vertical,a=r?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:function(t,e,i){var r=i[0],n=i[1],s=e[0],o=e[1],a=Ht(i,e),h=a[0],u=a[1],c=u>0,l=h>0;h=Ji(h),u=Ji(u);var p={isSnap:!1,offset:0,pos:0},d={isSnap:!1,offset:0,pos:0};if(0===h&&0===u)return{vertical:p,horizontal:d};var f=Dr(t,h?[r]:[],u?[n]:[]),g=f.vertical,m=f.horizontal;g.posInfos.filter((function(t){var e=t.pos;return l?e>=s:e<=s})),m.posInfos.filter((function(t){var e=t.pos;return c?e>=o:e<=o})),g.isSnap=g.posInfos.length>0,m.isSnap=m.posInfos.length>0;var _=Fr(g),v=_.isSnap,y=_.guideline,b=Fr(m),x=b.isSnap,E=b.guideline,T=x?E.pos[1]:0,S=v?y.pos[0]:0;if(0===h)x&&(d.isSnap=!0,d.pos=E.pos[1],d.offset=n-d.pos);else if(0===u)v&&(p.isSnap=!0,p.pos=S,p.offset=r-S);else{var w=u/h,A=i[1]-w*r,C=0,O=0,I=!1;v?(C=w*(O=S)+A,I=!0):x&&(O=((C=T)-A)/w,I=!0),I&&(p.isSnap=!0,p.pos=O,p.offset=r-O,d.isSnap=!0,d.pos=C,d.offset=n-C)}return{vertical:p,horizontal:d}}(t,e,i),h=a.horizontal,u=a.vertical,c=dn(s,h),l=dn(o,u),p=Math.abs(c),d=Math.abs(l);return{horizontal:{isBound:s.isBound,isSnap:h.isSnap,offset:c,dist:p},vertical:{isBound:o.isBound,isSnap:u.isSnap,offset:l,dist:d}}}(t,h,u,n):gn(t,n,[u]),l=c.horizontal,p=l.offset,d=l.isBound,f=l.isSnap,g=c.vertical,m=g.offset,_=g.isBound,v=g.isSnap,y=Ht(a,o);if(!m&&!p)return{isBound:_||d,isSnap:v||f,sign:y,offset:[0,0]};var b=function(t,e,i,r){var n=G(t,e)/Math.PI*180,s=i.vertical,o=s.isBound,a=s.isSnap,h=s.dist,u=i.horizontal,c=u.isBound,l=u.isSnap,p=n%180,d=p<3||p>177,f=p>87&&p<93;return u.dist<h&&(o||a&&!f&&(!r||!d))?"vertical":!c&&(!l||d||r&&f)?"":"horizontal"}(h,u,c,r);if(!b)return{sign:y,isBound:!1,isSnap:!1,offset:[0,0]};var x="vertical"===b,E=ln(h,u,-(x?m:p),x,s).offset.map((function(t,e){return t*(y[e]?2/y[e]:0)}));return{sign:y,isBound:x?_:d,isSnap:x?v:f,offset:E}}))}function vn(t,e,i,r,n,s){var o=function(t,e){var i=[],r=[-t[0],-t[1]];return t[0]&&t[1]?(i.push([r,[t[0],-t[1]]],[r,[-t[0],t[1]]]),e&&i.push([r,t])):t[0]?e?i.push([r,[r[0],-1]],[r,[r[0],1]],[r,[t[0],-1]],[r,t],[r,[t[0],1]]):i.push([[r[0],-1],[t[0],-1]],[[r[0],0],[t[0],0]],[[r[0],1],[t[0],1]]):t[1]?e?i.push([r,[-1,r[1]]],[r,[1,r[1]]],[r,[-1,t[1]]],[r,[1,t[1]]],[r,t]):i.push([[-1,r[1]],[-1,t[1]]],[[0,r[1]],[0,t[1]]],[[1,r[1]],[1,t[1]]]):i.push([r,[1,0]],[r,[-1,0]],[r,[0,-1]],[r,[0,1]],[[1,0],[1,-1]],[[1,0],[1,1]],[[0,1],[1,1]],[[0,1],[-1,1]],[[-1,0],[-1,-1]],[[-1,0],[-1,1]],[[0,-1],[1,-1]],[[0,-1],[-1,-1]]),i}(i,r),a=$r(e,i,r),h=Ye(_n(t,e,o,r,n,s),Wr(t,a,yr(e,[0,0]),s)),u=jr(h,0),c=jr(h,1);return{width:{isBound:u.isBound,offset:u.offset[0]},height:{isBound:c.isBound,offset:c.offset[1]}}}function yn(t,e,i,r,n,s,o,a){for(var h=Bi(t.state),u=t.props.keepRatio,c=0,l=0,p=0;p<2;++p){var d=vn(t,e(c,l),n,u,o,a),f=d.width,g=d.height,m=f.isBound,_=g.isBound,v=f.offset,y=g.offset;if(1===p&&(m||(v=0),_||(y=0)),0===p&&o&&!m&&!_)return[0,0];if(u){var b=Math.abs(v)*(i?1/i:1),x=Math.abs(y)*(r?1/r:1);(m&&_?b<x:_||!m&&b<x)?v=i*y/r:y=r*v/i}c+=v,l+=y}if(n[0]&&n[1]){var E=function(t,e,i,r,n){var s=[-i[0],-i[1]],o=t.state,a=o.width,h=o.height,u=t.props.bounds,c=1/0,l=1/0;if(u){var p=[[i[0],-i[1]],[-i[0],i[1]]],d=u.left,f=void 0===d?-1/0:d,g=u.top,m=void 0===g?-1/0:g,_=u.right,v=void 0===_?1/0:_,y=u.bottom,b=void 0===y?1/0:y;p.forEach((function(t){var i=t[0]!==s[0],o=t[1]!==s[1],u=yr(e,t),p=360*G(r,u)/Math.PI;if(o){var d=u.slice();(Math.abs(p-360)<2||Math.abs(p-180)<2)&&(d[1]=r[1]);var g=ln(r,d,(r[1]<u[1]?b:m)-u[1],!1,n),_=g.offset[1],y=g.isOutside;isNaN(_)||(l=h+(y?1:-1)*Math.abs(_))}if(i){d=u.slice(),(Math.abs(p-90)<2||Math.abs(p-270)<2)&&(d[0]=r[0]);var x=ln(r,d,(r[0]<u[0]?v:f)-u[0],!0,n),E=x.offset[0],T=x.isOutside;isNaN(E)||(c=a+(T?1:-1)*Math.abs(E))}}))}return{maxWidth:c,maxHeight:l}}(t,h,n,s,a),T=E.maxWidth,S=E.maxHeight,w=function(t,e,i,r,n,s,o,a,h){var u=gn(t,a,[yr(e,o)]),c=u.horizontal.offset,l=u.vertical.offset;if(l||c){var p=mr({datas:h,distX:-l,distY:-c}),d=p[0],f=p[1];return[Math.min(n||1/0,i+o[0]*d)-i,Math.min(s||1/0,r+o[1]*f)-r]}return[0,0]}(t,e(c,l).map((function(t){return t.map((function(t){return X(t,ei)}))})),i+c,r+l,T,S,n,o,a);c+=v=w[0],l+=y=w[1]}return[c,l]}function bn(t,e,i,r){if(!cn(t,"rotatable"))return r;var n=e.pos1,s=e.pos2,o=e.pos3,a=e.pos4,h=r*Math.PI/180,u=[n,s,o,a].map((function(t){return Ht(t,i)})),c=u.map((function(t){return Kt(t,h)})),l=Ye(function(t,e,i,r,n){if(!t.props.bounds)return[];var s=n*Math.PI/180,o=Kr(t),a=o.left,h=o.top,u=o.right,c=o.bottom,l=a-r[0],p=u-r[0],d=h-r[1],f=c-r[1],g={left:l,top:d,right:p,bottom:f};if(!Qr(i,g,0))return[];var m=[];return[[l,0],[p,0],[d,1],[f,1]].forEach((function(t){var r=t[0],n=t[1];i.forEach((function(t){var i=G([0,0],t);m.push.apply(m,function(t,e,i){var r=Ci(t),n=Math.sqrt(r*r-e*e)||0;return[n,-n].sort((function(e,r){return Math.abs(e-t[i?0:1])-Math.abs(r-t[i?0:1])})).map((function(t){return G([0,0],i?[t,e]:[e,t])}))}(t,r,n).map((function(t){return s+t-i})).filter((function(t){return!Qr(e,g,t)})).map((function(t){return X(180*t/Math.PI,ii)})))}))})),m}(t,u,c,i,r),function(t,e,i,r,n){var s=t.props.innerBounds,o=n*Math.PI/180;if(!s)return[];var a=s.left,h=s.top,u=s.width,c=s.height,l=a-r[0],p=a+u-r[0],d=h-r[1],f=h+c-r[1],g=[[l,d],[p,d],[l,f],[p,f]],m=yr(i,[0,0]);if(!qr(i,g,m,0))return[];var _=[],v=g.map((function(t){return[Ci(t),G([0,0],t)]}));return[[i[0],i[1]],[i[1],i[3]],[i[3],i[2]],[i[2],i[0]]].forEach((function(t){var i=G([0,0],function(t){var e=t[0],i=t[1],r=i[0]-e[0],n=i[1]-e[1];if(!r)return[e[0],0];if(!n)return[0,e[1]];var s=n/r,o=-s*e[0]+e[1];return[-o/(s+1/s),o/(s*s+1)]}(t)),r=function(t){var e=t[0],i=t[1],r=i[0]-e[0],n=i[1]-e[1];if(!r)return Math.abs(e[0]);if(!n)return Math.abs(e[1]);var s=n/r;return Math.abs((-s*e[0]+e[1])/Math.sqrt(Math.pow(s,2)+1))}(t);_.push.apply(_,v.filter((function(t){var e=t[0];return e&&r<=e})).map((function(t){var e=t[0],n=t[1],s=Math.acos(e?r/e:0);return[o+(n+s)-i,o+(n-s)-i]})).reduce((function(t,e){return t.push.apply(t,e),t}),[]).filter((function(t){return!qr(e,g,m,t)})).map((function(t){return X(180*t/Math.PI,ii)})))})),_}(t,u,c,i,r));return l.sort((function(t,e){return Math.abs(t-r)-Math.abs(e-r)})),l.length?l[0]:r}function xn(t,e,i,r,n,s){if(!cn(t,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var o=ki(s.absolutePoses,[e,i]),a=Si(o),h=a.left,u=a.right,c=a.top,l=a.bottom,p=[[h,c],[u,c],[h,l],[u,l]];t.props.snapCenter&&p.push([(h+u)/2,(c+l)/2]);var d=gn(t,n,p,o),f=d.vertical,g=d.horizontal,m=function(t,e,i){var r,n=$r(e,[0,0],!1).map((function(t){var e=t[0],i=t[1],r=t[2];return[e.map((function(t){return 2*Math.abs(t)})),i,r]})),s=Wr(t,n,yr(e,[0,0]),i),o=jr(s,0),a=jr(s,1),h=0,u=0,c=o.isVerticalBound||a.isVerticalBound,l=o.isHorizontalBound||a.isHorizontalBound;return(c||l)&&(r=function(t,e){var i=t.datas,r=t.distX,n=t.distY,s=(i.beforeMatrix,i.matrix),o=i.is3d,a=(i.startDragBeforeDist,i.startDragDist),h=i.absoluteOrigin,u=o?4:3;return Ht(Yt(s,zt(a,[r,n]),u),h)}({datas:i,distX:-o.offset[0],distY:-a.offset[1]}),h=r[0],u=r[1]),{vertical:{isBound:c,offset:h},horizontal:{isBound:l,offset:u}}}(t,o,s),_=m.vertical,v=m.horizontal,y=f.isSnap,b=g.isSnap,x=f.isBound||_.isBound,E=g.isBound||v.isBound,T=function(t,e,i,r,n){var s=e[0],o=e[1],a=i[0],h=i[1],u=r[0],c=r[1],l=n[0],p=n[1],d=-l,f=-p;if(t&&s&&o){d=0,f=0;var g=[];if(a&&h?g.push([0,p],[l,0]):a?g.push([l,0]):h?g.push([0,p]):u&&c?g.push([0,p],[l,0]):u?g.push([l,0]):c&&g.push([0,p]),g.length){g.sort((function(t,e){return Ci(Ht([s,o],t))-Ci(Ht([s,o],e))}));var m=g[0];if(m[0]&&Math.abs(s)>ii)d=-m[0],f=o*Math.abs(s+d)/Math.abs(s)-o;else if(m[1]&&Math.abs(o)>ii){var _=o;f=-m[1],d=s*Math.abs(o+f)/Math.abs(_)-s}if(t&&h&&a)if(Math.abs(d)>ii&&Math.abs(d)<Math.abs(l))d*=v=Math.abs(l)/Math.abs(d),f*=v;else if(Math.abs(f)>ii&&Math.abs(f)<Math.abs(p)){var v;d*=v=Math.abs(p)/Math.abs(f),f*=v}else d=Wi(-l,d),f=Wi(-p,f)}}else d=s||a?-l:0,f=o||h?-p:0;return[d,f]}(r,[e,i],[x,E],[y,b],[Wi(f.offset,_.offset),Wi(g.offset,v.offset)]);return[{isBound:x,isSnap:y,offset:T[0]},{isBound:E,isSnap:b,offset:T[1]}]}function En(t){var e=[];return t.forEach((function(t){t.guidelineInfos.forEach((function(t){var i=t.guideline;e.indexOf(i)>-1||e.push(i)}))})),e}function Tn(t,e,i,r){var n=t.filter((function(t){var i=t.element,r=t.gap,n=t.type;return i&&r&&n===e})),s="vertical"===e?[0,1]:[1,0],o=s[0],a=s[1];return Yi(n.map((function(t){var e=t.pos,n=t.gap,s=t.gapGuidelines,h=t.sizes,u=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.sort((function(t,e){return Math.abs(t)-Math.abs(e)})),t[0]}(e[a]+h[a]-i[a],e[a]-i[a]-r[a]),c=Math.min(h[a],r[a]);if(u>0&&u>c?u=2*(u-c/2):u<0&&u<-c&&(u=2*(u+c/2)),0===u)return[];var l=(u>0?0:r[a])+u/2;return Ye(function(t,e,i,r,n,s,o){var a=Math.abs(s),h=n[e]+(s>0?r[0]:0);return t.filter((function(t){return t.pos[e]<=i[e]})).sort((function(t,i){var r=t.pos;return i.pos[e]-r[e]})).filter((function(t){var i=t.pos,r=t.sizes,n=i[e];return X(n+r[e],ei)===X(h-a,ei)&&(h=n,!0)})).map((function(t){var r=-i[e]+t.pos[e]+t.sizes[e];return Ve(Ve({},t),{gap:s,renderPos:e?[o,r]:[r,o]})}))}(s,o,i,r,e,n,l),function(t,e,i,r,n,s,o){var a=Math.abs(s),h=n[e]+(s<0?r[e]:0);return t.filter((function(t){return t.pos[e]>i[e]})).sort((function(t,i){var r=t.pos,n=i.pos;return r[e]-n[e]})).filter((function(t){var i=t.pos,r=t.sizes,n=i[e];return X(n,ei)===X(h+a,ei)&&(h=n+r[e],!0)})).map((function(t){var r=-i[e]+t.pos[e]-a;return Ve(Ve({},t),{gap:s,renderPos:e?[o,r]:[r,o]})}))}(s,o,i,r,e,n,l))})))}function Sn(t,e,i,r,n,s){var o=Zr(Kr(t,s),e,i),a=o.vertical,h=o.horizontal;a.forEach((function(t){t.isBound&&r.push({type:"bounds",pos:t.pos})})),h.forEach((function(t){t.isBound&&n.push({type:"bounds",pos:t.pos})}));var u=function(t){var e=t.props.innerBounds;if(!e)return{vertical:[],horizontal:[]};var i=t.getRect(),r=i.pos1,n=i.pos2,s=i.pos3,o=i.pos4,a=yr([r,n,s,o],[0,0]),h=e.left,u=e.top,c=e.width,l=e.height,p=[[h,u],[h,u+l]],d=[[h,u],[h+c,u]],f=[[h+c,u],[h+c,u+l]],g=[[h,u+l],[h+c,u+l]],m=[],_=[],v={top:!1,bottom:!1,left:!1,right:!1};return[[r,n],[n,o],[o,s],[s,r]].forEach((function(t){var e=Xr(a,t),i=e.horizontal,r=e.vertical,n=Yr(t,d,r,1,!0),s=Yr(t,g,r,1,!0),o=Yr(t,p,i,1,!0),y=Yr(t,f,i,1,!0);n.isBound&&!v.top&&(m.push(u),v.top=!0),s.isBound&&!v.bottom&&(m.push(u+l),v.bottom=!0),o.isBound&&!v.left&&(_.push(h),v.left=!0),y.isBound&&!v.right&&(_.push(h+c),v.right=!0)})),{horizontal:m,vertical:_}}(t),c=u.vertical,l=u.horizontal;c.forEach((function(t){N(r,(function(e){var i=e.type,r=e.pos;return"bounds"===i&&r===t}))>=0||r.push({type:"bounds",pos:t})})),l.forEach((function(t){N(n,(function(e){var i=e.type,r=e.pos;return"bounds"===i&&r===t}))>=0||n.push({type:"bounds",pos:t})}))}var wn={name:"snappable",props:{snappable:[Boolean,Array],snapContainer:Object,snapCenter:Boolean,snapHorizontal:Boolean,snapVertical:Boolean,snapElement:Boolean,snapGap:Boolean,snapGridWidth:Number,snapGridHeight:Number,isDisplaySnapDigit:Boolean,isDisplayInnerSnapDigit:Boolean,snapDigit:Number,snapThreshold:Number,horizontalGuidelines:Array,verticalGuidelines:Array,elementGuidelines:Array,bounds:Object,innerBounds:Object,snapDistFormat:Function},events:{onSnap:"snap"},css:[":host {\n    --bounds-color: #d66;\n}\n.guideline {\n    pointer-events: none;\n    z-index: 2;\n}\n.guideline.bounds {\n    background: #d66;\n    background: var(--bounds-color);\n}\n.guideline-group {\n    position: absolute;\n    top: 0;\n    left: 0;\n}\n.guideline-group .size-value {\n    position: absolute;\n    color: #f55;\n    font-size: 12px;\n    font-weight: bold;\n}\n.guideline-group.horizontal .size-value {\n    transform-origin: 50% 100%;\n    transform: translateX(-50%);\n    left: 50%;\n    bottom: 5px;\n}\n.guideline-group.vertical .size-value {\n    transform-origin: 0% 50%;\n    top: 50%;\n    transform: translateY(-50%);\n    left: 5px;\n}\n.guideline.gap {\n    background: #f55;\n}\n.size-value.gap {\n    color: #f55;\n}\n"],render:function(t,e){var i=t.state,r=i.top,n=i.left,s=i.pos1,o=i.pos2,a=i.pos3,h=i.pos4,u=i.snapRenderInfo,c=i.targetClientRect,l=i.containerClientRect,p=i.is3d,d=i.rootMatrix;if(!u||!cn(t,""))return[];i.staticGuidelines=Nr(t,!1,i.staticGuidelines),i.guidelines=Lr(t);var f=p?4:3,g=Math.min(s[0],o[0],a[0],h[0]),m=Math.min(s[1],o[1],a[1],h[1]),_=Rr(d,l,f),v=$i(d,[c.left-_[0],c.top-_[1]],f),y=v[0],b=v[1],x=t.props,E=x.snapThreshold,T=void 0===E?5:E,S=x.snapDigit,w=void 0===S?0:S,A=x.snapDistFormat,C=void 0===A?function(t){return t}:A,O=u.externalPoses||[],I=Bi(t.state),R=[],M=[],P=[],N=[],L=[],D=Si(I),k=D.width,B=D.height,F=D.top,G=D.left,U=D.bottom,j=D.right,X=O.length>0,z=X?Si(O):{};if(!u.request){if(u.direction&&L.push(function(t,e,i){var r=[];if(i[0]&&i[1])r=[i,[-i[0],i[1]],[i[0],-i[1]]].map((function(t){return yr(e,t)}));else if(i[0]||i[1])t.props.keepRatio?r=[[-1,-1],[-1,1],[1,-1],[1,1],i].map((function(t){return yr(e,t)})):(r=vr(e,i)).length>1&&r.push([(r[0][0]+r[1][0])/2,(r[0][1]+r[1][1])/2]);else for(var n=[e[0],e[1],e[3],e[2],e[0]],s=0;s<4;++s)r.push(n[s]),r.push([(n[s][0]+n[s+1][0])/2,(n[s][1]+n[s+1][1])/2]);return Dr(t,r.map((function(t){return t[0]})),r.map((function(t){return t[1]})),!0,1)}(t,I,u.direction)),u.snap){var H=Si(I);u.center&&(H.middle=(H.top+H.bottom)/2,H.center=(H.left+H.right)/2),L.push(Br(t,H,!0,1))}X&&(u.center&&(z.middle=(z.top+z.bottom)/2,z.center=(z.left+z.right)/2),L.push(Br(t,z,!0,1))),L.forEach((function(t){var e=t.vertical.posInfos,i=t.horizontal.posInfos;R.push.apply(R,e.filter((function(t){return t.guidelineInfos.some((function(t){return!t.guideline.hide}))})).map((function(t){return{type:"snap",pos:t.pos}}))),M.push.apply(M,i.filter((function(t){return t.guidelineInfos.some((function(t){return!t.guideline.hide}))})).map((function(t){return{type:"snap",pos:t.pos}}))),P.push.apply(P,En(e)),N.push.apply(N,En(i))}))}Sn(t,[G,j],[F,U],R,M),X&&Sn(t,[z.left,z.right],[z.top,z.bottom],R,M,u.externalBounds);var V=Tn(P,"vertical",[n,r],[k,B]),Y=Tn(N,"horizontal",[n,r],[k,B]),W=Ye(P,N);ji(t,"onSnap",{guidelines:W.filter((function(t){return!t.element})),elements:Vi(W.filter((function(t){return t.element})),(function(t){return t.element})),gaps:Ye(Y,V)},!0);var $=on(t,N,0,[n,r],[y,b],[k,B]),q=$.guidelines,Z=$.groups,K=$.gapGuidelines,J=on(t,P,1,[n,r],[y,b],[k,B]),Q=J.guidelines,tt=J.groups;return Ye(hn(t,"vertical",Ye(Y,J.gapGuidelines),C,e),hn(t,"horizontal",Ye(V,K),C,e),nn(t,"horizontal",Z,g,y,k,r,T,w,0,C,e),nn(t,"vertical",tt,m,b,B,n,T,w,1,C,e),an(t,"horizontal",q,[n,r],e),an(t,"vertical",Q,[n,r],e),sn(t,"horizontal",M,g,r,k,0,e),sn(t,"vertical",R,m,n,B,1,e))},dragStart:function(t,e){t.state.snapRenderInfo={request:e.isRequest,snap:!0,center:!0},un(t)},drag:function(t){var e=t.state;e.staticGuidelines=Nr(t,!1,e.staticGuidelines),e.guidelines=Lr(t)},pinchStart:function(t){this.unset(t)},dragEnd:function(t){this.unset(t)},dragControlCondition:function(t,e){return!(!Qi(0,e)&&!Dn(t,e))||(!e.isRequest&&e.inputEvent?H(e.inputEvent.target,ci("snap-control")):void 0)},dragControlStart:function(t){t.state.snapRenderInfo=null,un(t)},dragControl:function(t){this.drag(t)},dragControlEnd:function(t){this.unset(t)},dragGroupStart:function(t,e){this.dragStart(t,e)},dragGroup:function(t){this.drag(t)},dragGroupEnd:function(t){this.unset(t)},dragGroupControlStart:function(t){t.state.snapRenderInfo=null,un(t)},dragGroupControl:function(t){this.drag(t)},dragGroupControlEnd:function(t){this.unset(t)},unset:function(t){var e=t.state;e.enableSnap=!1,e.staticGuidelines=[],e.guidelines=[],e.snapRenderInfo=null}},An={name:"draggable",props:{draggable:Boolean,throttleDrag:Number,throttleDragRotate:Number,startDragRotate:Number,edgeDraggable:Boolean},events:{onDragStart:"dragStart",onDrag:"drag",onDragEnd:"dragEnd",onDragGroupStart:"dragGroupStart",onDragGroup:"dragGroup",onDragGroupEnd:"dragGroupEnd"},render:function(t,e){var i=t.props,r=i.throttleDragRotate,n=i.zoom,s=t.state,o=s.dragInfo,a=s.beforeOrigin;if(!r||!o)return[];var h=o.dist;if(!h[0]&&!h[1])return[];var u=Ci(h),c=G(h,[0,0]);return[e.createElement("div",{className:ci("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:u+"px",transform:"translate("+a[0]+"px, "+a[1]+"px) rotate("+c+"rad) scaleY("+n+")"}})]},dragStart:function(t,e){var i=e.datas,r=e.parentEvent,n=e.parentGesto,s=t.state,o=s.target;if(s.gesto)return!1;s.gesto=n||t.targetGesto;var a=Xi(o);i.datas={},i.left=parseFloat(a.left||"")||0,i.top=parseFloat(a.top||"")||0,i.bottom=parseFloat(a.bottom||"")||0,i.right=parseFloat(a.right||"")||0,i.startValue=[0,0],lr(t,e),Er(e,"translate"),function(t,e){e.absolutePoses=Bi(t.state)}(t,i),i.prevDist=[0,0],i.prevBeforeDist=[0,0],i.isDrag=!1;var h=Gi(t,e,Ve({set:function(t){i.startValue=t}},xr(e)));return!1!==(r||ji(t,"onDragStart",h))?(i.isDrag=!0,t.state.dragInfo={startRect:t.getRect(),dist:[0,0]}):(s.gesto=null,i.isPinch=!1),!!i.isDrag&&h},drag:function(t,e){pr(e,"translate");var i=e.datas,r=e.parentEvent,n=e.parentFlag,s=e.isPinch,o=e.isRequest,a=e.distX,h=e.distY,u=i.isDrag,c=i.prevDist,l=i.prevBeforeDist,p=i.startValue;if(u){var d=t.props,f=d.parentMoveable,g=r?0:d.throttleDrag||0,m=r?0:d.throttleDragRotate||0,_=!1,v=0;if(!r&&m>0&&(a||h)){var y=d.startDragRotate||0,b=X(y+180*G([0,0],[a,h])/Math.PI,m)-y,x=h*Math.abs(Math.cos((b-90)/180*Math.PI)),E=Ci([a*Math.abs(Math.cos(b/180*Math.PI)),x]);v=b*Math.PI/180,a=E*Math.cos(v),h=E*Math.sin(v)}if(!s&&!r&&!n&&(!m||a||h)){var T=xn(t,a,h,m,o,i),S=T[0],w=T[1],A=S.isSnap,C=S.isBound,O=S.offset,I=w.isSnap,R=w.isBound;_=A||I||C||R,a+=O,h+=w.offset}i.passDeltaX=a-(i.passDistX||0),i.passDeltaY=h-(i.passDistY||0),i.passDistX=a,i.passDistY=h;var M=zt(gr({datas:i,distX:a,distY:h}),p),P=zt(function(t){var e=t.datas,i=gr({datas:e,distX:t.distX,distY:t.distY});return Yt(fr(e,function(t,e){for(var i=ee(4),r=0;r<3;++r)i[12+r]=t[r]||0;return i}([i[0],i[1]])),Gt([0,0,0],4),4)}({datas:i,distX:a,distY:h}),p);m||_||(z(P,g),z(M,g));var N=Ht(M,p),L=Ht(P,p),D=Ht(L,c),k=Ht(N,l);i.prevDist=L,i.prevBeforeDist=N;var B=i.left+N[0],F=i.top+N[1],U=i.right-N[0],j=i.bottom-N[1],H=dr(i,"translate("+P[0]+"px, "+P[1]+"px)","translate("+L[0]+"px, "+L[1]+"px)");if(t.state.dragInfo.dist=r?[0,0]:L,r||f||!D.every((function(t){return!t}))||!k.some((function(t){return!t}))){var V=t.state,Y=Gi(t,e,{transform:H,dist:L,delta:D,translate:P,beforeDist:N,beforeDelta:k,beforeTranslate:M,left:B,top:F,right:U,bottom:j,width:V.width,height:V.height,isPinch:s});return!r&&ji(t,"onDrag",Y),Y}}},dragEnd:function(t,e){var i=e.parentEvent,r=e.datas,n=e.isDrag;if(t.state.gesto=null,t.state.dragInfo=null,r.isDrag)return r.isDrag=!1,!i&&ji(t,"onDragEnd",Ui(t,e,{})),n},dragGroupStart:function(t,e){var i=e.datas,r=e.clientX,n=e.clientY,s=this.dragStart(t,e);if(!s)return!1;var o=hr(t,this,"dragStart",[r||0,n||0],e,!1),a=ji(t,"onDragGroupStart",Ve(Ve({},s),{targets:t.props.targets,events:o}));return i.isDrag=!1!==a,!!i.isDrag&&s},dragGroup:function(t,e){if(e.datas.isDrag){var i=this.drag(t,e),r=e.datas,n=hr(t,this,"drag",[r.passDeltaX,r.passDeltaY],e,!1);if(i){var s=Ve({targets:t.props.targets,events:n},i);return ji(t,"onDragGroup",s),s}}},dragGroupEnd:function(t,e){var i=e.isDrag;if(e.datas.isDrag)return this.dragEnd(t,e),hr(t,this,"dragEnd",[0,0],e,!1),ji(t,"onDragGroupEnd",Ui(t,e,{targets:t.props.targets})),i},request:function(t){var e={},i=t.getRect(),r=0,n=0;return{isControl:!1,requestStart:function(){return{datas:e}},request:function(t){return"x"in t?r=t.x-i.left:"deltaX"in t&&(r+=t.deltaX),"y"in t?n=t.y-i.top:"deltaY"in t&&(n+=t.deltaY),{datas:e,distX:r,distY:n}},requestEnd:function(){return{datas:e,isDrag:!0}}}},unset:function(t){t.state.dragInfo=null}};function Cn(t,e,i,r){void 0===r&&(r="");var n=t.state,s=n.renderPoses,o=n.rotation,a=n.direction,h=t.props,u=h.renderDirections,c=void 0===u?e:u,l=h.zoom,p={};if(!c)return[];var d=a>0?1:-1,f=!0===c?oi:c,g=o/Math.PI*180;return f.forEach((function(t){p[t]=!0})),f.map((function(t){var e=ai[t];if(!e||!p[t])return null;var n=(X(g,15)+d*hi[t]+720)%180;return i.createElement("div",{className:ci("control","direction",t,r),"data-rotation":n,"data-direction":t,key:"direction-"+t,style:Ri.apply(void 0,Ye([o,l],e.map((function(t){return s[t]}))))})}))}function On(t,e,i,r,n,s){for(var o=[],a=6;a<arguments.length;a++)o[a-6]=arguments[a];var h=G(i,r),u=e?X(h/Math.PI*180,15)%180:-1;return t.createElement("div",{key:"line"+s,className:ci.apply(void 0,Ye(["line","direction",e],o)),"data-rotation":u,"data-line-index":s,"data-direction":e,style:Ii(i,r,n,h)})}function In(t,e){return Cn(t,oi,e)}function Rn(t,e){return Cn(t,["nw","ne","sw","se"],e)}function Mn(t,e,i,r,n,s){var o=t.state.is3d?4:3,a=Ei(t.state.rootMatrix,n,o),h=zt([s.left,s.top],a);e.startAbsoluteOrigin=h,e.prevDeg=G(h,[i,r])/Math.PI*180,e.prevSnapDeg=e.prevDeg,e.startDeg=e.prevDeg,e.loop=0}function Pn(t,e,i,r,n,s){var o=i.prevDeg,a=bn(t,e,i.origin,r);return i.prevDeg=a,[a-o,a,s+a]}function Nn(t,e,i,r,n,s,o,a){var h=i.prevDeg,u=i.prevSnapDeg,c=i.startDeg,l=i.loop;h>r&&h>270&&r<90?++i.loop:h<r&&h<90&&r>270&&--i.loop;var p=i.loop,d=360*l+u-c+s,f=360*p+r-c+s;i.prevDeg=f-360*p+c-s;var g=n*((f=X(f,o))-s);return a&&(f=(g=bn(t,e,i.origin,g))/n+s),i.prevSnapDeg=f-360*p+c-s,[n*(f-d),g,s+g]}function Ln(t,e,i,r,n,s,o,a){return Nn(t,e,i,G(i.startAbsoluteOrigin,[n,s])/Math.PI*180,r,o,a,!0)}function Dn(t,e){if(e.isRequest)return"rotatable"===e.requestAble;var i=e.inputEvent.target;if(H(i,ci("rotation-control")))return!0;var r=t.props.rotationTarget;return!!r&&ir(r,!0).some((function(t){return!!t&&(i===t||i.contains(t))}))}var kn={name:"rotatable",canPinch:!0,props:{rotatable:Boolean,rotationPosition:String,throttleRotate:Number,renderDirections:Object,rotationTarget:Object},events:{onRotateStart:"rotateStart",onRotate:"rotate",onRotateEnd:"rotateEnd",onRotateGroupStart:"rotateGroupStart",onRotateGroup:"rotateGroup",onRotateGroupEnd:"rotateGroupEnd"},css:[".rotation {\n            position: absolute;\n            height: 40px;\n            width: 1px;\n            transform-origin: 50% 100%;\n            height: calc(40px * var(--zoom));\n            top: auto;\n            left: 0;\n            bottom: 100%;\n            will-change: transform;\n        }\n        .rotation .rotation-line {\n            display: block;\n            width: 100%;\n            height: 100%;\n            transform-origin: 50% 50%;\n        }\n        .rotation .rotation-control {\n            border-color: #4af;\n            border-color: var(--moveable-color);\n            background:#fff;\n            cursor: alias;\n        }"],render:function(t,e){var i=t.props,r=i.rotatable,n=i.rotationPosition,s=i.zoom,o=i.renderDirections,a=t.state,h=a.renderPoses,u=a.direction;if(!r)return null;var c=function(t,e,i){var r=e[0],n=e[1],s=e[2],o=e[3];if("none"!==t){var a=(t||"top").split("-"),h=a[0],u=a[1],c=[r,n];"left"===h?c=[s,r]:"right"===h?c=[n,o]:"bottom"===h&&(c=[o,s]);var l=[(c[0][0]+c[1][0])/2,(c[0][1]+c[1][1])/2],p=Pi(c,i);if(u){var d="top"===u||"left"===u,f="bottom"===h||"left"===h;l=c[d&&!f||!d&&f?0:1]}return[l,p]}}(n,h,u),l=[];if(c){var p=c[0],d=c[1];l.push(e.createElement("div",{key:"rotation",className:ci("rotation"),style:{transform:"translate(-50%) translate("+p[0]+"px, "+p[1]+"px) rotate("+d+"rad)"}},e.createElement("div",{className:ci("line rotation-line"),style:{transform:"scaleX("+s+")"}}),e.createElement("div",{className:ci("control rotation-control"),style:{transform:"translate(0.5px) scale("+s+")"}})))}return o&&l.push.apply(l,Cn(t,[],e)),l},dragControlCondition:Dn,dragControlStart:function(t,e){var i=e.datas,r=e.clientX,n=e.clientY,s=e.parentRotate,o=e.parentFlag,a=e.isPinch,h=e.isRequest,u=t.state,c=u.target,l=u.left,p=u.top,d=u.origin,f=u.beforeOrigin,g=u.direction,m=u.beforeDirection,_=u.targetTransform,v=u.moveableClientRect;if(!h&&!c)return!1;var y=t.getRect();if(i.rect=y,i.transform=_,i.left=l,i.top=p,i.fixedPosition=Or(t,Cr(t)),i.absoluteInfo={origin:y.origin,startValue:y.rotation},Mn(t,i.absoluteInfo,r,n,d,v),h||a||o){var b=s||0;i.beforeInfo={origin:y.beforeOrigin,prevDeg:b,startDeg:b,prevSnapDeg:b,loop:0},i.afterInfo={origin:y.origin,prevDeg:b,startDeg:b,prevSnapDeg:b,loop:0}}else i.beforeInfo={origin:y.beforeOrigin},i.afterInfo={origin:y.origin},Mn(t,i.beforeInfo,r,n,f,v),Mn(t,i.afterInfo,r,n,d,v);i.direction=g,i.beforeDirection=m,i.startValue=0,i.datas={},Er(e,"rotate");var x=Gi(t,e,Ve(Ve({set:function(t){i.startValue=t*Math.PI/180}},xr(e)),{dragStart:An.dragStart(t,(new or).dragStart([0,0],e))})),E=ji(t,"onRotateStart",x);return i.isRotate=!1!==E,t.state.snapRenderInfo={request:e.isRequest},!!i.isRotate&&x},dragControl:function(t,e){var i,r,n,s,o,a,h,u,c,l=e.datas,p=e.clientX,d=e.clientY,f=e.parentRotate,g=e.parentFlag,m=e.isPinch,_=e.groupDelta,v=l.beforeDirection,y=l.beforeInfo,b=l.afterInfo,x=l.absoluteInfo,E=l.isRotate,T=l.startValue,S=l.rect;if(E){pr(e,"rotate");var w,A,C,O,I,R,M,P,N,L=function(t){return Ai(t.datas.beforeTransform,[50,50],100,100).direction}(e),D=v*L,k=t.props,B=k.throttleRotate,F=void 0===B?0:B,G=k.parentMoveable,U=180/Math.PI*T,j=x.startValue;if(!g&&"parentDist"in e){var X=e.parentDist;w=(i=Pn(t,S,b,X,0,U))[0],A=i[1],C=i[2],O=(r=Pn(t,S,y,X,0,U))[0],I=r[1],R=r[2],M=(n=Pn(t,S,x,X,0,j))[0],P=n[1],N=n[2]}else m||g?(w=(s=Nn(t,S,b,f,D,U,F))[0],A=s[1],C=s[2],O=(o=Nn(t,S,y,f,v,U,F))[0],I=o[1],R=o[2],M=(a=Nn(t,S,x,f,D,j,F))[0],P=a[1],N=a[2]):(w=(h=Ln(t,S,b,D,p,d,U,F))[0],A=h[1],C=h[2],O=(u=Ln(t,S,y,v,p,d,U,F))[0],I=u[1],R=u[2],M=(c=Ln(t,S,x,D,p,d,j,F))[0],P=c[1],N=c[2]);if(M||w||O||G){var z=dr(l,"rotate("+C+"deg)","rotate("+A+"deg)"),H=function(t,e,i,r){return Ar(t,"rotate("+e+"deg)",Cr(t),i,r)}(t,A,l.fixedPosition,l),V=Ht(zt(_||[0,0],H),l.prevInverseDist||[0,0]);l.prevInverseDist=H;var Y=Gi(t,e,Ve({delta:w,dist:A,rotate:C,beforeDist:I,beforeDelta:O,beforeRotate:R,absoluteDist:P,absoluteDelta:M,absoluteRotate:N,isPinch:!!m},wr(t,z,V,m,e)));return ji(t,"onRotate",Y),Y}}},dragControlEnd:function(t,e){var i=e.datas,r=e.isDrag;return!!i.isRotate&&(i.isRotate=!1,ji(t,"onRotateEnd",Ui(t,e,{})),r)},dragGroupControlCondition:Dn,dragGroupControlStart:function(t,e){var i=e.datas,r=t.state,n=r.left,s=r.top,o=r.beforeOrigin,a=this.dragControlStart(t,e);if(!a)return!1;a.set(i.beforeDirection*t.rotation);var h=ur(t,this,"dragControlStart",e,(function(t,e){var i=t.state,r=i.left,a=i.top,h=i.beforeOrigin,u=zt(Ht([r,a],[n,s]),Ht(h,o));return e.datas.groupClient=u,Ve(Ve({},e),{parentRotate:0})})),u=ji(t,"onRotateGroupStart",Ve(Ve({},a),{targets:t.props.targets,events:h}));return i.isRotate=!1!==u,!!i.isRotate&&a},dragGroupControl:function(t,e){var i=e.datas;if(i.isRotate){var r=this.dragControl(t,e);if(r){var n=i.beforeDirection,s=r.beforeDist,o=r.beforeDelta/180*Math.PI,a=ur(t,this,"dragControl",e,(function(t,e){var i=e.datas.groupClient,r=i[0],a=i[1],h=Kt([r,a],o*n),u=h[0],c=h[1],l=[u-r,c-a];return e.datas.groupClient=[u,c],Ve(Ve({},e),{parentRotate:s,groupDelta:l})}));t.rotation=n*r.beforeRotate;var h=Ve({targets:t.props.targets,events:a,set:function(e){t.rotation=e}},r);return ji(t,"onRotateGroup",h),h}}},dragGroupControlEnd:function(t,e){var i=e.isDrag;if(e.datas.isRotate)return this.dragControlEnd(t,e),ur(t,this,"dragControlEnd",e),ji(t,"onRotateGroupEnd",Ui(t,e,{targets:t.props.targets})),i},request:function(t){var e={},i=0,r=t.getRotation();return{isControl:!0,requestStart:function(){return{datas:e}},request:function(t){return"deltaRotate"in t?i+=t.deltaRotate:"rotate"in t&&(i=t.rotate-r),{datas:e,parentDist:i}},requestEnd:function(){return{datas:e,isDrag:!0}}}}},Bn={name:"resizable",ableGroup:"size",canPinch:!0,props:{resizable:Boolean,throttleResize:Number,renderDirections:Array,keepRatio:Boolean},events:{onResizeStart:"resizeStart",onResize:"resize",onResizeEnd:"resizeEnd",onResizeGroupStart:"resizeGroupStart",onResizeGroup:"resizeGroup",onResizeGroupEnd:"resizeGroupEnd"},render:function(t,e){var i=t.props,r=i.resizable,n=i.edge;if(r)return n?Rn(t,e):In(t,e)},dragControlCondition:Qi,dragControlStart:function(t,e){var i,r=e.inputEvent,n=e.isPinch,s=e.parentDirection,o=e.datas,a=e.parentFlag,h=s||(n?[0,0]:Di(r.target)),u=t.state,c=u.target,l=u.width,p=u.height;if(!h||!c)return!1;!n&&lr(t,e),o.datas={},o.direction=h,o.startOffsetWidth=l,o.startOffsetHeight=p,o.prevWidth=0,o.prevHeight=0,i=function(t){var e=Xi(t);return[parseFloat(e.width),parseFloat(e.height)]}(c),o.startWidth=i[0],o.startHeight=i[1];var d=[Math.max(0,l-o.startWidth),Math.max(0,p-o.startHeight)];if(o.minSize=d,o.maxSize=[1/0,1/0],!a){var f=Xi(c),g=f.position,m=f.minWidth,_=f.minHeight,v=f.maxWidth,y=f.maxHeight,b="static"===g||"relative"===g,x=b?c.parentElement:c.offsetParent,T=l,S=p;if(x&&(T=x.clientWidth,S=x.clientHeight,b)){var w=Xi(x);T-=parseFloat(w.paddingLeft)||0,S-=parseFloat(w.paddingTop)||0}o.minSize=zt([k(m,T)||0,k(_,S)||0],d),o.maxSize=zt([k(v,T)||1/0,k(y,S)||1/0],d)}var A=t.props.transformOrigin||"% %";function C(t){o.ratio=t&&isFinite(t)?t:0}function O(e){o.fixedDirection=e,o.fixedPosition=Ir(t,e)}o.transformOrigin=A&&E(A)?A.split(" "):A,o.isWidth=!h[0]&&!h[1]||h[0]||!h[1],C(l/p),O([-h[0],-h[1]]);var I=Gi(t,e,{direction:h,set:function(t){var e=t[0],i=t[1];o.startWidth=e,o.startHeight=i},setMin:function(t){o.minSize=t},setMax:function(t){o.maxSize=[t[0]||1/0,t[1]||1/0]},setRatio:C,setFixedDirection:O,setOrigin:function(t){o.transformOrigin=t},dragStart:An.dragStart(t,(new or).dragStart([0,0],e))});return!1!==ji(t,"onResizeStart",I)&&(o.isResize=!0,t.state.snapRenderInfo={request:e.isRequest,direction:h}),!!o.isResize&&I},dragControl:function(t,e){var i,r=e.datas,n=e.distX,s=e.distY,o=e.parentFlag,a=e.isPinch,h=e.parentDistance,u=e.parentScale,c=e.parentKeepRatio,l=e.dragClient,p=e.parentDist,d=e.isRequest,f=r.isResize,g=r.transformOrigin,m=r.fixedDirection,_=r.startWidth,v=r.startHeight,y=r.prevWidth,b=r.prevHeight,x=r.minSize,E=r.maxSize,T=r.ratio,S=r.isWidth,w=r.startOffsetWidth,A=r.startOffsetHeight;if(f){var C=t.props,O=C.throttleResize,I=void 0===O?0:O,M=C.parentMoveable,P=C.snapThreshold,N=void 0===P?5:P,L=r.direction,D=L,k=0,F=0;L[0]||L[1]||(D=[1,1]);var U=T&&(t.props.keepRatio||c),j=l;if(l||(j=!o&&a?Ir(t,[0,0]):r.fixedPosition),p)k=p[0],F=p[1],U&&(k?F||(F=k/T):k=F*T);else if(u)k=(u[0]-1)*w,F=(u[1]-1)*A;else if(a)h&&(k=h,F=h*A/w);else{var z=mr({datas:r,distX:n,distY:s});if(k=D[0]*z[0],F=D[1]*z[1],U&&w&&A){var H=G([0,0],z),V=G([0,0],D),Y=Ci([k,F]),W=Math.cos(H-V)*Y;if(D[0])if(D[1]){var $=2*D[0]*w,q=2*D[1]*A,Z=Ci([$+z[0],q+z[1]])-Ci([$,q]),K=G([0,0],[T,1]);k=Math.cos(K)*Z,F=Math.sin(K)*Z}else F=(k=W)*T;else k=(F=W)/T}else if(!U){var J=Ye(L);w||(z[0]<0?J[0]=-1:z[0]>0&&(J[0]=1)),A||(z[1]<0?J[1]=-1:z[1]>0&&(J[1]=1)),L=J,k=(D=J)[0]*z[0],F=D[1]*z[1]}}var Q=D[0]||U?Math.max(w+k,ii):w,tt=D[1]||U?Math.max(A+F,ii):A;U&&w&&A&&(S?tt=Q/T:Q=tt*T);var et=[0,0];if(a||(et=function(t,e,i,r,n,s,o){if(!cn(t,"resizable"))return[0,0];var a=t.state,h=a.allMatrix,u=a.is3d;return yn(t,(function(t,s){return pn(h,e+t,i+s,n,r,u)}),e,i,r,n,s,o)}(t,Q,tt,L,j,d,r)),p&&(!p[0]&&(et[0]=0),!p[1]&&(et[1]=0)),U){D[0]&&D[1]&&et[0]&&et[1]&&(Math.abs(et[0])>Math.abs(et[1])?et[1]=0:et[0]=0);var it=!et[0]&&!et[1];it&&(S?Q=X(Q,I):tt=X(tt,I)),D[0]&&!D[1]||et[0]&&!et[1]||it&&S?tt=(Q+=et[0])/T:(!D[0]&&D[1]||!et[0]&&et[1]||it&&!S)&&(Q=(tt+=et[1])*T)}else w+k<-N&&(et[0]=0),w+F<-N&&(et[1]=0),Q+=et[0],tt+=et[1],et[0]||(Q=X(Q,I)),et[1]||(tt=X(tt,I));Q=(i=function(t,e,i,r){if(!r)return t.map((function(t,r){return function(t,e,i){return Math.max(e,Math.min(t,i))}(t,e[r],i[r])}));var n=t[0],s=t[1],o=B(t,e,!1),a=o[0],h=o[1],u=B(t,i,!0),c=u[0],l=u[1];return n<a||s<h?(n=a,s=h):(n>c||s>l)&&(n=c,s=l),[n,s]}([Q,tt],x,E,U))[0],tt=i[1];var rt=[(k=(Q=Math.round(Q))-w)-y,(F=(tt=Math.round(tt))-A)-b];r.prevWidth=k,r.prevHeight=F;var nt=function(t,e,i,r,n,s){var o=t.props.groupable,a=t.state,h=a.transformOrigin,u=a.targetMatrix,c=a.offsetMatrix,l=a.is3d,p=a.width,d=a.height,f=a.left,g=a.top,m=l?4:3,_=function(t,e,i,r,n,s){return void 0===r&&(r=e),void 0===n&&(n=i),void 0===s&&(s=[0,0]),t?t.map((function(t,o){var a=R(t),h=a.value,u=a.unit,c=o?n:r,l=o?i:e;return"%"===t||isNaN(h)?l*(c?s[o]/c:0):"%"!==u?h:l*h/100})):s}(s,e,i,p,d,h),v=o?f:0,y=o?g:0,b=function(t,e,i,r,n,s){var o=yr(Ti(e,i,r,n),s);return[t[0]-o[0],t[1]-o[1]]}(n,br(c,u,_,m),e,i,m,r);return Ht(b,[v,y])}(t,Q,tt,m,j,g);if(M||!rt.every((function(t){return!t}))||!nt.every((function(t){return!t}))){var st=Gi(t,e,{width:_+k,height:v+F,offsetWidth:Q,offsetHeight:tt,direction:L,dist:[k,F],delta:rt,isPinch:!!a,drag:An.drag(t,sr(e,t.state,nt,!!a,!1))});return ji(t,"onResize",st),st}}},dragControlAfter:function(t,e){var i=e.datas,r=i.isResize,n=i.startOffsetWidth,s=i.startOffsetHeight,o=i.prevWidth,a=i.prevHeight;if(r){var h=t.state,u=h.width-(n+o),c=h.height-(s+a),l=Math.abs(u)>3,p=Math.abs(c)>3;return l&&(i.startWidth+=u,i.startOffsetWidth+=u,i.prevWidth+=u),p&&(i.startHeight+=c,i.startOffsetHeight+=c,i.prevHeight+=c),l||p?(this.dragControl(t,e),!0):void 0}},dragControlEnd:function(t,e){var i=e.datas,r=e.isDrag;return!!i.isResize&&(i.isResize=!1,ji(t,"onResizeEnd",Ui(t,e,{})),r)},dragGroupControlCondition:Qi,dragGroupControlStart:function(t,e){var i=e.datas,r=this.dragControlStart(t,e);if(!r)return!1;var n=ar(t,"resizable",e);function s(e,r){var n=i.fixedDirection,s=i.fixedPosition,o=Ir(e,n),a=Yt(te(-t.rotation/180*Math.PI,3),[o[0]-s[0],o[1]-s[1],1],3),h=a[0],u=a[1];return r.datas.originalX=h,r.datas.originalY=u,r}var o=ur(t,this,"dragControlStart",e,(function(t,e){return s(t,e)})),a=Ve(Ve({},r),{targets:t.props.targets,events:o,setFixedDirection:function(e){r.setFixedDirection(e),o.forEach((function(i,r){i.setFixedDirection(e),s(t.moveables[r],n[r])}))}}),h=ji(t,"onResizeGroupStart",a);return i.isResize=!1!==h,!!i.isResize&&r},dragGroupControl:function(t,e){var i=e.datas;if(i.isResize){var r=this.dragControl(t,e);if(r){var n=r.offsetWidth,s=r.offsetHeight,o=r.dist,a=t.props.keepRatio,h=[n/(n-o[0]),s/(s-o[1])],u=i.fixedPosition,c=ur(t,this,"dragControl",e,(function(e,i){var r=Yt(te(t.rotation/180*Math.PI,3),[i.datas.originalX*h[0],i.datas.originalY*h[1],1],3),n=r[0],s=r[1];return Ve(Ve({},i),{parentDist:null,parentScale:h,dragClient:zt(u,[n,s]),parentKeepRatio:a})})),l=Ve({targets:t.props.targets,events:c},r);return ji(t,"onResizeGroup",l),l}}},dragGroupControlEnd:function(t,e){var i=e.isDrag;if(e.datas.isResize)return this.dragControlEnd(t,e),ur(t,this,"dragControlEnd",e),ji(t,"onResizeGroupEnd",Ui(t,e,{targets:t.props.targets})),i},request:function(t){var e={},i=0,r=0,n=t.getRect();return{isControl:!0,requestStart:function(t){return{datas:e,parentDirection:t.direction||[1,1]}},request:function(t){return"offsetWidth"in t?i=t.offsetWidth-n.offsetWidth:"deltaWidth"in t&&(i+=t.deltaWidth),"offsetHeight"in t?r=t.offsetHeight-n.offsetHeight:"deltaHeight"in t&&(r+=t.deltaHeight),{datas:e,parentDist:[i,r]}},requestEnd:function(){return{datas:e,isDrag:!0}}}}},Fn={name:"scalable",ableGroup:"size",canPinch:!0,props:{scalable:Boolean,throttleScale:Number,renderDirections:String,keepRatio:Boolean},events:{onScaleStart:"scaleStart",onScale:"scale",onScaleEnd:"scaleEnd",onScaleGroupStart:"scaleGroupStart",onScaleGroup:"scaleGroup",onScaleGroupEnd:"scaleGroupEnd"},render:function(t,e){var i=t.props,r=i.resizable,n=i.scalable,s=i.edge;if(!r&&n)return s?Rn(t,e):In(t,e)},dragControlCondition:Qi,dragControlStart:function(t,e){var i=e.datas,r=e.isPinch,n=e.inputEvent,s=e.parentDirection||(r?[0,0]:Di(n.target)),o=t.state,a=o.width,h=o.height,u=o.targetTransform,c=o.target,l=o.pos1,p=o.pos2,d=o.pos4;if(!s||!c)return!1;r||lr(t,e),i.datas={},i.transform=u,i.prevDist=[1,1],i.direction=s,i.width=a,i.height=h,i.startValue=[1,1];var f=j(l,p),g=j(p,d),m=!s[0]&&!s[1]||s[0]||!s[1];function _(t){i.ratio=t&&isFinite(t)?t:0}function v(e){i.fixedDirection=e,i.fixedPosition=Ir(t,e)}i.scaleWidth=f,i.scaleHeight=g,i.scaleXRatio=f/a,i.scaleYRatio=g/h,Er(e,"scale"),i.isWidth=m,_(j(l,p)/j(p,d)),v([-s[0],-s[1]]);var y=Gi(t,e,Ve(Ve({direction:s,set:function(t){i.startValue=t},setRatio:_,setFixedDirection:v},xr(e)),{dragStart:An.dragStart(t,(new or).dragStart([0,0],e))}));return!1!==ji(t,"onScaleStart",y)&&(i.isScale=!0,t.state.snapRenderInfo={request:e.isRequest,direction:s}),!!i.isScale&&y},dragControl:function(t,e){pr(e,"scale");var i=e.datas,r=e.distX,n=e.distY,s=e.parentScale,o=e.parentDistance,a=e.parentKeepRatio,h=e.parentFlag,u=e.isPinch,c=e.dragClient,l=e.parentDist,p=e.isRequest,d=i.prevDist,f=i.direction,g=i.width,m=i.height,_=i.isScale,v=i.startValue,y=i.isWidth,b=i.ratio,E=i.fixedDirection,T=i.scaleXRatio,S=i.scaleYRatio;if(!_)return!1;var w=t.props,A=w.throttleScale,C=w.parentMoveable,O=f;f[0]||f[1]||(O=[1,1]);var I=b&&(t.props.keepRatio||a),R=t.state,M=1,P=1,N=c;if(c||(N=!h&&u?Ir(t,[0,0]):i.fixedPosition),l)M=(g+l[0])/g,P=(m+l[1])/m;else if(s)M=s[0],P=s[1];else if(u)o&&(M=(g+o)/g,P=(m+o*m/g)/m);else{var L=mr({datas:i,distX:r,distY:n}),D=O[0]*L[0]*T,k=O[1]*L[1]*S;if(I&&g&&m)if(O[0])if(O[1]){var B=Ci([D,k]),F=G([0,0],L),U=G([0,0],O),j=Math.cos(F-U)*B,z=G([0,0],[b,1]);D=Math.cos(z)*j,k=Math.sin(z)*j}else k=D/b;else D=k*b;M=(g+D/T)/g,P=(m+k/S)/m}M=O[0]||I?M*v[0]:v[0],P=O[1]||I?P*v[1]:v[1],0===M&&(M=(d[0]>0?1:-1)*ri),0===P&&(P=(d[1]>0?1:-1)*ri);var H=[M/v[0],P/v[1]],V=[M,P];if(!u&&t.props.groupable){var Y=(R.snapRenderInfo||{}).direction;x(Y)&&(Y[0]||Y[1])&&(R.snapRenderInfo={direction:f,request:e.isRequest})}var W=[0,0];if(u||(W=function(t,e,i,r,n){var s=n.width,o=n.height,a=n.fixedPosition;if(!cn(t,"scalable"))return[0,0];var h=n.is3d,u=yn(t,(function(t,r){return pn(function(t,e){var i=t.transformOrigin,r=t.offsetMatrix,n=t.is3d?4:3;return br(r,Xt(t.targetMatrix,ie(e,n),n),i,n)}(n,zt(e,[t/s,r/o])),s,o,a,i,h)}),s,o,i,a,r,n);return[u[0]/s,u[1]/o]}(t,H,f,p,i)),I){O[0]&&O[1]&&W[0]&&W[1]&&(Math.abs(W[0]*g)>Math.abs(W[1]*m)?W[1]=0:W[0]=0);var $=!W[0]&&!W[1];if($&&(y?H[0]=X(H[0]*v[0],A)/v[0]:H[1]=X(H[1]*v[1],A)/v[1]),O[0]&&!O[1]||W[0]&&!W[1]||$&&y){H[0]+=W[0];var q=g*H[0]*v[0]/b;H[1]=q/m/v[1]}else if(!O[0]&&O[1]||!W[0]&&W[1]||$&&!y){H[1]+=W[1];var Z=m*H[1]*v[1]*b;H[0]=Z/g/v[0]}}else H[0]+=W[0],H[1]+=W[1],W[0]||(H[0]=X(H[0]*v[0],A)/v[0]),W[1]||(H[1]=X(H[1]*v[1],A)/v[1]);0===H[0]&&(H[0]=(d[0]>0?1:-1)*ri),0===H[1]&&(H[1]=(d[1]>0?1:-1)*ri);var K,J,Q=[H[0]/d[0],H[1]/d[1]];J=v,V=[(K=H)[0]*J[0],K[1]*J[1]];var tt=function(t,e,i,r,n){return Ar(t,"scale("+e.join(", ")+")",i,r,n)}(t,H,E,N,i),et=Ht(tt,i.prevInverseDist||[0,0]);if(i.prevDist=H,i.prevInverseDist=tt,M===d[0]&&P===d[1]&&et.every((function(t){return!t}))&&!C)return!1;var it=dr(i,"scale("+V.join(", ")+")","scale("+H.join(", ")+")"),rt=Gi(t,e,Ve({offsetWidth:g,offsetHeight:m,direction:f,scale:V,dist:H,delta:Q,isPinch:!!u},wr(t,it,et,u,e)));return ji(t,"onScale",rt),rt},dragControlEnd:function(t,e){var i=e.datas,r=e.isDrag;return!!i.isScale&&(i.isScale=!1,ji(t,"onScaleEnd",Ui(t,e,{})),r)},dragGroupControlCondition:Qi,dragGroupControlStart:function(t,e){var i=e.datas,r=this.dragControlStart(t,e);if(!r)return!1;var n=ar(t,"resizable",e);function s(e,r){var n=i.fixedDirection,s=i.fixedPosition,o=Ir(e,n),a=Yt(te(-t.rotation/180*Math.PI,3),[o[0]-s[0],o[1]-s[1],1],3),h=a[0],u=a[1];return r.datas.originalX=h,r.datas.originalY=u,r}i.moveableScale=t.scale;var o=ur(t,this,"dragControlStart",e,(function(t,e){return s(t,e)})),a=Ve(Ve({},r),{targets:t.props.targets,events:o,setFixedDirection:function(e){r.setFixedDirection(e),o.forEach((function(i,r){i.setFixedDirection(e),s(t.moveables[r],n[r])}))}}),h=ji(t,"onScaleGroupStart",a);return i.isScale=!1!==h,!!i.isScale&&a},dragGroupControl:function(t,e){var i=e.datas;if(i.isScale){var r=this.dragControl(t,e);if(r){var n=i.moveableScale;t.scale=[r.scale[0]*n[0],r.scale[1]*n[1]];var s=t.props.keepRatio,o=r.dist,a=r.scale,h=i.fixedPosition,u=ur(t,this,"dragControl",e,(function(e,i){var r=Yt(te(t.rotation/180*Math.PI,3),[i.datas.originalX*o[0],i.datas.originalY*o[1],1],3),n=r[0],u=r[1];return Ve(Ve({},i),{parentDist:null,parentScale:a,parentKeepRatio:s,dragClient:zt(h,[n,u])})})),c=Ve({targets:t.props.targets,events:u},r);return ji(t,"onScaleGroup",c),c}}},dragGroupControlEnd:function(t,e){var i=e.isDrag;if(e.datas.isScale)return this.dragControlEnd(t,e),ur(t,this,"dragControlEnd",e),ji(t,"onScaleGroupEnd",Ui(t,e,{targets:t.props.targets})),i},request:function(){var t={},e=0,i=0;return{isControl:!0,requestStart:function(e){return{datas:t,parentDirection:e.direction||[1,1]}},request:function(r){return e+=r.deltaWidth,i+=r.deltaHeight,{datas:t,parentDist:[e,i]}},requestEnd:function(){return{datas:t,isDrag:!0}}}}};function Gn(t,e){return t.map((function(t,i){return(t*2+e[i]*1)/3}))}function Un(t,e,i){var r=G(t,e),n=G(t,i)-r;return n>=0?n:n+2*Math.PI}var jn={name:"warpable",ableGroup:"size",props:{warpable:Boolean,renderDirections:Array},events:{onWarpStart:"warpStart",onWarp:"warp",onWarpEnd:"warpEnd"},render:function(t,e){var i=t.props,r=i.resizable,n=i.scalable,s=i.warpable,o=i.zoom;if(r||n||!s)return[];var a=t.state,h=a.pos1,u=a.pos2,c=a.pos3,l=a.pos4,p=Gn(h,u),d=Gn(u,h),f=Gn(h,c),g=Gn(c,h),m=Gn(c,l),_=Gn(l,c),v=Gn(u,l),y=Gn(l,u);return Ye([e.createElement("div",{className:ci("line"),key:"middeLine1",style:Ii(p,m,o)}),e.createElement("div",{className:ci("line"),key:"middeLine2",style:Ii(d,_,o)}),e.createElement("div",{className:ci("line"),key:"middeLine3",style:Ii(f,v,o)}),e.createElement("div",{className:ci("line"),key:"middeLine4",style:Ii(g,y,o)})],In(t,e))},dragControlCondition:function(t,e){return!e.isRequest&&H(e.inputEvent.target,ci("direction"))},dragControlStart:function(t,e){var i=e.datas,r=e.inputEvent,n=t.props.target,s=Di(r.target);if(!s||!n)return!1;var o=t.state,a=o.transformOrigin,h=o.is3d,u=o.targetTransform,c=o.targetMatrix,l=o.width,p=o.height,d=o.left,f=o.top;return i.datas={},i.targetTransform=u,i.warpTargetMatrix=h?c:Ut(c,3,4),i.targetInverseMatrix=Bt(Ft(i.warpTargetMatrix,4),3,4),i.direction=s,i.left=d,i.top=f,i.poses=[[0,0],[l,0],[0,p],[l,p]].map((function(t){return Ht(t,a)})),i.nextPoses=i.poses.map((function(t){var e=t[0],r=t[1];return Yt(i.warpTargetMatrix,[e,r,0,1],4)})),i.startValue=ee(4),i.prevMatrix=ee(4),i.absolutePoses=Bi(o),i.posIndexes=_r(s),lr(t,e),Er(e,"matrix3d"),o.snapRenderInfo={request:e.isRequest,direction:s},!1!==ji(t,"onWarpStart",Gi(t,e,Ve({set:function(t){i.startValue=t}},xr(e))))&&(i.isWarp=!0),i.isWarp},dragControl:function(t,e){var i=e.datas,r=e.isRequest,n=e.distX,s=e.distY,o=i.targetInverseMatrix,a=i.prevMatrix,h=i.isWarp,u=i.startValue,c=i.poses,l=i.posIndexes,p=i.absolutePoses;if(!h)return!1;if(pr(e,"matrix3d"),cn(t,"warpable")){var d=l.map((function(t){return p[t]}));d.length>1&&d.push([(d[0][0]+d[1][0])/2,(d[0][1]+d[1][1])/2]);var f=gn(t,r,d.map((function(t){return[t[0]+n,t[1]+s]}))),g=f.horizontal,m=f.vertical;s-=g.offset,n-=m.offset}var _=mr({datas:i,distX:n,distY:s},!0),v=i.nextPoses.slice();if(l.forEach((function(t){v[t]=zt(v[t],_)})),!ti.every((function(t){return e=t.map((function(t){return c[t]})),i=t.map((function(t){return v[t]})),r=Un(e[0],e[1],e[2]),n=Un(i[0],i[1],i[2]),!(r>=(s=Math.PI)&&n<=s||r<=s&&n>=s);var e,i,r,n,s})))return!1;var y=ne(c[0],c[2],c[1],c[3],v[0],v[2],v[1],v[3]);if(!y.length)return!1;var b=fr(i,Xt(o,y,4),!0),x=Xt(Ft(a,4),b,4);i.prevMatrix=b;var E=Xt(u,b,4),T=dr(i,"matrix3d("+E.join(", ")+")","matrix3d("+b.join(", ")+")");return Sr(e,T),ji(t,"onWarp",Gi(t,e,{delta:x,matrix:E,dist:b,multiply:Xt,transform:T})),!0},dragControlEnd:function(t,e){var i=e.datas,r=e.isDrag;return!!i.isWarp&&(i.isWarp=!1,ji(t,"onWarpEnd",Ui(t,e,{})),r)}},Xn=ci("area-pieces"),zn=ci("area-piece"),Hn=ci("avoid");function Vn(t){var e=t.areaElement,i=t.state,r=i.width,n=i.height;!function(t,e){if(t.classList)t.classList.remove(e);else{var i=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(i," ")}}(e,Hn),e.style.cssText+="left: 0px; top: 0px; width: "+r+"px; height: "+n+"px"}function Yn(t){return t.createElement("div",{key:"area_pieces",className:Xn},t.createElement("div",{className:zn}),t.createElement("div",{className:zn}),t.createElement("div",{className:zn}),t.createElement("div",{className:zn}))}var Wn={name:"dragArea",props:{dragArea:Boolean,passDragArea:Boolean},events:{onClick:"click",onClickGroup:"clickGroup"},render:function(t,e){var i=t.props,r=i.target,s=i.dragArea,o=i.groupable,a=i.passDragArea,h=t.state,u=h.width,c=h.height,l=h.renderPoses,p=a?ci("area","pass"):ci("area");if(o)return[e.createElement("div",{key:"area",ref:n(t,"areaElement"),className:p}),Yn(e)];if(!r||!s)return[];var d=ne([0,0],[u,0],[0,c],[u,c],l[0],l[1],l[2],l[3]),f=d.length?yi(d,!0):"none";return[e.createElement("div",{key:"area",ref:n(t,"areaElement"),className:p,style:{top:"0px",left:"0px",width:u+"px",height:c+"px",transformOrigin:"0 0",transform:f}}),Yn(e)]},dragStart:function(t,e){var i=e.datas,r=e.clientX,n=e.clientY;if(!e.inputEvent)return!1;i.isDragArea=!1;var s,o,a=t.areaElement,h=t.state,u=h.moveableClientRect,c=h.renderPoses,l=h.rootMatrix,p=h.is3d,d=u.left,f=u.top,g=Si(c),m=g.left,_=g.top,v=g.width,y=g.height,b=$i(l,[r-d,n-f],p?4:3),x=b[0],E=b[1],T=[{left:m,top:_,width:v,height:(E-=_)-10},{left:m,top:_,width:(x-=m)-10,height:y},{left:m,top:_+E+10,width:v,height:y-E-10},{left:m+x+10,top:_,width:v-x-10,height:y}],S=[].slice.call(a.nextElementSibling.children);T.forEach((function(t,e){S[e].style.cssText="left: "+t.left+"px;top: "+t.top+"px; width: "+t.width+"px; height: "+t.height+"px;"})),o=Hn,(s=a).classList?s.classList.add(o):s.className+=" "+o,h.disableNativeEvent=!0},drag:function(t,e){var i=e.datas,r=e.inputEvent;if(this.enableNativeEvent(t),!r)return!1;i.isDragArea||(i.isDragArea=!0,Vn(t))},dragEnd:function(t,e){this.enableNativeEvent(t);var i=e.inputEvent,r=e.datas;if(!i)return!1;r.isDragArea||Vn(t)},dragGroupStart:function(t,e){return this.dragStart(t,e)},dragGroup:function(t,e){return this.drag(t,e)},dragGroupEnd:function(t,e){return this.dragEnd(t,e)},unset:function(t){Vn(t),t.state.disableNativeEvent=!1},enableNativeEvent:function(t){var e=t.state;e.disableNativeEvent&&requestAnimationFrame((function(){e.disableNativeEvent=!1}))}},$n=We("origin",{render:function(t,e){var i=t.props.zoom,r=t.state,n=r.beforeOrigin,s=r.rotation;return[e.createElement("div",{className:ci("control","origin"),style:Ri(s,i,n),key:"beforeOrigin"})]}});function qn(t){var e=t.scrollContainer;return[e.scrollLeft,e.scrollTop]}var Zn={name:"scrollable",canPinch:!0,props:{scrollable:Boolean,scrollContainer:Object,scrollThreshold:Number,getScrollPosition:Function},events:{onScroll:"scroll",onScrollGroup:"scrollGroup"},dragStart:function(t,e){var i=t.props.scrollContainer,r=void 0===i?t.getContainer():i,n=new we,s=er(r,!0);e.datas.dragScroll=n;var o=e.isControl?"controlGesto":"targetGesto",a=e.targets;n.on("scroll",(function(i){var r=i.container,n=i.direction,s=Gi(t,e,{scrollContainer:r,direction:n}),o=a?"onScrollGroup":"onScroll";a&&(s.targets=a),ji(t,o,s)})).on("move",(function(i){var r=i.offsetX,n=i.offsetY;t[o].scrollBy(r,n,e.inputEvent,!1)})),n.dragStart(e,{container:s})},checkScroll:function(t,e){var i=e.datas.dragScroll;if(i){var r=t.props,n=r.scrollContainer,s=void 0===n?t.getContainer():n,o=r.scrollThreshold,a=void 0===o?0:o,h=r.getScrollPosition,u=void 0===h?qn:h;return i.drag(e,{container:s,threshold:a,getScrollPosition:function(t){return u({scrollContainer:t.container,direction:t.direction})}}),!0}},drag:function(t,e){return this.checkScroll(t,e)},dragEnd:function(t,e){e.datas.dragScroll.dragEnd(),e.datas.dragScroll=null},dragControlStart:function(t,e){return this.dragStart(t,Ve(Ve({},e),{isControl:!0}))},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupStart:function(t,e){return this.dragStart(t,Ve(Ve({},e),{targets:t.props.targets}))},dragGroup:function(t,e){return this.drag(t,Ve(Ve({},e),{targets:t.props.targets}))},dragGroupEnd:function(t,e){return this.dragEnd(t,Ve(Ve({},e),{targets:t.props.targets}))},dragGroupControlStart:function(t,e){return this.dragStart(t,Ve(Ve({},e),{targets:t.props.targets,isControl:!0}))},dragGroupContro:function(t,e){return this.drag(t,Ve(Ve({},e),{targets:t.props.targets}))},dragGroupControEnd:function(t,e){return this.dragEnd(t,Ve(Ve({},e),{targets:t.props.targets}))}},Kn={name:"",props:{target:Object,dragTarget:Object,container:Object,portalContainer:Object,rootContainer:Object,zoom:Number,transformOrigin:Array,edge:Boolean,ables:Array,className:String,pinchThreshold:Number,pinchOutside:Boolean,triggerAblesSimultaneously:Boolean,checkInput:Boolean,cspNonce:String,translateZ:Number,props:Object},events:{}},Jn=We("padding",{render:function(t,e){var i=t.props;if(i.dragArea)return[];var r=i.padding||{},n=r.left,s=void 0===n?0:n,o=r.top,a=void 0===o?0:o,h=r.right,u=void 0===h?0:h,c=r.bottom,l=void 0===c?0:c,p=t.state,d=p.renderPoses,f=[p.pos1,p.pos2,p.pos3,p.pos4],g=[];return s>0&&g.push([0,2]),a>0&&g.push([0,1]),u>0&&g.push([1,3]),l>0&&g.push([2,3]),g.map((function(t,i){var r=t[0],n=t[1],s=ne([0,0],[100,0],[0,100],[100,100],f[r],f[n],d[r],d[n]);if(s.length)return e.createElement("div",{key:"padding"+i,className:ci("padding"),style:{transform:yi(s,!0)}})}))}}),Qn=["nw","ne","se","sw"];function ts(t,e){var i=t[0]+t[1],r=i>e?e/i:1;return t[0]*=r,t[1]=e-t[1]*r,t}var es=[1,2,5,6],is=[0,3,4,7],rs=[1,-1,-1,1],ns=[1,1,-1,-1];function ss(t,e,i,r,n,s,o,a,h){void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=r),void 0===h&&(h=n);var u=[],c=!1,l=t.map((function(t,l){var p=e[l],d=p.horizontal,f=p.vertical;if(f&&!c&&(c=!0,u.push("/")),c){var g=Math.max(0,1===f?t[1]-o:h-t[1]);return u.push(Ki(g,n,i)),g}return g=Math.max(0,1===d?t[0]-s:a-t[0]),u.push(Ki(g,r,i)),g}));return{styles:u,raws:l}}function os(t){for(var e=[0,0],i=[0,0],r=t.length,n=0;n<r;++n){var s=t[n];s.sub&&(s.horizontal&&(0===e[1]&&(e[0]=n),e[1]=n-e[0]+1,i[0]=n+1),s.vertical&&(0===i[1]&&(i[0]=n),i[1]=n-i[0]+1))}return{horizontalRange:e,verticalRange:i}}function as(t,e,i,r,n,s){var o,a,h,u;void 0===s&&(s=[0,0]);var c=t.indexOf("/"),l=(c>-1?t.slice(0,c):t).length,p=t.slice(0,l),d=t.slice(l+1),f=p[0],g=void 0===f?"0px":f,m=p[1],_=void 0===m?g:m,v=p[2],y=void 0===v?g:v,b=p[3],x=void 0===b?_:b,E=d[0],T=void 0===E?g:E,S=d[1],w=void 0===S?T:S,A=d[2],C=void 0===A?T:A,O=d[3],I=void 0===O?w:O,R=[g,_,y,x].map((function(t){return k(t,e)})),M=[T,w,C,I].map((function(t){return k(t,i)})),P=R.slice(),N=M.slice();o=ts([P[0],P[1]],e),P[0]=o[0],P[1]=o[1],a=ts([P[3],P[2]],e),P[3]=a[0],P[2]=a[1],h=ts([N[0],N[3]],i),N[0]=h[0],N[3]=h[1],u=ts([N[1],N[2]],i),N[1]=u[0],N[2]=u[1];var L=P.slice(0,Math.max(s[0],p.length)),D=N.slice(0,Math.max(s[1],d.length));return Ye(L.map((function(t,e){var s=Qn[e];return{horizontal:rs[e],vertical:0,pos:[r+t,n+(-1===ns[e]?i:0)],sub:!0,raw:R[e],direction:s}})),D.map((function(t,i){var s=Qn[i];return{horizontal:0,vertical:ns[i],pos:[r+(-1===rs[i]?e:0),n+t],sub:!0,raw:M[i],direction:s}})))}function hs(t,e,i,r,n){void 0===n&&(n=e.length);var s=os(t.slice(r)),o=s.horizontalRange,a=s.verticalRange,h=i-r,u=0;if(0===h)u=n;else if(h>0&&h<o[1])u=o[1]-h;else{if(!(h>=a[0]))return;u=a[0]+a[1]-h}t.splice(i,u),e.splice(i,u)}function us(t,e,i,r,n,s,o,a,h,u,c){void 0===u&&(u=0),void 0===c&&(c=0);var l=os(t.slice(i)),p=l.horizontalRange,d=l.verticalRange;if(r>-1)for(var f=1===rs[r]?s-u:a-s,g=p[1];g<=r;++g){var m=1===ns[g]?c:h,_=0;if(r===g?_=s:0===g?_=u+f:-1===rs[g]&&(_=a-(e[i][0]-u)),t.splice(i+g,0,{horizontal:rs[g],vertical:0,pos:[_,m]}),e.splice(i+g,0,[_,m]),0===g)break}else if(n>-1){var v=1===ns[n]?o-c:h-o;if(0===p[1]&&0===d[1]){var y=[u+v,c];t.push({horizontal:rs[0],vertical:0,pos:y}),e.push(y)}var b=d[0];for(g=d[1];g<=n&&(_=1===rs[g]?u:a,m=0,n===g?m=o:0===g?m=c+v:1===ns[g]?m=e[i+b][1]:-1===ns[g]&&(m=h-(e[i+b][1]-c)),t.push({horizontal:0,vertical:ns[g],pos:[_,m]}),e.push([_,m]),0!==g);++g);}}function cs(t,e){return void 0===e&&(e=t.map((function(t){return t.raw}))),{horizontals:t.map((function(t,i){return t.horizontal?e[i]:null})).filter((function(t){return null!=t})),verticals:t.map((function(t,i){return t.vertical?e[i]:null})).filter((function(t){return null!=t}))}}var ls=[[0,-1,"n"],[1,0,"e"]],ps=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function ds(t,e,i){var r=t.props.clipRelative,n=t.state,s=n.width,o=n.height,a=e,h=a.type,u=a.poses,c="rect"===h,l="circle"===h;if("polygon"===h)return i.map((function(t){return Ki(t[0],s,r)+" "+Ki(t[1],o,r)}));if(c||"inset"===h){var p=i[1][1],d=i[3][0],f=i[7][0],g=i[5][1];if(c)return[p,d,g,f].map((function(t){return t+"px"}));var m=[p,s-d,o-g,f].map((function(t,e){return Ki(t,e%2?s:o,r)}));if(i.length>8){var _=Ht(i[4],i[0]),v=_[0],y=_[1];m.push.apply(m,Ye(["round"],ss(i.slice(8),u.slice(8),r,v,y,f,p,d,g).styles))}return m}if(l||"ellipse"===h){var b=i[0],x=Ki(Math.abs(i[1][1]-b[1]),l?Math.sqrt((s*s+o*o)/2):o,r);return(m=l?[x]:[Ki(Math.abs(i[2][0]-b[0]),s,r),x]).push("at",Ki(b[0],s,r),Ki(b[1],o,r)),m}}function fs(t,e,i,r){var n=[r,(r+e)/2,e],s=[t,(t+i)/2,i];return ps.map((function(t){var e=t[0],i=t[1],r=t[2],o=n[e+1],a=s[i+1];return{vertical:Math.abs(i),horizontal:Math.abs(e),direction:r,pos:[o,a]}}))}function gs(t,e,i,r,n){var s,o,a,h,u,c,l,p=n;if(!p){var d=Xi(t),f=d.clipPath;p="none"!==f?f:d.clip}if(p&&"none"!==p&&"auto"!==p||(p=r)){var g=I(p),m=g.prefix,_=void 0===m?p:m,v=g.value,y=void 0===v?"":v,b="circle"===_,x=" ";if("polygon"===_){x=",";var E=(L=O(y||"0% 0%, 100% 0%, 100% 100%, 0% 100%")).map((function(t){var r=t.split(" "),n=r[0],s=r[1];return{vertical:1,horizontal:1,pos:[k(n,e),k(s,i)]}}));return{type:_,clipText:p,poses:E,splitter:x}}if(b||"ellipse"===_){var T,S,w,A="",M="",P=0,N=0,L=C(y);if(b)T=void 0===(s=L[0])?"50%":s,A=void 0===(o=L[2])?"50%":o,M=void 0===(a=L[3])?"50%":a,P=k(T,Math.sqrt((e*e+i*i)/2)),N=P;else S=void 0===(h=L[0])?"50%":h,w=void 0===(u=L[1])?"50%":u,A=void 0===(c=L[3])?"50%":c,M=void 0===(l=L[4])?"50%":l,P=k(S,e),N=k(w,i);var D=[k(A,e),k(M,i)];return E=Ye([{vertical:1,horizontal:1,pos:D,direction:"nesw"}],ls.slice(0,b?1:2).map((function(t){return{vertical:Math.abs(t[1]),horizontal:t[0],direction:t[2],sub:!0,pos:[D[0]+t[0]*P,D[1]+t[1]*N]}}))),{type:_,clipText:p,radiusX:P,radiusY:N,left:D[0]-P,top:D[1]-N,poses:E,splitter:x}}if("inset"===_){var B=(L=C(y||"0 0 0 0")).indexOf("round"),F=(B>-1?L.slice(0,B):L).length,G=L.slice(F+1),U=L.slice(0,F),j=U[0],X=U[1],z=void 0===X?j:X,H=U[2],V=void 0===H?j:H,Y=U[3],W=void 0===Y?z:Y,$=[j,V].map((function(t){return k(t,i)})),q=$[0],Z=$[1],K=[W,z].map((function(t){return k(t,e)})),J=K[0],Q=K[1],tt=e-Q,et=i-Z,it=as(G,tt-J,et-q,J,q);return{type:"inset",clipText:p,poses:E=Ye(fs(q,tt,et,J),it),top:q,left:J,right:tt,bottom:et,radius:G,splitter:x}}if("rect"===_){x=",";var rt=(L=O(y||"0px, "+e+"px, "+i+"px, 0px")).map((function(t){return R(t).value}));return{type:"rect",clipText:p,poses:E=fs(q=rt[0],Q=rt[1],Z=rt[2],J=rt[3]),top:q,right:Q,bottom:Z,left:J,values:L,splitter:x}}}}var ms={name:"clippable",props:{clippable:Boolean,defaultClipPath:String,customClipPath:String,clipRelative:Boolean,clipArea:Boolean,dragWithClip:Boolean,clipTargetBounds:Boolean,clipVerticalGuidelines:Array,clipHorizontalGuidelines:Array,clipSnapThreshold:Boolean},events:{onClipStart:"clipStart",onClip:"clip",onClipEnd:"clipEnd"},css:[".control.clip-control {\n    background: #6d6;\n    cursor: pointer;\n}\n.control.clip-control.clip-radius {\n    background: #d66;\n}\n.line.clip-line {\n    background: #6e6;\n    cursor: move;\n    z-index: 1;\n}\n.clip-area {\n    position: absolute;\n    top: 0;\n    left: 0;\n}\n.clip-ellipse {\n    position: absolute;\n    cursor: move;\n    border: 1px solid #6d6;\n    border: var(--zoompx) solid #6d6;\n    border-radius: 50%;\n    transform-origin: 0px 0px;\n}",":host {\n    --bounds-color: #d66;\n}",".guideline {\n    pointer-events: none;\n    z-index: 2;\n}",".line.guideline.bounds {\n    background: #d66;\n    background: var(--bounds-color);\n}"],render:function(t,e){var i=t.props,r=i.customClipPath,n=i.defaultClipPath,s=i.clipArea,o=i.zoom,a=t.state,h=a.target,u=a.width,c=a.height,l=a.allMatrix,p=a.is3d,d=a.left,f=a.top,g=a.pos1,m=a.pos2,_=a.pos3,v=a.pos4,y=a.clipPathState,b=a.snapBoundInfos;if(!h)return[];var x=gs(h,u,c,n||"inset",y||r);if(!x)return[];var E=p?4:3,T=x.type,S=x.poses.map((function(t){var e=Ei(l,t.pos,E);return[e[0]-d,e[1]-f]})),w=[],A=[],C="rect"===T,O="inset"===T,I="polygon"===T;if(C||O||I){var R=O?S.slice(0,8):S;A=R.map((function(t,i){var r=0===i?R[R.length-1]:R[i-1],n=G(r,t),s=Oi(r,t);return e.createElement("div",{key:"clipLine"+i,className:ci("line","clip-line","snap-control"),"data-clip-index":i,style:{width:s+"px",transform:"translate("+r[0]+"px, "+r[1]+"px) rotate("+n+"rad) scaleY("+o+")"}})}))}if(w=S.map((function(t,i){return e.createElement("div",{key:"clipControl"+i,className:ci("control","clip-control","snap-control"),"data-clip-index":i,style:{transform:"translate("+t[0]+"px, "+t[1]+"px) scale("+o+")"}})})),O&&w.push.apply(w,S.slice(8).map((function(t,i){return e.createElement("div",{key:"clipRadiusControl"+i,className:ci("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+i,style:{transform:"translate("+t[0]+"px, "+t[1]+"px) scale("+o+")"}})}))),"circle"===T||"ellipse"===T){var M=x.left,P=x.top,N=x.radiusX,L=x.radiusY,D=Ht(Ei(l,[M,P],E),Ei(l,[0,0],E)),k=D[0],B=D[1],F="none";if(!s){for(var U=Math.max(10,N/5,L/5),j=[],X=0;X<=U;++X){var z=2*Math.PI/U*X;j.push([N+(N-o)*Math.cos(z),L+(L-o)*Math.sin(z)])}j.push([N,-2]),j.push([-2,-2]),j.push([-2,2*L+2]),j.push([2*N+2,2*L+2]),j.push([2*N+2,-2]),j.push([N,-2]),F="polygon("+j.map((function(t){return t[0]+"px "+t[1]+"px"})).join(", ")+")"}w.push(e.createElement("div",{key:"clipEllipse",className:ci("clip-ellipse","snap-control"),style:{width:2*N+"px",height:2*L+"px",clipPath:F,transform:"translate("+(-d+k)+"px, "+(-f+B)+"px) "+yi(l)}}))}if(s){var H=Si(Ye([g,m,_,v],S)),V=H.width,Y=H.height,W=H.left,$=H.top;(I||C||O)&&(j=O?S.slice(0,8):S,w.push(e.createElement("div",{key:"clipArea",className:ci("clip-area","snap-control"),style:{width:V+"px",height:Y+"px",transform:"translate("+W+"px, "+$+"px)",clipPath:"polygon("+j.map((function(t){return t[0]-W+"px "+(t[1]-$)+"px"})).join(", ")+")"}})))}return b&&["vertical","horizontal"].forEach((function(t){var i=b[t],r="horizontal"===t;i.isSnap&&A.push.apply(A,i.snap.posInfos.map((function(i,n){var s=i.pos,a=Ht(Ei(l,r?[0,s]:[s,0],E),[d,f]),h=Ht(Ei(l,r?[u,s]:[s,c],E),[d,f]);return On(e,"",a,h,o,"clip"+t+"snap"+n,"guideline")}))),i.isBound&&A.push.apply(A,i.bounds.map((function(i,n){var s=i.pos,a=Ht(Ei(l,r?[0,s]:[s,0],E),[d,f]),h=Ht(Ei(l,r?[u,s]:[s,c],E),[d,f]);return On(e,"",a,h,o,"clip"+t+"bounds"+n,"guideline","bounds","bold")})))})),Ye(w,A)},dragControlCondition:function(t,e){return e.inputEvent&&(e.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(t,e){var i=t.props.dragWithClip;return!(void 0===i||i)&&this.dragControlStart(t,e)},drag:function(t,e){return this.dragControl(t,e)},dragEnd:function(t,e){return this.dragControlEnd(t,e)},dragControlStart:function(t,e){var i=t.state,r=t.props,n=r.defaultClipPath,s=r.customClipPath,o=i.target,a=i.width,h=i.height,u=e.inputEvent?e.inputEvent.target:null,c=u?u.getAttribute("class"):"",l=e.datas,p=gs(o,a,h,n||"inset",s);if(!p)return!1;var d=p.clipText;return!1===ji(t,"onClipStart",Gi(t,e,{clipType:p.type,clipStyle:d,poses:p.poses.map((function(t){return t.pos}))}))?(l.isClipStart=!1,!1):(l.isControl=c.indexOf("clip-control")>-1,l.isLine=c.indexOf("clip-line")>-1,l.isArea=c.indexOf("clip-area")>-1||c.indexOf("clip-ellipse")>-1,l.index=u?parseInt(u.getAttribute("data-clip-index"),10):-1,l.clipPath=p,l.isClipStart=!0,i.clipPathState=d,lr(t,e),!0)},dragControl:function(t,e){var i=e.datas,r=e.originalDatas;if(!i.isClipStart)return!1;var n=r&&r.draggable||{},s=i,o=s.isControl,a=s.isLine,h=s.isArea,u=s.index,c=s.clipPath;if(!c)return!1;var l=n.isDrag?n.prevDist:mr(e),p=l[0],d=l[1],f=t.props,g=t.state,m=g.width,_=g.height,v=!h&&!o&&!a,y=c.type,b=c.poses,x=c.splitter,E=b.map((function(t){return t.pos}));v&&(p=-p,d=-d);var T=!o||"nesw"===b[u].direction,S="inset"===y||"rect"===y,w=b.map((function(){return[0,0]}));if(o&&!T){var A=b[u],C=A.horizontal,O=A.vertical,I=[p*Math.abs(C),d*Math.abs(O)];w=function(t,e,i,r){var n=t[e],s=n.direction,o=n.sub,a=t.map((function(){return[0,0]})),h=s?s.split(""):[];if(r&&e<8){var u=h.filter((function(t){return"w"===t||"e"===t}))[0],c=h.filter((function(t){return"n"===t||"s"===t}))[0];a[e]=i,t.forEach((function(t,e){var r=t.direction;r&&(r.indexOf(u)>-1&&(a[e][0]=i[0]),r.indexOf(c)>-1&&(a[e][1]=i[1]))})),u&&(a[1][0]=i[0]/2,a[5][0]=i[0]/2),c&&(a[3][1]=i[1]/2,a[7][1]=i[1]/2)}else s&&!o?h.forEach((function(e){var r="n"===e||"s"===e;t.forEach((function(t,n){var s=t.direction,o=t.horizontal,h=t.vertical;s&&-1!==s.indexOf(e)&&(a[n]=[r||!o?0:i[0],r&&h?i[1]:0])}))})):a[e]=i;return a}(b,u,I,S)}else T&&(w=E.map((function(){return[p,d]})));var R=E.map((function(t,e){return zt(t,w[e])})),M=Ye(R);g.snapBoundInfos=null;var P="circle"===c.type,N="ellipse"===c.type;if(P||N){var L=Si(R),D=Math.abs(L.bottom-L.top),B=Math.abs(N?L.right-L.left:D),F=R[0][1]+D,G=R[0][0]-B,U=R[0][0]+B;P&&(M.push([U,L.bottom]),w.push([1,0])),M.push([L.left,F]),w.push([0,1]),M.push([G,L.bottom]),w.push([1,0])}var j=Pr((f.clipHorizontalGuidelines||[]).map((function(t){return k(""+t,_)})),(f.clipVerticalGuidelines||[]).map((function(t){return k(""+t,m)})),m,_),X=[],z=[];if(P||N)X=[M[4][0],M[2][0]],z=[M[1][1],M[3][1]];else if(S){var H=[M[0],M[2],M[4],M[6]],V=[w[0],w[2],w[4],w[6]];X=H.filter((function(t,e){return V[e][0]})).map((function(t){return t[0]})),z=H.filter((function(t,e){return V[e][1]})).map((function(t){return t[1]}))}else X=M.filter((function(t,e){return w[e][0]})).map((function(t){return t[0]})),z=M.filter((function(t,e){return w[e][1]})).map((function(t){return t[1]}));for(var Y=function(t){var e=mn(j,f.clipTargetBounds&&{left:0,top:0,right:m,bottom:_},X,z,{snapThreshold:5}),i=e.horizontal,r=e.vertical,n=i.offset,s=r.offset;if(!N&&!P||0!==w[0][0]||0!==w[0][1])return M.forEach((function(t,e){var i=w[e];i[0]&&(t[0]-=s),i[1]&&(t[1]-=n)})),"break";var o=Si(R),a=o.bottom-o.top,h=N?o.right-o.left:a;h-=r.isBound?Math.abs(s):0===r.snapIndex?-s:s,a-=i.isBound?Math.abs(n):0===i.snapIndex?-n:n,P&&(h=a=Ur(r,i)>0?a:h);var u=M[0];M[1][1]=u[1]-a,M[2][0]=u[0]+h,M[3][1]=u[1]+a,M[4][0]=u[0]-h},W=0;W<2&&"break"!==Y();++W);var $=ds(t,c,R),q=y+"("+$.join(x)+")";return g.clipPathState=q,P||N?(X=[M[4][0],M[2][0]],z=[M[1][1],M[3][1]]):S?(H=[M[0],M[2],M[4],M[6]],X=H.map((function(t){return t[0]})),z=H.map((function(t){return t[1]}))):(X=M.map((function(t){return t[0]})),z=M.map((function(t){return t[1]}))),g.snapBoundInfos=mn(j,f.clipTargetBounds&&{left:0,top:0,right:m,bottom:_},X,z,{snapThreshold:1}),ji(t,"onClip",Gi(t,e,{clipEventType:"changed",clipType:y,poses:R,clipStyle:q,clipStyles:$,distX:p,distY:d})),!0},dragControlEnd:function(t,e){this.unset(t);var i=e.isDrag,r=e.datas,n=e.isDouble,s=r.isLine,o=r.isClipStart,a=r.isControl;return!!o&&(ji(t,"onClipEnd",Ui(t,e,{})),n&&(a?function(t,e){var i=e.datas,r=i.clipPath,n=i.index,s=r,o=s.type,a=s.poses,h=s.splitter,u=a.map((function(t){return t.pos})),c=u.length;if("polygon"===o)a.splice(n,1),u.splice(n,1);else{if("inset"!==o)return;if(n<8)return;if(hs(a,u,n,8,c),c===a.length)return}var l=ds(t,r,u);ji(t,"onClip",Gi(t,e,{clipEventType:"removed",clipType:o,poses:u,clipStyles:l,clipStyle:o+"("+l.join(h)+")",distX:0,distY:0}))}(t,e):s&&function(t,e){var i=cr(t,e),r=i[0],n=i[1],s=e.datas,o=s.clipPath,a=s.index,h=o,u=h.type,c=h.poses,l=h.splitter,p=c.map((function(t){return t.pos}));if("polygon"===u)p.splice(a,0,[r,n]);else{if("inset"!==u)return;var d=es.indexOf(a),f=is.indexOf(a),g=c.length;if(us(c,p,8,d,f,r,n,p[4][0],p[4][1],p[0][0],p[0][1]),g===c.length)return}var m=ds(t,o,p);ji(t,"onClip",Gi(t,e,{clipEventType:"added",clipType:u,poses:p,clipStyles:m,clipStyle:u+"("+m.join(l)+")",distX:0,distY:0}))}(t,e)),n||i)},unset:function(t){t.state.clipPathState="",t.state.snapBoundInfos=null}},_s={name:"originDraggable",props:{originDraggable:Boolean,originRelative:Boolean},events:{onDragOriginStart:"dragOriginStart",onDragOrigin:"dragOrigin",onDragOriginEnd:"dragOriginEnd"},css:[":host[data-able-origindraggable] .control.origin {\n    pointer-events: auto;\n}"],dragControlCondition:function(t,e){return e.isRequest?"originDraggable"===e.requestAble:H(e.inputEvent.target,ci("origin"))},dragControlStart:function(t,e){var i=e.datas;lr(t,e);var r=Gi(t,e,{dragStart:An.dragStart(t,(new or).dragStart([0,0],e))}),n=ji(t,"onDragOriginStart",r);return i.startOrigin=t.state.transformOrigin,i.startTargetOrigin=t.state.targetOrigin,i.prevOrigin=[0,0],i.isDragOrigin=!0,!1===n?(i.isDragOrigin=!1,!1):r},dragControl:function(t,e){var i=e.datas,r=e.isPinch,n=e.isRequest;if(!i.isDragOrigin)return!1;var s=mr(e),o=s[0],a=s[1],h=t.state,u=h.width,c=h.height,l=h.offsetMatrix,p=h.targetMatrix,d=h.is3d,f=t.props.originRelative,g=void 0===f||f,m=d?4:3,_=[o,a];if(n){var v=e.distOrigin;(v[0]||v[1])&&(_=v)}var y=zt(i.startOrigin,_),b=zt(i.startTargetOrigin,_),x=Ht(_,i.prevOrigin),E=br(l,p,y,m),T=t.getRect(),S=Si(Ti(E,u,c,m)),w=[T.left-S.left,T.top-S.top];i.prevOrigin=_;var A=Gi(t,e,{width:u,height:c,origin:y,dist:_,delta:x,transformOrigin:[Ki(b[0],u,g),Ki(b[1],c,g)].join(" "),drag:An.drag(t,sr(e,t.state,w,!!r,!1))});return ji(t,"onDragOrigin",A),A},dragControlEnd:function(t,e){return!!e.datas.isDragOrigin&&(ji(t,"onDragOriginEnd",Ui(t,e,{})),!0)},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragGroupControlStart:function(t,e){return!!this.dragControlStart(t,e)},dragGroupControl:function(t,e){var i=this.dragControl(t,e);return!!i&&(t.transformOrigin=i.transformOrigin,!0)},request:function(t){var e={},i=t.getRect(),r=0,n=0,s=i.transformOrigin,o=[0,0];return{isControl:!0,requestStart:function(){return{datas:e}},request:function(t){return"deltaOrigin"in t?(o[0]+=t.deltaOrigin[0],o[1]+=t.deltaOrigin[1]):"origin"in t?(o[0]=t.origin[0]-s[0],o[1]=t.origin[1]-s[1]):("x"in t?r=t.x-i.left:"deltaX"in t&&(r+=t.deltaX),"y"in t?n=t.y-i.top:"deltaY"in t&&(n+=t.deltaY)),{datas:e,distX:r,distY:n,distOrigin:o}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function vs(t,e,i,r,n){var s;if(void 0===r&&(r=[0,0]),n)s=n;else{var o=Xi(t);s=o&&o.borderRadius||""}return as(!s||!n&&"0px"===s?[]:C(s),e,i,0,0,r)}function ys(t,e,i,r,n,s){var o=t.state,a=o.width,h=o.height,u=ss(s,n,t.props.roundRelative,a,h),c=u.raws,l=u.styles,p=cs(n,c),d=p.horizontals,f=p.verticals,g=l.join(" ");o.borderRadiusState=g,ji(t,"onRound",Gi(t,e,{horizontals:d,verticals:f,borderRadius:g,width:a,height:h,delta:r,dist:i}))}var bs={name:"roundable",props:{roundable:Boolean,roundRelative:Boolean,minRoundControls:Array,maxRoundControls:Array,roundClickable:Boolean},events:{onRoundStart:"roundStart",onRound:"round",onRoundEnd:"roundEnd"},css:[".control.border-radius {\n    background: #d66;\n    cursor: pointer;\n}",":host[data-able-roundable] .line.direction {\n    cursor: pointer;\n}"],render:function(t,e){var i=t.state,r=i.target,n=i.width,s=i.height,o=i.allMatrix,a=i.is3d,h=i.left,u=i.top,c=i.borderRadiusState,l=t.props,p=l.minRoundControls,d=void 0===p?[0,0]:p,f=l.maxRoundControls,g=void 0===f?[4,4]:f,m=l.zoom;if(!r)return null;var _=a?4:3,v=vs(r,n,s,d,c);if(!v)return null;var y=0,b=0;return v.map((function(t,i){b+=Math.abs(t.horizontal),y+=Math.abs(t.vertical);var r=Ht(Ei(o,t.pos,_),[h,u]),n=t.vertical?y<=g[1]:b<=g[0];return e.createElement("div",{key:"borderRadiusControl"+i,className:ci("control","border-radius"),"data-radius-index":i,style:{display:n?"block":"none",transform:"translate("+r[0]+"px, "+r[1]+"px) scale("+m+")"}})}))},dragControlCondition:function(t,e){if(!e.inputEvent||e.isRequest)return!1;var i=e.inputEvent.target.getAttribute("class")||"";return i.indexOf("border-radius")>-1||i.indexOf("moveable-line")>-1&&i.indexOf("moveable-direction")>-1},dragControlStart:function(t,e){var i=e.inputEvent,r=e.datas,n=i.target,s=n.getAttribute("class")||"",o=s.indexOf("border-radius")>-1,a=s.indexOf("moveable-line")>-1&&s.indexOf("moveable-direction")>-1,h=o?parseInt(n.getAttribute("data-radius-index"),10):-1,u=a?parseInt(n.getAttribute("data-line-index"),10):-1;if(!o&&!a)return!1;if(!1===ji(t,"onRoundStart",Gi(t,e,{})))return!1;r.lineIndex=u,r.controlIndex=h,r.isControl=o,r.isLine=a,lr(t,e);var c=t.props,l=c.roundRelative,p=c.minRoundControls,d=void 0===p?[0,0]:p,f=t.state,g=f.target,m=f.width,_=f.height;r.isRound=!0,r.prevDist=[0,0];var v=vs(g,m,_,d)||[];return r.controlPoses=v,f.borderRadiusState=ss(v.map((function(t){return t.pos})),v,l,m,_).styles.join(" "),!0},dragControl:function(t,e){var i=e.datas;if(!i.isRound||!i.isControl||!i.controlPoses.length)return!1;var r=i.controlIndex,n=i.controlPoses,s=mr(e),o=s[0],a=s[1],h=[o,a],u=Ht(h,i.prevDist),c=t.props.maxRoundControls,l=void 0===c?[4,4]:c,p=t.state,d=p.width,f=p.height,g=n[r],m=g.vertical,_=g.horizontal,v=n.map((function(t){var e=t.horizontal,i=t.vertical,r=[e*_*h[0],i*m*h[1]];if(e){if(1===l[0])return r;if(l[0]<4&&e!==_)return r}else{if(0===l[1])return r[1]=i*_*h[0]/d*f,r;if(m){if(1===l[1])return r;if(l[1]<4&&i!==m)return r}}return[0,0]}));v[r]=h;var y=n.map((function(t,e){return zt(t.pos,v[e])}));return i.prevDist=[o,a],ys(t,e,h,u,n,y),!0},dragControlEnd:function(t,e){var i=t.state;i.borderRadiusState="";var r=e.datas,n=e.isDouble;if(!r.isRound)return!1;var s=i.width,o=i.height,a=r.isControl,h=r.controlIndex,u=r.isLine,c=r.lineIndex,l=r.controlPoses,p=l.map((function(t){return t.pos})),d=p.length,f=t.props.roundClickable;if(n&&(void 0===f||f)){if(a)hs(l,p,h,0);else if(u){var g=cr(t,e);!function(t,e,i,r,n,s,o){var a=cs(t),h=a.horizontals,u=a.verticals,c=h.length,l=u.length,p=-1,d=-1;0===i?0===c?p=0:1===c&&(p=1):3===i&&(c<=2?p=2:c<=3&&(p=3)),2===i?0===l?d=0:l<4&&(d=3):1===i&&(l<=1?d=1:l<=2&&(d=2)),us(t,e,0,p,d,r,n,s,o)}(l,p,c,g[0],g[1],s,o)}d!==l.length&&ys(t,e,[0,0],[0,0],l,p)}return ji(t,"onRoundEnd",Ui(t,e,{})),i.borderRadiusState="",!0},unset:function(t){t.state.borderRadiusState=""}},xs={isPinch:!0,name:"beforeRenderable",props:{},events:{onBeforeRenderStart:"beforeRenderStart",onBeforeRender:"beforeRender",onBeforeRenderEnd:"beforeRenderEnd",onBeforeRenderGroupStart:"beforeRenderGroupStart",onBeforeRenderGroup:"beforeRenderGroup",onBeforeRenderGroupEnd:"beforeRenderGroupEnd"},setTransform:function(t,e){var i=t.state,r=i.is3d,n=i.target,s=i.targetMatrix,o=null==n?void 0:n.style.transform,a=r?"matrix3d("+s.join(",")+")":"matrix("+Vt(s,!0)+")";e.datas.startTransforms=o&&"none"!==o?C(o):[a]},resetTransform:function(t,e){e.datas.nextTransforms=e.datas.startTransforms,e.datas.nextTransformAppendedIndexes=[]},fillDragStartParams:function(t,e){return Gi(t,e,{setTransform:function(t){e.datas.startTransforms=x(t)?t:C(t)},isPinch:!!e.isPinch})},fillDragParams:function(t,e){return Gi(t,e,{isPinch:!!e.isPinch})},dragStart:function(t,e){this.setTransform(t,e),ji(t,"onBeforeRenderStart",this.fillDragStartParams(t,e))},drag:function(t,e){this.resetTransform(t,e),ji(t,"onBeforeRender",Gi(t,e,{isPinch:!!e.isPinch}))},dragEnd:function(t,e){ji(t,"onBeforeRenderEnd",Gi(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag}))},dragGroupStart:function(t,e){var i=this;this.dragStart(t,e);var r=ar(t,"beforeRenderable",e),n=t.moveables,s=r.map((function(t,e){var r=n[e];return i.setTransform(r,t),i.fillDragStartParams(r,t)}));ji(t,"onBeforeRenderGroupStart",Gi(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,setTransform:function(){},events:s}))},dragGroup:function(t,e){var i=this;this.drag(t,e);var r=ar(t,"beforeRenderable",e),n=t.moveables,s=r.map((function(t,e){var r=n[e];return i.resetTransform(r,t),i.fillDragParams(r,t)}));ji(t,"onBeforeRenderGroup",Gi(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,events:s}))},dragGroupEnd:function(t,e){this.dragEnd(t,e),ji(t,"onBeforeRenderGroupEnd",Gi(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets}))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)}},Es={name:"renderable",props:{},events:{onRenderStart:"renderStart",onRender:"render",onRenderEnd:"renderEnd",onRenderGroupStart:"renderGroupStart",onRenderGroup:"renderGroup",onRenderGroupEnd:"renderGroupEnd"},dragStart:function(t,e){ji(t,"onRenderStart",Gi(t,e,{isPinch:!!e.isPinch}))},drag:function(t,e){ji(t,"onRender",Gi(t,e,{isPinch:!!e.isPinch}))},dragEnd:function(t,e){ji(t,"onRenderEnd",Gi(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag}))},dragGroupStart:function(t,e){ji(t,"onRenderGroupStart",Gi(t,e,{isPinch:!!e.isPinch,targets:t.props.targets}))},dragGroup:function(t,e){ji(t,"onRenderGroup",Gi(t,e,{isPinch:!!e.isPinch,targets:t.props.targets}))},dragGroupEnd:function(t,e){ji(t,"onRenderGroupEnd",Gi(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets}))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)}};function Ts(t,e,i,r,n,s,o){var a="Start"===n,h=t.state.target,u=s.isRequest;if(!h||a&&r.indexOf("Control")>-1&&!u&&t.areaElement===s.inputEvent.target)return!1;var c=""+i+r+n,l=""+i+r+"Condition",p="End"===n,d=n.indexOf("After")>-1,f=a&&(!t.targetGesto||!t.controlGesto||!t.targetGesto.isFlag()||!t.controlGesto.isFlag());f&&t.updateRect(n,!0,!1),""!==n||d||u||qi(t.state,s);var g=Ye([xs],t[e].slice(),[Es]);if(u){var m=s.requestAble;g.some((function(t){return t.name===m}))||g.push.apply(g,t.props.ables.filter((function(t){return t.name===m})))}if(!g.length)return!1;var _=g.filter((function(t){return t[c]})),v=s.datas;f&&_.forEach((function(e){e.unset&&e.unset(t)}));var y,b=s.inputEvent;p&&b&&(y=document.elementFromPoint(s.clientX,s.clientY)||b.target);var x=_.filter((function(e){var i=e.name,r=v[i]||(v[i]={});return a&&(r.isEventStart=!e[l]||e[l](t,s)),!!r.isEventStart&&e[c](t,Ve(Ve({},s),{datas:r,originalDatas:v,inputTarget:y}))})).length,E=a&&_.length&&!x;return(p||E)&&(t.state.gesto=null,t.moveables&&t.moveables.forEach((function(t){t.state.gesto=null}))),f&&E&&_.forEach((function(e){e.unset&&e.unset(t)})),!t.isUnmounted&&!E&&((!a&&x&&!o||p)&&(t.updateRect(n,!0,!1),t.forceUpdate()),a||p||d||!x||o||Ts(t,e,i,r,n+"After",s),!0)}function Ss(t,e,i){var r=t.controlBox.getElement(),n=[];n.push(r),t.props.dragArea&&!t.props.dragTarget||n.push(e);var s=function(e){var i=e.inputEvent.target;return i===t.areaElement||!t.isMoveableElement(i)||H(i,"moveable-area")||H(i,"moveable-padding")};return ws(t,n,"targetAbles",i,{dragStart:s,pinchStart:s})}function ws(t,e,i,r,n){void 0===n&&(n={});var s=t.props,o=s.pinchOutside,a=s.pinchThreshold,h={container:window,pinchThreshold:a,pinchOutside:o},u=new ke(e,h);return["drag","pinch"].forEach((function(e){["Start","","End"].forEach((function(s){u.on(""+e+s,(function(o){var a=o.eventType;(!n[a]||n[a](o))&&Ts(t,i,e,r,s,o)||o.stop()}))}))})),u}var As=function(){function t(t,e,i){var r=this;this.target=t,this.moveable=e,this.eventName=i,this.ables=[],this.onEvent=function(t){var e=r.eventName,i=r.moveable;i.state.disableNativeEvent||r.ables.forEach((function(r){r[e](i,{inputEvent:t})}))},this.target.addEventListener(this.eventName.toLowerCase(),this.onEvent)}var e=t.prototype;return e.setAbles=function(t){this.ables=t},e.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this.onEvent),this.target=null,this.moveable=null},t}(),Cs=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=Ve({container:null,target:null,gesto:null,renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1},Ni(null)),e.enabledAbles=[],e.targetAbles=[],e.controlAbles=[],e.rotation=0,e.scale=[1,1],e.isUnmounted=!1,e.events={mouseEnter:null,mouseLeave:null},e.onPreventClick=function(t){t.stopPropagation(),Y(window,"click",e.onPreventClick,!0)},e}He(e,t);var i=e.prototype;return i.render=function(){var t=this.props,e=this.state,i=t.edge,r=t.parentPosition,s=t.className,o=t.target,a=t.zoom,h=t.cspNonce,u=t.translateZ,c=t.cssStyled,l=t.portalContainer;this.checkUpdate(),this.updateRenderPoses();var p=r||{left:0,top:0},d=p.left,f=p.top,g=e.left,m=e.top,_=e.target,v=e.direction,y=e.renderPoses,b=t.targets,x=(b&&b.length||o)&&_,E=this.isDragging(),T={},S={createElement:st};return this.getEnabledAbles().forEach((function(t){T["data-able-"+t.name.toLowerCase()]=!0})),st(c,Ve({cspNonce:h,ref:n(this,"controlBox"),className:ci("control-box",-1===v?"reverse":"",E?"dragging":"")+" "+s},T,{onClick:this.onPreventClick,portalContainer:l,style:{position:"absolute",display:x?"block":"none",transform:"translate3d("+(g-d)+"px, "+(m-f)+"px, "+u+")","--zoom":a,"--zoompx":a+"px"}}),this.renderAbles(),On(S,i?"n":"",y[0],y[1],a,0),On(S,i?"e":"",y[1],y[3],a,1),On(S,i?"w":"",y[0],y[2],a,2),On(S,i?"s":"",y[2],y[3],a,3))},i.componentDidMount=function(){this.controlBox.getElement();var t=this.props,e=t.parentMoveable,i=t.container,r=t.wrapperMoveable;this.updateEvent(t),this.updateNativeEvents(t),i||e||r||this.updateRect("",!1,!0),this.updateCheckInput()},i.componentDidUpdate=function(t){this.updateNativeEvents(t),this.updateEvent(t),this.updateCheckInput()},i.componentWillUnmount=function(){this.isUnmounted=!0,Fi(this,"targetGesto"),Fi(this,"controlGesto");var t=this.events;for(var e in t){var i=t[e];i&&i.destroy()}},i.getContainer=function(){var t=this.props,e=t.parentMoveable,i=t.wrapperMoveable;return t.container||i&&i.getContainer()||e&&e.getContainer()||this.controlBox.getElement().parentElement},i.isMoveableElement=function(t){return t&&(t.getAttribute("class")||"").indexOf(Je)>-1},i.dragStart=function(t){return this.targetGesto&&this.targetGesto.triggerDragStart(t),this},i.hitTest=function(t){var e,i=this.state,r=i.target,n=i.pos1,s=i.pos2,o=i.pos3,a=i.pos4,h=i.targetClientRect;if(!r)return 0;if(t instanceof Element){var u=t.getBoundingClientRect();e={left:u.left,top:u.top,width:u.width,height:u.height}}else e=Ve({width:0,height:0},t);var c=e.left,l=e.top,p=e.width,d=e.height,f=he([n,s,a,o],h),g=function(t,e){var i=function(t,e){var i=t.slice(),r=e.slice();-1===U(i)&&i.reverse(),-1===U(r)&&r.reverse();var n=fe(i),s=fe(r),o=n.map((function(t){return le(t[0],t[1])})),a=s.map((function(t){return le(t[0],t[1])})),h=[];o.forEach((function(t,e){var i=n[e],o=[];a.forEach((function(r,n){var a=de(pe(t,r),[i,s[n]]);o.push.apply(o,a.map((function(t){return{index1:e,index2:n,pos:t}})))})),o.sort((function(t,e){return j(i[0],t.pos)-j(i[0],e.pos)})),h.push.apply(h,o),ce(i[1],r)&&h.push({index1:e,index2:-1,pos:i[1]})})),s.forEach((function(t,e){if(ce(t[1],i)){var r=!1,n=N(h,(function(t){return t.index2===e?(r=!0,!1):!!r}));-1===n&&(r=!1,n=N(h,(function(t){var i=t.index1,n=t.index2;return-1===i&&n+1===e?(r=!0,!1):!!r}))),-1===n?h.push({index1:-1,index2:e,pos:t[1]}):h.splice(n,0,{index1:-1,index2:e,pos:t[1]})}}));var u=h.map((function(t){return t.pos})),c={};return u.filter((function(t){var e=t[0]+"x"+t[1];return!c[e]&&(c[e]=!0,!0)}))}(t,e);return ae(i)}(f,[[c,l],[c+p,l],[c+p,l+d],[c,l+d]]),m=ae(f);return g&&m?Math.min(100,g/m*100):0},i.isInside=function(t,e){var i=this.state,r=i.target,n=i.pos1,s=i.pos2,o=i.pos3,a=i.pos4,h=i.targetClientRect;return!!r&&ce([t,e],he([n,s,a,o],h))},i.updateRect=function(t,e,i){void 0===i&&(i=!0);var r=this.props,n=r.parentMoveable,s=this.state.target||this.props.target,o=this.getContainer(),a=n?n.props.rootContainer:r.rootContainer;this.updateState(Ni(this.controlBox&&this.controlBox.getElement(),s,o,o,a||o),!n&&i)},i.isTargetChanged=function(t,e){var i=this.props,r=i.dragTarget||i.target,n=t.dragTarget||t.target,s=i.dragArea,o=t.dragArea;return!s&&n!==r||(e||s)&&o!==s},i.updateNativeEvents=function(t){var e=this,i=this.props.dragArea?this.areaElement:this.state.target,r=this.events,n=D(r);if(this.isTargetChanged(t))for(var s in r){var o=r[s];o&&o.destroy(),r[s]=null}if(i){var a=this.enabledAbles;n.forEach((function(t){var n=zi(a,[t]),s=n.length>0,o=r[t];s?(o||(o=new As(i,e,t),r[t]=o),o.setAbles(n)):o&&(o.destroy(),r[t]=null)}))}},i.updateEvent=function(t){var e=this.controlBox.getElement(),i=this.targetAbles.length,r=this.controlAbles.length,n=this.props,s=n.dragTarget||n.target,o=this.isTargetChanged(t,!0),a=!i&&this.targetGesto||o;a&&(Fi(this,"targetGesto"),this.updateState({gesto:null})),r||Fi(this,"controlGesto"),s&&i&&!this.targetGesto&&(this.targetGesto=Ss(this,s,"")),!this.controlGesto&&r&&(this.controlGesto=ws(this,e,"controlAbles","Control")),a&&this.unsetAbles()},i.isDragging=function(){return!!this.targetGesto&&this.targetGesto.isFlag()||!!this.controlGesto&&this.controlGesto.isFlag()},i.updateTarget=function(t){this.updateRect(t,!0)},i.getRect=function(){var t=this.state,e=Bi(this.state),i=e[0],r=e[1],n=e[2],s=e[3],o=Si(e),a=t.width,h=t.height,u=o.width,c=o.height,l=o.left,p=o.top,d=[t.left,t.top],f=zt(d,t.origin);return{width:u,height:c,left:l,top:p,pos1:i,pos2:r,pos3:n,pos4:s,offsetWidth:a,offsetHeight:h,beforeOrigin:zt(d,t.beforeOrigin),origin:f,transformOrigin:t.transformOrigin,rotation:this.getRotation()}},i.getManager=function(){return this},i.getRotation=function(){var t,e,i,r,n=this.state;return t=n.pos1,e=n.pos2,i=n.direction,r=G(t,e)/Math.PI*180,(r=i>=0?r:180-r)>=0?r:360+r},i.request=function(t,e,i){void 0===e&&(e={});var r=this.props,n=r.ables,s=r.groupable,o=n.filter((function(e){return e.name===t}))[0];if(this.isDragging()||!o||!o.request)return{request:function(){return this},requestEnd:function(){return this}};var a=this,h=o.request(this),u=i||e.isInstant,c=h.isControl?"controlAbles":"targetAbles",l=(s?"Group":"")+(h.isControl?"Control":""),p={request:function(e){return Ts(a,c,"drag",l,"",Ve(Ve({},h.request(e)),{requestAble:t,isRequest:!0}),u),this},requestEnd:function(){return Ts(a,c,"drag",l,"End",Ve(Ve({},h.requestEnd()),{requestAble:t,isRequest:!0}),u),this}};return Ts(a,c,"drag",l,"Start",Ve(Ve({},h.requestStart(e)),{requestAble:t,isRequest:!0}),u),u?p.request(e).requestEnd():p},i.destroy=function(){this.componentWillUnmount()},i.updateRenderPoses=function(){var t=this.state,e=this.props,i=t.originalBeforeOrigin,r=t.transformOrigin,n=t.allMatrix,s=t.is3d,o=t.pos1,a=t.pos2,h=t.pos3,u=t.pos4,c=t.left,l=t.top,p=e.padding||{},d=p.left,f=void 0===d?0:d,g=p.top,m=void 0===g?0:g,_=p.bottom,v=void 0===_?0:_,y=p.right,b=void 0===y?0:y,x=s?4:3,E=e.groupable?i:zt(i,[c,l]);t.renderPoses=[zt(o,Zi(n,[-f,-m],r,E,x)),zt(a,Zi(n,[b,-m],r,E,x)),zt(h,Zi(n,[-f,v],r,E,x)),zt(u,Zi(n,[b,v],r,E,x))]},i.checkUpdate=function(){var t=this.props,e=t.target,i=t.container,r=t.parentMoveable,n=this.state,s=n.target,o=n.container;(s||e)&&(this.updateAbles(),(!Hi(s,e)||!Hi(o,i))&&(this.updateState({target:e,container:i}),r||!i&&!this.controlBox||this.updateRect("End",!1,!1)))},i.triggerEvent=function(t,e){var i=this.props[t];return i&&i(e)},i.useCSS=function(t,e){var i=this.props.customStyledMap,r=t+e;return i[r]||(i[r]=Xe(t,e)),i[r]},i.unsetAbles=function(){var t=this;this.targetAbles.filter((function(e){return!!e.unset&&(e.unset(t),!0)})).length&&this.forceUpdate()},i.updateAbles=function(t,e){void 0===t&&(t=this.props.ables),void 0===e&&(e="");var i=this.props,r=i.triggerAblesSimultaneously,n=t.filter((function(t){return t&&(t.always||i[t.name])})),s="drag"+e+"ControlStart",o=zi(n,["drag"+e+"Start","pinch"+e+"Start"],r),a=zi(n,[s],r);this.enabledAbles=n,this.targetAbles=o,this.controlAbles=a},i.updateState=function(t,e){if(e)this.setState(t);else{var i=this.state;for(var r in t)i[r]=t[r]}},i.getEnabledAbles=function(){var t=this.props;return t.ables.filter((function(e){return e&&t[e.name]}))},i.renderAbles=function(){var t,e,i,r,n=this,s=this.props.triggerAblesSimultaneously,o={createElement:st};return(t=Yi(zi(this.getEnabledAbles(),["render"],s).map((function(t){return(0,t.render)(n,o)||[]}))).filter((function(t){return t})),e=function(t){return t.key},i=[],r={},t.forEach((function(t,n){var s=e(t),o=r[s];o||(o=[],r[s]=o,i.push(o)),o.push(t)})),i).map((function(t){return t[0]}))},i.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},e.defaultProps={target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,edge:!1,parentMoveable:null,wrapperMoveable:null,parentPosition:null,portalContainer:null,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,groupable:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{}},e}(mt),Os={name:"groupable",props:{defaultGroupRotate:Number,defaultGroupOrigin:String,groupable:Boolean},events:{},render:function(t,e){var i=t.props.targets||[];t.moveables=[];var r=t.state,n={left:r.left,top:r.top};return i.map((function(i,r){return e.createElement(Cs,{key:"moveable"+r,ref:s(t,"moveables",r),target:i,origin:!1,cssStyled:t.props.cssStyled,customStyledMap:t.props.customStyledMap,parentMoveable:t,parentPosition:n})}))}},Is=We("clickable",{props:{},events:{onClick:"click",onClickGroup:"clickGroup"},always:!0,dragStart:function(t,e){e.isRequest||V(window,"click",t.onPreventClick,!0)},dragControlStart:function(t,e){this.dragStart(t,e)},dragGroupStart:function(t,e){this.dragStart(t,e),e.datas.inputTarget=e.inputEvent&&e.inputEvent.target},dragEnd:function(t,e){this.endEvent(t);var i=t.state.target,r=e.inputEvent,n=e.inputTarget;if(r&&n&&!e.isDrag&&!t.isMoveableElement(n)){var s=i.contains(n);ji(t,"onClick",Gi(t,e,{isDouble:e.isDouble,inputTarget:n,isTarget:i===n,containsTarget:s}))}},dragGroupEnd:function(t,e){this.endEvent(t);var i=e.inputEvent,r=e.inputTarget;if(i&&r&&!e.isDrag&&!t.isMoveableElement(r)&&e.datas.inputTarget!==r){var n=t.props.targets,s=n.indexOf(r),o=s>-1,a=!1;-1===s&&(a=(s=N(n,(function(t){return t.contains(r)})))>-1),ji(t,"onClickGroup",Gi(t,e,{isDouble:e.isDouble,targets:n,inputTarget:r,targetIndex:s,isTarget:o,containsTarget:a}))}},dragControlEnd:function(t){this.endEvent(t)},dragGroupControlEnd:function(t){this.endEvent(t)},endEvent:function(t){var e=this;requestAnimationFrame((function(){e.unset(t)}))},unset:function(t){Y(window,"click",t.onPreventClick,!0)}});function Rs(t){var e=t.originalDatas.draggable;return e||(t.originalDatas.draggable={},e=t.originalDatas.draggable),Ve(Ve({},t),{datas:e})}var Ms=We("edgeDraggable",{dragControlCondition:function(t,e){if(!t.props.edgeDraggable||!e.inputEvent)return!1;var i=e.inputEvent.target;return H(i,ci("direction"))&&H(i,ci("line"))},dragControlStart:function(t,e){return An.dragStart(t,Rs(e))},dragControl:function(t,e){return An.drag(t,Rs(e))},dragControlEnd:function(t,e){return An.dragEnd(t,Rs(e))},dragGroupControlCondition:function(t,e){if(!t.props.edgeDraggable||!e.inputEvent)return!1;var i=e.inputEvent.target;return H(i,ci("direction"))&&H(i,ci("line"))},dragGroupControlStart:function(t,e){return An.dragGroupStart(t,Rs(e))},dragGroupControl:function(t,e){return An.dragGroup(t,Rs(e))},dragGroupControlEnd:function(t,e){return An.dragGroupEnd(t,Rs(e))},unset:function(t){t.state.dragInfo=null}}),Ps={name:"individualGroupable",props:{individualGroupable:Boolean},events:{}},Ns=[xs,Kn,wn,nr,An,Ms,kn,Bn,Fn,jn,Zn,Jn,$n,_s,ms,bs,Os,Ps,Is,Wn,Es],Ls=Ns.reduce((function(t,e){return Ve(Ve({},t),"events"in e?e.events:{})}),{}),Ds=Ns.reduce((function(t,e){return Ve(Ve({},t),e.props)}),{}),ks=tr(Ls),Bs=Object.keys(ks),Fs=Object.keys(Ds);function Gs(t,e){return Math.max.apply(Math,t.map((function(t){var i=t[0],r=t[1],n=t[2],s=t[3];return Math.max(i[e],r[e],n[e],s[e])})))}function Us(t,e){return Math.min.apply(Math,t.map((function(t){var i=t[0],r=t[1],n=t[2],s=t[3];return Math.min(i[e],r[e],n[e],s[e])})))}var js=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.differ=new ve,e.moveables=[],e.transformOrigin="50% 50%",e}He(e,t);var i=e.prototype;return i.updateEvent=function(t){var e=this.state,i=this.props,r=t.dragTarget||e.target,n=i.dragTarget||this.areaElement;r!==n&&(Fi(this,"targetGesto"),Fi(this,"controlGesto"),e.target=null),e.target||(e.target=this.areaElement,this.controlBox.getElement().style.display="block",this.targetGesto=Ss(this,n,"Group"),this.controlGesto=ws(this,this.controlBox.getElement(),"controlAbles","GroupControl"));var s=!Hi(t.container,i.container);s&&(e.container=i.container);var o=this.differ.update(i.targets),a=o.added,h=o.changed,u=o.removed;(s||a.length||h.length||u.length)&&this.updateRect()},i.checkUpdate=function(){this.updateAbles()},i.updateRect=function(t,e,i){if(void 0===i&&(i=!0),this.controlBox){this.moveables.forEach((function(e){e.updateRect(t,!1,!1)}));var r=this.state,n=this.props,s=r.target||n.target;(!e||""!==t&&n.updateGroup)&&(this.rotation=n.defaultGroupRotate,this.transformOrigin=n.defaultGroupOrigin||"50% 50%",this.scale=[1,1]);var o=this.rotation,a=this.scale,h=function(t,e){if(!t.length)return[0,0,0,0];var i=t.map((function(t){return Bi(t.state)})),r=ni,n=ni,s=0,o=0,a=X(e,ii);if(a%90){var h=a/180*Math.PI,u=Math.tan(h),c=-1/u,l=[si,ni],p=[si,ni];i.forEach((function(t){t.forEach((function(t){var e=t[1]-u*t[0],i=t[1]-c*t[0];l[0]=Math.max(l[0],e),l[1]=Math.min(l[1],e),p[0]=Math.max(p[0],i),p[1]=Math.min(p[1],i)}))})),l.forEach((function(t){p.forEach((function(e){var i=(e-t)/(u-c),s=u*i+t;r=Math.min(r,i),n=Math.min(n,s)}))}));var d=i.map((function(t){var e=t[0],i=t[1],r=t[2],n=t[3];return[Kt(e,-h),Kt(i,-h),Kt(r,-h),Kt(n,-h)]}));s=Gs(d,0)-Us(d,0),o=Gs(d,1)-Us(d,1)}else if(r=Us(i,0),n=Us(i,1),s=Gs(i,0)-r,o=Gs(i,1)-n,a%180){var f=s;s=o,o=f}return[r,n,s,o]}(this.moveables,o),u=h[0],c=h[1],l=h[2],p=h[3],d="rotate("+o+"deg) scale("+(a[0]>=0?1:-1)+", "+(a[1]>=0?1:-1)+")";s.style.cssText+="left:0px;top:0px; transform-origin: "+this.transformOrigin+"; width:"+l+"px; height:"+p+"px;transform:"+d,r.width=l,r.height=p;var f=this.getContainer(),g=Ni(this.controlBox.getElement(),s,this.controlBox.getElement(),this.getContainer(),this.props.rootContainer||f),m=[g.left,g.top],_=Bi(g),v=_[0],y=_[1],b=_[2],x=_[3],E=ue([v,y,b,x]),T=[E.minX,E.minY];g.pos1=Ht(v,T),g.pos2=Ht(y,T),g.pos3=Ht(b,T),g.pos4=Ht(x,T),g.left=u-g.left+T[0],g.top=c-g.top+T[1],g.origin=Ht(zt(m,g.origin),T),g.beforeOrigin=Ht(zt(m,g.beforeOrigin),T),g.originalBeforeOrigin=zt(m,g.originalBeforeOrigin);var S=g.targetClientRect,w=a[0]*a[1]>0?1:-1;S.top+=g.top-r.top,S.left+=g.left-r.left,s.style.transform="translate("+-T[0]+"px, "+-T[1]+"px) "+d,this.updateState(Ve(Ve({},g),{direction:w,beforeDirection:w}),i)}},i.getRect=function(){return Ve(Ve({},t.prototype.getRect.call(this)),{children:this.moveables.map((function(t){return t.getRect()}))})},i.triggerEvent=function(e,i,r){if(r||e.indexOf("Group")>-1)return t.prototype.triggerEvent.call(this,e,i)},i.updateAbles=function(){t.prototype.updateAbles.call(this,Ye(this.props.ables,[Os]),"Group")},e.defaultProps=Ve(Ve({},Cs.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),e}(Cs),Xs=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.moveables=[],e}He(e,t);var i=e.prototype;return i.render=function(){var t=this,e=this.props,i=e.cspNonce,r=e.cssStyled,o=e.targets;return st(r,{cspNonce:i,ref:n(this,"controlBox"),className:ci("control-box")},o.map((function(e,i){return st(Cs,Ve({key:"moveable"+i,ref:s(t,"moveables",i)},t.props,{target:e,wrapperMoveable:t}))})))},i.componentDidUpdate=function(){},i.updateRect=function(t,e,i){void 0===i&&(i=!0),this.moveables.forEach((function(r){r.updateRect(t,e,i)}))},i.getRect=function(){return Ve(Ve({},t.prototype.getRect.call(this)),{children:this.moveables.map((function(t){return t.getRect()}))})},i.request=function(){return{request:function(){return this},requestEnd:function(){return this}}},i.dragStart=function(){return this},i.hitTest=function(){return 0},i.isInside=function(){return!1},i.isDragging=function(){return!1},i.updateRenderPoses=function(){},i.updateEvent=function(){},i.checkUpdate=function(){},i.triggerEvent=function(){},i.updateAbles=function(){},e}(Cs),zs=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.refTargets=[],e.selectorMap={},e}He(e,t);var i,r,s=e.prototype;return e.makeStyled=function(){var t={};this.getTotalAbles().forEach((function(e){var i=e.css;i&&i.forEach((function(e){t[e]=!0}))}));var e=D(t).join("\n");this.defaultStyled=Xe("div",(Qe+e).replace(/([^}{]*){/gm,(function(t,e){return e.replace(/\.([^{,\s\d.]+)/g,".moveable-$1")+"{"})))},e.getTotalAbles=function(){return Ye([Kn,Os,Ps,Wn],this.defaultAbles)},s.render=function(){var t=this.constructor;t.defaultStyled||t.makeStyled();var e=this.props,i=e.ables,r=e.props,s=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i}(e,["ables","props"]),o=ir(s.target||s.targets),a=function(t,e){var i=[];return t.forEach((function(t){t&&(E(t)?e[t]&&i.push.apply(i,e[t]):i.push(t))})),i}(o,this.selectorMap);this.refTargets=o;var h=a.length>1,u=Ye(t.getTotalAbles(),i||[]),c=Ve(Ve(Ve({},s),r||{}),{ables:u,cssStyled:t.defaultStyled,customStyledMap:t.customStyledMap});return h?s.individualGroupable?st(Xs,Ve({key:"individual-group",ref:n(this,"moveable")},c,{target:null,targets:a})):st(js,Ve({key:"group",ref:n(this,"moveable")},c,{target:null,targets:a})):st(Cs,Ve({key:"single",ref:n(this,"moveable")},c,{target:a[0]}))},s.componentDidMount=function(){this.updateRefs()},s.componentDidUpdate=function(){this.updateRefs()},s.updateRefs=function(t){var e=ir(this.props.target||this.props.targets),i=this.refTargets.some((function(t,i){var r=e[i];return!(!t&&!r)&&t!==r})),r=t?{}:this.selectorMap,n={};this.refTargets.forEach((function(t){E(t)&&(r[t]?n[t]=r[t]:(i=!0,n[t]=[].slice.call(document.querySelectorAll(t))))})),this.selectorMap=n,i&&this.forceUpdate()},s.getManager=function(){return this.moveable},e.defaultAbles=[],e.customStyledMap={},e.defaultStyled=null,function(t,e,i,r){var n,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(s<3?n(o):s>3?n(e,i,o):n(e,i))||o);s>3&&o&&Object.defineProperty(e,i,o)}([(i=ui,void 0===r&&(r={}),function(t,e){i.forEach((function(i){var n=r[i]||i;t[n]||(t[n]=function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var s=(t=this[e])[i].apply(t,r);return s===this[e]?this:s})}))})],e.prototype,"moveable",void 0),e}(mt),Hs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return He(e,t),e.defaultAbles=Ns,e}(zs);const Vs=Hs;var Ys=function(t,e){return Ys=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},Ys(t,e)};function Ws(t,e){function i(){this.constructor=t}Ys(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var $s=function(){return $s=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},$s.apply(this,arguments)},qs=function(t){function e(e){var i=t.call(this,e)||this;return i.state={},i.state=i.props,i}return Ws(e,t),e.prototype.render=function(){return t=st(Vs,$s({ref:n(this,"moveable")},this.state)),e=this.state.parentElement,st(_t,{element:t,container:e});var t,e},e}(gt),Zs=Fs,Ks=ui,Js=Bs,Qs=Ds,to=function(){return to=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},to.apply(this,arguments)},eo=function(){function t(){this._events={}}var e=t.prototype;return e.on=function(t,e){if(b(t))for(var i in t)this.on(i,t[i]);else this._addEvent(t,e,{});return this},e.off=function(t,e){if(t)if(b(t))for(var i in t)this.off(i);else if(e){var r=this._events[t];if(r){var n=N(r,(function(t){return t.listener===e}));n>-1&&r.splice(n,1)}}else this._events[t]=[];else this._events={};return this},e.once=function(t,e){var i=this;return e&&this._addEvent(t,e,{once:!0}),new Promise((function(e){i._addEvent(t,e,{once:!0})}))},e.emit=function(t,e){var i=this;void 0===e&&(e={});var r=this._events[t];if(!t||!r)return!0;var n=!1;return e.eventType=t,e.stop=function(){n=!0},e.currentTarget=this,function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var r=Array(t),n=0;for(e=0;e<i;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,n++)r[n]=s[o];return r}(r).forEach((function(r){r.listener(e),r.once&&i.off(t,r.listener)})),!n},e.trigger=function(t,e){return void 0===e&&(e={}),this.emit(t,e)},e._addEvent=function(t,e,i){var r=this._events;r[t]=r[t]||[],r[t].push(to({listener:e},i))},t}(),io=function(t){function e(e,i){void 0===i&&(i={});var r=t.call(this)||this;r.tempElement=document.createElement("div");var s=$s({container:e||document.body},i),o={};Js.forEach((function(t){var e;o[(e="on "+t,e.replace(/[\s-_]([a-z])/g,(function(t,e){return e.toUpperCase()})))]=function(e){return r.trigger(t,e)}})),bt(st(qs,$s({ref:n(r,"innerMoveable"),parentElement:e},s,o)),r.tempElement);var a=s.target;return x(a)&&a.length>1&&r.updateRect(),r}Ws(e,t);var i=e.prototype;return i.setState=function(t,e){this.innerMoveable.setState(t,e)},i.destroy=function(){bt(null,this.tempElement),this.off(),this.tempElement=null,this.innerMoveable=null},i.getMoveable=function(){return this.innerMoveable.moveable},e=function(t,e,i,r){var n,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(s<3?n(o):s>3?n(e,i,o):n(e,i))||o);return s>3&&o&&Object.defineProperty(e,i,o),o}([o(Ks,(function(t,e){t[e]||(t[e]=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r=this.getMoveable();if(r&&r[e])return r[e].apply(r,t)})})),o(Zs,(function(t,e){Object.defineProperty(t,e,{get:function(){return this.getMoveable().props[e]},set:function(t){var i;this.setState(((i={})[e]=t,i))},enumerable:!0,configurable:!0})}))],e),e}(eo),ro=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ws(e,t),e}(io);function no(t,e,i){return function(t,e,i){return void 0===i&&(i=e),vi(t,e,i,!0)}(t,e,i)}function so(t,e){return We(t,e)}const oo=ro},7824:t=>{var e=1e3,i=60*e,r=60*i,n=24*r;function s(t,e,i,r){var n=e>=1.5*i;return Math.round(t/i)+" "+r+(n?"s":"")}t.exports=function(t,o){o=o||{};var a,h,u=typeof t;if("string"===u&&t.length>0)return function(t){if(!((t=String(t)).length>100)){var s=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(s){var o=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return 6048e5*o;case"days":case"day":case"d":return o*n;case"hours":case"hour":case"hrs":case"hr":case"h":return o*r;case"minutes":case"minute":case"mins":case"min":case"m":return o*i;case"seconds":case"second":case"secs":case"sec":case"s":return o*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}(t);if("number"===u&&isFinite(t))return o.long?(a=t,(h=Math.abs(a))>=n?s(a,h,n,"day"):h>=r?s(a,h,r,"hour"):h>=i?s(a,h,i,"minute"):h>=e?s(a,h,e,"second"):a+" ms"):function(t){var s=Math.abs(t);return s>=n?Math.round(t/n)+"d":s>=r?Math.round(t/r)+"h":s>=i?Math.round(t/i)+"m":s>=e?Math.round(t/e)+"s":t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},7418:t=>{"use strict";var e=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function n(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},i=0;i<10;i++)e["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,s){for(var o,a,h=n(t),u=1;u<arguments.length;u++){for(var c in o=Object(arguments[u]))i.call(o,c)&&(h[c]=o[c]);if(e){a=e(o);for(var l=0;l<a.length;l++)r.call(o,a[l])&&(h[a[l]]=o[a[l]])}}return h}},1830:(t,e)=>{e.encode=function(t){var e="";for(var i in t)t.hasOwnProperty(i)&&(e.length&&(e+="&"),e+=encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return e},e.decode=function(t){for(var e={},i=t.split("&"),r=0,n=i.length;r<n;r++){var s=i[r].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}},4187:t=>{var e=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(t){var r,n,s=t,o=t.indexOf("["),a=t.indexOf("]");-1!=o&&-1!=a&&(t=t.substring(0,o)+t.substring(o,a).replace(/:/g,";")+t.substring(a,t.length));for(var h,u,c=e.exec(t||""),l={},p=14;p--;)l[i[p]]=c[p]||"";return-1!=o&&-1!=a&&(l.source=s,l.host=l.host.substring(1,l.host.length-1).replace(/;/g,":"),l.authority=l.authority.replace("[","").replace("]","").replace(/;/g,":"),l.ipv6uri=!0),l.pathNames=(r=l.path,n=r.replace(/\/{2,9}/g,"/").split("/"),"/"!=r.substr(0,1)&&0!==r.length||n.splice(0,1),"/"==r.substr(r.length-1,1)&&n.splice(n.length-1,1),n),l.queryKey=(h=l.query,u={},h.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(t,e,i){e&&(u[e]=i)})),u),l}},7864:function(t){"undefined"!=typeof self&&self,t.exports=function(t){var e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},i.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";function r(t){if(!(this instanceof r))return new r(t);this._=t}var n=r.prototype;function s(t,e){for(var i=0;i<t;i++)e(i)}function o(t,e,i){return function(t,e){s(e.length,(function(i){t(e[i],i,e)}))}((function(i,r,n){e=t(e,i,r,n)}),i),e}function a(t,e){return o((function(e,i,r,n){return e.concat([t(i,r,n)])}),[],e)}function h(t,e){var i={v:0,buf:e};return s(t,(function(){var t;i={v:i.v<<1|(t=i.buf,t[0]>>7),buf:function(t){var e=o((function(t,e,i,r){return t.concat(i===r.length-1?Buffer.from([e,0]).readUInt16BE(0):r.readUInt16BE(i))}),[],t);return Buffer.from(a((function(t){return(t<<1&65535)>>8}),e))}(i.buf)}})),i}function u(){return"undefined"!=typeof Buffer}function c(){if(!u())throw new Error("Buffer global does not exist; please use webpack if you need to parse Buffers in the browser.")}function l(t){c();var e=o((function(t,e){return t+e}),0,t);if(e%8!=0)throw new Error("The bits ["+t.join(", ")+"] add up to "+e+" which is not an even number of bytes; the total should be divisible by 8");var i,n=e/8,s=(i=function(t){return t>48},o((function(t,e){return t||(i(e)?e:t)}),null,t));if(s)throw new Error(s+" bit range requested exceeds 48 bit (6 byte) Number max.");return new r((function(e,i){var r=n+i;return r>e.length?E(i,n.toString()+" bytes"):x(r,o((function(t,e){var i=h(e,t.buf);return{coll:t.coll.concat(i.v),buf:i.buf}}),{coll:[],buf:e.slice(i,r)},t).coll)}))}function p(t,e){return new r((function(i,r){return c(),r+e>i.length?E(r,e+" bytes for "+t):x(r+e,i.slice(r,r+e))}))}function d(t,e){if("number"!=typeof(i=e)||Math.floor(i)!==i||e<0||e>6)throw new Error(t+" requires integer length in range [0, 6].");var i}function f(t){return d("uintBE",t),p("uintBE("+t+")",t).map((function(e){return e.readUIntBE(0,t)}))}function g(t){return d("uintLE",t),p("uintLE("+t+")",t).map((function(e){return e.readUIntLE(0,t)}))}function m(t){return d("intBE",t),p("intBE("+t+")",t).map((function(e){return e.readIntBE(0,t)}))}function _(t){return d("intLE",t),p("intLE("+t+")",t).map((function(e){return e.readIntLE(0,t)}))}function v(t){return t instanceof r}function y(t){return"[object Array]"==={}.toString.call(t)}function b(t){return u()&&Buffer.isBuffer(t)}function x(t,e){return{status:!0,index:t,value:e,furthest:-1,expected:[]}}function E(t,e){return y(e)||(e=[e]),{status:!1,index:-1,value:null,furthest:t,expected:e}}function T(t,e){if(!e)return t;if(t.furthest>e.furthest)return t;var i=t.furthest===e.furthest?function(t,e){if(function(){if(void 0!==r._supportsSet)return r._supportsSet;var t="undefined"!=typeof Set;return r._supportsSet=t,t}()&&Array.from){for(var i=new Set(t),n=0;n<e.length;n++)i.add(e[n]);var s=Array.from(i);return s.sort(),s}for(var o={},a=0;a<t.length;a++)o[t[a]]=!0;for(var h=0;h<e.length;h++)o[e[h]]=!0;var u=[];for(var c in o)({}).hasOwnProperty.call(o,c)&&u.push(c);return u.sort(),u}(t.expected,e.expected):e.expected;return{status:t.status,index:t.index,value:t.value,furthest:e.furthest,expected:i}}var S={};function w(t,e){if(b(t))return{offset:e,line:-1,column:-1};t in S||(S[t]={});for(var i=S[t],r=0,n=0,s=0,o=e;o>=0;){if(o in i){r=i[o].line,0===s&&(s=i[o].lineStart);break}"\n"===t.charAt(o)&&(n++,0===s&&(s=o+1)),o--}var a=r+n,h=e-s;return i[e]={line:a,lineStart:s},{offset:e,line:a+1,column:h+1}}function A(t){if(!v(t))throw new Error("not a parser: "+t)}function C(t,e){return"string"==typeof t?t.charAt(e):t[e]}function O(t){if("number"!=typeof t)throw new Error("not a number: "+t)}function I(t){if("function"!=typeof t)throw new Error("not a function: "+t)}function R(t){if("string"!=typeof t)throw new Error("not a string: "+t)}function M(t,e){return new Array(e+1).join(t)}function P(t,e,i){var r=e-t.length;return r<=0?t:M(i,r)+t}function N(t,e,i,r){return{from:t-e>0?t-e:0,to:t+i>r?r:t+i}}function L(t,e){var i,r,n,s,h,u=e.index,c=u.offset,l=1;if(c===t.length)return"Got the end of the input";if(b(t)){var p=c-c%8,d=c-p,f=N(p,40,40,t.length),g=a((function(t){return a((function(t){return P(t.toString(16),2,"0")}),t)}),function(t,e){var i=t.length,r=[],n=0;if(i<=8)return[t.slice()];for(var s=0;s<i;s++)r[n]||r.push([]),r[n].push(t[s]),(s+1)%8==0&&n++;return r}(t.slice(f.from,f.to).toJSON().data));s=function(t){return 0===t.from&&1===t.to?{from:t.from,to:t.to}:{from:t.from/8,to:Math.floor(t.to/8)}}(f),r=p/8,i=3*d,d>=4&&(i+=1),l=2,n=a((function(t){return t.length<=4?t.join(" "):t.slice(0,4).join(" ")+"  "+t.slice(4).join(" ")}),g),(h=(8*(s.to>0?s.to-1:s.to)).toString(16).length)<2&&(h=2)}else{var m=t.split(/\r\n|[\n\r\u2028\u2029]/);i=u.column-1,r=u.line-1,s=N(r,2,3,m.length),n=m.slice(s.from,s.to),h=s.to.toString().length}var _=r-s.from;return b(t)&&(h=(8*(s.to>0?s.to-1:s.to)).toString(16).length)<2&&(h=2),o((function(e,r,n){var o,a=n===_,u=a?"> ":"  ";return o=b(t)?P((8*(s.from+n)).toString(16),h,"0"):P((s.from+n+1).toString(),h," "),[].concat(e,[u+o+" | "+r],a?["  "+M(" ",h)+" | "+P("",i," ")+M("^",l)]:[])}),[],n).join("\n")}function D(t,e){return["\n","-- PARSING FAILED "+M("-",50),"\n\n",L(t,e),"\n\n",(i=e.expected,1===i.length?"Expected:\n\n"+i[0]:"Expected one of the following: \n\n"+i.join(", ")),"\n"].join("");var i}function k(t){return void 0!==t.flags?t.flags:[t.global?"g":"",t.ignoreCase?"i":"",t.multiline?"m":"",t.unicode?"u":"",t.sticky?"y":""].join("")}function B(){for(var t=[].slice.call(arguments),e=t.length,i=0;i<e;i+=1)A(t[i]);return r((function(i,r){for(var n,s=new Array(e),o=0;o<e;o+=1){if(!(n=T(t[o]._(i,r),n)).status)return n;s[o]=n.value,r=n.index}return T(x(r,s),n)}))}function F(){var t=[].slice.call(arguments);if(0===t.length)throw new Error("seqMap needs at least one argument");var e=t.pop();return I(e),B.apply(null,t).map((function(t){return e.apply(null,t)}))}function G(){var t=[].slice.call(arguments),e=t.length;if(0===e)return V("zero alternates");for(var i=0;i<e;i+=1)A(t[i]);return r((function(e,i){for(var r,n=0;n<t.length;n+=1)if((r=T(t[n]._(e,i),r)).status)return r;return r}))}function U(t,e){return j(t,e).or(H([]))}function j(t,e){return A(t),A(e),F(t,e.then(t).many(),(function(t,e){return[t].concat(e)}))}function X(t){R(t);var e="'"+t+"'";return r((function(i,r){var n=r+t.length,s=i.slice(r,n);return s===t?x(n,s):E(r,e)}))}function z(t,e){!function(t){if(!(t instanceof RegExp))throw new Error("not a regexp: "+t);for(var e=k(t),i=0;i<e.length;i++){var r=e.charAt(i);if("i"!==r&&"m"!==r&&"u"!==r&&"s"!==r)throw new Error('unsupported regexp flag "'+r+'": '+t)}}(t),arguments.length>=2?O(e):e=0;var i=function(t){return RegExp("^(?:"+t.source+")",k(t))}(t),n=""+t;return r((function(t,r){var s=i.exec(t.slice(r));if(s){if(0<=e&&e<=s.length){var o=s[0],a=s[e];return x(r+o.length,a)}return E(r,"valid match group (0 to "+s.length+") in "+n)}return E(r,n)}))}function H(t){return r((function(e,i){return x(i,t)}))}function V(t){return r((function(e,i){return E(i,t)}))}function Y(t){if(v(t))return r((function(e,i){var r=t._(e,i);return r.index=i,r.value="",r}));if("string"==typeof t)return Y(X(t));if(t instanceof RegExp)return Y(z(t));throw new Error("not a string, regexp, or parser: "+t)}function W(t){return A(t),r((function(e,i){var r=t._(e,i),n=e.slice(i,r.index);return r.status?E(i,'not "'+n+'"'):x(i,null)}))}function $(t){return I(t),r((function(e,i){var r=C(e,i);return i<e.length&&t(r)?x(i+1,r):E(i,"a character/byte matching "+t)}))}function q(t,e){arguments.length<2&&(e=t,t=void 0);var i=r((function(t,r){return i._=e()._,i._(t,r)}));return t?i.desc(t):i}function Z(){return V("fantasy-land/empty")}n.parse=function(t){if("string"!=typeof t&&!b(t))throw new Error(".parse must be called with a string or Buffer as its argument");var e,i=this.skip(tt)._(t,0);return e=i.status?{status:!0,value:i.value}:{status:!1,index:w(t,i.furthest),expected:i.expected},delete S[t],e},n.tryParse=function(t){var e=this.parse(t);if(e.status)return e.value;var i=D(t,e),r=new Error(i);throw r.type="ParsimmonError",r.result=e,r},n.assert=function(t,e){return this.chain((function(i){return t(i)?H(i):V(e)}))},n.or=function(t){return G(this,t)},n.trim=function(t){return this.wrap(t,t)},n.wrap=function(t,e){return F(t,this,e,(function(t,e){return e}))},n.thru=function(t){return t(this)},n.then=function(t){return A(t),B(this,t).map((function(t){return t[1]}))},n.many=function(){var t=this;return r((function(e,i){for(var r=[],n=void 0;;){if(!(n=T(t._(e,i),n)).status)return T(x(i,r),n);if(i===n.index)throw new Error("infinite loop detected in .many() parser --- calling .many() on a parser which can accept zero characters is usually the cause");i=n.index,r.push(n.value)}}))},n.tieWith=function(t){return R(t),this.map((function(e){if(function(t){if(!y(t))throw new Error("not an array: "+t)}(e),e.length){R(e[0]);for(var i=e[0],r=1;r<e.length;r++)R(e[r]),i+=t+e[r];return i}return""}))},n.tie=function(){return this.tieWith("")},n.times=function(t,e){var i=this;return arguments.length<2&&(e=t),O(t),O(e),r((function(r,n){for(var s=[],o=void 0,a=void 0,h=0;h<t;h+=1){if(a=T(o=i._(r,n),a),!o.status)return a;n=o.index,s.push(o.value)}for(;h<e&&(a=T(o=i._(r,n),a),o.status);h+=1)n=o.index,s.push(o.value);return T(x(n,s),a)}))},n.result=function(t){return this.map((function(){return t}))},n.atMost=function(t){return this.times(0,t)},n.atLeast=function(t){return F(this.times(t),this.many(),(function(t,e){return t.concat(e)}))},n.map=function(t){I(t);var e=this;return r((function(i,r){var n=e._(i,r);return n.status?T(x(n.index,t(n.value)),n):n}))},n.contramap=function(t){I(t);var e=this;return r((function(i,r){var n=e.parse(t(i.slice(r)));return n.status?x(r+i.length,n.value):n}))},n.promap=function(t,e){return I(t),I(e),this.contramap(t).map(e)},n.skip=function(t){return B(this,t).map((function(t){return t[0]}))},n.mark=function(){return F(K,this,K,(function(t,e,i){return{start:t,value:e,end:i}}))},n.node=function(t){return F(K,this,K,(function(e,i,r){return{name:t,value:i,start:e,end:r}}))},n.sepBy=function(t){return U(this,t)},n.sepBy1=function(t){return j(this,t)},n.lookahead=function(t){return this.skip(Y(t))},n.notFollowedBy=function(t){return this.skip(W(t))},n.desc=function(t){y(t)||(t=[t]);var e=this;return r((function(i,r){var n=e._(i,r);return n.status||(n.expected=t),n}))},n.fallback=function(t){return this.or(H(t))},n.ap=function(t){return F(t,this,(function(t,e){return t(e)}))},n.chain=function(t){var e=this;return r((function(i,r){var n=e._(i,r);return n.status?T(t(n.value)._(i,n.index),n):n}))},n.concat=n.or,n.empty=Z,n.of=H,n["fantasy-land/ap"]=n.ap,n["fantasy-land/chain"]=n.chain,n["fantasy-land/concat"]=n.concat,n["fantasy-land/empty"]=n.empty,n["fantasy-land/of"]=n.of,n["fantasy-land/map"]=n.map;var K=r((function(t,e){return x(e,w(t,e))})),J=r((function(t,e){return e>=t.length?E(e,"any character/byte"):x(e+1,C(t,e))})),Q=r((function(t,e){return x(t.length,t.slice(e))})),tt=r((function(t,e){return e<t.length?E(e,"EOF"):x(e,null)})),et=z(/[0-9]/).desc("a digit"),it=z(/[0-9]*/).desc("optional digits"),rt=z(/[a-z]/i).desc("a letter"),nt=z(/[a-z]*/i).desc("optional letters"),st=z(/\s*/).desc("optional whitespace"),ot=z(/\s+/).desc("whitespace"),at=X("\r"),ht=X("\n"),ut=X("\r\n"),ct=G(ut,ht,at).desc("newline"),lt=G(ct,tt);r.all=Q,r.alt=G,r.any=J,r.cr=at,r.createLanguage=function(t){var e={};for(var i in t)({}).hasOwnProperty.call(t,i)&&function(i){e[i]=q((function(){return t[i](e)}))}(i);return e},r.crlf=ut,r.custom=function(t){return r(t(x,E))},r.digit=et,r.digits=it,r.empty=Z,r.end=lt,r.eof=tt,r.fail=V,r.formatError=D,r.index=K,r.isParser=v,r.lazy=q,r.letter=rt,r.letters=nt,r.lf=ht,r.lookahead=Y,r.makeFailure=E,r.makeSuccess=x,r.newline=ct,r.noneOf=function(t){return $((function(e){return t.indexOf(e)<0})).desc("none of '"+t+"'")},r.notFollowedBy=W,r.of=H,r.oneOf=function(t){for(var e=t.split(""),i=0;i<e.length;i++)e[i]="'"+e[i]+"'";return $((function(e){return t.indexOf(e)>=0})).desc(e)},r.optWhitespace=st,r.Parser=r,r.range=function(t,e){return $((function(i){return t<=i&&i<=e})).desc(t+"-"+e)},r.regex=z,r.regexp=z,r.sepBy=U,r.sepBy1=j,r.seq=B,r.seqMap=F,r.seqObj=function(){for(var t,e={},i=0,n=(t=arguments,Array.prototype.slice.call(t)),s=n.length,o=0;o<s;o+=1){var a=n[o];if(!v(a)){if(y(a)&&2===a.length&&"string"==typeof a[0]&&v(a[1])){var h=a[0];if(Object.prototype.hasOwnProperty.call(e,h))throw new Error("seqObj: duplicate key "+h);e[h]=!0,i++;continue}throw new Error("seqObj arguments must be parsers or [string, parser] array pairs.")}}if(0===i)throw new Error("seqObj expects at least one named parser, found zero");return r((function(t,e){for(var i,r={},o=0;o<s;o+=1){var a,h;if(y(n[o])?(a=n[o][0],h=n[o][1]):(a=null,h=n[o]),!(i=T(h._(t,e),i)).status)return i;a&&(r[a]=i.value),e=i.index}return T(x(e,r),i)}))},r.string=X,r.succeed=H,r.takeWhile=function(t){return I(t),r((function(e,i){for(var r=i;r<e.length&&t(C(e,r));)r++;return x(r,e.slice(i,r))}))},r.test=$,r.whitespace=ot,r["fantasy-land/empty"]=Z,r["fantasy-land/of"]=H,r.Binary={bitSeq:l,bitSeqObj:function(t){c();var e={},i=0,r=a((function(t){if(y(t)){var r=t;if(2!==r.length)throw new Error("["+r.join(", ")+"] should be length 2, got length "+r.length);if(R(r[0]),O(r[1]),Object.prototype.hasOwnProperty.call(e,r[0]))throw new Error("duplicate key in bitSeqObj: "+r[0]);return e[r[0]]=!0,i++,r}return O(t),[null,t]}),t);if(i<1)throw new Error("bitSeqObj expects at least one named pair, got ["+t.join(", ")+"]");var n=a((function(t){return t[0]}),r);return l(a((function(t){return t[1]}),r)).map((function(t){return o((function(t,e){return null!==e[0]&&(t[e[0]]=e[1]),t}),{},a((function(e,i){return[e,t[i]]}),n))}))},byte:function(t){if(c(),O(t),t>255)throw new Error("Value specified to byte constructor ("+t+"=0x"+t.toString(16)+") is larger in value than a single byte.");var e=(t>15?"0x":"0x0")+t.toString(16);return r((function(i,r){var n=C(i,r);return n===t?x(r+1,n):E(r,e)}))},buffer:function(t){return p("buffer",t).map((function(t){return Buffer.from(t)}))},encodedString:function(t,e){return p("string",e).map((function(e){return e.toString(t)}))},uintBE:f,uint8BE:f(1),uint16BE:f(2),uint32BE:f(4),uintLE:g,uint8LE:g(1),uint16LE:g(2),uint32LE:g(4),intBE:m,int8BE:m(1),int16BE:m(2),int32BE:m(4),intLE:_,int8LE:_(1),int16LE:_(2),int32LE:_(4),floatBE:p("floatBE",4).map((function(t){return t.readFloatBE(0)})),floatLE:p("floatLE",4).map((function(t){return t.readFloatLE(0)})),doubleBE:p("doubleBE",8).map((function(t){return t.readDoubleBE(0)})),doubleLE:p("doubleLE",8).map((function(t){return t.readDoubleLE(0)}))},t.exports=r}])},6841:(t,e,i)=>{"use strict";i.r(e),i.d(e,{ALPHA_MODES:()=>Z.iw,AbstractBatchRenderer:()=>X.eo,AbstractMultiResource:()=>X.M4,AbstractRenderer:()=>X.I8,AccessibilityManager:()=>P,AnimatedSprite:()=>Er,AppLoaderPlugin:()=>q.LP,Application:()=>z,ArrayResource:()=>X.$N,Attribute:()=>X.ah,BLEND_MODES:()=>Z.T$,BUFFER_BITS:()=>Z.V0,BUFFER_TYPE:()=>Z.mr,BaseImageResource:()=>X.bg,BasePrepare:()=>Oe,BaseRenderTexture:()=>X.jd,BaseTexture:()=>X.VL,BatchDrawCall:()=>X.a$,BatchGeometry:()=>X.JZ,BatchPluginFactory:()=>X.TJ,BatchRenderer:()=>X.Bv,BatchShaderGenerator:()=>X.Zk,BatchSystem:()=>X.Sj,BatchTextureArray:()=>X.Ie,BitmapFont:()=>si,BitmapFontData:()=>Je,BitmapFontLoader:()=>ui,BitmapText:()=>hi,BlobResource:()=>it,Bounds:()=>S,Buffer:()=>X.lW,BufferResource:()=>X.qm,CLEAR_MODES:()=>Z.yl,CanvasResource:()=>X.Y8,Circle:()=>T.Cd,CompressedTextureLoader:()=>nt,CompressedTextureResource:()=>rt,Container:()=>R,ContextSystem:()=>X.lH,CountLimiter:()=>be,CubeResource:()=>X.TA,DDSLoader:()=>dt,DEG_TO_RAD:()=>T.ZX,DRAW_MODES:()=>Z.lg,DisplayObject:()=>C,ENV:()=>Z.Vi,Ellipse:()=>T.Pj,Extract:()=>$,FORMATS:()=>Z.I2,FORMATS_TO_COMPONENTS:()=>mt,FillStyle:()=>Ct,Filter:()=>X.wn,FilterState:()=>X.jV,FilterSystem:()=>X.kV,Framebuffer:()=>X.AI,FramebufferSystem:()=>X.WB,GC_MODES:()=>Z.UN,GLFramebuffer:()=>X.tT,GLProgram:()=>X.Ei,GLTexture:()=>X.fy,GRAPHICS_CURVES:()=>At,Geometry:()=>X.ZX,GeometrySystem:()=>X.TO,Graphics:()=>ie,GraphicsData:()=>qt,GraphicsGeometry:()=>Jt,IGLUniformData:()=>X.W1,INSTALLED:()=>X.e_,INTERNAL_FORMATS:()=>Y,INTERNAL_FORMAT_TO_BYTES_PER_PIXEL:()=>K,ImageBitmapResource:()=>X._w,ImageResource:()=>X.PA,InteractionData:()=>L,InteractionEvent:()=>k,InteractionManager:()=>j,InteractionTrackingData:()=>B,KTXLoader:()=>vt,LINE_CAP:()=>Et,LINE_JOIN:()=>xt,LineStyle:()=>Qt,Loader:()=>q.aN,LoaderResource:()=>q.kC,MASK_TYPES:()=>Z.A7,MIPMAP_MODES:()=>Z.WB,MSAA_QUALITY:()=>Z.G5,MaskData:()=>X.HI,MaskSystem:()=>X.zj,Matrix:()=>T.y3,Mesh:()=>$e,MeshBatchUvs:()=>Ve,MeshGeometry:()=>Ze,MeshMaterial:()=>qe,NineSlicePlane:()=>yr,ObjectRenderer:()=>X.bO,ObservablePoint:()=>T.AB,PI_2:()=>T._b,PRECISION:()=>Z.cB,ParticleContainer:()=>Tt,ParticleRenderer:()=>wt,PlaneGeometry:()=>fr,Point:()=>T.E9,Polygon:()=>T.mg,Prepare:()=>Pe,Program:()=>X.$r,ProjectionSystem:()=>X.NW,Quad:()=>X.lD,QuadUv:()=>X.ud,RAD_TO_DEG:()=>T.jl,RENDERER_TYPE:()=>Z.N3,Rectangle:()=>T.Ae,RenderTexture:()=>X.TI,RenderTexturePool:()=>X.uW,RenderTextureSystem:()=>X.J$,Renderer:()=>X.Th,Resource:()=>X._z,RopeGeometry:()=>gr,RoundedRectangle:()=>T.c9,Runner:()=>br.R,SAMPLER_TYPES:()=>Z.oT,SCALE_MODES:()=>Z.aH,SHAPES:()=>T.HS,SVGResource:()=>X.pX,ScissorSystem:()=>X.id,Shader:()=>X.ex,ShaderSystem:()=>X.p,SimpleMesh:()=>vr,SimplePlane:()=>_r,SimpleRope:()=>mr,Sprite:()=>ae,SpriteMaskFilter:()=>X.z9,Spritesheet:()=>Le,SpritesheetLoader:()=>De,State:()=>X.ZM,StateSystem:()=>X.zI,StencilSystem:()=>X.Ld,System:()=>X.xP,TARGETS:()=>Z.sp,TEXT_GRADIENT:()=>$t,TYPES:()=>Z.vK,TYPES_TO_BYTES_PER_COMPONENT:()=>gt,TYPES_TO_BYTES_PER_PIXEL:()=>_t,TemporaryDisplayObject:()=>O,Text:()=>ve,TextMetrics:()=>ge,TextStyle:()=>le,Texture:()=>X.xE,TextureGCSystem:()=>X.wr,TextureLoader:()=>q.dp,TextureMatrix:()=>X.UX,TextureSystem:()=>X.CT,TextureUvs:()=>X.aF,Ticker:()=>N.vB,TickerPlugin:()=>N.Sb,TilingSprite:()=>Ge,TilingSpriteRenderer:()=>Xe,TimeLimiter:()=>Ne,Transform:()=>T.wx,UPDATE_PRIORITY:()=>N.uF,UniformGroup:()=>X.oo,VERSION:()=>Tr,VideoResource:()=>X.eH,ViewableBuffer:()=>X.Rv,WRAP_MODES:()=>Z.Nt,accessibleTarget:()=>M,autoDetectRenderer:()=>X.e6,autoDetectResource:()=>X.pb,checkMaxIfStatementsInShader:()=>X.a7,createUBOElements:()=>X.TF,defaultFilterVertex:()=>X.Y9,defaultVertex:()=>X.kP,filters:()=>Sr,generateProgram:()=>X.qw,generateUniformBufferSync:()=>X.K0,getTestContext:()=>X.Kc,getUBOData:()=>X.DL,graphicsUtils:()=>re,groupD8:()=>T.Lv,interactiveTarget:()=>G,isMobile:()=>E.t,resources:()=>X.Jb,settings:()=>E.X,systems:()=>X.eG,uniformParsers:()=>X.sg,utils:()=>x});var r=setTimeout;function n(t){return Boolean(t&&void 0!==t.length)}function s(){}function o(t){if(!(this instanceof o))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],p(t,this)}function a(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,o._immediateFn((function(){var i=1===t._state?e.onFulfilled:e.onRejected;if(null!==i){var r;try{r=i(t._value)}catch(t){return void u(e.promise,t)}h(e.promise,r)}else(1===t._state?h:u)(e.promise,t._value)}))):t._deferreds.push(e)}function h(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var i=e.then;if(e instanceof o)return t._state=3,t._value=e,void c(t);if("function"==typeof i)return void p((r=i,n=e,function(){r.apply(n,arguments)}),t)}t._state=1,t._value=e,c(t)}catch(e){u(t,e)}var r,n}function u(t,e){t._state=2,t._value=e,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&o._immediateFn((function(){t._handled||o._unhandledRejectionFn(t._value)}));for(var e=0,i=t._deferreds.length;e<i;e++)a(t,t._deferreds[e]);t._deferreds=null}function l(t,e,i){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=i}function p(t,e){var i=!1;try{t((function(t){i||(i=!0,h(e,t))}),(function(t){i||(i=!0,u(e,t))}))}catch(t){if(i)return;i=!0,u(e,t)}}o.prototype.catch=function(t){return this.then(null,t)},o.prototype.then=function(t,e){var i=new this.constructor(s);return a(this,new l(t,e,i)),i},o.prototype.finally=function(t){var e=this.constructor;return this.then((function(i){return e.resolve(t()).then((function(){return i}))}),(function(i){return e.resolve(t()).then((function(){return e.reject(i)}))}))},o.all=function(t){return new o((function(e,i){if(!n(t))return i(new TypeError("Promise.all accepts an array"));var r=Array.prototype.slice.call(t);if(0===r.length)return e([]);var s=r.length;function o(t,n){try{if(n&&("object"==typeof n||"function"==typeof n)){var a=n.then;if("function"==typeof a)return void a.call(n,(function(e){o(t,e)}),i)}r[t]=n,0==--s&&e(r)}catch(t){i(t)}}for(var a=0;a<r.length;a++)o(a,r[a])}))},o.allSettled=function(t){return new this((function(e,i){if(!t||void 0===t.length)return i(new TypeError(typeof t+" "+t+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var r=Array.prototype.slice.call(t);if(0===r.length)return e([]);var n=r.length;function s(t,i){if(i&&("object"==typeof i||"function"==typeof i)){var o=i.then;if("function"==typeof o)return void o.call(i,(function(e){s(t,e)}),(function(i){r[t]={status:"rejected",reason:i},0==--n&&e(r)}))}r[t]={status:"fulfilled",value:i},0==--n&&e(r)}for(var o=0;o<r.length;o++)s(o,r[o])}))},o.resolve=function(t){return t&&"object"==typeof t&&t.constructor===o?t:new o((function(e){e(t)}))},o.reject=function(t){return new o((function(e,i){i(t)}))},o.race=function(t){return new o((function(e,i){if(!n(t))return i(new TypeError("Promise.race accepts an array"));for(var r=0,s=t.length;r<s;r++)o.resolve(t[r]).then(e,i)}))},o._immediateFn="function"==typeof setImmediate&&function(t){setImmediate(t)}||function(t){r(t,0)},o._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};const d=o;var f=i(7418),g=i.n(f);if(self.Promise||(self.Promise=d),Object.assign||(Object.assign=g()),Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!self.performance||!self.performance.now){var m=Date.now();self.performance||(self.performance={}),self.performance.now=function(){return Date.now()-m}}for(var _=Date.now(),v=["ms","moz","webkit","o"],y=0;y<v.length&&!self.requestAnimationFrame;++y){var b=v[y];self.requestAnimationFrame=self[b+"RequestAnimationFrame"],self.cancelAnimationFrame=self[b+"CancelAnimationFrame"]||self[b+"CancelRequestAnimationFrame"]}self.requestAnimationFrame||(self.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(t+"is not a function");var e=Date.now(),i=16+_-e;return i<0&&(i=0),_=e,self.setTimeout((function(){_=Date.now(),t(performance.now())}),i)}),self.cancelAnimationFrame||(self.cancelAnimationFrame=function(t){return clearTimeout(t)}),Math.sign||(Math.sign=function(t){return 0===(t=Number(t))||isNaN(t)?t:t>0?1:-1}),Number.isInteger||(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),self.ArrayBuffer||(self.ArrayBuffer=Array),self.Float32Array||(self.Float32Array=Array),self.Uint32Array||(self.Uint32Array=Array),self.Uint16Array||(self.Uint16Array=Array),self.Uint8Array||(self.Uint8Array=Array),self.Int32Array||(self.Int32Array=Array);var x=i(8942),E=i(9319),T=i(9658);E.X.SORTABLE_CHILDREN=!1;var S=function(){function t(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return t.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},t.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},t.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?T.Ae.EMPTY:((t=t||new T.Ae(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},t.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},t.prototype.addPointMatrix=function(t,e){var i=t.a,r=t.b,n=t.c,s=t.d,o=t.tx,a=t.ty,h=i*e.x+n*e.y+o,u=r*e.x+s*e.y+a;this.minX=Math.min(this.minX,h),this.maxX=Math.max(this.maxX,h),this.minY=Math.min(this.minY,u),this.maxY=Math.max(this.maxY,u)},t.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=s>r?s:r,n=o>n?o:n,e=(s=t[2])<e?s:e,i=(o=t[3])<i?o:i,r=s>r?s:r,n=o>n?o:n,e=(s=t[4])<e?s:e,i=(o=t[5])<i?o:i,r=s>r?s:r,n=o>n?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=s>r?s:r,n=o>n?o:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},t.prototype.addFrame=function(t,e,i,r,n){this.addFrameMatrix(t.worldTransform,e,i,r,n)},t.prototype.addFrameMatrix=function(t,e,i,r,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,c=t.ty,l=this.minX,p=this.minY,d=this.maxX,f=this.maxY,g=s*e+a*i+u,m=o*e+h*i+c;l=g<l?g:l,p=m<p?m:p,d=g>d?g:d,f=m>f?m:f,l=(g=s*r+a*i+u)<l?g:l,p=(m=o*r+h*i+c)<p?m:p,d=g>d?g:d,f=m>f?m:f,l=(g=s*e+a*n+u)<l?g:l,p=(m=o*e+h*n+c)<p?m:p,d=g>d?g:d,f=m>f?m:f,l=(g=s*r+a*n+u)<l?g:l,p=(m=o*r+h*n+c)<p?m:p,d=g>d?g:d,f=m>f?m:f,this.minX=l,this.minY=p,this.maxX=d,this.maxY=f},t.prototype.addVertexData=function(t,e,i){for(var r=this.minX,n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],u=t[a+1];r=h<r?h:r,n=u<n?u:n,s=h>s?h:s,o=u>o?u:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},t.prototype.addVertices=function(t,e,i,r){this.addVerticesMatrix(t.worldTransform,e,i,r)},t.prototype.addVerticesMatrix=function(t,e,i,r,n,s){void 0===n&&(n=0),void 0===s&&(s=n);for(var o=t.a,a=t.b,h=t.c,u=t.d,c=t.tx,l=t.ty,p=this.minX,d=this.minY,f=this.maxX,g=this.maxY,m=i;m<r;m+=2){var _=e[m],v=e[m+1],y=o*_+h*v+c,b=u*v+a*_+l;p=Math.min(p,y-n),f=Math.max(f,y+n),d=Math.min(d,b-s),g=Math.max(g,b+s)}this.minX=p,this.minY=d,this.maxX=f,this.maxY=g},t.prototype.addBounds=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},t.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=n>h?n:h,this.maxY=s>u?s:u}},t.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},t.prototype.addBoundsArea=function(t,e){var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=n>h?n:h,this.maxY=s>u?s:u}},t.prototype.pad=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},t.prototype.addFramePad=function(t,e,i,r,n,s){t-=n,e-=s,i+=n,r+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r},t}(),w=function(t,e){return w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},w(t,e)};function A(t,e){function i(){this.constructor=t}w(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var C=function(t){function e(){var e=t.call(this)||this;return e.tempDisplayObjectParent=null,e.transform=new T.wx,e.alpha=1,e.visible=!0,e.renderable=!0,e.parent=null,e.worldAlpha=1,e._lastSortedIndex=0,e._zIndex=0,e.filterArea=null,e.filters=null,e._enabledFilters=null,e._bounds=new S,e._localBounds=null,e._boundsID=0,e._boundsRect=null,e._localBoundsRect=null,e._mask=null,e._destroyed=!1,e.isSprite=!1,e.isMask=!1,e}return A(e,t),e.mixin=function(t){for(var i=Object.keys(t),r=0;r<i.length;++r){var n=i[r];Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t,n))}},Object.defineProperty(e.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new T.Ae),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){t||(this._localBoundsRect||(this._localBoundsRect=new T.Ae),t=this._localBoundsRect),this._localBounds||(this._localBounds=new S);var e=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var r=this._bounds,n=this._boundsID;this._bounds=this._localBounds;var s=this.getBounds(!1,t);return this.parent=i,this.transform=e,this._bounds=r,this._bounds.updateID+=this._boundsID-n,s},e.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},e.prototype.destroy=function(t){this.parent&&this.parent.removeChild(this),this.emit("destroyed"),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},Object.defineProperty(e.prototype,"_tempDisplayObjectParent",{get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new O),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),e.prototype.enableTempParent=function(){var t=this.parent;return this.parent=this._tempDisplayObjectParent,t},e.prototype.disableTempParent=function(t){this.parent=t},Object.defineProperty(e.prototype,"x",{get:function(){return this.position.x},set:function(t){this.transform.position.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.position.y},set:function(t){this.transform.position.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this.transform.position},set:function(t){this.transform.position.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this.transform.scale},set:function(t){this.transform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(t){this.transform.pivot.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skew",{get:function(){return this.transform.skew},set:function(t){this.transform.skew.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this.transform.rotation*T.jl},set:function(t){this.transform.rotation=t*T.ZX},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zIndex",{get:function(){return this._zIndex},set:function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldVisible",{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},set:function(t){var e;this._mask&&((e=this._mask.maskObject||this._mask).renderable=!0,e.isMask=!1),this._mask=t,this._mask&&((e=this._mask.maskObject||this._mask).renderable=!1,e.isMask=!0)},enumerable:!1,configurable:!0}),e}(x.EventEmitter),O=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sortDirty=null,e}return A(e,t),e}(C);function I(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}C.prototype.displayObjectUpdateTransform=C.prototype.updateTransform;var R=function(t){function e(){var e=t.call(this)||this;return e.children=[],e.sortableChildren=E.X.SORTABLE_CHILDREN,e.sortDirty=!1,e}return A(e,t),e.prototype.onChildrenChange=function(t){},e.prototype.addChild=function(){for(var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(e.length>1)for(var r=0;r<e.length;r++)this.addChild(e[r]);else{var n=e[0];n.parent&&n.parent.removeChild(n),n.parent=this,this.sortDirty=!0,n.transform._parentID=-1,this.children.push(n),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",n,this,this.children.length-1),n.emit("added",this)}return e[0]},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},e.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e);this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);(0,x.removeItems)(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(){for(var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(e.length>1)for(var r=0;r<e.length;r++)this.removeChild(e[r]);else{var n=e[0],s=this.children.indexOf(n);if(-1===s)return null;n.parent=null,n.transform._parentID=-1,(0,x.removeItems)(this.children,s,1),this._boundsID++,this.onChildrenChange(s),n.emit("removed",this),this.emit("childRemoved",n,this,s)}return e[0]},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,(0,x.removeItems)(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0),void 0===e&&(e=this.children.length);var i,r=t,n=e-r;if(n>0&&n<=e){i=this.children.splice(r,n);for(var s=0;s<i.length;++s)i[s].parent=null,i[s].transform&&(i[s].transform._parentID=-1);for(this._boundsID++,this.onChildrenChange(t),s=0;s<i.length;++s)i[s].emit("removed",this),this.emit("childRemoved",i[s],this,s);return i}if(0===n&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(I),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t];i.visible&&i.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID},e.prototype.getLocalBounds=function(e,i){void 0===i&&(i=!1);var r=t.prototype.getLocalBounds.call(this,e);if(!i)for(var n=0,s=this.children.length;n<s;++n){var o=this.children[n];o.visible&&o.updateTransform()}return r},e.prototype._calculateBounds=function(){},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,i=this.children.length;e<i;++e)this.children[e].render(t)}},e.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var r=0;r<e.length;r++)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t),r=0;for(var n=this.children.length;r<n;r++)this.children[r].render(t);t.batch.flush(),i&&t.mask.pop(this),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var i="boolean"==typeof e?e:e&&e.children,r=this.removeChildren(0,this.children.length);if(i)for(var n=0;n<r.length;++n)r[n].destroy(e)},Object.defineProperty(e.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},enumerable:!1,configurable:!0}),e}(C);R.prototype.containerUpdateTransform=R.prototype.updateTransform;var M={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};C.mixin(M);var P=function(){function t(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(x.isMobile.tablet||x.isMobile.phone)&&this.createTouchHook();var e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=2..toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),self.addEventListener("keydown",this._onKeyDown,!1)}return Object.defineProperty(t.prototype,"isActive",{get:function(){return this._isActive},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMobileAccessibility",{get:function(){return this._isMobileAccessibility},enumerable:!1,configurable:!0}),t.prototype.createTouchHook=function(){var t=this,e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2..toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",(function(){t._isMobileAccessibility=!0,t.activate(),t.destroyTouchHook()})),document.body.appendChild(e),this._hookDiv=e},t.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},t.prototype.activate=function(){var t;this._isActive||(this._isActive=!0,self.document.addEventListener("mousemove",this._onMouseMove,!0),self.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),null===(t=this.renderer.view.parentNode)||void 0===t||t.appendChild(this.div))},t.prototype.deactivate=function(){var t;this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,self.document.removeEventListener("mousemove",this._onMouseMove,!0),self.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),null===(t=this.div.parentNode)||void 0===t||t.removeChild(this.div))},t.prototype.updateAccessibleObjects=function(t){if(t.visible&&t.accessibleChildren){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);for(var e=t.children,i=0;i<e.length;i++)this.updateAccessibleObjects(e[i])}},t.prototype.update=function(){var t=performance.now();if(!(x.isMobile.android.device&&t<this.androidUpdateCount)&&(this.androidUpdateCount=t+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.renderer._lastObjectRendered&&this.updateAccessibleObjects(this.renderer._lastObjectRendered);var e=this.renderer.view.getBoundingClientRect(),i=e.left,r=e.top,n=e.width,s=e.height,o=this.renderer,a=o.width,h=o.height,u=o.resolution,c=n/a*u,l=s/h*u,p=this.div;p.style.left=i+"px",p.style.top=r+"px",p.style.width=a+"px",p.style.height=h+"px";for(var d=0;d<this.children.length;d++){var f=this.children[d];if(f.renderId!==this.renderId)f._accessibleActive=!1,(0,x.removeItems)(this.children,d,1),this.div.removeChild(f._accessibleDiv),this.pool.push(f._accessibleDiv),f._accessibleDiv=null,d--;else{p=f._accessibleDiv;var g=f.hitArea,m=f.worldTransform;f.hitArea?(p.style.left=(m.tx+g.x*m.a)*c+"px",p.style.top=(m.ty+g.y*m.d)*l+"px",p.style.width=g.width*m.a*c+"px",p.style.height=g.height*m.d*l+"px"):(g=f.getBounds(),this.capHitArea(g),p.style.left=g.x*c+"px",p.style.top=g.y*l+"px",p.style.width=g.width*c+"px",p.style.height=g.height*l+"px",p.title!==f.accessibleTitle&&null!==f.accessibleTitle&&(p.title=f.accessibleTitle),p.getAttribute("aria-label")!==f.accessibleHint&&null!==f.accessibleHint&&p.setAttribute("aria-label",f.accessibleHint)),f.accessibleTitle===p.title&&f.tabIndex===p.tabIndex||(p.title=f.accessibleTitle,p.tabIndex=f.tabIndex,this.debug&&this.updateDebugHTML(p))}}this.renderId++}},t.prototype.updateDebugHTML=function(t){t.innerHTML="type: "+t.type+"</br> title : "+t.title+"</br> tabIndex: "+t.tabIndex},t.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);var e=this.renderer,i=e.width,r=e.height;t.x+t.width>i&&(t.width=i-t.x),t.y+t.height>r&&(t.height=r-t.y)},t.prototype.addChild=function(t){var e=this.pool.pop();e||((e=document.createElement("button")).style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2..toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&null!==t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleHint&&null!==t.accessibleHint||(e.title="displayObject "+t.tabIndex),t.accessibleHint&&null!==t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},t.prototype._onClick=function(t){var e=this.renderer.plugins.interaction,i=t.target.displayObject,r=e.eventData;e.dispatchEvent(i,"click",r),e.dispatchEvent(i,"pointertap",r),e.dispatchEvent(i,"tap",r)},t.prototype._onFocus=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive");var e=this.renderer.plugins.interaction,i=t.target.displayObject,r=e.eventData;e.dispatchEvent(i,"mouseover",r)},t.prototype._onFocusOut=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite");var e=this.renderer.plugins.interaction,i=t.target.displayObject,r=e.eventData;e.dispatchEvent(i,"mouseout",r)},t.prototype._onKeyDown=function(t){9===t.keyCode&&this.activate()},t.prototype._onMouseMove=function(t){0===t.movementX&&0===t.movementY||this.deactivate()},t.prototype.destroy=function(){this.destroyTouchHook(),this.div=null,self.document.removeEventListener("mousemove",this._onMouseMove,!0),self.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},t}(),N=i(6679),L=function(){function t(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new T.E9,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(t.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),t.prototype.getLocalPosition=function(t,e,i){return t.worldTransform.applyInverse(i||this.global,e)},t.prototype.copyEvent=function(t){"isPrimary"in t&&t.isPrimary&&(this.isPrimary=!0),this.button="button"in t&&t.button;var e="buttons"in t&&t.buttons;this.buttons=Number.isInteger(e)?e:"which"in t&&t.which,this.width="width"in t&&t.width,this.height="height"in t&&t.height,this.tiltX="tiltX"in t&&t.tiltX,this.tiltY="tiltY"in t&&t.tiltY,this.pointerType="pointerType"in t&&t.pointerType,this.pressure="pressure"in t&&t.pressure,this.rotationAngle="rotationAngle"in t&&t.rotationAngle,this.twist="twist"in t&&t.twist||0,this.tangentialPressure="tangentialPressure"in t&&t.tangentialPressure||0},t.prototype.reset=function(){this.isPrimary=!1},t}(),D=function(t,e){return D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},D(t,e)},k=function(){function t(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return t.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},t.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},t}(),B=function(){function t(e){this._pointerId=e,this._flags=t.FLAGS.NONE}return t.prototype._doSet=function(t,e){this._flags=e?this._flags|t:this._flags&~t},Object.defineProperty(t.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"flags",{get:function(){return this._flags},set:function(t){this._flags=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"none",{get:function(){return this._flags===t.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"over",{get:function(){return 0!=(this._flags&t.FLAGS.OVER)},set:function(e){this._doSet(t.FLAGS.OVER,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightDown",{get:function(){return 0!=(this._flags&t.FLAGS.RIGHT_DOWN)},set:function(e){this._doSet(t.FLAGS.RIGHT_DOWN,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftDown",{get:function(){return 0!=(this._flags&t.FLAGS.LEFT_DOWN)},set:function(e){this._doSet(t.FLAGS.LEFT_DOWN,e)},enumerable:!1,configurable:!0}),t.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),t}(),F=function(){function t(){this._tempPoint=new T.E9}return t.prototype.recursiveFindHit=function(t,e,i,r,n){if(!e||!e.visible)return!1;var s=t.data.global,o=!1,a=n=e.interactive||n,h=!0;if(e.hitArea?(r&&(e.worldTransform.applyInverse(s,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?o=!0:(r=!1,h=!1)),a=!1):e._mask&&r&&(e._mask.containsPoint&&e._mask.containsPoint(s)||(r=!1)),h&&e.interactiveChildren&&e.children)for(var u=e.children,c=u.length-1;c>=0;c--){var l=u[c],p=this.recursiveFindHit(t,l,i,r,a);if(p){if(!l.parent)continue;a=!1,p&&(t.target&&(r=!1),o=!0)}}return n&&(r&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(s)&&(o=!0),e.interactive&&(o&&!t.target&&(t.target=e),i&&i(t,e,!!o))),o},t.prototype.findHit=function(t,e,i,r){this.recursiveFindHit(t,e,i,r,!1)},t}(),G={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(t){t?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};C.mixin(G);var U={target:null,data:{global:null}},j=function(t){function e(e,i){var r=t.call(this)||this;return i=i||{},r.renderer=e,r.autoPreventDefault=void 0===i.autoPreventDefault||i.autoPreventDefault,r.interactionFrequency=i.interactionFrequency||10,r.mouse=new L,r.mouse.identifier=1,r.mouse.global.set(-999999),r.activeInteractionData={},r.activeInteractionData[1]=r.mouse,r.interactionDataPool=[],r.eventData=new k,r.interactionDOMElement=null,r.moveWhenInside=!1,r.eventsAdded=!1,r.tickerAdded=!1,r.mouseOverRenderer=!("PointerEvent"in self),r.supportsTouchEvents="ontouchstart"in self,r.supportsPointerEvents=!!self.PointerEvent,r.onPointerUp=r.onPointerUp.bind(r),r.processPointerUp=r.processPointerUp.bind(r),r.onPointerCancel=r.onPointerCancel.bind(r),r.processPointerCancel=r.processPointerCancel.bind(r),r.onPointerDown=r.onPointerDown.bind(r),r.processPointerDown=r.processPointerDown.bind(r),r.onPointerMove=r.onPointerMove.bind(r),r.processPointerMove=r.processPointerMove.bind(r),r.onPointerOut=r.onPointerOut.bind(r),r.processPointerOverOut=r.processPointerOverOut.bind(r),r.onPointerOver=r.onPointerOver.bind(r),r.cursorStyles={default:"inherit",pointer:"pointer"},r.currentCursorMode=null,r.cursor=null,r.resolution=1,r.delayedEvents=[],r.search=new F,r._tempDisplayObject=new O,r._eventListenerOptions={capture:!0,passive:!1},r._useSystemTicker=void 0===i.useSystemTicker||i.useSystemTicker,r.setTargetElement(r.renderer.view,r.renderer.resolution),r}return function(t,e){function i(){this.constructor=t}D(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}(e,t),Object.defineProperty(e.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(t){this._useSystemTicker=t,t?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),e.prototype.hitTest=function(t,e){return U.target=null,U.data.global=t,e||(e=this.lastObjectRendered),this.processInteractive(U,e,null,!0),U.target},e.prototype.setTargetElement=function(t,e){void 0===e&&(e=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=t,this.resolution=e,this.addEvents(),this.addTickerListener()},e.prototype.addTickerListener=function(){!this.tickerAdded&&this.interactionDOMElement&&this._useSystemTicker&&(N.vB.system.add(this.tickerUpdate,this,N.uF.INTERACTION),this.tickerAdded=!0)},e.prototype.removeTickerListener=function(){this.tickerAdded&&(N.vB.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},e.prototype.addEvents=function(){if(!this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;self.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none"),this.supportsPointerEvents?(self.document.addEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),self.addEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),self.addEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(self.document.addEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),self.addEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.eventsAdded=!0}},e.prototype.removeEvents=function(){if(this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;self.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(self.document.removeEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),self.removeEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),self.removeEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(self.document.removeEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),self.removeEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.interactionDOMElement=null,this.eventsAdded=!1}},e.prototype.tickerUpdate=function(t){this._deltaTime+=t,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())},e.prototype.update=function(){if(this.interactionDOMElement)if(this._didMove)this._didMove=!1;else{for(var t in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(t)){var e=this.activeInteractionData[t];if(e.originalEvent&&"touch"!==e.pointerType){var i=this.configureInteractionEventForDOMEvent(this.eventData,e.originalEvent,e);this.processInteractive(i,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},e.prototype.setCursorMode=function(t){t=t||"default";var e=!0;if(self.OffscreenCanvas&&this.interactionDOMElement instanceof OffscreenCanvas&&(e=!1),this.currentCursorMode!==t){this.currentCursorMode=t;var i=this.cursorStyles[t];if(i)switch(typeof i){case"string":e&&(this.interactionDOMElement.style.cursor=i);break;case"function":i(t);break;case"object":e&&Object.assign(this.interactionDOMElement.style,i)}else e&&"string"==typeof t&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.interactionDOMElement.style.cursor=t)}},e.prototype.dispatchEvent=function(t,e,i){i.stopPropagationHint&&t!==i.stopsPropagatingAt||(i.currentTarget=t,i.type=e,t.emit(e,i),t[e]&&t[e](i))},e.prototype.delayDispatchEvent=function(t,e,i){this.delayedEvents.push({displayObject:t,eventString:e,eventData:i})},e.prototype.mapPositionToPoint=function(t,e,i){var r;r=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:this.interactionDOMElement.width,height:this.interactionDOMElement.height,left:0,top:0};var n=1/this.resolution;t.x=(e-r.left)*(this.interactionDOMElement.width/r.width)*n,t.y=(i-r.top)*(this.interactionDOMElement.height/r.height)*n},e.prototype.processInteractive=function(t,e,i,r){var n=this.search.findHit(t,e,i,r),s=this.delayedEvents;if(!s.length)return n;t.stopPropagationHint=!1;var o=s.length;this.delayedEvents=[];for(var a=0;a<o;a++){var h=s[a],u=h.displayObject,c=h.eventString,l=h.eventData;l.stopsPropagatingAt===u&&(l.stopPropagationHint=!0),this.dispatchEvent(u,c,l)}return n},e.prototype.onPointerDown=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(var i=e.length,r=0;r<i;r++){var n=e[r],s=this.getInteractionDataForPointerId(n),o=this.configureInteractionEventForDOMEvent(this.eventData,n,s);if(o.data.originalEvent=t,this.processInteractive(o,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",o),"touch"===n.pointerType)this.emit("touchstart",o);else if("mouse"===n.pointerType||"pen"===n.pointerType){var a=2===n.button;this.emit(a?"rightdown":"mousedown",this.eventData)}}}},e.prototype.processPointerDown=function(t,e,i){var r=t.data,n=t.data.identifier;if(i)if(e.trackedPointers[n]||(e.trackedPointers[n]=new B(n)),this.dispatchEvent(e,"pointerdown",t),"touch"===r.pointerType)this.dispatchEvent(e,"touchstart",t);else if("mouse"===r.pointerType||"pen"===r.pointerType){var s=2===r.button;s?e.trackedPointers[n].rightDown=!0:e.trackedPointers[n].leftDown=!0,this.dispatchEvent(e,s?"rightdown":"mousedown",t)}},e.prototype.onPointerComplete=function(t,e,i){for(var r=this.normalizeToPointerData(t),n=r.length,s=t.target!==this.interactionDOMElement?"outside":"",o=0;o<n;o++){var a=r[o],h=this.getInteractionDataForPointerId(a),u=this.configureInteractionEventForDOMEvent(this.eventData,a,h);if(u.data.originalEvent=t,this.processInteractive(u,this.lastObjectRendered,i,e||!s),this.emit(e?"pointercancel":"pointerup"+s,u),"mouse"===a.pointerType||"pen"===a.pointerType){var c=2===a.button;this.emit(c?"rightup"+s:"mouseup"+s,u)}else"touch"===a.pointerType&&(this.emit(e?"touchcancel":"touchend"+s,u),this.releaseInteractionDataForPointerId(a.pointerId))}},e.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!0,this.processPointerCancel)},e.prototype.processPointerCancel=function(t,e){var i=t.data,r=t.data.identifier;void 0!==e.trackedPointers[r]&&(delete e.trackedPointers[r],this.dispatchEvent(e,"pointercancel",t),"touch"===i.pointerType&&this.dispatchEvent(e,"touchcancel",t))},e.prototype.onPointerUp=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!1,this.processPointerUp)},e.prototype.processPointerUp=function(t,e,i){var r=t.data,n=t.data.identifier,s=e.trackedPointers[n],o="touch"===r.pointerType,a="mouse"===r.pointerType||"pen"===r.pointerType,h=!1;if(a){var u=2===r.button,c=B.FLAGS,l=u?c.RIGHT_DOWN:c.LEFT_DOWN,p=void 0!==s&&s.flags&l;i?(this.dispatchEvent(e,u?"rightup":"mouseup",t),p&&(this.dispatchEvent(e,u?"rightclick":"click",t),h=!0)):p&&this.dispatchEvent(e,u?"rightupoutside":"mouseupoutside",t),s&&(u?s.rightDown=!1:s.leftDown=!1)}i?(this.dispatchEvent(e,"pointerup",t),o&&this.dispatchEvent(e,"touchend",t),s&&(a&&!h||this.dispatchEvent(e,"pointertap",t),o&&(this.dispatchEvent(e,"tap",t),s.over=!1))):s&&(this.dispatchEvent(e,"pointerupoutside",t),o&&this.dispatchEvent(e,"touchendoutside",t)),s&&s.none&&delete e.trackedPointers[n]},e.prototype.onPointerMove=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);"mouse"!==e[0].pointerType&&"pen"!==e[0].pointerType||(this._didMove=!0,this.cursor=null);for(var i=e.length,r=0;r<i;r++){var n=e[r],s=this.getInteractionDataForPointerId(n),o=this.configureInteractionEventForDOMEvent(this.eventData,n,s);o.data.originalEvent=t,this.processInteractive(o,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",o),"touch"===n.pointerType&&this.emit("touchmove",o),"mouse"!==n.pointerType&&"pen"!==n.pointerType||this.emit("mousemove",o)}"mouse"===e[0].pointerType&&this.setCursorMode(this.cursor)}},e.prototype.processPointerMove=function(t,e,i){var r=t.data,n="touch"===r.pointerType,s="mouse"===r.pointerType||"pen"===r.pointerType;s&&this.processPointerOverOut(t,e,i),this.moveWhenInside&&!i||(this.dispatchEvent(e,"pointermove",t),n&&this.dispatchEvent(e,"touchmove",t),s&&this.dispatchEvent(e,"mousemove",t))},e.prototype.onPointerOut=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t)[0];"mouse"===e.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var i=this.getInteractionDataForPointerId(e),r=this.configureInteractionEventForDOMEvent(this.eventData,e,i);r.data.originalEvent=e,this.processInteractive(r,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",r),"mouse"===e.pointerType||"pen"===e.pointerType?this.emit("mouseout",r):this.releaseInteractionDataForPointerId(i.identifier)}},e.prototype.processPointerOverOut=function(t,e,i){var r=t.data,n=t.data.identifier,s="mouse"===r.pointerType||"pen"===r.pointerType,o=e.trackedPointers[n];i&&!o&&(o=e.trackedPointers[n]=new B(n)),void 0!==o&&(i&&this.mouseOverRenderer?(o.over||(o.over=!0,this.delayDispatchEvent(e,"pointerover",t),s&&this.delayDispatchEvent(e,"mouseover",t)),s&&null===this.cursor&&(this.cursor=e.cursor)):o.over&&(o.over=!1,this.dispatchEvent(e,"pointerout",this.eventData),s&&this.dispatchEvent(e,"mouseout",t),o.none&&delete e.trackedPointers[n]))},e.prototype.onPointerOver=function(t){var e=this.normalizeToPointerData(t)[0],i=this.getInteractionDataForPointerId(e),r=this.configureInteractionEventForDOMEvent(this.eventData,e,i);r.data.originalEvent=e,"mouse"===e.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",r),"mouse"!==e.pointerType&&"pen"!==e.pointerType||this.emit("mouseover",r)},e.prototype.getInteractionDataForPointerId=function(t){var e,i=t.pointerId;return 1===i||"mouse"===t.pointerType?e=this.mouse:this.activeInteractionData[i]?e=this.activeInteractionData[i]:((e=this.interactionDataPool.pop()||new L).identifier=i,this.activeInteractionData[i]=e),e.copyEvent(t),e},e.prototype.releaseInteractionDataForPointerId=function(t){var e=this.activeInteractionData[t];e&&(delete this.activeInteractionData[t],e.reset(),this.interactionDataPool.push(e))},e.prototype.configureInteractionEventForDOMEvent=function(t,e,i){return t.data=i,this.mapPositionToPoint(i.global,e.clientX,e.clientY),"touch"===e.pointerType&&(e.globalX=i.global.x,e.globalY=i.global.y),i.originalEvent=e,t.reset(),t},e.prototype.normalizeToPointerData=function(t){var e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var i=0,r=t.changedTouches.length;i<r;i++){var n=t.changedTouches[i];void 0===n.button&&(n.button=t.touches.length?1:0),void 0===n.buttons&&(n.buttons=t.touches.length?1:0),void 0===n.isPrimary&&(n.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===n.width&&(n.width=n.radiusX||1),void 0===n.height&&(n.height=n.radiusY||1),void 0===n.tiltX&&(n.tiltX=0),void 0===n.tiltY&&(n.tiltY=0),void 0===n.pointerType&&(n.pointerType="touch"),void 0===n.pointerId&&(n.pointerId=n.identifier||0),void 0===n.pressure&&(n.pressure=n.force||.5),void 0===n.twist&&(n.twist=0),void 0===n.tangentialPressure&&(n.tangentialPressure=0),void 0===n.layerX&&(n.layerX=n.offsetX=n.clientX),void 0===n.layerY&&(n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,e.push(n)}else if(!self.MouseEvent||t instanceof MouseEvent&&!(this.supportsPointerEvents&&t instanceof self.PointerEvent)){var s=t;void 0===s.isPrimary&&(s.isPrimary=!0),void 0===s.width&&(s.width=1),void 0===s.height&&(s.height=1),void 0===s.tiltX&&(s.tiltX=0),void 0===s.tiltY&&(s.tiltY=0),void 0===s.pointerType&&(s.pointerType="mouse"),void 0===s.pointerId&&(s.pointerId=1),void 0===s.pressure&&(s.pressure=.5),void 0===s.twist&&(s.twist=0),void 0===s.tangentialPressure&&(s.tangentialPressure=0),s.isNormalized=!0,e.push(s)}else e.push(t);return e},e.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},e}(x.EventEmitter),X=i(2038),z=function(){function t(e){var i=this;this.stage=new R,e=Object.assign({forceCanvas:!1},e),this.renderer=(0,X.e6)(e),t._plugins.forEach((function(t){t.init.call(i,e)}))}return t.registerPlugin=function(e){t._plugins.push(e)},t.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(t.prototype,"view",{get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"screen",{get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),t.prototype.destroy=function(e,i){var r=this,n=t._plugins.slice(0);n.reverse(),n.forEach((function(t){t.destroy.call(r)})),this.stage.destroy(i),this.stage=null,this.renderer.destroy(e),this.renderer=null},t._plugins=[],t}(),H=function(){function t(){}return t.init=function(t){var e=this;Object.defineProperty(this,"resizeTo",{set:function(t){self.removeEventListener("resize",this.queueResize),this._resizeTo=t,t&&(self.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){e._resizeTo&&(e.cancelResize(),e._resizeId=requestAnimationFrame((function(){return e.resize()})))},this.cancelResize=function(){e._resizeId&&(cancelAnimationFrame(e._resizeId),e._resizeId=null)},this.resize=function(){if(e._resizeTo){var t,i;if(e.cancelResize(),e._resizeTo===self)t=self.innerWidth,i=self.innerHeight;else{var r=e._resizeTo;t=r.clientWidth,i=r.clientHeight}e.renderer.resize(t,i)}},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null},t.destroy=function(){self.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},t}();z.registerPlugin(H);var V,Y,W=new T.Ae,$=function(){function t(t){this.renderer=t}return t.prototype.image=function(t,e,i){var r=new Image;return r.src=this.base64(t,e,i),r},t.prototype.base64=function(t,e,i){return this.canvas(t).toDataURL(e,i)},t.prototype.canvas=function(e){var i,r,n,s=this.renderer,o=!1,a=!1;e&&(e instanceof X.TI?n=e:(n=this.renderer.generateTexture(e),a=!0)),n?(i=n.baseTexture.resolution,r=n.frame,o=!1,s.renderTexture.bind(n)):(i=this.renderer.resolution,o=!0,(r=W).width=this.renderer.width,r.height=this.renderer.height,s.renderTexture.bind(null));var h=Math.floor(r.width*i+1e-4),u=Math.floor(r.height*i+1e-4),c=new x.CanvasRenderTarget(h,u,1),l=new Uint8Array(4*h*u),p=s.gl;p.readPixels(r.x*i,r.y*i,h,u,p.RGBA,p.UNSIGNED_BYTE,l);var d=c.context.getImageData(0,0,h,u);if(t.arrayPostDivide(l,d.data),c.context.putImageData(d,0,0),o){var f=new x.CanvasRenderTarget(c.width,c.height,1);f.context.scale(1,-1),f.context.drawImage(c.canvas,0,-u),c.destroy(),c=f}return a&&n.destroy(!0),c.canvas},t.prototype.pixels=function(e){var i,r,n,s=this.renderer,o=!1;e&&(e instanceof X.TI?n=e:(n=this.renderer.generateTexture(e),o=!0)),n?(i=n.baseTexture.resolution,r=n.frame,s.renderTexture.bind(n)):(i=s.resolution,(r=W).width=s.width,r.height=s.height,s.renderTexture.bind(null));var a=r.width*i,h=r.height*i,u=new Uint8Array(4*a*h),c=s.gl;return c.readPixels(r.x*i,r.y*i,a,h,c.RGBA,c.UNSIGNED_BYTE,u),o&&n.destroy(!0),t.arrayPostDivide(u,u),u},t.prototype.destroy=function(){this.renderer=null},t.arrayPostDivide=function(t,e){for(var i=0;i<t.length;i+=4){var r=e[i+3]=t[i+3];0!==r?(e[i]=Math.round(Math.min(255*t[i]/r,255)),e[i+1]=Math.round(Math.min(255*t[i+1]/r,255)),e[i+2]=Math.round(Math.min(255*t[i+2]/r,255))):(e[i]=t[i],e[i+1]=t[i+1],e[i+2]=t[i+2])}},t}(),q=i(550),Z=i(1680);!function(t){t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL"}(Y||(Y={}));var K=((V={})[Y.COMPRESSED_RGB_S3TC_DXT1_EXT]=.5,V[Y.COMPRESSED_RGBA_S3TC_DXT1_EXT]=.5,V[Y.COMPRESSED_RGBA_S3TC_DXT3_EXT]=1,V[Y.COMPRESSED_RGBA_S3TC_DXT5_EXT]=1,V[Y.COMPRESSED_SRGB_S3TC_DXT1_EXT]=.5,V[Y.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT]=.5,V[Y.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT]=1,V[Y.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT]=1,V[Y.COMPRESSED_R11_EAC]=.5,V[Y.COMPRESSED_SIGNED_R11_EAC]=.5,V[Y.COMPRESSED_RG11_EAC]=1,V[Y.COMPRESSED_SIGNED_RG11_EAC]=1,V[Y.COMPRESSED_RGB8_ETC2]=.5,V[Y.COMPRESSED_RGBA8_ETC2_EAC]=1,V[Y.COMPRESSED_SRGB8_ETC2]=.5,V[Y.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC]=1,V[Y.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,V[Y.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,V[Y.COMPRESSED_RGB_PVRTC_4BPPV1_IMG]=.5,V[Y.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG]=.5,V[Y.COMPRESSED_RGB_PVRTC_2BPPV1_IMG]=.25,V[Y.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG]=.25,V[Y.COMPRESSED_RGB_ETC1_WEBGL]=.5,V[Y.COMPRESSED_RGB_ATC_WEBGL]=.5,V[Y.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL]=1,V[Y.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL]=1,V),J=function(t,e){return J=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},J(t,e)};function Q(t,e){function i(){this.constructor=t}J(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var tt,et,it=function(t){function e(e,i){void 0===i&&(i={width:1,height:1,autoLoad:!0});var r,n,s=this;return"string"==typeof e?(r=e,n=new Uint8Array):(r=null,n=e),(s=t.call(this,n,i)||this).origin=r,s.buffer=n?new X.Rv(n):null,s.origin&&!1!==i.autoLoad&&s.load(),n&&n.length&&(s.loaded=!0,s.onBlobLoaded(s.buffer.rawBinaryData)),s}return Q(e,t),e.prototype.onBlobLoaded=function(t){},e.prototype.load=function(){return t=this,void 0,i=function(){var t;return function(t,e){var i,r,n,s,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((n=(n=o.trys).length>0&&n[n.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(6===s[0]&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{i=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}(this,(function(e){switch(e.label){case 0:return[4,fetch(this.origin)];case 1:return[4,e.sent().blob()];case 2:return[4,e.sent().arrayBuffer()];case 3:return t=e.sent(),this.data=new Uint32Array(t),this.buffer=new X.Rv(t),this.loaded=!0,this.onBlobLoaded(t),this.update(),[2,this]}}))},new((e=Promise)||(e=Promise))((function(r,n){function s(t){try{a(i.next(t))}catch(t){n(t)}}function o(t){try{a(i.throw(t))}catch(t){n(t)}}function a(t){t.done?r(t.value):new e((function(e){e(t.value)})).then(s,o)}a((i=i.apply(t,[])).next())}));var t,e,i},e}(X.qm),rt=function(t){function e(i,r){var n=t.call(this,i,r)||this;return n.format=r.format,n.levels=r.levels||1,n._width=r.width,n._height=r.height,n._extension=e._formatToExtension(n.format),(r.levelBuffers||n.buffer)&&(n._levelBuffers=r.levelBuffers||e._createLevelBuffers(i instanceof Uint8Array?i:n.buffer.uint8View,n.format,n.levels,4,4,n.width,n.height)),n}return Q(e,t),e.prototype.upload=function(t,e,i){var r=t.gl;if(!t.context.extensions[this._extension])throw new Error(this._extension+" textures are not supported on the current machine");if(!this._levelBuffers)return!1;for(var n=0,s=this.levels;n<s;n++){var o=this._levelBuffers[n],a=o.levelID,h=o.levelWidth,u=o.levelHeight,c=o.levelBuffer;r.compressedTexImage2D(r.TEXTURE_2D,a,this.format,h,u,0,c)}return!0},e.prototype.onBlobLoaded=function(){this._levelBuffers=e._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)},e._formatToExtension=function(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")},e._createLevelBuffers=function(t,e,i,r,n,s,o){for(var a=new Array(i),h=t.byteOffset,u=s,c=o,l=u+r-1&~(r-1),p=c+n-1&~(n-1),d=l*p*K[e],f=0;f<i;f++)a[f]={levelID:f,levelWidth:i>1?u:l,levelHeight:i>1?c:p,levelBuffer:new Uint8Array(t.buffer,h,d)},h+=d,d=(l=(u=u>>1||1)+r-1&~(r-1))*(p=(c=c>>1||1)+n-1&~(n-1))*K[e];return a},e}(it),nt=function(){function t(){}return t.use=function(e,i){var r=e.data;if(e.type===q.kC.TYPE.JSON&&r&&r.cacheID&&r.textures){for(var n=r.textures,s=void 0,o=void 0,a=0,h=n.length;a<h;a++){var u=n[a],c=u.src,l=u.format;if(l||(o=c),t.textureFormats[l]){s=c;break}}if(!(s=s||o))return void i(new Error("Cannot load compressed-textures in "+e.url+", make sure you provide a fallback"));if(s===e.url)return void i(new Error("URL of compressed texture cannot be the same as the manifest's URL"));var p={crossOrigin:e.crossOrigin,metadata:e.metadata.imageMetadata,parentResource:e},d=x.url.resolve(e.url.replace(this.baseUrl,""),s),f=r.cacheID;this.add(f,d,p,(function(t){if(t.error)i(t.error);else{var r=t.texture,n=void 0===r?null:r,s=t.textures,o=void 0===s?{}:s;Object.assign(e,{texture:n,textures:o}),i()}}))}else i()},t.add=function(){var e=document.createElement("canvas").getContext("webgl");if(e){var i={s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};for(var r in t.textureExtensions=i,t.textureFormats={},i){var n=i[r];n&&Object.assign(t.textureFormats,Object.getPrototypeOf(n))}}else console.warn("WebGL not available for compressed textures. Silently failing.")},t}();function st(t,e,i){var r={textures:{},texture:null};return e?(e.map((function(t){return new X.xE(new X.VL(t,Object.assign({mipmap:Z.WB.OFF,alphaMode:Z.iw.NO_PREMULTIPLIED_ALPHA},i)))})).forEach((function(e,i){var n=e.baseTexture,s=t+"-"+(i+1);X.VL.addToCache(n,s),X.xE.addToCache(e,s),0===i&&(X.VL.addToCache(n,t),X.xE.addToCache(e,t),r.texture=e),r.textures[s]=e})),r):r}q.kC.setExtensionXhrType("dds",q.kC.XHR_RESPONSE_TYPE.BUFFER);var ot,at;!function(t){t[t.DXGI_FORMAT_UNKNOWN=0]="DXGI_FORMAT_UNKNOWN",t[t.DXGI_FORMAT_R32G32B32A32_TYPELESS=1]="DXGI_FORMAT_R32G32B32A32_TYPELESS",t[t.DXGI_FORMAT_R32G32B32A32_FLOAT=2]="DXGI_FORMAT_R32G32B32A32_FLOAT",t[t.DXGI_FORMAT_R32G32B32A32_UINT=3]="DXGI_FORMAT_R32G32B32A32_UINT",t[t.DXGI_FORMAT_R32G32B32A32_SINT=4]="DXGI_FORMAT_R32G32B32A32_SINT",t[t.DXGI_FORMAT_R32G32B32_TYPELESS=5]="DXGI_FORMAT_R32G32B32_TYPELESS",t[t.DXGI_FORMAT_R32G32B32_FLOAT=6]="DXGI_FORMAT_R32G32B32_FLOAT",t[t.DXGI_FORMAT_R32G32B32_UINT=7]="DXGI_FORMAT_R32G32B32_UINT",t[t.DXGI_FORMAT_R32G32B32_SINT=8]="DXGI_FORMAT_R32G32B32_SINT",t[t.DXGI_FORMAT_R16G16B16A16_TYPELESS=9]="DXGI_FORMAT_R16G16B16A16_TYPELESS",t[t.DXGI_FORMAT_R16G16B16A16_FLOAT=10]="DXGI_FORMAT_R16G16B16A16_FLOAT",t[t.DXGI_FORMAT_R16G16B16A16_UNORM=11]="DXGI_FORMAT_R16G16B16A16_UNORM",t[t.DXGI_FORMAT_R16G16B16A16_UINT=12]="DXGI_FORMAT_R16G16B16A16_UINT",t[t.DXGI_FORMAT_R16G16B16A16_SNORM=13]="DXGI_FORMAT_R16G16B16A16_SNORM",t[t.DXGI_FORMAT_R16G16B16A16_SINT=14]="DXGI_FORMAT_R16G16B16A16_SINT",t[t.DXGI_FORMAT_R32G32_TYPELESS=15]="DXGI_FORMAT_R32G32_TYPELESS",t[t.DXGI_FORMAT_R32G32_FLOAT=16]="DXGI_FORMAT_R32G32_FLOAT",t[t.DXGI_FORMAT_R32G32_UINT=17]="DXGI_FORMAT_R32G32_UINT",t[t.DXGI_FORMAT_R32G32_SINT=18]="DXGI_FORMAT_R32G32_SINT",t[t.DXGI_FORMAT_R32G8X24_TYPELESS=19]="DXGI_FORMAT_R32G8X24_TYPELESS",t[t.DXGI_FORMAT_D32_FLOAT_S8X24_UINT=20]="DXGI_FORMAT_D32_FLOAT_S8X24_UINT",t[t.DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS=21]="DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS",t[t.DXGI_FORMAT_X32_TYPELESS_G8X24_UINT=22]="DXGI_FORMAT_X32_TYPELESS_G8X24_UINT",t[t.DXGI_FORMAT_R10G10B10A2_TYPELESS=23]="DXGI_FORMAT_R10G10B10A2_TYPELESS",t[t.DXGI_FORMAT_R10G10B10A2_UNORM=24]="DXGI_FORMAT_R10G10B10A2_UNORM",t[t.DXGI_FORMAT_R10G10B10A2_UINT=25]="DXGI_FORMAT_R10G10B10A2_UINT",t[t.DXGI_FORMAT_R11G11B10_FLOAT=26]="DXGI_FORMAT_R11G11B10_FLOAT",t[t.DXGI_FORMAT_R8G8B8A8_TYPELESS=27]="DXGI_FORMAT_R8G8B8A8_TYPELESS",t[t.DXGI_FORMAT_R8G8B8A8_UNORM=28]="DXGI_FORMAT_R8G8B8A8_UNORM",t[t.DXGI_FORMAT_R8G8B8A8_UNORM_SRGB=29]="DXGI_FORMAT_R8G8B8A8_UNORM_SRGB",t[t.DXGI_FORMAT_R8G8B8A8_UINT=30]="DXGI_FORMAT_R8G8B8A8_UINT",t[t.DXGI_FORMAT_R8G8B8A8_SNORM=31]="DXGI_FORMAT_R8G8B8A8_SNORM",t[t.DXGI_FORMAT_R8G8B8A8_SINT=32]="DXGI_FORMAT_R8G8B8A8_SINT",t[t.DXGI_FORMAT_R16G16_TYPELESS=33]="DXGI_FORMAT_R16G16_TYPELESS",t[t.DXGI_FORMAT_R16G16_FLOAT=34]="DXGI_FORMAT_R16G16_FLOAT",t[t.DXGI_FORMAT_R16G16_UNORM=35]="DXGI_FORMAT_R16G16_UNORM",t[t.DXGI_FORMAT_R16G16_UINT=36]="DXGI_FORMAT_R16G16_UINT",t[t.DXGI_FORMAT_R16G16_SNORM=37]="DXGI_FORMAT_R16G16_SNORM",t[t.DXGI_FORMAT_R16G16_SINT=38]="DXGI_FORMAT_R16G16_SINT",t[t.DXGI_FORMAT_R32_TYPELESS=39]="DXGI_FORMAT_R32_TYPELESS",t[t.DXGI_FORMAT_D32_FLOAT=40]="DXGI_FORMAT_D32_FLOAT",t[t.DXGI_FORMAT_R32_FLOAT=41]="DXGI_FORMAT_R32_FLOAT",t[t.DXGI_FORMAT_R32_UINT=42]="DXGI_FORMAT_R32_UINT",t[t.DXGI_FORMAT_R32_SINT=43]="DXGI_FORMAT_R32_SINT",t[t.DXGI_FORMAT_R24G8_TYPELESS=44]="DXGI_FORMAT_R24G8_TYPELESS",t[t.DXGI_FORMAT_D24_UNORM_S8_UINT=45]="DXGI_FORMAT_D24_UNORM_S8_UINT",t[t.DXGI_FORMAT_R24_UNORM_X8_TYPELESS=46]="DXGI_FORMAT_R24_UNORM_X8_TYPELESS",t[t.DXGI_FORMAT_X24_TYPELESS_G8_UINT=47]="DXGI_FORMAT_X24_TYPELESS_G8_UINT",t[t.DXGI_FORMAT_R8G8_TYPELESS=48]="DXGI_FORMAT_R8G8_TYPELESS",t[t.DXGI_FORMAT_R8G8_UNORM=49]="DXGI_FORMAT_R8G8_UNORM",t[t.DXGI_FORMAT_R8G8_UINT=50]="DXGI_FORMAT_R8G8_UINT",t[t.DXGI_FORMAT_R8G8_SNORM=51]="DXGI_FORMAT_R8G8_SNORM",t[t.DXGI_FORMAT_R8G8_SINT=52]="DXGI_FORMAT_R8G8_SINT",t[t.DXGI_FORMAT_R16_TYPELESS=53]="DXGI_FORMAT_R16_TYPELESS",t[t.DXGI_FORMAT_R16_FLOAT=54]="DXGI_FORMAT_R16_FLOAT",t[t.DXGI_FORMAT_D16_UNORM=55]="DXGI_FORMAT_D16_UNORM",t[t.DXGI_FORMAT_R16_UNORM=56]="DXGI_FORMAT_R16_UNORM",t[t.DXGI_FORMAT_R16_UINT=57]="DXGI_FORMAT_R16_UINT",t[t.DXGI_FORMAT_R16_SNORM=58]="DXGI_FORMAT_R16_SNORM",t[t.DXGI_FORMAT_R16_SINT=59]="DXGI_FORMAT_R16_SINT",t[t.DXGI_FORMAT_R8_TYPELESS=60]="DXGI_FORMAT_R8_TYPELESS",t[t.DXGI_FORMAT_R8_UNORM=61]="DXGI_FORMAT_R8_UNORM",t[t.DXGI_FORMAT_R8_UINT=62]="DXGI_FORMAT_R8_UINT",t[t.DXGI_FORMAT_R8_SNORM=63]="DXGI_FORMAT_R8_SNORM",t[t.DXGI_FORMAT_R8_SINT=64]="DXGI_FORMAT_R8_SINT",t[t.DXGI_FORMAT_A8_UNORM=65]="DXGI_FORMAT_A8_UNORM",t[t.DXGI_FORMAT_R1_UNORM=66]="DXGI_FORMAT_R1_UNORM",t[t.DXGI_FORMAT_R9G9B9E5_SHAREDEXP=67]="DXGI_FORMAT_R9G9B9E5_SHAREDEXP",t[t.DXGI_FORMAT_R8G8_B8G8_UNORM=68]="DXGI_FORMAT_R8G8_B8G8_UNORM",t[t.DXGI_FORMAT_G8R8_G8B8_UNORM=69]="DXGI_FORMAT_G8R8_G8B8_UNORM",t[t.DXGI_FORMAT_BC1_TYPELESS=70]="DXGI_FORMAT_BC1_TYPELESS",t[t.DXGI_FORMAT_BC1_UNORM=71]="DXGI_FORMAT_BC1_UNORM",t[t.DXGI_FORMAT_BC1_UNORM_SRGB=72]="DXGI_FORMAT_BC1_UNORM_SRGB",t[t.DXGI_FORMAT_BC2_TYPELESS=73]="DXGI_FORMAT_BC2_TYPELESS",t[t.DXGI_FORMAT_BC2_UNORM=74]="DXGI_FORMAT_BC2_UNORM",t[t.DXGI_FORMAT_BC2_UNORM_SRGB=75]="DXGI_FORMAT_BC2_UNORM_SRGB",t[t.DXGI_FORMAT_BC3_TYPELESS=76]="DXGI_FORMAT_BC3_TYPELESS",t[t.DXGI_FORMAT_BC3_UNORM=77]="DXGI_FORMAT_BC3_UNORM",t[t.DXGI_FORMAT_BC3_UNORM_SRGB=78]="DXGI_FORMAT_BC3_UNORM_SRGB",t[t.DXGI_FORMAT_BC4_TYPELESS=79]="DXGI_FORMAT_BC4_TYPELESS",t[t.DXGI_FORMAT_BC4_UNORM=80]="DXGI_FORMAT_BC4_UNORM",t[t.DXGI_FORMAT_BC4_SNORM=81]="DXGI_FORMAT_BC4_SNORM",t[t.DXGI_FORMAT_BC5_TYPELESS=82]="DXGI_FORMAT_BC5_TYPELESS",t[t.DXGI_FORMAT_BC5_UNORM=83]="DXGI_FORMAT_BC5_UNORM",t[t.DXGI_FORMAT_BC5_SNORM=84]="DXGI_FORMAT_BC5_SNORM",t[t.DXGI_FORMAT_B5G6R5_UNORM=85]="DXGI_FORMAT_B5G6R5_UNORM",t[t.DXGI_FORMAT_B5G5R5A1_UNORM=86]="DXGI_FORMAT_B5G5R5A1_UNORM",t[t.DXGI_FORMAT_B8G8R8A8_UNORM=87]="DXGI_FORMAT_B8G8R8A8_UNORM",t[t.DXGI_FORMAT_B8G8R8X8_UNORM=88]="DXGI_FORMAT_B8G8R8X8_UNORM",t[t.DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM=89]="DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM",t[t.DXGI_FORMAT_B8G8R8A8_TYPELESS=90]="DXGI_FORMAT_B8G8R8A8_TYPELESS",t[t.DXGI_FORMAT_B8G8R8A8_UNORM_SRGB=91]="DXGI_FORMAT_B8G8R8A8_UNORM_SRGB",t[t.DXGI_FORMAT_B8G8R8X8_TYPELESS=92]="DXGI_FORMAT_B8G8R8X8_TYPELESS",t[t.DXGI_FORMAT_B8G8R8X8_UNORM_SRGB=93]="DXGI_FORMAT_B8G8R8X8_UNORM_SRGB",t[t.DXGI_FORMAT_BC6H_TYPELESS=94]="DXGI_FORMAT_BC6H_TYPELESS",t[t.DXGI_FORMAT_BC6H_UF16=95]="DXGI_FORMAT_BC6H_UF16",t[t.DXGI_FORMAT_BC6H_SF16=96]="DXGI_FORMAT_BC6H_SF16",t[t.DXGI_FORMAT_BC7_TYPELESS=97]="DXGI_FORMAT_BC7_TYPELESS",t[t.DXGI_FORMAT_BC7_UNORM=98]="DXGI_FORMAT_BC7_UNORM",t[t.DXGI_FORMAT_BC7_UNORM_SRGB=99]="DXGI_FORMAT_BC7_UNORM_SRGB",t[t.DXGI_FORMAT_AYUV=100]="DXGI_FORMAT_AYUV",t[t.DXGI_FORMAT_Y410=101]="DXGI_FORMAT_Y410",t[t.DXGI_FORMAT_Y416=102]="DXGI_FORMAT_Y416",t[t.DXGI_FORMAT_NV12=103]="DXGI_FORMAT_NV12",t[t.DXGI_FORMAT_P010=104]="DXGI_FORMAT_P010",t[t.DXGI_FORMAT_P016=105]="DXGI_FORMAT_P016",t[t.DXGI_FORMAT_420_OPAQUE=106]="DXGI_FORMAT_420_OPAQUE",t[t.DXGI_FORMAT_YUY2=107]="DXGI_FORMAT_YUY2",t[t.DXGI_FORMAT_Y210=108]="DXGI_FORMAT_Y210",t[t.DXGI_FORMAT_Y216=109]="DXGI_FORMAT_Y216",t[t.DXGI_FORMAT_NV11=110]="DXGI_FORMAT_NV11",t[t.DXGI_FORMAT_AI44=111]="DXGI_FORMAT_AI44",t[t.DXGI_FORMAT_IA44=112]="DXGI_FORMAT_IA44",t[t.DXGI_FORMAT_P8=113]="DXGI_FORMAT_P8",t[t.DXGI_FORMAT_A8P8=114]="DXGI_FORMAT_A8P8",t[t.DXGI_FORMAT_B4G4R4A4_UNORM=115]="DXGI_FORMAT_B4G4R4A4_UNORM",t[t.DXGI_FORMAT_P208=116]="DXGI_FORMAT_P208",t[t.DXGI_FORMAT_V208=117]="DXGI_FORMAT_V208",t[t.DXGI_FORMAT_V408=118]="DXGI_FORMAT_V408",t[t.DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE=119]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE",t[t.DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE=120]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE",t[t.DXGI_FORMAT_FORCE_UINT=121]="DXGI_FORMAT_FORCE_UINT"}(ot||(ot={})),function(t){t[t.DDS_DIMENSION_TEXTURE1D=2]="DDS_DIMENSION_TEXTURE1D",t[t.DDS_DIMENSION_TEXTURE2D=3]="DDS_DIMENSION_TEXTURE2D",t[t.DDS_DIMENSION_TEXTURE3D=6]="DDS_DIMENSION_TEXTURE3D"}(at||(at={}));var ht,ut,ct,lt=((tt={})[827611204]=Y.COMPRESSED_RGBA_S3TC_DXT1_EXT,tt[861165636]=Y.COMPRESSED_RGBA_S3TC_DXT3_EXT,tt[894720068]=Y.COMPRESSED_RGBA_S3TC_DXT5_EXT,tt),pt=((et={})[ot.DXGI_FORMAT_BC1_TYPELESS]=Y.COMPRESSED_RGBA_S3TC_DXT1_EXT,et[ot.DXGI_FORMAT_BC1_UNORM]=Y.COMPRESSED_RGBA_S3TC_DXT1_EXT,et[ot.DXGI_FORMAT_BC2_TYPELESS]=Y.COMPRESSED_RGBA_S3TC_DXT3_EXT,et[ot.DXGI_FORMAT_BC2_UNORM]=Y.COMPRESSED_RGBA_S3TC_DXT3_EXT,et[ot.DXGI_FORMAT_BC3_TYPELESS]=Y.COMPRESSED_RGBA_S3TC_DXT5_EXT,et[ot.DXGI_FORMAT_BC3_UNORM]=Y.COMPRESSED_RGBA_S3TC_DXT5_EXT,et[ot.DXGI_FORMAT_BC1_UNORM_SRGB]=Y.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,et[ot.DXGI_FORMAT_BC2_UNORM_SRGB]=Y.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,et[ot.DXGI_FORMAT_BC3_UNORM_SRGB]=Y.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,et),dt=function(){function t(){}return t.use=function(e,i){if("dds"===e.extension&&e.data)try{Object.assign(e,st(e.name||e.url,t.parse(e.data),e.metadata))}catch(t){return void i(t)}i()},t.parse=function(t){var e=new Uint32Array(t);if(542327876!==e[0])throw new Error("Invalid DDS file magic word");var i=new Uint32Array(t,0,124/Uint32Array.BYTES_PER_ELEMENT),r=i[3],n=i[4],s=i[7],o=new Uint32Array(t,19*Uint32Array.BYTES_PER_ELEMENT,32/Uint32Array.BYTES_PER_ELEMENT),a=o[1];if(4&a){var h=o[2];if(808540228!==h){var u=lt[h],c=new Uint8Array(t,128);return[new rt(c,{format:u,width:n,height:r,levels:s})]}var l=new Uint32Array(e.buffer,128,20/Uint32Array.BYTES_PER_ELEMENT),p=l[0],d=l[1],f=l[2],g=l[3],m=pt[p];if(void 0===m)throw new Error("DDSLoader cannot parse texture data with DXGI format "+p);if(4===f)throw new Error("DDSLoader does not support cubemap textures");if(d===at.DDS_DIMENSION_TEXTURE3D)throw new Error("DDSLoader does not supported 3D texture data");var _=new Array;if(1===g)_.push(new Uint8Array(t,148));else{for(var v=K[m],y=0,b=n,x=r,E=0;E<s;E++)y+=Math.max(1,b+3&-4)*Math.max(1,x+3&-4)*v,b>>>=1,x>>>=1;var T=148;for(E=0;E<g;E++)_.push(new Uint8Array(t,T,y)),T+=y}return _.map((function(t){return new rt(t,{format:m,width:n,height:r,levels:s})}))}if(64&a)throw new Error("DDSLoader does not support uncompressed texture data.");if(512&a)throw new Error("DDSLoader does not supported YUV uncompressed texture data.");if(131072&a)throw new Error("DDSLoader does not support single-channel (lumninance) texture data!");if(2&a)throw new Error("DDSLoader does not support single-channel (alpha) texture data!");throw new Error("DDSLoader failed to load a texture file due to an unknown reason!")},t}();q.kC.setExtensionXhrType("ktx",q.kC.XHR_RESPONSE_TYPE.BUFFER);var ft=[171,75,84,88,32,49,49,187,13,10,26,10],gt=((ht={})[Z.vK.UNSIGNED_BYTE]=1,ht[Z.vK.UNSIGNED_SHORT]=2,ht[Z.vK.FLOAT]=4,ht[Z.vK.HALF_FLOAT]=8,ht),mt=((ut={})[Z.I2.RGBA]=4,ut[Z.I2.RGB]=3,ut[Z.I2.LUMINANCE]=1,ut[Z.I2.LUMINANCE_ALPHA]=2,ut[Z.I2.ALPHA]=1,ut),_t=((ct={})[Z.vK.UNSIGNED_SHORT_4_4_4_4]=2,ct[Z.vK.UNSIGNED_SHORT_5_5_5_1]=2,ct[Z.vK.UNSIGNED_SHORT_5_6_5]=2,ct),vt=function(){function t(){}return t.use=function(e,i){if("ktx"===e.extension&&e.data)try{var r=e.name||e.url;Object.assign(e,st(r,t.parse(r,e.data),e.metadata))}catch(t){return void i(t)}i()},t.parse=function(e,i){var r=new DataView(i);if(!t.validate(e,r))return null;var n=67305985===r.getUint32(12,!0),s=r.getUint32(16,n),o=r.getUint32(24,n),a=r.getUint32(28,n),h=r.getUint32(36,n),u=r.getUint32(40,n)||1,c=r.getUint32(44,n)||1,l=r.getUint32(48,n)||1,p=r.getUint32(52,n),d=r.getUint32(56,n),f=r.getUint32(60,n);if(0===u||1!==c)throw new Error("Only 2D textures are supported");if(1!==p)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(1!==l)throw new Error("WebGL does not support array textures");var g,m=h+3&-4,_=u+3&-4,v=new Array(l),y=h*u;if(0===s&&(y=m*_),void 0===(g=0!==s?gt[s]?gt[s]*mt[o]:_t[s]:K[a]))throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");for(var b=y*g,x=h,E=u,T=m,S=_,w=64+f,A=0;A<d;A++){for(var C=r.getUint32(w,n),O=w+4,I=0;I<l;I++){var R=v[I];R||(R=v[I]=new Array(d)),R[A]={levelID:A,levelWidth:d>1?x:T,levelHeight:d>1?E:S,levelBuffer:new Uint8Array(i,O,b)},O+=b}w=(w+=C+4)%4!=0?w+4-w%4:w,b=(T=(x=x>>1||1)+4-1&-4)*(S=(E=E>>1||1)+4-1&-4)*g}if(0!==s)throw new Error("TODO: Uncompressed");return v.map((function(t){return new rt(null,{format:a,width:h,height:u,levels:d,levelBuffers:t})}))},t.validate=function(t,e){for(var i=0;i<ft.length;i++)if(e.getUint8(i)!==ft[i])return console.error(t+" is not a valid *.ktx file!"),!1;return!0},t}(),yt=function(t,e){return yt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},yt(t,e)};function bt(t,e){function i(){this.constructor=t}yt(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var xt,Et,Tt=function(t){function e(e,i,r,n){void 0===e&&(e=1500),void 0===r&&(r=16384),void 0===n&&(n=!1);var s=t.call(this)||this;return r>16384&&(r=16384),s._properties=[!1,!0,!1,!1,!1],s._maxSize=e,s._batchSize=r,s._buffers=null,s._bufferUpdateIDs=[],s._updateID=0,s.interactiveChildren=!1,s.blendMode=Z.T$.NORMAL,s.autoResize=n,s.roundPixels=!0,s.baseTexture=null,s.setProperties(i),s._tint=0,s.tintRgb=new Float32Array(4),s.tint=16777215,s}return bt(e,t),e.prototype.setProperties=function(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])},e.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,(0,x.hex2rgb)(t,this.tintRgb)},enumerable:!1,configurable:!0}),e.prototype.render=function(t){var e=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",(function(){return e.onChildrenChange(0)}))),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},e.prototype.onChildrenChange=function(t){for(var e=Math.floor(t/this._batchSize);this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID},e.prototype.dispose=function(){if(this._buffers){for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},e}(R),St=function(){function t(t,e,i){this.geometry=new X.ZX,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(var r=0;r<t.length;++r){var n=t[r];n={attributeName:n.attributeName,size:n.size,uploadFunction:n.uploadFunction,type:n.type||Z.vK.FLOAT,offset:n.offset},e[r]?this.dynamicProperties.push(n):this.staticProperties.push(n)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return t.prototype.initBuffers=function(){var t=this.geometry,e=0;this.indexBuffer=new X.lW((0,x.createIndicesForQuads)(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(var i=0;i<this.dynamicProperties.length;++i)(o=this.dynamicProperties[i]).offset=e,e+=o.size,this.dynamicStride+=o.size;var r=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(r),this.dynamicDataUint32=new Uint32Array(r),this.dynamicBuffer=new X.lW(this.dynamicData,!1,!1);var n=0;for(this.staticStride=0,i=0;i<this.staticProperties.length;++i)(o=this.staticProperties[i]).offset=n,n+=o.size,this.staticStride+=o.size;var s=new ArrayBuffer(this.size*this.staticStride*4*4);for(this.staticData=new Float32Array(s),this.staticDataUint32=new Uint32Array(s),this.staticBuffer=new X.lW(this.staticData,!0,!1),i=0;i<this.dynamicProperties.length;++i){var o=this.dynamicProperties[i];t.addAttribute(o.attributeName,this.dynamicBuffer,0,o.type===Z.vK.UNSIGNED_BYTE,o.type,4*this.dynamicStride,4*o.offset)}for(i=0;i<this.staticProperties.length;++i)o=this.staticProperties[i],t.addAttribute(o.attributeName,this.staticBuffer,0,o.type===Z.vK.UNSIGNED_BYTE,o.type,4*this.staticStride,4*o.offset)},t.prototype.uploadDynamic=function(t,e,i){for(var r=0;r<this.dynamicProperties.length;r++){var n=this.dynamicProperties[r];n.uploadFunction(t,e,i,n.type===Z.vK.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,n.offset)}this.dynamicBuffer._updateID++},t.prototype.uploadStatic=function(t,e,i){for(var r=0;r<this.staticProperties.length;r++){var n=this.staticProperties[r];n.uploadFunction(t,e,i,n.type===Z.vK.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,n.offset)}this.staticBuffer._updateID++},t.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()},t}(),wt=function(t){function e(e){var i=t.call(this,e)||this;return i.shader=null,i.properties=null,i.tempMatrix=new T.y3,i.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:i.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:i.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:i.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:i.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:Z.vK.UNSIGNED_BYTE,uploadFunction:i.uploadTint,offset:0}],i.shader=X.ex.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",{}),i.state=X.ZM.for2d(),i}return bt(e,t),e.prototype.render=function(t){var e=t.children,i=t._maxSize,r=t._batchSize,n=this.renderer,s=e.length;if(0!==s){s>i&&!t.autoResize&&(s=i);var o=t._buffers;o||(o=t._buffers=this.generateBuffers(t));var a=e[0]._texture.baseTexture;this.state.blendMode=(0,x.correctBlendMode)(t.blendMode,a.alphaMode),n.state.set(this.state);var h=n.gl,u=t.worldTransform.copyTo(this.tempMatrix);u.prepend(n.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=u.toArray(!0),this.shader.uniforms.uColor=(0,x.premultiplyRgba)(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,a.alphaMode),this.shader.uniforms.uSampler=a,this.renderer.shader.bind(this.shader);for(var c=!1,l=0,p=0;l<s;l+=r,p+=1){var d=s-l;d>r&&(d=r),p>=o.length&&o.push(this._generateOneMoreBuffer(t));var f=o[p];f.uploadDynamic(e,l,d);var g=t._bufferUpdateIDs[p]||0;(c=c||f._updateID<g)&&(f._updateID=t._updateID,f.uploadStatic(e,l,d)),n.geometry.bind(f.geometry),h.drawElements(h.TRIANGLES,6*d,h.UNSIGNED_SHORT,0)}}},e.prototype.generateBuffers=function(t){for(var e=[],i=t._maxSize,r=t._batchSize,n=t._properties,s=0;s<i;s+=r)e.push(new St(this.properties,n,r));return e},e.prototype._generateOneMoreBuffer=function(t){var e=t._batchSize,i=t._properties;return new St(this.properties,i,e)},e.prototype.uploadVertices=function(t,e,i,r,n,s){for(var o=0,a=0,h=0,u=0,c=0;c<i;++c){var l=t[e+c],p=l._texture,d=l.scale.x,f=l.scale.y,g=p.trim,m=p.orig;g?(o=(a=g.x-l.anchor.x*m.width)+g.width,h=(u=g.y-l.anchor.y*m.height)+g.height):(o=m.width*(1-l.anchor.x),a=m.width*-l.anchor.x,h=m.height*(1-l.anchor.y),u=m.height*-l.anchor.y),r[s]=a*d,r[s+1]=u*f,r[s+n]=o*d,r[s+n+1]=u*f,r[s+2*n]=o*d,r[s+2*n+1]=h*f,r[s+3*n]=a*d,r[s+3*n+1]=h*f,s+=4*n}},e.prototype.uploadPosition=function(t,e,i,r,n,s){for(var o=0;o<i;o++){var a=t[e+o].position;r[s]=a.x,r[s+1]=a.y,r[s+n]=a.x,r[s+n+1]=a.y,r[s+2*n]=a.x,r[s+2*n+1]=a.y,r[s+3*n]=a.x,r[s+3*n+1]=a.y,s+=4*n}},e.prototype.uploadRotation=function(t,e,i,r,n,s){for(var o=0;o<i;o++){var a=t[e+o].rotation;r[s]=a,r[s+n]=a,r[s+2*n]=a,r[s+3*n]=a,s+=4*n}},e.prototype.uploadUvs=function(t,e,i,r,n,s){for(var o=0;o<i;++o){var a=t[e+o]._texture._uvs;a?(r[s]=a.x0,r[s+1]=a.y0,r[s+n]=a.x1,r[s+n+1]=a.y1,r[s+2*n]=a.x2,r[s+2*n+1]=a.y2,r[s+3*n]=a.x3,r[s+3*n+1]=a.y3,s+=4*n):(r[s]=0,r[s+1]=0,r[s+n]=0,r[s+n+1]=0,r[s+2*n]=0,r[s+2*n+1]=0,r[s+3*n]=0,r[s+3*n+1]=0,s+=4*n)}},e.prototype.uploadTint=function(t,e,i,r,n,s){for(var o=0;o<i;++o){var a=t[e+o],h=a._texture.baseTexture.alphaMode>0,u=a.alpha,c=u<1&&h?(0,x.premultiplyTint)(a._tintRGB,u):a._tintRGB+(255*u<<24);r[s]=c,r[s+n]=c,r[s+2*n]=c,r[s+3*n]=c,s+=4*n}},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},e}(X.bO);!function(t){t.MITER="miter",t.BEVEL="bevel",t.ROUND="round"}(xt||(xt={})),function(t){t.BUTT="butt",t.ROUND="round",t.SQUARE="square"}(Et||(Et={}));var At={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(t,e){if(void 0===e&&(e=20),!this.adaptive||!t||isNaN(t))return e;var i=Math.ceil(t/this.maxLength);return i<this.minSegments?i=this.minSegments:i>this.maxSegments&&(i=this.maxSegments),i}},Ct=function(){function t(){this.color=16777215,this.alpha=1,this.texture=X.xE.WHITE,this.matrix=null,this.visible=!1,this.reset()}return t.prototype.clone=function(){var e=new t;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e},t.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=X.xE.WHITE,this.matrix=null,this.visible=!1},t.prototype.destroy=function(){this.texture=null,this.matrix=null},t}(),Ot=function(t,e){return Ot=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},Ot(t,e)};function It(t,e){function i(){this.constructor=t}Ot(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var Rt={build:function(t){t.points=t.shape.points.slice()},triangulate:function(t,e){var i=t.points,r=t.holes,n=e.points,s=e.indices;if(i.length>=6){for(var o=[],a=0;a<r.length;a++){var h=r[a];o.push(i.length/2),i=i.concat(h.points)}var u=(0,x.earcut)(i,o,2);if(!u)return;var c=n.length/2;for(a=0;a<u.length;a+=3)s.push(u[a]+c),s.push(u[a+1]+c),s.push(u[a+2]+c);for(a=0;a<i.length;a++)n.push(i[a])}}},Mt={build:function(t){var e,i,r=t.shape,n=t.points,s=r.x,o=r.y;if(n.length=0,t.type===T.HS.CIRC)e=r.radius,i=r.radius;else{var a=t.shape;e=a.width,i=a.height}if(0!==e&&0!==i){var h=Math.floor(30*Math.sqrt(r.radius))||Math.floor(15*Math.sqrt(e+i));h/=2.3;for(var u=2*Math.PI/h,c=0;c<h-.5;c++)n.push(s+Math.sin(-u*c)*e,o+Math.cos(-u*c)*i);n.push(n[0],n[1])}},triangulate:function(t,e){var i=t.points,r=e.points,n=e.indices,s=r.length/2,o=s,a=t.shape,h=t.matrix,u=a.x,c=a.y;r.push(t.matrix?h.a*u+h.c*c+h.tx:u,t.matrix?h.b*u+h.d*c+h.ty:c);for(var l=0;l<i.length;l+=2)r.push(i[l],i[l+1]),n.push(s++,o,s)}},Pt={build:function(t){var e=t.shape,i=e.x,r=e.y,n=e.width,s=e.height,o=t.points;o.length=0,o.push(i,r,i+n,r,i+n,r+s,i,r+s)},triangulate:function(t,e){var i=t.points,r=e.points,n=r.length/2;r.push(i[0],i[1],i[2],i[3],i[6],i[7],i[4],i[5]),e.indices.push(n,n+1,n+2,n+1,n+2,n+3)}};function Nt(t,e,i){return t+(e-t)*i}function Lt(t,e,i,r,n,s,o){void 0===o&&(o=[]);for(var a=o,h=0,u=0,c=0,l=0,p=0,d=0,f=0,g=0;f<=20;++f)h=Nt(t,i,g=f/20),u=Nt(e,r,g),c=Nt(i,n,g),l=Nt(r,s,g),p=Nt(h,c,g),d=Nt(u,l,g),0===f&&a[a.length-2]===p&&a[a.length-1]===d||a.push(p,d);return a}var Dt={build:function(t){var e=t.shape,i=t.points,r=e.x,n=e.y,s=e.width,o=e.height,a=Math.max(0,Math.min(e.radius,Math.min(s,o)/2));i.length=0,a?(Lt(r,n+a,r,n,r+a,n,i),Lt(r+s-a,n,r+s,n,r+s,n+a,i),Lt(r+s,n+o-a,r+s,n+o,r+s-a,n+o,i),Lt(r+a,n+o,r,n+o,r,n+o-a,i)):i.push(r,n,r+s,n,r+s,n+o,r,n+o)},triangulate:function(t,e){for(var i=t.points,r=e.points,n=e.indices,s=r.length/2,o=(0,x.earcut)(i,null,2),a=0,h=o.length;a<h;a+=3)n.push(o[a]+s),n.push(o[a+1]+s),n.push(o[a+2]+s);for(a=0,h=i.length;a<h;a++)r.push(i[a],i[++a])}};function kt(t,e,i,r,n,s,o,a){var h,u;o?(h=r,u=-i):(h=-r,u=i);var c=t-i*n+h,l=e-r*n+u,p=t+i*s+h,d=e+r*s+u;return a.push(c,l),a.push(p,d),2}function Bt(t,e,i,r,n,s,o,a){var h=i-t,u=r-e,c=Math.atan2(h,u),l=Math.atan2(n-t,s-e);a&&c<l?c+=2*Math.PI:!a&&c>l&&(l+=2*Math.PI);var p=c,d=l-c,f=Math.abs(d),g=Math.sqrt(h*h+u*u),m=1+(15*f*Math.sqrt(g)/Math.PI>>0),_=d/m;if(p+=_,a){o.push(t,e),o.push(i,r);for(var v=1,y=p;v<m;v++,y+=_)o.push(t,e),o.push(t+Math.sin(y)*g,e+Math.cos(y)*g);o.push(t,e),o.push(n,s)}else{for(o.push(i,r),o.push(t,e),v=1,y=p;v<m;v++,y+=_)o.push(t+Math.sin(y)*g,e+Math.cos(y)*g),o.push(t,e);o.push(n,s),o.push(t,e)}return 2*m}function Ft(t,e){t.lineStyle.native?function(t,e){var i=0,r=t.shape,n=t.points||r.points,s=r.type!==T.HS.POLY||r.closeStroke;if(0!==n.length){var o=e.points,a=e.indices,h=n.length/2,u=o.length/2,c=u;for(o.push(n[0],n[1]),i=1;i<h;i++)o.push(n[2*i],n[2*i+1]),a.push(c,c+1),c++;s&&a.push(c,u)}}(t,e):function(t,e){var i=t.shape,r=t.points||i.points.slice(),n=e.closePointEps;if(0!==r.length){var s=t.lineStyle,o=new T.E9(r[0],r[1]),a=new T.E9(r[r.length-2],r[r.length-1]),h=i.type!==T.HS.POLY||i.closeStroke,u=Math.abs(o.x-a.x)<n&&Math.abs(o.y-a.y)<n;if(h){r=r.slice(),u&&(r.pop(),r.pop(),a.set(r[r.length-2],r[r.length-1]));var c=.5*(o.x+a.x),l=.5*(a.y+o.y);r.unshift(c,l),r.push(c,l)}var p=e.points,d=r.length/2,f=r.length,g=p.length/2,m=s.width/2,_=m*m,v=s.miterLimit*s.miterLimit,y=r[0],b=r[1],x=r[2],E=r[3],S=0,w=0,A=-(b-E),C=y-x,O=0,I=0,R=Math.sqrt(A*A+C*C);A/=R,C/=R,A*=m,C*=m;var M=s.alignment,P=2*(1-M),N=2*M;h||(s.cap===Et.ROUND?f+=Bt(y-A*(P-N)*.5,b-C*(P-N)*.5,y-A*P,b-C*P,y+A*N,b+C*N,p,!0)+2:s.cap===Et.SQUARE&&(f+=kt(y,b,A,C,P,N,!0,p))),p.push(y-A*P,b-C*P),p.push(y+A*N,b+C*N);for(var L=1;L<d-1;++L){y=r[2*(L-1)],b=r[2*(L-1)+1],x=r[2*L],E=r[2*L+1],S=r[2*(L+1)],w=r[2*(L+1)+1],A=-(b-E),C=y-x,A/=R=Math.sqrt(A*A+C*C),C/=R,A*=m,C*=m,O=-(E-w),I=x-S,O/=R=Math.sqrt(O*O+I*I),I/=R,O*=m,I*=m;var D=x-y,k=b-E,B=x-S,F=w-E,G=k*B-F*D,U=G<0;if(Math.abs(G)<.1)p.push(x-A*P,E-C*P),p.push(x+A*N,E+C*N);else{var j=(-A+y)*(-C+E)-(-A+x)*(-C+b),X=(-O+S)*(-I+E)-(-O+x)*(-I+w),z=(D*X-B*j)/G,H=(F*j-k*X)/G,V=(z-x)*(z-x)+(H-E)*(H-E),Y=x+(z-x)*P,W=E+(H-E)*P,$=x-(z-x)*N,q=E-(H-E)*N,Z=U?P:N;V<=Math.min(D*D+k*k,B*B+F*F)+Z*Z*_?s.join===xt.BEVEL||V/_>v?(U?(p.push(Y,W),p.push(x+A*N,E+C*N),p.push(Y,W),p.push(x+O*N,E+I*N)):(p.push(x-A*P,E-C*P),p.push($,q),p.push(x-O*P,E-I*P),p.push($,q)),f+=2):s.join===xt.ROUND?U?(p.push(Y,W),p.push(x+A*N,E+C*N),f+=Bt(x,E,x+A*N,E+C*N,x+O*N,E+I*N,p,!0)+4,p.push(Y,W),p.push(x+O*N,E+I*N)):(p.push(x-A*P,E-C*P),p.push($,q),f+=Bt(x,E,x-A*P,E-C*P,x-O*P,E-I*P,p,!1)+4,p.push(x-O*P,E-I*P),p.push($,q)):(p.push(Y,W),p.push($,q)):(p.push(x-A*P,E-C*P),p.push(x+A*N,E+C*N),s.join===xt.BEVEL||V/_>v||(s.join===xt.ROUND?f+=U?Bt(x,E,x+A*N,E+C*N,x+O*N,E+I*N,p,!0)+2:Bt(x,E,x-A*P,E-C*P,x-O*P,E-I*P,p,!1)+2:(U?(p.push($,q),p.push($,q)):(p.push(Y,W),p.push(Y,W)),f+=2)),p.push(x-O*P,E-I*P),p.push(x+O*N,E+I*N),f+=2)}}y=r[2*(d-2)],b=r[2*(d-2)+1],x=r[2*(d-1)],A=-(b-(E=r[2*(d-1)+1])),C=y-x,A/=R=Math.sqrt(A*A+C*C),C/=R,A*=m,C*=m,p.push(x-A*P,E-C*P),p.push(x+A*N,E+C*N),h||(s.cap===Et.ROUND?f+=Bt(x-A*(P-N)*.5,E-C*(P-N)*.5,x-A*P,E-C*P,x+A*N,E+C*N,p,!1)+2:s.cap===Et.SQUARE&&(f+=kt(x,E,A,C,P,N,!1,p)));var K=e.indices,J=At.epsilon*At.epsilon;for(L=g;L<f+g-2;++L)y=p[2*L],b=p[2*L+1],x=p[2*(L+1)],E=p[2*(L+1)+1],S=p[2*(L+2)],w=p[2*(L+2)+1],Math.abs(y*(E-w)+x*(w-b)+S*(b-E))<J||K.push(L,L+1,L+2)}}(t,e)}var Gt,Ut=function(){function t(){}return t.curveTo=function(t,e,i,r,n,s){var o=s[s.length-2],a=s[s.length-1]-e,h=o-t,u=r-e,c=i-t,l=Math.abs(a*c-h*u);if(l<1e-8||0===n)return s[s.length-2]===t&&s[s.length-1]===e||s.push(t,e),null;var p=a*a+h*h,d=u*u+c*c,f=a*u+h*c,g=n*Math.sqrt(p)/l,m=n*Math.sqrt(d)/l,_=g*f/p,v=m*f/d,y=g*c+m*h,b=g*u+m*a,x=h*(m+_),E=a*(m+_),T=c*(g+v),S=u*(g+v);return{cx:y+t,cy:b+e,radius:n,startAngle:Math.atan2(E-b,x-y),endAngle:Math.atan2(S-b,T-y),anticlockwise:h*u>c*a}},t.arc=function(t,e,i,r,n,s,o,a,h){for(var u=o-s,c=At._segmentsCount(Math.abs(u)*n,40*Math.ceil(Math.abs(u)/T._b)),l=u/(2*c),p=2*l,d=Math.cos(l),f=Math.sin(l),g=c-1,m=g%1/g,_=0;_<=g;++_){var v=l+s+p*(_+m*_),y=Math.cos(v),b=-Math.sin(v);h.push((d*y+f*b)*n+i,(d*-b+f*y)*n+r)}},t}(),jt=function(){function t(){}return t.curveLength=function(t,e,i,r,n,s,o,a){for(var h=0,u=0,c=0,l=0,p=0,d=0,f=0,g=0,m=0,_=0,v=0,y=t,b=e,x=1;x<=10;++x)_=y-(g=(f=(d=(p=1-(u=x/10))*p)*p)*t+3*d*u*i+3*p*(c=u*u)*n+(l=c*u)*o),v=b-(m=f*e+3*d*u*r+3*p*c*s+l*a),y=g,b=m,h+=Math.sqrt(_*_+v*v);return h},t.curveTo=function(e,i,r,n,s,o,a){var h=a[a.length-2],u=a[a.length-1];a.length-=2;var c=At._segmentsCount(t.curveLength(h,u,e,i,r,n,s,o)),l=0,p=0,d=0,f=0,g=0;a.push(h,u);for(var m=1,_=0;m<=c;++m)d=(p=(l=1-(_=m/c))*l)*l,g=(f=_*_)*_,a.push(d*h+3*p*_*e+3*l*f*r+g*s,d*u+3*p*_*i+3*l*f*n+g*o)},t}(),Xt=function(){function t(){}return t.curveLength=function(t,e,i,r,n,s){var o=t-2*i+n,a=e-2*r+s,h=2*i-2*t,u=2*r-2*e,c=4*(o*o+a*a),l=4*(o*h+a*u),p=h*h+u*u,d=2*Math.sqrt(c+l+p),f=Math.sqrt(c),g=2*c*f,m=2*Math.sqrt(p),_=l/f;return(g*d+f*l*(d-m)+(4*p*c-l*l)*Math.log((2*f+_+d)/(_+m)))/(4*g)},t.curveTo=function(e,i,r,n,s){for(var o=s[s.length-2],a=s[s.length-1],h=At._segmentsCount(t.curveLength(o,a,e,i,r,n)),u=0,c=0,l=1;l<=h;++l){var p=l/h;u=o+(e-o)*p,c=a+(i-a)*p,s.push(u+(e+(r-e)*p-u)*p,c+(i+(n-i)*p-c)*p)}},t}(),zt=function(){function t(){this.reset()}return t.prototype.begin=function(t,e,i){this.reset(),this.style=t,this.start=e,this.attribStart=i},t.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},t.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},t}(),Ht=((Gt={})[T.HS.POLY]=Rt,Gt[T.HS.CIRC]=Mt,Gt[T.HS.ELIP]=Mt,Gt[T.HS.RECT]=Pt,Gt[T.HS.RREC]=Dt,Gt),Vt=[],Yt=[];function Wt(t){for(var e=t.points,i=0,r=0;r<e.length-2;r+=2)i+=(e[r+2]-e[r])*(e[r+3]+e[r+1]);return i>0}var $t,qt=function(){function t(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=null),void 0===r&&(r=null),this.points=[],this.holes=[],this.shape=t,this.lineStyle=i,this.fillStyle=e,this.matrix=r,this.type=t.type}return t.prototype.clone=function(){return new t(this.shape,this.fillStyle,this.lineStyle,this.matrix)},t.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},t}(),Zt=new T.E9,Kt=new S,Jt=function(t){function e(){var e=t.call(this)||this;return e.closePointEps=1e-4,e.boundsPadding=0,e.uvsFloat32=null,e.indicesUint16=null,e.batchable=!1,e.points=[],e.colors=[],e.uvs=[],e.indices=[],e.textureIds=[],e.graphicsData=[],e.drawCalls=[],e.batchDirty=-1,e.batches=[],e.dirty=0,e.cacheDirty=-1,e.clearDirty=0,e.shapeIndex=0,e._bounds=new S,e.boundsDirty=-1,e}return It(e,t),Object.defineProperty(e.prototype,"bounds",{get:function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),e.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),Yt.push(this.drawCalls[t]);for(this.drawCalls.length=0,t=0;t<this.batches.length;t++){var e=this.batches[t];e.reset(),Vt.push(e)}this.batches.length=0},e.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},e.prototype.drawShape=function(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=null),void 0===r&&(r=null);var n=new qt(t,e,i,r);return this.graphicsData.push(n),this.dirty++,this},e.prototype.drawHole=function(t,e){if(void 0===e&&(e=null),!this.graphicsData.length)return null;var i=new qt(t,null,null,e),r=this.graphicsData[this.graphicsData.length-1];return i.lineStyle=r.lineStyle,r.holes.push(i),this.dirty++,this},e.prototype.destroy=function(){t.prototype.destroy.call(this);for(var e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},e.prototype.containsPoint=function(t){for(var e=this.graphicsData,i=0;i<e.length;++i){var r=e[i];if(r.fillStyle.visible&&r.shape&&(r.matrix?r.matrix.applyInverse(t,Zt):Zt.copyFrom(t),r.shape.contains(Zt.x,Zt.y))){var n=!1;if(r.holes)for(var s=0;s<r.holes.length;s++)if(r.holes[s].shape.contains(Zt.x,Zt.y)){n=!0;break}if(!n)return!0}}return!1},e.prototype.updateBatches=function(t){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var e=this.uvs,i=this.graphicsData,r=null,n=null;this.batches.length>0&&(n=(r=this.batches[this.batches.length-1]).style);for(var s=this.shapeIndex;s<i.length;s++){this.shapeIndex++;var o=i[s],a=o.fillStyle,h=o.lineStyle;Ht[o.type].build(o),o.matrix&&this.transformPoints(o.points,o.matrix);for(var u=0;u<2;u++){var c=0===u?a:h;if(c.visible){var l=c.texture.baseTexture,p=this.indices.length,d=this.points.length/2;l.wrapMode=Z.Nt.REPEAT,0===u?this.processFill(o):this.processLine(o);var f=this.points.length/2-d;0!==f&&(r&&!this._compareStyles(n,c)&&(r.end(p,d),r=null),r||((r=Vt.pop()||new zt).begin(c,p,d),this.batches.push(r),n=c),this.addUvs(this.points,e,c.texture,d,f,c.matrix))}}}var g=this.indices.length,m=this.points.length/2;if(r&&r.end(g,m),0!==this.batches.length){if(this.indicesUint16&&this.indices.length===this.indicesUint16.length)this.indicesUint16.set(this.indices);else{var _=m>65535&&t;this.indicesUint16=_?new Uint32Array(this.indices):new Uint16Array(this.indices)}this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}else this.batchable=!0}}else this.batchable=!0},e.prototype._compareStyles=function(t,e){return!(!t||!e)&&t.texture.baseTexture===e.texture.baseTexture&&t.color+t.alpha===e.color+e.alpha&&!!t.native==!!e.native},e.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,e=this.graphicsData.length;t<e;t++){var i=this.graphicsData[t],r=i.fillStyle,n=i.lineStyle;if(r&&!r.texture.baseTexture.valid)return!1;if(n&&!n.texture.baseTexture.valid)return!1}return!0},e.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,e=0,i=t.length;e<i;e++)for(var r=t[e],n=0;n<r.size;n++){var s=r.start+n;this.indicesUint16[s]=this.indicesUint16[s]-r.attribStart}},e.prototype.isBatchable=function(){if(this.points.length>131070)return!1;for(var t=this.batches,i=0;i<t.length;i++)if(t[i].style.native)return!1;return this.points.length<2*e.BATCHABLE_SIZE},e.prototype.buildDrawCalls=function(){for(var t=++X.VL._globalBatch,e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),Yt.push(this.drawCalls[e]);this.drawCalls.length=0;var i=this.colors,r=this.textureIds,n=Yt.pop();n||((n=new X.a$).texArray=new X.Ie),n.texArray.count=0,n.start=0,n.size=0,n.type=Z.lg.TRIANGLES;var s=0,o=null,a=0,h=!1,u=Z.lg.TRIANGLES,c=0;for(this.drawCalls.push(n),e=0;e<this.batches.length;e++){var l=this.batches[e],p=l.style,d=p.texture.baseTexture;h!==!!p.native&&(u=(h=!!p.native)?Z.lg.LINES:Z.lg.TRIANGLES,o=null,s=8,t++),o!==d&&(o=d,d._batchEnabled!==t&&(8===s&&(t++,s=0,n.size>0&&((n=Yt.pop())||((n=new X.a$).texArray=new X.Ie),this.drawCalls.push(n)),n.start=c,n.size=0,n.texArray.count=0,n.type=u),d.touched=1,d._batchEnabled=t,d._batchLocation=s,d.wrapMode=Z.Nt.REPEAT,n.texArray.elements[n.texArray.count++]=d,s++)),n.size+=l.size,c+=l.size,a=d._batchLocation,this.addColors(i,p.color,p.alpha,l.attribSize,l.attribStart),this.addTextureIds(r,a,l.attribSize,l.attribStart)}X.VL._globalBatch=t,this.packAttributes()},e.prototype.packAttributes=function(){for(var t=this.points,e=this.uvs,i=this.colors,r=this.textureIds,n=new ArrayBuffer(3*t.length*4),s=new Float32Array(n),o=new Uint32Array(n),a=0,h=0;h<t.length/2;h++)s[a++]=t[2*h],s[a++]=t[2*h+1],s[a++]=e[2*h],s[a++]=e[2*h+1],o[a++]=i[h],s[a++]=r[h];this._buffer.update(n),this._indexBuffer.update(this.indicesUint16)},e.prototype.processFill=function(t){t.holes.length?(this.processHoles(t.holes),Rt.triangulate(t,this)):Ht[t.type].triangulate(t,this)},e.prototype.processLine=function(t){Ft(t,this);for(var e=0;e<t.holes.length;e++)Ft(t.holes[e],this)},e.prototype.processHoles=function(t){for(var e=0;e<t.length;e++){var i=t[e];Ht[i.type].build(i),i.matrix&&this.transformPoints(i.points,i.matrix)}},e.prototype.calculateBounds=function(){var t=this._bounds,e=Kt,i=T.y3.IDENTITY;this._bounds.clear(),e.clear();for(var r=0;r<this.graphicsData.length;r++){var n=this.graphicsData[r],s=n.shape,o=n.type,a=n.lineStyle,h=n.matrix||T.y3.IDENTITY,u=0;if(a&&a.visible){var c=a.alignment;u=a.width,o===T.HS.POLY?Wt(s)?u*=1-c:u*=c:u*=Math.max(0,c)}if(i!==h&&(e.isEmpty()||(t.addBoundsMatrix(e,i),e.clear()),i=h),o===T.HS.RECT||o===T.HS.RREC){var l=s;e.addFramePad(l.x,l.y,l.x+l.width,l.y+l.height,u,u)}else if(o===T.HS.CIRC){var p=s;e.addFramePad(p.x,p.y,p.x,p.y,p.radius+u,p.radius+u)}else if(o===T.HS.ELIP){var d=s;e.addFramePad(d.x,d.y,d.x,d.y,d.width+u,d.height+u)}else{var f=s;t.addVerticesMatrix(i,f.points,0,f.points.length,u,u)}}e.isEmpty()||t.addBoundsMatrix(e,i),t.pad(this.boundsPadding,this.boundsPadding)},e.prototype.transformPoints=function(t,e){for(var i=0;i<t.length/2;i++){var r=t[2*i],n=t[2*i+1];t[2*i]=e.a*r+e.c*n+e.tx,t[2*i+1]=e.b*r+e.d*n+e.ty}},e.prototype.addColors=function(t,e,i,r,n){void 0===n&&(n=0);var s=(e>>16)+(65280&e)+((255&e)<<16),o=(0,x.premultiplyTint)(s,i);t.length=Math.max(t.length,n+r);for(var a=0;a<r;a++)t[n+a]=o},e.prototype.addTextureIds=function(t,e,i,r){void 0===r&&(r=0),t.length=Math.max(t.length,r+i);for(var n=0;n<i;n++)t[r+n]=e},e.prototype.addUvs=function(t,e,i,r,n,s){void 0===s&&(s=null);for(var o=0,a=e.length,h=i.frame;o<n;){var u=t[2*(r+o)],c=t[2*(r+o)+1];if(s){var l=s.a*u+s.c*c+s.tx;c=s.b*u+s.d*c+s.ty,u=l}o++,e.push(u/h.width,c/h.height)}var p=i.baseTexture;(h.width<p.width||h.height<p.height)&&this.adjustUvs(e,i,a,n)},e.prototype.adjustUvs=function(t,e,i,r){for(var n=e.baseTexture,s=1e-6,o=i+2*r,a=e.frame,h=a.width/n.width,u=a.height/n.height,c=a.x/a.width,l=a.y/a.height,p=Math.floor(t[i]+s),d=Math.floor(t[i+1]+s),f=i+2;f<o;f+=2)p=Math.min(p,Math.floor(t[f]+s)),d=Math.min(d,Math.floor(t[f+1]+s));for(c-=p,l-=d,f=i;f<o;f+=2)t[f]=(t[f]+c)*h,t[f+1]=(t[f+1]+l)*u},e.BATCHABLE_SIZE=100,e}(X.JZ),Qt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.width=0,e.alignment=.5,e.native=!1,e.cap=Et.BUTT,e.join=xt.MITER,e.miterLimit=10,e}return It(e,t),e.prototype.clone=function(){var t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t},e.prototype.reset=function(){t.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},e}(Ct),te=new Float32Array(3),ee={},ie=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i.shader=null,i.pluginName="batch",i.currentPath=null,i.batches=[],i.batchTint=-1,i.batchDirty=-1,i.vertexData=null,i._fillStyle=new Ct,i._lineStyle=new Qt,i._matrix=null,i._holeMode=!1,i.state=X.ZM.for2d(),i._geometry=e||new Jt,i._geometry.refCount++,i._transformID=-1,i.tint=16777215,i.blendMode=Z.T$.NORMAL,i}return It(e,t),Object.defineProperty(e.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return this.finishPoly(),new e(this._geometry)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),e.prototype.lineStyle=function(t,e,i,r,n){return void 0===t&&(t=null),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=.5),void 0===n&&(n=!1),"number"==typeof t&&(t={width:t,color:e,alpha:i,alignment:r,native:n}),this.lineTextureStyle(t)},e.prototype.lineTextureStyle=function(t){t=Object.assign({width:0,texture:X.xE.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:Et.BUTT,join:xt.MITER,miterLimit:10},t),this.currentPath&&this.startPoly();var e=t.width>0&&t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:e},t)):this._lineStyle.reset(),this},e.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new T.mg,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new T.mg,this.currentPath.closeStroke=!1},e.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},e.prototype.moveTo=function(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this},e.prototype.lineTo=function(t,e){this.currentPath||this.moveTo(0,0);var i=this.currentPath.points,r=i[i.length-2],n=i[i.length-1];return r===t&&n===e||i.push(t,e),this},e.prototype._initCurve=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)},e.prototype.quadraticCurveTo=function(t,e,i,r){this._initCurve();var n=this.currentPath.points;return 0===n.length&&this.moveTo(0,0),Xt.curveTo(t,e,i,r,n),this},e.prototype.bezierCurveTo=function(t,e,i,r,n,s){return this._initCurve(),jt.curveTo(t,e,i,r,n,s,this.currentPath.points),this},e.prototype.arcTo=function(t,e,i,r,n){this._initCurve(t,e);var s=this.currentPath.points,o=Ut.curveTo(t,e,i,r,n,s);if(o){var a=o.cx,h=o.cy,u=o.radius,c=o.startAngle,l=o.endAngle,p=o.anticlockwise;this.arc(a,h,u,c,l,p)}return this},e.prototype.arc=function(t,e,i,r,n,s){if(void 0===s&&(s=!1),r===n)return this;if(!s&&n<=r?n+=T._b:s&&r<=n&&(r+=T._b),0==n-r)return this;var o=t+Math.cos(r)*i,a=e+Math.sin(r)*i,h=this._geometry.closePointEps,u=this.currentPath?this.currentPath.points:null;if(u){var c=Math.abs(u[u.length-2]-o),l=Math.abs(u[u.length-1]-a);c<h&&l<h||u.push(o,a)}else this.moveTo(o,a),u=this.currentPath.points;return Ut.arc(o,a,t,e,i,r,n,s,u),this},e.prototype.beginFill=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this.beginTextureFill({texture:X.xE.WHITE,color:t,alpha:e})},e.prototype.beginTextureFill=function(t){t=Object.assign({texture:X.xE.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();var e=t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:e},t)):this._fillStyle.reset(),this},e.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},e.prototype.drawRect=function(t,e,i,r){return this.drawShape(new T.Ae(t,e,i,r))},e.prototype.drawRoundedRect=function(t,e,i,r,n){return this.drawShape(new T.c9(t,e,i,r,n))},e.prototype.drawCircle=function(t,e,i){return this.drawShape(new T.Cd(t,e,i))},e.prototype.drawEllipse=function(t,e,i,r){return this.drawShape(new T.Pj(t,e,i,r))},e.prototype.drawPolygon=function(){for(var t,e=arguments,i=[],r=0;r<arguments.length;r++)i[r]=e[r];var n=!0,s=i[0];s.points?(n=s.closeStroke,t=s.points):t=Array.isArray(i[0])?i[0]:i;var o=new T.mg(t);return o.closeStroke=n,this.drawShape(o),this},e.prototype.drawShape=function(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},e.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},e.prototype.isFastRect=function(){var t=this._geometry.graphicsData;return!(1!==t.length||t[0].shape.type!==T.HS.RECT||t[0].holes.length||t[0].lineStyle.visible&&t[0].lineStyle.width)},e.prototype._render=function(t){this.finishPoly();var e=this._geometry,i=t.context.supports.uint32Indices;e.updateBatches(i),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))},e.prototype._populateBatches=function(){var t=this._geometry,e=this.blendMode,i=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=i,this.vertexData=new Float32Array(t.points);for(var r=0;r<i;r++){var n=t.batches[r],s=n.style.color,o=new Float32Array(this.vertexData.buffer,4*n.attribStart*2,2*n.attribSize),a=new Float32Array(t.uvsFloat32.buffer,4*n.attribStart*2,2*n.attribSize),h={vertexData:o,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*n.start,n.size),uvs:a,_batchRGB:(0,x.hex2rgb)(s),_tintRGB:s,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[r]=h}},e.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var e=0,i=this.batches.length;e<i;e++){var r=this.batches[e];r.worldAlpha=this.worldAlpha*r.alpha,t.plugins[this.pluginName].render(r)}}},e.prototype._renderDirect=function(t){var e=this._resolveDirectShader(t),i=this._geometry,r=this.tint,n=this.worldAlpha,s=e.uniforms,o=i.drawCalls;s.translationMatrix=this.transform.worldTransform,s.tint[0]=(r>>16&255)/255*n,s.tint[1]=(r>>8&255)/255*n,s.tint[2]=(255&r)/255*n,s.tint[3]=n,t.shader.bind(e),t.geometry.bind(i,e),t.state.set(this.state);for(var a=0,h=o.length;a<h;a++)this._renderDrawCallDirect(t,i.drawCalls[a])},e.prototype._renderDrawCallDirect=function(t,e){for(var i=e.texArray,r=e.type,n=e.size,s=e.start,o=i.count,a=0;a<o;a++)t.texture.bind(i.elements[a],a);t.geometry.draw(r,n,s)},e.prototype._resolveDirectShader=function(t){var e=this.shader,i=this.pluginName;if(!e){if(!ee[i]){for(var r=t.plugins.batch.MAX_TEXTURES,n=new Int32Array(r),s=0;s<r;s++)n[s]=s;var o={tint:new Float32Array([1,1,1,1]),translationMatrix:new T.y3,default:X.oo.from({uSamplers:n},!0)},a=t.plugins[i]._shader.program;ee[i]=new X.ex(a,o)}e=ee[i]}return e},e.prototype._calculateBounds=function(){this.finishPoly();var t=this._geometry;if(t.graphicsData.length){var e=t.bounds,i=e.minX,r=e.minY,n=e.maxX,s=e.maxY;this._bounds.addFrame(this.transform,i,r,n,s)}},e.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,e._TEMP_POINT),this._geometry.containsPoint(e._TEMP_POINT)},e.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=(0,x.hex2rgb)(this.tint,te),e=0;e<this.batches.length;e++){var i=this.batches[e],r=i._batchRGB,n=(t[0]*r[0]*255<<16)+(t[1]*r[1]*255<<8)+(0|t[2]*r[2]*255);i._tintRGB=(n>>16)+(65280&n)+((255&n)<<16)}}},e.prototype.calculateVertices=function(){var t=this.transform._worldID;if(this._transformID!==t){this._transformID=t;for(var e=this.transform.worldTransform,i=e.a,r=e.b,n=e.c,s=e.d,o=e.tx,a=e.ty,h=this._geometry.points,u=this.vertexData,c=0,l=0;l<h.length;l+=2){var p=h[l],d=h[l+1];u[c++]=i*p+n*d+o,u[c++]=s*d+r*p+a}}},e.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this},e.prototype.setMatrix=function(t){return this._matrix=t,this},e.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},e.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},e.prototype.destroy=function(e){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,t.prototype.destroy.call(this,e)},e._TEMP_POINT=new T.E9,e}(R),re={buildPoly:Rt,buildCircle:Mt,buildRectangle:Pt,buildRoundedRectangle:Dt,buildLine:Ft,ArcUtils:Ut,BezierUtils:jt,QuadraticUtils:Xt,BatchPart:zt,FILL_COMMANDS:Ht,BATCH_POOL:Vt,DRAW_CALL_POOL:Yt},ne=function(t,e){return ne=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},ne(t,e)},se=new T.E9,oe=new Uint16Array([0,1,2,0,2,3]),ae=function(t){function e(e){var i=t.call(this)||this;return i._anchor=new T.AB(i._onAnchorUpdate,i,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),i._texture=null,i._width=0,i._height=0,i._tint=null,i._tintRGB=null,i.tint=16777215,i.blendMode=Z.T$.NORMAL,i._cachedTint=16777215,i.uvs=null,i.texture=e||X.xE.EMPTY,i.vertexData=new Float32Array(8),i.vertexTrimmedData=null,i._transformID=-1,i._textureID=-1,i._transformTrimmedID=-1,i._textureTrimmedID=-1,i.indices=oe,i.pluginName="batch",i.isSprite=!0,i._roundPixels=E.X.ROUND_PIXELS,i}return function(t,e){function i(){this.constructor=t}ne(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}(e,t),e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=(0,x.sign)(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=(0,x.sign)(this.scale.y)*this._height/this._texture.orig.height)},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},e.prototype.calculateVertices=function(){var t=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==t._updateID){this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var e=this.transform.worldTransform,i=e.a,r=e.b,n=e.c,s=e.d,o=e.tx,a=e.ty,h=this.vertexData,u=t.trim,c=t.orig,l=this._anchor,p=0,d=0,f=0,g=0;if(u?(p=(d=u.x-l._x*c.width)+u.width,f=(g=u.y-l._y*c.height)+u.height):(p=(d=-l._x*c.width)+c.width,f=(g=-l._y*c.height)+c.height),h[0]=i*d+n*g+o,h[1]=s*g+r*d+a,h[2]=i*p+n*g+o,h[3]=s*g+r*p+a,h[4]=i*p+n*f+o,h[5]=s*f+r*p+a,h[6]=i*d+n*f+o,h[7]=s*f+r*d+a,this._roundPixels)for(var m=E.X.RESOLUTION,_=0;_<h.length;++_)h[_]=Math.round((h[_]*m|0)/m)}},e.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,i=t.orig,r=this._anchor,n=this.transform.worldTransform,s=n.a,o=n.b,a=n.c,h=n.d,u=n.tx,c=n.ty,l=-r._x*i.width,p=l+i.width,d=-r._y*i.height,f=d+i.height;e[0]=s*l+a*d+u,e[1]=h*d+o*l+c,e[2]=s*p+a*d+u,e[3]=h*d+o*p+c,e[4]=s*p+a*f+u,e[5]=h*f+o*p+c,e[6]=s*l+a*f+u,e[7]=h*f+o*l+c},e.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new T.Ae),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,se);var e=this._texture.orig.width,i=this._texture.orig.height,r=-e*this.anchor.x,n=0;return se.x>=r&&se.x<r+e&&(n=-i*this.anchor.y,se.y>=n&&se.y<n+i)},e.prototype.destroy=function(e){if(t.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof e?e:e&&e.texture){var i="boolean"==typeof e?e:e&&e.baseTexture;this._texture.destroy(!!i)}this._texture=null},e.from=function(t,i){return new e(t instanceof X.xE?t:X.xE.from(t,i))},Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){var e=(0,x.sign)(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){var e=(0,x.sign)(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},set:function(t){this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||X.xE.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),e}(R),he=function(t,e){return he=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},he(t,e)};!function(t){t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL"}($t||($t={}));var ue={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:$t.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},ce=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],le=function(){function t(t){this.styleID=0,this.reset(),fe(this,t,t)}return t.prototype.clone=function(){var e={};return fe(e,this,ue),new t(e)},t.prototype.reset=function(){fe(this,ue,ue)},Object.defineProperty(t.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"breakWords",{get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(t){var e=de(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){return this._fill},set:function(t){var e=de(t);this._fill!==e&&(this._fill=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leading",{get:function(){return this._leading},set:function(t){this._leading!==t&&(this._leading=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stroke",{get:function(){return this._stroke},set:function(t){var e=de(t);this._stroke!==e&&(this._stroke=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"trim",{get:function(){return this._trim},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)},enumerable:!1,configurable:!0}),t.prototype.toFontString=function(){var t="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var i=e.length-1;i>=0;i--){var r=e[i].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&ce.indexOf(r)<0&&(r='"'+r+'"'),e[i]=r}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},t}();function pe(t){return"number"==typeof t?(0,x.hex2string)(t):("string"==typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t)}function de(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=pe(t[e]);return t}return pe(t)}function fe(t,e,i){for(var r in i)Array.isArray(e[r])?t[r]=e[r].slice():t[r]=e[r]}var ge=function(){function t(t,e,i,r,n,s,o,a,h){this.text=t,this.style=e,this.width=i,this.height=r,this.lines=n,this.lineWidths=s,this.lineHeight=o,this.maxLineWidth=a,this.fontProperties=h}return t.measureText=function(e,i,r,n){void 0===n&&(n=t._canvas),r=null==r?i.wordWrap:r;var s=i.toFontString(),o=t.measureFont(s);0===o.fontSize&&(o.fontSize=i.fontSize,o.ascent=i.fontSize);var a=n.getContext("2d");a.font=s;for(var h=(r?t.wordWrap(e,i,n):e).split(/(?:\r\n|\r|\n)/),u=new Array(h.length),c=0,l=0;l<h.length;l++){var p=a.measureText(h[l]).width+(h[l].length-1)*i.letterSpacing;u[l]=p,c=Math.max(c,p)}var d=c+i.strokeThickness;i.dropShadow&&(d+=i.dropShadowDistance);var f=i.lineHeight||o.fontSize+i.strokeThickness,g=Math.max(f,o.fontSize+i.strokeThickness)+(h.length-1)*(f+i.leading);return i.dropShadow&&(g+=i.dropShadowDistance),new t(e,i,d,g,h,u,f+i.leading,c,o)},t.wordWrap=function(e,i,r){void 0===r&&(r=t._canvas);for(var n=r.getContext("2d"),s=0,o="",a="",h=Object.create(null),u=i.letterSpacing,c=i.whiteSpace,l=t.collapseSpaces(c),p=t.collapseNewlines(c),d=!l,f=i.wordWrapWidth+u,g=t.tokenize(e),m=0;m<g.length;m++){var _=g[m];if(t.isNewline(_)){if(!p){a+=t.addLine(o),d=!l,o="",s=0;continue}_=" "}if(l){var v=t.isBreakingSpace(_),y=t.isBreakingSpace(o[o.length-1]);if(v&&y)continue}var b=t.getFromCache(_,u,h,n);if(b>f)if(""!==o&&(a+=t.addLine(o),o="",s=0),t.canBreakWords(_,i.breakWords))for(var x=t.wordWrapSplit(_),E=0;E<x.length;E++){for(var T=x[E],S=1;x[E+S];){var w=x[E+S],A=T[T.length-1];if(t.canBreakChars(A,w,_,E,i.breakWords))break;T+=w,S++}E+=T.length-1;var C=t.getFromCache(T,u,h,n);C+s>f&&(a+=t.addLine(o),d=!1,o="",s=0),o+=T,s+=C}else{o.length>0&&(a+=t.addLine(o),o="",s=0);var O=m===g.length-1;a+=t.addLine(_,!O),d=!1,o="",s=0}else b+s>f&&(d=!1,a+=t.addLine(o),o="",s=0),(o.length>0||!t.isBreakingSpace(_)||d)&&(o+=_,s+=b)}return a+t.addLine(o,!1)},t.addLine=function(e,i){return void 0===i&&(i=!0),e=t.trimRight(e),i?e+"\n":e},t.getFromCache=function(t,e,i,r){var n=i[t];if("number"!=typeof n){var s=t.length*e;n=r.measureText(t).width+s,i[t]=n}return n},t.collapseSpaces=function(t){return"normal"===t||"pre-line"===t},t.collapseNewlines=function(t){return"normal"===t},t.trimRight=function(e){if("string"!=typeof e)return"";for(var i=e.length-1;i>=0;i--){var r=e[i];if(!t.isBreakingSpace(r))break;e=e.slice(0,-1)}return e},t.isNewline=function(e){return"string"==typeof e&&t._newlines.indexOf(e.charCodeAt(0))>=0},t.isBreakingSpace=function(e,i){return"string"==typeof e&&t._breakingSpaces.indexOf(e.charCodeAt(0))>=0},t.tokenize=function(e){var i=[],r="";if("string"!=typeof e)return i;for(var n=0;n<e.length;n++){var s=e[n],o=e[n+1];t.isBreakingSpace(s,o)||t.isNewline(s)?(""!==r&&(i.push(r),r=""),i.push(s)):r+=s}return""!==r&&i.push(r),i},t.canBreakWords=function(t,e){return e},t.canBreakChars=function(t,e,i,r,n){return!0},t.wordWrapSplit=function(t){return t.split("")},t.measureFont=function(e){if(t._fonts[e])return t._fonts[e];var i={ascent:0,descent:0,fontSize:0},r=t._canvas,n=t._context;n.font=e;var s=t.METRICS_STRING+t.BASELINE_SYMBOL,o=Math.ceil(n.measureText(s).width),a=Math.ceil(n.measureText(t.BASELINE_SYMBOL).width),h=Math.ceil(t.HEIGHT_MULTIPLIER*a);a=a*t.BASELINE_MULTIPLIER|0,r.width=o,r.height=h,n.fillStyle="#f00",n.fillRect(0,0,o,h),n.font=e,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText(s,0,a);var u=n.getImageData(0,0,o,h).data,c=u.length,l=4*o,p=0,d=0,f=!1;for(p=0;p<a;++p){for(var g=0;g<l;g+=4)if(255!==u[d+g]){f=!0;break}if(f)break;d+=l}for(i.ascent=a-p,d=c-l,f=!1,p=h;p>a;--p){for(g=0;g<l;g+=4)if(255!==u[d+g]){f=!0;break}if(f)break;d-=l}return i.descent=p-a,i.fontSize=i.ascent+i.descent,t._fonts[e]=i,i},t.clearMetrics=function(e){void 0===e&&(e=""),e?delete t._fonts[e]:t._fonts={}},t}(),me=function(){try{var t=new OffscreenCanvas(0,0),e=t.getContext("2d");return e&&e.measureText?t:document.createElement("canvas")}catch(t){return document.createElement("canvas")}}();me.width=me.height=10,ge._canvas=me,ge._context=me.getContext("2d"),ge._fonts={},ge.METRICS_STRING="|q",ge.BASELINE_SYMBOL="M",ge.BASELINE_MULTIPLIER=1.4,ge.HEIGHT_MULTIPLIER=2,ge._newlines=[10,13],ge._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var _e={texture:!0,children:!1,baseTexture:!0},ve=function(t){function e(e,i,r){var n=this,s=!1;r||(r=document.createElement("canvas"),s=!0),r.width=3,r.height=3;var o=X.xE.from(r);return o.orig=new T.Ae,o.trim=new T.Ae,(n=t.call(this,o)||this)._ownCanvas=s,n.canvas=r,n.context=n.canvas.getContext("2d"),n._resolution=E.X.RESOLUTION,n._autoResolution=!0,n._text=null,n._style=null,n._styleListener=null,n._font="",n.text=e,n.style=i,n.localStyleID=-1,n}return function(t,e){function i(){this.constructor=t}he(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}(e,t),e.prototype.updateText=function(t){var i=this._style;if(this.localStyleID!==i.styleID&&(this.dirty=!0,this.localStyleID=i.styleID),this.dirty||!t){this._font=this._style.toFontString();var r,n,s=this.context,o=ge.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),a=o.width,h=o.height,u=o.lines,c=o.lineHeight,l=o.lineWidths,p=o.maxLineWidth,d=o.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,a)+2*i.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,h)+2*i.padding)*this._resolution),s.scale(this._resolution,this._resolution),s.clearRect(0,0,this.canvas.width,this.canvas.height),s.font=this._font,s.lineWidth=i.strokeThickness,s.textBaseline=i.textBaseline,s.lineJoin=i.lineJoin,s.miterLimit=i.miterLimit;for(var f=i.dropShadow?2:1,g=0;g<f;++g){var m=i.dropShadow&&0===g,_=m?Math.ceil(Math.max(1,h)+2*i.padding):0,v=_*this._resolution;if(m){s.fillStyle="black",s.strokeStyle="black";var y=i.dropShadowColor,b=(0,x.hex2rgb)("number"==typeof y?y:(0,x.string2hex)(y));s.shadowColor="rgba("+255*b[0]+","+255*b[1]+","+255*b[2]+","+i.dropShadowAlpha+")",s.shadowBlur=i.dropShadowBlur,s.shadowOffsetX=Math.cos(i.dropShadowAngle)*i.dropShadowDistance,s.shadowOffsetY=Math.sin(i.dropShadowAngle)*i.dropShadowDistance+v}else s.fillStyle=this._generateFillStyle(i,u,o),s.strokeStyle=i.stroke,s.shadowColor="black",s.shadowBlur=0,s.shadowOffsetX=0,s.shadowOffsetY=0;var E=(c-d.fontSize)/2;(!e.nextLineHeightBehavior||c-d.fontSize<0)&&(E=0);for(var T=0;T<u.length;T++)r=i.strokeThickness/2,n=i.strokeThickness/2+T*c+d.ascent+E,"right"===i.align?r+=p-l[T]:"center"===i.align&&(r+=(p-l[T])/2),i.stroke&&i.strokeThickness&&this.drawLetterSpacing(u[T],r+i.padding,n+i.padding-_,!0),i.fill&&this.drawLetterSpacing(u[T],r+i.padding,n+i.padding-_)}this.updateTexture()}},e.prototype.drawLetterSpacing=function(t,e,i,r){void 0===r&&(r=!1);var n=this._style.letterSpacing;if(0!==n)for(var s=e,o=Array.from?Array.from(t):t.split(""),a=this.context.measureText(t).width,h=0,u=0;u<o.length;++u){var c=o[u];r?this.context.strokeText(c,s,i):this.context.fillText(c,s,i),s+=a-(h=this.context.measureText(t.substring(u+1)).width)+n,a=h}else r?this.context.strokeText(t,e,i):this.context.fillText(t,e,i)},e.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var e=(0,x.trimCanvas)(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}var i=this._texture,r=this._style,n=r.trim?0:r.padding,s=i.baseTexture;i.trim.width=i._frame.width=t.width/this._resolution,i.trim.height=i._frame.height=t.height/this._resolution,i.trim.x=-n,i.trim.y=-n,i.orig.width=i._frame.width-2*n,i.orig.height=i._frame.height-2*n,this._onTextureUpdate(),s.setRealSize(t.width,t.height,this._resolution),i.updateUvs(),this._recursivePostUpdateTransform(),this.dirty=!1},e.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype._render.call(this,e)},e.prototype.getLocalBounds=function(e){return this.updateText(!0),t.prototype.getLocalBounds.call(this,e)},e.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},e.prototype._generateFillStyle=function(t,e,i){var r,n=t.fill;if(!Array.isArray(n))return n;if(1===n.length)return n[0];var s=t.dropShadow?t.dropShadowDistance:0,o=t.padding||0,a=this.canvas.width/this._resolution-s-2*o,h=this.canvas.height/this._resolution-s-2*o,u=n.slice(),c=t.fillGradientStops.slice();if(!c.length)for(var l=u.length+1,p=1;p<l;++p)c.push(p/l);if(u.unshift(n[0]),c.unshift(0),u.push(n[n.length-1]),c.push(1),t.fillGradientType===$t.LINEAR_VERTICAL){r=this.context.createLinearGradient(a/2,o,a/2,h+o);var d=i.fontProperties.fontSize+t.strokeThickness;for(p=0;p<e.length;p++){var f=i.lineHeight*(p-1)+d,g=i.lineHeight*p,m=g;p>0&&f>g&&(m=(g+f)/2);var _=g+d,v=i.lineHeight*(p+1),y=_;p+1<e.length&&v<_&&(y=(_+v)/2);for(var b=(y-m)/h,x=0;x<u.length;x++){var E;E="number"==typeof c[x]?c[x]:x/u.length;var T=Math.min(1,Math.max(0,m/h+E*b));T=Number(T.toFixed(5)),r.addColorStop(T,u[x])}}}else{r=this.context.createLinearGradient(o,h/2,a+o,h/2);var S=u.length+1,w=1;for(p=0;p<u.length;p++){var A;A="number"==typeof c[p]?c[p]:w/S,r.addColorStop(A,u[p]),w++}}return r},e.prototype.destroy=function(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},_e,e),t.prototype.destroy.call(this,e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(e.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){this.updateText(!0);var e=(0,x.sign)(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){this.updateText(!0);var e=(0,x.sign)(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this._style},set:function(t){t=t||{},this._style=t instanceof le?t:new le(t),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},enumerable:!1,configurable:!0}),e.nextLineHeightBehavior=!1,e}(ae);E.X.UPLOADS_PER_FRAME=4;var ye=function(t,e){return ye=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},ye(t,e)},be=function(){function t(t){this.maxItemsPerFrame=t,this.itemsLeft=0}return t.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},t.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},t}();function xe(t,e){var i=!1;if(t&&t._textures&&t._textures.length)for(var r=0;r<t._textures.length;r++)if(t._textures[r]instanceof X.xE){var n=t._textures[r].baseTexture;-1===e.indexOf(n)&&(e.push(n),i=!0)}return i}function Ee(t,e){if(t.baseTexture instanceof X.VL){var i=t.baseTexture;return-1===e.indexOf(i)&&e.push(i),!0}return!1}function Te(t,e){if(t._texture&&t._texture instanceof X.xE){var i=t._texture.baseTexture;return-1===e.indexOf(i)&&e.push(i),!0}return!1}function Se(t,e){return e instanceof ve&&(e.updateText(!0),!0)}function we(t,e){if(e instanceof le){var i=e.toFontString();return ge.measureFont(i),!0}return!1}function Ae(t,e){if(t instanceof ve){-1===e.indexOf(t.style)&&e.push(t.style),-1===e.indexOf(t)&&e.push(t);var i=t._texture.baseTexture;return-1===e.indexOf(i)&&e.push(i),!0}return!1}function Ce(t,e){return t instanceof le&&(-1===e.indexOf(t)&&e.push(t),!0)}var Oe=function(){function t(t){var e=this;this.limiter=new be(E.X.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){e.queue&&e.prepareItems()},this.registerFindHook(Ae),this.registerFindHook(Ce),this.registerFindHook(xe),this.registerFindHook(Ee),this.registerFindHook(Te),this.registerUploadHook(Se),this.registerUploadHook(we)}return t.prototype.upload=function(t,e){"function"==typeof t&&(e=t,t=null),t&&this.add(t),this.queue.length?(e&&this.completes.push(e),this.ticking||(this.ticking=!0,N.vB.system.addOnce(this.tick,this,N.uF.UTILITY))):e&&e()},t.prototype.tick=function(){setTimeout(this.delayedTick,0)},t.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var t=this.queue[0],e=!1;if(t&&!t._destroyed)for(var i=0,r=this.uploadHooks.length;i<r;i++)if(this.uploadHooks[i](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)N.vB.system.addOnce(this.tick,this,N.uF.UTILITY);else{this.ticking=!1;var n=this.completes.slice(0);for(this.completes.length=0,i=0,r=n.length;i<r;i++)n[i]()}},t.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this},t.prototype.registerUploadHook=function(t){return t&&this.uploadHooks.push(t),this},t.prototype.add=function(t){for(var e=0,i=this.addHooks.length;e<i&&!this.addHooks[e](t,this.queue);e++);if(t instanceof R)for(e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this},t.prototype.destroy=function(){this.ticking&&N.vB.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},t}();function Ie(t,e){return e instanceof X.VL&&(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0)}function Re(t,e){if(!(e instanceof ie))return!1;var i=e.geometry;e.finishPoly(),i.updateBatches();for(var r=i.batches,n=0;n<r.length;n++){var s=r[n].style.texture;s&&Ie(t,s.baseTexture)}return i.batchable||t.geometry.bind(i,e._resolveDirectShader(t)),!0}function Me(t,e){return t instanceof ie&&(e.push(t),!0)}var Pe=function(t){function e(e){var i=t.call(this,e)||this;return i.uploadHookHelper=i.renderer,i.registerFindHook(Me),i.registerUploadHook(Ie),i.registerUploadHook(Re),i}return function(t,e){function i(){this.constructor=t}ye(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}(e,t),e}(Oe),Ne=function(){function t(t){this.maxMilliseconds=t,this.frameStart=0}return t.prototype.beginFrame=function(){this.frameStart=Date.now()},t.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds},t}(),Le=function(){function t(t,e,i){void 0===i&&(i=null),this._texture=t instanceof X.xE?t:null,this.baseTexture=t instanceof X.VL?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;var r=this.baseTexture.resource;this.resolution=this._updateResolution(i||(r?r.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return t.prototype._updateResolution=function(t){void 0===t&&(t=null);var e=this.data.meta.scale,i=(0,x.getResolutionOfUrl)(t,null);return null===i&&(i=void 0!==e?parseFloat(e):1),1!==i&&this.baseTexture.setResolution(i),i},t.prototype.parse=function(e){this._batchIndex=0,this._callback=e,this._frameKeys.length<=t.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},t.prototype._processFrames=function(e){for(var i=e,r=t.BATCH_SIZE;i-e<r&&i<this._frameKeys.length;){var n=this._frameKeys[i],s=this._frames[n],o=s.frame;if(o){var a,h=null,u=!1!==s.trimmed&&s.sourceSize?s.sourceSize:s.frame,c=new T.Ae(0,0,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution);a=s.rotated?new T.Ae(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):new T.Ae(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),!1!==s.trimmed&&s.spriteSourceSize&&(h=new T.Ae(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[n]=new X.xE(this.baseTexture,a,c,h,s.rotated?2:0,s.anchor),X.xE.addToCache(this.textures[n],n)}i++}},t.prototype._processAnimations=function(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];for(var i=0;i<t[e].length;i++){var r=t[e][i];this.animations[e].push(this.textures[r])}}},t.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},t.prototype._nextBatch=function(){var e=this;this._processFrames(this._batchIndex*t.BATCH_SIZE),this._batchIndex++,setTimeout((function(){e._batchIndex*t.BATCH_SIZE<e._frameKeys.length?e._nextBatch():(e._processAnimations(),e._parseComplete())}),0)},t.prototype.destroy=function(t){var e;for(var i in void 0===t&&(t=!1),this.textures)this.textures[i].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(null===(e=this._texture)||void 0===e||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null},t.BATCH_SIZE=1e3,t}(),De=function(){function t(){}return t.use=function(e,i){var r,n,s=this,o=e.name+"_image";if(e.data&&e.type===q.kC.TYPE.JSON&&e.data.frames&&!s.resources[o]){var a=null===(n=null===(r=e.data)||void 0===r?void 0:r.meta)||void 0===n?void 0:n.related_multi_packs;if(Array.isArray(a))for(var h=function(t){if("string"!=typeof t)return"continue";var i=t.replace(".json",""),r=x.url.resolve(e.url.replace(s.baseUrl,""),t);if(s.resources[i]||Object.values(s.resources).some((function(t){return x.url.format(x.url.parse(t.url))===r})))return"continue";var n={crossOrigin:e.crossOrigin,loadType:q.kC.LOAD_TYPE.XHR,xhrType:q.kC.XHR_RESPONSE_TYPE.JSON,parentResource:e,metadata:e.metadata};s.add(i,r,n)},u=0,c=a;u<c.length;u++)h(c[u]);var l={crossOrigin:e.crossOrigin,metadata:e.metadata.imageMetadata,parentResource:e},p=t.getResourcePath(e,s.baseUrl);s.add(o,p,l,(function(t){if(t.error)i(t.error);else{var r=new Le(t.texture,e.data,e.url);r.parse((function(){e.spritesheet=r,e.textures=r.textures,i()}))}}))}else i()},t.getResourcePath=function(t,e){return t.isDataUrl?t.data.meta.image:x.url.resolve(t.url.replace(e,""),t.data.meta.image)},t}(),ke=function(t,e){return ke=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},ke(t,e)};function Be(t,e){function i(){this.constructor=t}ke(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var Fe=new T.E9,Ge=function(t){function e(e,i,r){void 0===i&&(i=100),void 0===r&&(r=100);var n=t.call(this,e)||this;return n.tileTransform=new T.wx,n._width=i,n._height=r,n.uvMatrix=n.texture.uvMatrix||new X.UX(e),n.pluginName="tilingSprite",n.uvRespectAnchor=!1,n}return Be(e,t),Object.defineProperty(e.prototype,"clampMargin",{get:function(){return this.uvMatrix.clampMargin},set:function(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tileScale",{get:function(){return this.tileTransform.scale},set:function(t){this.tileTransform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tilePosition",{get:function(){return this.tileTransform.position},set:function(t){this.tileTransform.position.copyFrom(t)},enumerable:!1,configurable:!0}),e.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},e.prototype._render=function(t){var e=this._texture;e&&e.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},e.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,i=this._width*(1-this._anchor._x),r=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,i,r)},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new T.Ae),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,Fe);var e=this._width,i=this._height,r=-e*this.anchor._x;if(Fe.x>=r&&Fe.x<r+e){var n=-i*this.anchor._y;if(Fe.y>=n&&Fe.y<n+i)return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.tileTransform=null,this.uvMatrix=null},e.from=function(t,i){return new e(t instanceof X.xE?t:X.xE.from(t,i),i.width,i.height)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t},enumerable:!1,configurable:!0}),e}(ae),Ue="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n",je=new T.y3,Xe=function(t){function e(e){var i=t.call(this,e)||this,r={globals:i.renderer.globalUniforms};return i.shader=X.ex.from(Ue,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture2D(uSampler, coord);\n    gl_FragColor = texSample * uColor;\n}\n",r),i.simpleShader=X.ex.from(Ue,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = sample * uColor;\n}\n",r),i.quad=new X.ud,i.state=X.ZM.for2d(),i}return Be(e,t),e.prototype.render=function(t){var e=this.renderer,i=this.quad,r=i.vertices;r[0]=r[6]=t._width*-t.anchor.x,r[1]=r[3]=t._height*-t.anchor.y,r[2]=r[4]=t._width*(1-t.anchor.x),r[5]=r[7]=t._height*(1-t.anchor.y);var n=t.uvRespectAnchor?t.anchor.x:0,s=t.uvRespectAnchor?t.anchor.y:0;(r=i.uvs)[0]=r[6]=-n,r[1]=r[3]=-s,r[2]=r[4]=1-n,r[5]=r[7]=1-s,i.invalidate();var o=t._texture,a=o.baseTexture,h=t.tileTransform.localTransform,u=t.uvMatrix,c=a.isPowerOfTwo&&o.frame.width===a.width&&o.frame.height===a.height;c&&(a._glTextures[e.CONTEXT_UID]?c=a.wrapMode!==Z.Nt.CLAMP:a.wrapMode===Z.Nt.CLAMP&&(a.wrapMode=Z.Nt.REPEAT));var l=c?this.simpleShader:this.shader,p=o.width,d=o.height,f=t._width,g=t._height;je.set(h.a*p/f,h.b*p/g,h.c*d/f,h.d*d/g,h.tx/f,h.ty/g),je.invert(),c?je.prepend(u.mapCoord):(l.uniforms.uMapCoord=u.mapCoord.toArray(!0),l.uniforms.uClampFrame=u.uClampFrame,l.uniforms.uClampOffset=u.uClampOffset),l.uniforms.uTransform=je.toArray(!0),l.uniforms.uColor=(0,x.premultiplyTintToRgba)(t.tint,t.worldAlpha,l.uniforms.uColor,a.alphaMode),l.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),l.uniforms.uSampler=o,e.shader.bind(l),e.geometry.bind(i),this.state.blendMode=(0,x.correctBlendMode)(t.blendMode,a.alphaMode),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},e}(X.bO),ze=function(t,e){return ze=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},ze(t,e)};function He(t,e){function i(){this.constructor=t}ze(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var Ve=function(){function t(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return t.prototype.update=function(t){if(t||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var e=this.uvBuffer.data;this.data&&this.data.length===e.length||(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}},t}(),Ye=new T.E9,We=new T.mg,$e=function(t){function e(e,i,r,n){void 0===n&&(n=Z.lg.TRIANGLES);var s=t.call(this)||this;return s.geometry=e,e.refCount++,s.shader=i,s.state=r||X.ZM.for2d(),s.drawMode=n,s.start=0,s.size=0,s.uvs=null,s.indices=null,s.vertexData=new Float32Array(1),s.vertexDirty=-1,s._transformID=-1,s._roundPixels=E.X.ROUND_PIXELS,s.batchUvs=null,s}return He(e,t),Object.defineProperty(e.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"material",{get:function(){return this.shader},set:function(t){this.shader=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return"tint"in this.shader?this.shader.tint:null},set:function(t){this.shader.tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return"texture"in this.shader?this.shader.texture:null},set:function(t){this.shader.texture=t},enumerable:!1,configurable:!0}),e.prototype._render=function(t){var i=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===Z.lg.TRIANGLES&&i.length<2*e.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)},e.prototype._renderDefault=function(t){var e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},e.prototype._renderToBatch=function(t){var e=this.geometry,i=this.shader;i.uvMatrix&&(i.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=i._tintRGB,this._texture=i.texture;var r=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[r]),t.plugins[r].render(this)},e.prototype.calculateVertices=function(){var t=this.geometry.buffers[0],e=t.data,i=t._updateID;if(i!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));for(var r=this.transform.worldTransform,n=r.a,s=r.b,o=r.c,a=r.d,h=r.tx,u=r.ty,c=this.vertexData,l=0;l<c.length/2;l++){var p=e[2*l],d=e[2*l+1];c[2*l]=n*p+o*d+h,c[2*l+1]=s*p+a*d+u}if(this._roundPixels){var f=E.X.RESOLUTION;for(l=0;l<c.length;++l)c[l]=Math.round((c[l]*f|0)/f)}this.vertexDirty=i}},e.prototype.calculateUvs=function(){var t=this.geometry.buffers[1],e=this.shader;e.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new Ve(t,e.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},e.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},e.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,Ye);for(var e=this.geometry.getBuffer("aVertexPosition").data,i=We.points,r=this.geometry.getIndex().data,n=r.length,s=4===this.drawMode?3:1,o=0;o+2<n;o+=s){var a=2*r[o],h=2*r[o+1],u=2*r[o+2];if(i[0]=e[a],i[1]=e[a+1],i[2]=e[h],i[3]=e[h+1],i[4]=e[u],i[5]=e[u+1],We.contains(Ye.x,Ye.y))return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.geometry.refCount--,0===this.geometry.refCount&&this.geometry.dispose(),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},e.BATCHABLE_SIZE=100,e}(R),qe=function(t){function e(e,i){var r=this,n={uSampler:e,alpha:1,uTextureMatrix:T.y3.IDENTITY,uColor:new Float32Array([1,1,1,1])};return(i=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},i)).uniforms&&Object.assign(n,i.uniforms),(r=t.call(this,i.program||X.$r.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),n)||this)._colorDirty=!1,r.uvMatrix=new X.UX(e),r.batchable=void 0===i.program,r.pluginName=i.pluginName,r.tint=i.tint,r.alpha=i.alpha,r}return He(e,t),Object.defineProperty(e.prototype,"texture",{get:function(){return this.uniforms.uSampler},set:function(t){this.uniforms.uSampler!==t&&(this.uniforms.uSampler=t,this.uvMatrix.texture=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),e.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var t=this.texture.baseTexture;(0,x.premultiplyTintToRgba)(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},e}(X.ex),Ze=function(t){function e(e,i,r){var n=t.call(this)||this,s=new X.lW(e),o=new X.lW(i,!0),a=new X.lW(r,!0,!0);return n.addAttribute("aVertexPosition",s,2,!1,Z.vK.FLOAT).addAttribute("aTextureCoord",o,2,!1,Z.vK.FLOAT).addIndex(a),n._updateId=-1,n}return He(e,t),Object.defineProperty(e.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),e}(X.ZX),Ke=function(t,e){return Ke=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},Ke(t,e)},Je=function(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[]},Qe=function(){function t(){}return t.test=function(t){return"string"==typeof t&&0===t.indexOf("info face=")},t.parse=function(t){var e=t.match(/^[a-z]+\s+.+$/gm),i={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[]};for(var r in e){var n=e[r].match(/^[a-z]+/gm)[0],s=e[r].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),o={};for(var a in s){var h=s[a].split("="),u=h[0],c=h[1].replace(/"/gm,""),l=parseFloat(c),p=isNaN(l)?c:l;o[u]=p}i[n].push(o)}var d=new Je;return i.info.forEach((function(t){return d.info.push({face:t.face,size:parseInt(t.size,10)})})),i.common.forEach((function(t){return d.common.push({lineHeight:parseInt(t.lineHeight,10)})})),i.page.forEach((function(t){return d.page.push({id:parseInt(t.id,10),file:t.file})})),i.char.forEach((function(t){return d.char.push({id:parseInt(t.id,10),page:parseInt(t.page,10),x:parseInt(t.x,10),y:parseInt(t.y,10),width:parseInt(t.width,10),height:parseInt(t.height,10),xoffset:parseInt(t.xoffset,10),yoffset:parseInt(t.yoffset,10),xadvance:parseInt(t.xadvance,10)})})),i.kerning.forEach((function(t){return d.kerning.push({first:parseInt(t.first,10),second:parseInt(t.second,10),amount:parseInt(t.amount,10)})})),d},t}(),ti=function(){function t(){}return t.test=function(t){return t instanceof XMLDocument&&t.getElementsByTagName("page").length&&null!==t.getElementsByTagName("info")[0].getAttribute("face")},t.parse=function(t){for(var e=new Je,i=t.getElementsByTagName("info"),r=t.getElementsByTagName("common"),n=t.getElementsByTagName("page"),s=t.getElementsByTagName("char"),o=t.getElementsByTagName("kerning"),a=0;a<i.length;a++)e.info.push({face:i[a].getAttribute("face"),size:parseInt(i[a].getAttribute("size"),10)});for(a=0;a<r.length;a++)e.common.push({lineHeight:parseInt(r[a].getAttribute("lineHeight"),10)});for(a=0;a<n.length;a++)e.page.push({id:parseInt(n[a].getAttribute("id"),10)||0,file:n[a].getAttribute("file")});for(a=0;a<s.length;a++){var h=s[a];e.char.push({id:parseInt(h.getAttribute("id"),10),page:parseInt(h.getAttribute("page"),10)||0,x:parseInt(h.getAttribute("x"),10),y:parseInt(h.getAttribute("y"),10),width:parseInt(h.getAttribute("width"),10),height:parseInt(h.getAttribute("height"),10),xoffset:parseInt(h.getAttribute("xoffset"),10),yoffset:parseInt(h.getAttribute("yoffset"),10),xadvance:parseInt(h.getAttribute("xadvance"),10)})}for(a=0;a<o.length;a++)e.kerning.push({first:parseInt(o[a].getAttribute("first"),10),second:parseInt(o[a].getAttribute("second"),10),amount:parseInt(o[a].getAttribute("amount"),10)});return e},t}(),ei=function(){function t(){}return t.test=function(t){if("string"==typeof t&&t.indexOf("<font>")>-1){var e=(new self.DOMParser).parseFromString(t,"text/xml");return ti.test(e)}return!1},t.parse=function(t){var e=(new self.DOMParser).parseFromString(t,"text/xml");return ti.parse(e)},t}(),ii=[Qe,ti,ei];function ri(t){for(var e=0;e<ii.length;e++)if(ii[e].test(t))return ii[e];return null}function ni(t,e,i,r,n,s,o){var a=i.text,h=i.fontProperties;e.translate(r,n),e.scale(s,s);var u=o.strokeThickness/2,c=-o.strokeThickness/2;e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=function(t,e,i,r,n,s){var o,a=i.fill;if(!Array.isArray(a))return a;if(1===a.length)return a[0];var h=i.dropShadow?i.dropShadowDistance:0,u=i.padding||0,c=t.width/r-h-2*u,l=t.height/r-h-2*u,p=a.slice(),d=i.fillGradientStops.slice();if(!d.length)for(var f=p.length+1,g=1;g<f;++g)d.push(g/f);if(p.unshift(a[0]),d.unshift(0),p.push(a[a.length-1]),d.push(1),i.fillGradientType===$t.LINEAR_VERTICAL){o=e.createLinearGradient(c/2,u,c/2,l+u);var m=0,_=(s.fontProperties.fontSize+i.strokeThickness)/l;for(g=0;g<n.length;g++)for(var v=s.lineHeight*g,y=0;y<p.length;y++){var b=v/l+("number"==typeof d[y]?d[y]:y/p.length)*_,x=Math.max(m,b);x=Math.min(x,1),o.addColorStop(x,p[y]),m=x}}else{o=e.createLinearGradient(u,l/2,c+u,l/2);var E=p.length+1,T=1;for(g=0;g<p.length;g++){var S;S="number"==typeof d[g]?d[g]:T/E,o.addColorStop(S,p[g]),T++}}return o}(t,e,o,s,[a],i),e.strokeStyle=o.stroke;var l=o.dropShadowColor,p=(0,x.hex2rgb)("number"==typeof l?l:(0,x.string2hex)(l));o.dropShadow?(e.shadowColor="rgba("+255*p[0]+","+255*p[1]+","+255*p[2]+","+o.dropShadowAlpha+")",e.shadowBlur=o.dropShadowBlur,e.shadowOffsetX=Math.cos(o.dropShadowAngle)*o.dropShadowDistance,e.shadowOffsetY=Math.sin(o.dropShadowAngle)*o.dropShadowDistance):(e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),o.stroke&&o.strokeThickness&&e.strokeText(a,u,c+i.lineHeight-h.descent),o.fill&&e.fillText(a,u,c+i.lineHeight-h.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}var si=function(){function t(t,e,i){var r=t.info[0],n=t.common[0],s=t.page[0],o=(0,x.getResolutionOfUrl)(s.file),a={};this._ownsTextures=i,this.font=r.face,this.size=r.size,this.lineHeight=n.lineHeight/o,this.chars={},this.pageTextures=a;for(var h=0;h<t.page.length;h++){var u=t.page[h],c=u.id,l=u.file;a[c]=e instanceof Array?e[h]:e[l]}for(h=0;h<t.char.length;h++){var p=t.char[h],d=(c=p.id,p.page),f=t.char[h],g=f.x,m=f.y,_=f.width,v=f.height,y=f.xoffset,b=f.yoffset,E=f.xadvance;g/=o,m/=o,_/=o,v/=o,y/=o,b/=o,E/=o;var S=new T.Ae(g+a[d].frame.x/o,m+a[d].frame.y/o,_,v);this.chars[c]={xOffset:y,yOffset:b,xAdvance:E,kerning:{},texture:new X.xE(a[d].baseTexture,S),page:d}}for(h=0;h<t.kerning.length;h++){var w=t.kerning[h],A=w.first,C=w.second,O=w.amount;A/=o,C/=o,O/=o,this.chars[C]&&(this.chars[C].kerning[A]=O)}}return t.prototype.destroy=function(){for(var t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(var t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null},t.install=function(e,i,r){var n;if(e instanceof Je)n=e;else{var s=ri(e);if(!s)throw new Error("Unrecognized data format for font.");n=s.parse(e)}i instanceof X.xE&&(i=[i]);var o=new t(n,i,r);return t.available[o.font]=o,o},t.uninstall=function(e){var i=t.available[e];if(!i)throw new Error("No font found named '"+e+"'");i.destroy(),delete t.available[e]},t.from=function(e,i,r){if(!e)throw new Error("[BitmapFont] Property `name` is required.");var n=Object.assign({},t.defaultOptions,r),s=n.chars,o=n.padding,a=n.resolution,h=n.textureWidth,u=n.textureHeight,c=function(t){"string"==typeof t&&(t=[t]);for(var e=[],i=0,r=t.length;i<r;i++){var n=t[i];if(Array.isArray(n)){if(2!==n.length)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+n.length+".");var s=n[0].charCodeAt(0),o=n[1].charCodeAt(0);if(o<s)throw new Error("[BitmapFont]: Invalid character range.");for(var a=s,h=o;a<=h;a++)e.push(String.fromCharCode(a))}else e.push.apply(e,n.split(""))}if(0===e.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}(s),l=i instanceof le?i:new le(i),p=h,d=new Je;d.info[0]={face:l.fontFamily,size:l.fontSize},d.common[0]={lineHeight:l.fontSize};for(var f,g,m,_=0,v=0,y=0,b=[],x=0;x<c.length;x++){f||((f=document.createElement("canvas")).width=h,f.height=u,g=f.getContext("2d"),m=new X.VL(f,{resolution:a}),b.push(new X.xE(m)),d.page.push({id:b.length-1,file:""}));var E=ge.measureText(c[x],l,!1,f),T=E.width,S=Math.ceil(E.height),w=Math.ceil(("italic"===l.fontStyle?2:1)*T);if(v>=u-S*a){if(0===v)throw new Error("[BitmapFont] textureHeight "+u+"px is too small for "+l.fontSize+"px fonts");--x,f=null,g=null,m=null,v=0,_=0,y=0}else if(y=Math.max(S+E.fontProperties.descent,y),w*a+_>=p)--x,v+=y*a,v=Math.ceil(v),_=0,y=0;else{ni(f,g,E,_,v,a,l);var A=E.text.charCodeAt(0);d.char.push({id:A,page:b.length-1,x:_/a,y:v/a,width:w,height:S,xoffset:0,yoffset:0,xadvance:Math.ceil(T-(l.dropShadow?l.dropShadowDistance:0)-(l.stroke?l.strokeThickness:0))}),_+=(w+2*o)*a,_=Math.ceil(_)}}x=0;for(var C=c.length;x<C;x++)for(var O=c[x],I=0;I<C;I++){var R=c[I],M=g.measureText(O).width,P=g.measureText(R).width,N=g.measureText(O+R).width-(M+P);N&&d.kerning.push({first:O.charCodeAt(0),second:R.charCodeAt(0),amount:N})}var L=new t(d,b,!0);return void 0!==t.available[e]&&t.uninstall(e),t.available[e]=L,L},t.ALPHA=[["a","z"],["A","Z"]," "],t.NUMERIC=[["0","9"]],t.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],t.ASCII=[[" ","~"]],t.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:t.ALPHANUMERIC},t.available={},t}(),oi=[],ai=[],hi=function(t){function e(i,r){void 0===r&&(r={});var n=t.call(this)||this;n._tint=16777215;var s=Object.assign({},e.styleDefaults,r),o=s.align,a=s.tint,h=s.maxWidth,u=s.letterSpacing,c=s.fontName,l=s.fontSize;if(!si.available[c])throw new Error('Missing BitmapFont "'+c+'"');return n._activePagesMeshData=[],n._textWidth=0,n._textHeight=0,n._align=o,n._tint=a,n._fontName=c,n._fontSize=l||si.available[c].size,n._text=i,n._maxWidth=h,n._maxLineHeight=0,n._letterSpacing=u,n._anchor=new T.AB((function(){n.dirty=!0}),n,0,0),n._roundPixels=E.X.ROUND_PIXELS,n.dirty=!0,n._textureCache={},n}return function(t,e){function i(){this.constructor=t}Ke(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}(e,t),e.prototype.updateText=function(){for(var t,e=si.available[this._fontName],i=this._fontSize/e.size,r=new T.E9,n=[],s=[],o=[],a=this._text.replace(/(?:\r\n|\r)/g,"\n")||" ",h=a.length,u=this._maxWidth*e.size/this._fontSize,c=null,l=0,p=0,d=0,f=-1,g=0,m=0,_=0,v=0,y=0;y<h;y++){var b=a.charCodeAt(y),E=a.charAt(y);if(/(?:\s)/.test(E)&&(f=y,g=l,v++),"\r"!==E&&"\n"!==E){var S=e.chars[b];if(S){c&&S.kerning[c]&&(r.x+=S.kerning[c]);var w=ai.pop()||{texture:X.xE.EMPTY,line:0,charCode:0,prevSpaces:0,position:new T.E9};w.texture=S.texture,w.line=d,w.charCode=b,w.position.x=r.x+S.xOffset+this._letterSpacing/2,w.position.y=r.y+S.yOffset,w.prevSpaces=v,n.push(w),l=w.position.x+S.texture.orig.width,r.x+=S.xAdvance+this._letterSpacing,_=Math.max(_,S.yOffset+S.texture.height),c=b,-1!==f&&u>0&&r.x>u&&(++m,(0,x.removeItems)(n,1+f-m,1+y-f),y=f,f=-1,s.push(g),o.push(n.length>0?n[n.length-1].prevSpaces:0),p=Math.max(p,g),d++,r.x=0,r.y+=e.lineHeight,c=null,v=0)}}else s.push(l),o.push(-1),p=Math.max(p,l),++d,++m,r.x=0,r.y+=e.lineHeight,c=null,v=0}var A=a.charAt(a.length-1);"\r"!==A&&"\n"!==A&&(/(?:\s)/.test(A)&&(l=g),s.push(l),p=Math.max(p,l),o.push(-1));var C=[];for(y=0;y<=d;y++){var O=0;"right"===this._align?O=p-s[y]:"center"===this._align?O=(p-s[y])/2:"justify"===this._align&&(O=o[y]<0?0:(p-s[y])/o[y]),C.push(O)}var I=n.length,R={},M=[],P=this._activePagesMeshData;for(y=0;y<P.length;y++)oi.push(P[y]);for(y=0;y<I;y++){var N=(z=n[y].texture).baseTexture.uid;if(!R[N]){if(!(Z=oi.pop())){var L=new Ze,D=new qe(X.xE.EMPTY);Z={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:new $e(L,D),vertices:null,uvs:null,indices:null}}Z.index=0,Z.indexCount=0,Z.vertexCount=0,Z.uvsCount=0,Z.total=0;var k=this._textureCache;k[N]=k[N]||new X.xE(z.baseTexture),Z.mesh.texture=k[N],Z.mesh.tint=this._tint,M.push(Z),R[N]=Z}R[N].total++}for(y=0;y<P.length;y++)-1===M.indexOf(P[y])&&this.removeChild(P[y].mesh);for(y=0;y<M.length;y++)M[y].mesh.parent!==this&&this.addChild(M[y].mesh);for(var y in this._activePagesMeshData=M,R){var B=(Z=R[y]).total;if(!((null===(t=Z.indices)||void 0===t?void 0:t.length)>6*B)||Z.vertices.length<2*$e.BATCHABLE_SIZE)Z.vertices=new Float32Array(8*B),Z.uvs=new Float32Array(8*B),Z.indices=new Uint16Array(6*B);else for(var F=Z.total,G=Z.vertices,U=4*F*2;U<G.length;U++)G[U]=0;Z.mesh.size=6*B}for(y=0;y<I;y++){var j=(E=n[y]).position.x+C[E.line]*("justify"===this._align?E.prevSpaces:1);this._roundPixels&&(j=Math.round(j));var z,H=j*i,V=E.position.y*i,Y=R[(z=E.texture).baseTexture.uid],W=z.frame,$=z._uvs,q=Y.index++;Y.indices[6*q+0]=0+4*q,Y.indices[6*q+1]=1+4*q,Y.indices[6*q+2]=2+4*q,Y.indices[6*q+3]=0+4*q,Y.indices[6*q+4]=2+4*q,Y.indices[6*q+5]=3+4*q,Y.vertices[8*q+0]=H,Y.vertices[8*q+1]=V,Y.vertices[8*q+2]=H+W.width*i,Y.vertices[8*q+3]=V,Y.vertices[8*q+4]=H+W.width*i,Y.vertices[8*q+5]=V+W.height*i,Y.vertices[8*q+6]=H,Y.vertices[8*q+7]=V+W.height*i,Y.uvs[8*q+0]=$.x0,Y.uvs[8*q+1]=$.y0,Y.uvs[8*q+2]=$.x1,Y.uvs[8*q+3]=$.y1,Y.uvs[8*q+4]=$.x2,Y.uvs[8*q+5]=$.y2,Y.uvs[8*q+6]=$.x3,Y.uvs[8*q+7]=$.y3}for(var y in this._textWidth=p*i,this._textHeight=(r.y+e.lineHeight)*i,R){var Z=R[y];if(0!==this.anchor.x||0!==this.anchor.y)for(var K=0,J=this._textWidth*this.anchor.x,Q=this._textHeight*this.anchor.y,tt=0;tt<Z.total;tt++)Z.vertices[K++]-=J,Z.vertices[K++]-=Q,Z.vertices[K++]-=J,Z.vertices[K++]-=Q,Z.vertices[K++]-=J,Z.vertices[K++]-=Q,Z.vertices[K++]-=J,Z.vertices[K++]-=Q;this._maxLineHeight=_*i;var et=Z.mesh.geometry.getBuffer("aVertexPosition"),it=Z.mesh.geometry.getBuffer("aTextureCoord"),rt=Z.mesh.geometry.getIndex();et.data=Z.vertices,it.data=Z.uvs,rt.data=Z.indices,et.update(),it.update(),rt.update()}for(y=0;y<n.length;y++)ai.push(n[y])},e.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},e.prototype.getLocalBounds=function(){return this.validate(),t.prototype.getLocalBounds.call(this)},e.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){if(this._tint!==t){this._tint=t;for(var e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontName",{get:function(){return this._fontName},set:function(t){if(!si.available[t])throw new Error('Missing BitmapFont "'+t+'"');this._fontName!==t&&(this._fontName=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},set:function(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),e.prototype.destroy=function(e){var i=this._textureCache;for(var r in i)i[r].destroy(),delete i[r];this._textureCache=null,t.prototype.destroy.call(this,e)},e.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0},e}(R),ui=function(){function t(){}return t.add=function(){q.kC.setExtensionXhrType("fnt",q.kC.XHR_RESPONSE_TYPE.TEXT)},t.use=function(e,i){var r=ri(e.data);if(r)for(var n=t.getBaseUrl(this,e),s=r.parse(e.data),o={},a=function(t){o[t.metadata.pageFile]=t.texture,Object.keys(o).length===s.page.length&&(e.bitmapFont=si.install(s,o,!0),i())},h=0;h<s.page.length;++h){var u=s.page[h].file,c=n+u,l=!1;for(var p in this.resources){var d=this.resources[p];if(d.url===c){d.metadata.pageFile=u,d.texture?a(d):d.onAfterMiddleware.add(a),l=!0;break}}if(!l){var f={crossOrigin:e.crossOrigin,loadType:q.kC.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:u},e.metadata.imageMetadata),parentResource:e};this.add(c,f,a)}}else i()},t.getBaseUrl=function(e,i){var r=i.isDataUrl?"":t.dirname(i.url);return i.isDataUrl&&("."===r&&(r=""),e.baseUrl&&r&&"/"===e.baseUrl.charAt(e.baseUrl.length-1)&&(r+="/")),(r=r.replace(e.baseUrl,""))&&"/"!==r.charAt(r.length-1)&&(r+="/"),r},t.dirname=function(t){var e=t.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return e===t?".":""===e?"/":e},t}(),ci=function(t,e){return ci=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},ci(t,e)},li=function(t){function e(e){void 0===e&&(e=1);var i=t.call(this,X.kP,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",{uAlpha:1})||this;return i.alpha=e,i}return function(t,e){function i(){this.constructor=t}ci(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}(e,t),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),e}(X.wn),pi=function(t,e){return pi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},pi(t,e)};function di(t,e){function i(){this.constructor=t}pi(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var fi,gi,mi,_i,vi,yi,bi,xi,Ei,Ti,Si,wi,Ai,Ci,Oi,Ii,Ri,Mi,Pi,Ni={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},Li=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(fi||(fi={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(gi||(gi={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL"}(mi||(mi={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(_i||(_i={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(vi||(vi={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(yi||(yi={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(bi||(bi={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(xi||(xi={})),function(t){t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT"}(Ei||(Ei={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(Ti||(Ti={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(Si||(Si={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL"}(wi||(wi={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(Ai||(Ai={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT"}(Ci||(Ci={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(Oi||(Oi={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(Ii||(Ii={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(Ri||(Ri={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH"}(Mi||(Mi={})),function(t){t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(Pi||(Pi={}));var Di=function(t){function e(e,i,r,n,s){void 0===i&&(i=8),void 0===r&&(r=4),void 0===n&&(n=E.X.FILTER_RESOLUTION),void 0===s&&(s=5);var o=this,a=function(t,e){var i,r=Math.ceil(t/2),n="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }",s="";i=e?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var o=0;o<t;o++){var a=i.replace("%index%",o.toString());s+=a=a.replace("%sampleIndex%",o-(r-1)+".0"),s+="\n"}return(n=n.replace("%blur%",s)).replace("%size%",t.toString())}(s,e),h=function(t){for(var e,i=Ni[t],r=i.length,n=Li,s="",o=0;o<t;o++){var a="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",o.toString());e=o,o>=r&&(e=t-o-1),s+=a=a.replace("%value%",i[e].toString()),s+="\n"}return(n=n.replace("%blur%",s)).replace("%size%",t.toString())}(s);return(o=t.call(this,a,h)||this).horizontal=e,o.resolution=n,o._quality=0,o.quality=r,o.blur=i,o}return di(e,t),e.prototype.apply=function(t,e,i,r){if(i?this.horizontal?this.uniforms.strength=1/i.width*(i.width/e.width):this.uniforms.strength=1/i.height*(i.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,i,r);else{var n=t.getFilterTexture(),s=t.renderer,o=e,a=n;this.state.blend=!1,t.applyFilter(this,o,a,Ci.CLEAR);for(var h=1;h<this.passes-1;h++){t.bindAndClear(o,Ci.BLIT),this.uniforms.uSampler=a;var u=a;a=o,o=u,s.shader.bind(this),s.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,a,i,r),t.returnFilterTexture(n)}},Object.defineProperty(e.prototype,"blur",{get:function(){return this.strength},set:function(t){this.padding=1+2*Math.abs(t),this.strength=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t},enumerable:!1,configurable:!0}),e}(X.wn),ki=function(t){function e(e,i,r,n){void 0===e&&(e=8),void 0===i&&(i=4),void 0===r&&(r=E.X.FILTER_RESOLUTION),void 0===n&&(n=5);var s=t.call(this)||this;return s.blurXFilter=new Di(!0,e,i,r,n),s.blurYFilter=new Di(!1,e,i,r,n),s.resolution=r,s.quality=i,s.blur=e,s.repeatEdgePixels=!1,s}return di(e,t),e.prototype.apply=function(t,e,i,r){var n=Math.abs(this.blurXFilter.strength),s=Math.abs(this.blurYFilter.strength);if(n&&s){var o=t.getFilterTexture();this.blurXFilter.apply(t,e,o,Ci.CLEAR),this.blurYFilter.apply(t,o,i,r),t.returnFilterTexture(o)}else s?this.blurYFilter.apply(t,e,i,r):this.blurXFilter.apply(t,e,i,r)},e.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))},Object.defineProperty(e.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this.blurXFilter.quality},set:function(t){this.blurXFilter.quality=this.blurYFilter.quality=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.blurYFilter.blendMode},set:function(t){this.blurYFilter.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"repeatEdgePixels",{get:function(){return this._repeatEdgePixels},set:function(t){this._repeatEdgePixels=t,this.updatePadding()},enumerable:!1,configurable:!0}),e}(X.wn),Bi=function(t,e){return Bi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},Bi(t,e)},Fi=function(t){function e(){var e=this,i={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return(e=t.call(this,X.Y9,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",i)||this).alpha=1,e}return function(t,e){function i(){this.constructor=t}Bi(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}(e,t),e.prototype._loadMatrix=function(t,e){void 0===e&&(e=!1);var i=t;e&&(this._multiply(i,this.uniforms.m,t),i=this._colorMatrix(i)),this.uniforms.m=i},e.prototype._multiply=function(t,e,i){return t[0]=e[0]*i[0]+e[1]*i[5]+e[2]*i[10]+e[3]*i[15],t[1]=e[0]*i[1]+e[1]*i[6]+e[2]*i[11]+e[3]*i[16],t[2]=e[0]*i[2]+e[1]*i[7]+e[2]*i[12]+e[3]*i[17],t[3]=e[0]*i[3]+e[1]*i[8]+e[2]*i[13]+e[3]*i[18],t[4]=e[0]*i[4]+e[1]*i[9]+e[2]*i[14]+e[3]*i[19]+e[4],t[5]=e[5]*i[0]+e[6]*i[5]+e[7]*i[10]+e[8]*i[15],t[6]=e[5]*i[1]+e[6]*i[6]+e[7]*i[11]+e[8]*i[16],t[7]=e[5]*i[2]+e[6]*i[7]+e[7]*i[12]+e[8]*i[17],t[8]=e[5]*i[3]+e[6]*i[8]+e[7]*i[13]+e[8]*i[18],t[9]=e[5]*i[4]+e[6]*i[9]+e[7]*i[14]+e[8]*i[19]+e[9],t[10]=e[10]*i[0]+e[11]*i[5]+e[12]*i[10]+e[13]*i[15],t[11]=e[10]*i[1]+e[11]*i[6]+e[12]*i[11]+e[13]*i[16],t[12]=e[10]*i[2]+e[11]*i[7]+e[12]*i[12]+e[13]*i[17],t[13]=e[10]*i[3]+e[11]*i[8]+e[12]*i[13]+e[13]*i[18],t[14]=e[10]*i[4]+e[11]*i[9]+e[12]*i[14]+e[13]*i[19]+e[14],t[15]=e[15]*i[0]+e[16]*i[5]+e[17]*i[10]+e[18]*i[15],t[16]=e[15]*i[1]+e[16]*i[6]+e[17]*i[11]+e[18]*i[16],t[17]=e[15]*i[2]+e[16]*i[7]+e[17]*i[12]+e[18]*i[17],t[18]=e[15]*i[3]+e[16]*i[8]+e[17]*i[13]+e[18]*i[18],t[19]=e[15]*i[4]+e[16]*i[9]+e[17]*i[14]+e[18]*i[19]+e[19],t},e.prototype._colorMatrix=function(t){var e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e},e.prototype.brightness=function(t,e){var i=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.tint=function(t,e){var i=[(t>>16&255)/255,0,0,0,0,0,(t>>8&255)/255,0,0,0,0,0,(255&t)/255,0,0,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.greyscale=function(t,e){var i=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.blackAndWhite=function(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)},e.prototype.hue=function(t,e){t=(t||0)/180*Math.PI;var i=Math.cos(t),r=Math.sin(t),n=1/3,s=(0,Math.sqrt)(n),o=[i+(1-i)*n,n*(1-i)-s*r,n*(1-i)+s*r,0,0,n*(1-i)+s*r,i+n*(1-i),n*(1-i)-s*r,0,0,n*(1-i)-s*r,n*(1-i)+s*r,i+n*(1-i),0,0,0,0,0,1,0];this._loadMatrix(o,e)},e.prototype.contrast=function(t,e){var i=(t||0)+1,r=-.5*(i-1),n=[i,0,0,0,r,0,i,0,0,r,0,0,i,0,r,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.saturate=function(t,e){void 0===t&&(t=0);var i=2*t/3+1,r=-.5*(i-1),n=[i,r,r,0,0,r,i,r,0,0,r,r,i,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.desaturate=function(){this.saturate(-1)},e.prototype.negative=function(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)},e.prototype.sepia=function(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)},e.prototype.technicolor=function(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)},e.prototype.polaroid=function(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)},e.prototype.toBGR=function(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)},e.prototype.kodachrome=function(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)},e.prototype.browni=function(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)},e.prototype.vintage=function(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)},e.prototype.colorTone=function(t,e,i,r,n){var s=((i=i||16770432)>>16&255)/255,o=(i>>8&255)/255,a=(255&i)/255,h=((r=r||3375104)>>16&255)/255,u=(r>>8&255)/255,c=(255&r)/255,l=[.3,.59,.11,0,0,s,o,a,t=t||.2,0,h,u,c,e=e||.15,0,s-h,o-u,a-c,0,0];this._loadMatrix(l,n)},e.prototype.night=function(t,e){var i=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.predator=function(t,e){var i=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.lsd=function(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)},e.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},Object.defineProperty(e.prototype,"matrix",{get:function(){return this.uniforms.m},set:function(t){this.uniforms.m=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),e}(X.wn);Fi.prototype.grayscale=Fi.prototype.greyscale;var Gi,Ui,ji,Xi,zi,Hi,Vi,Yi,Wi,$i,qi,Zi,Ki,Ji,Qi,tr,er,ir,rr,nr=function(t,e){return nr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},nr(t,e)},sr=function(t){function e(e,i){var r=this,n=new T.y3;return e.renderable=!1,(r=t.call(this,"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",{mapSampler:e._texture,filterMatrix:n,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])})||this).maskSprite=e,r.maskMatrix=n,null==i&&(i=20),r.scale=new T.E9(i,i),r}return function(t,e){function i(){this.constructor=t}nr(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}(e,t),e.prototype.apply=function(t,e,i,r){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var n=this.maskSprite.worldTransform,s=Math.sqrt(n.a*n.a+n.b*n.b),o=Math.sqrt(n.c*n.c+n.d*n.d);0!==s&&0!==o&&(this.uniforms.rotation[0]=n.a/s,this.uniforms.rotation[1]=n.b/s,this.uniforms.rotation[2]=n.c/o,this.uniforms.rotation[3]=n.d/o),t.applyFilter(this,e,i,r)},Object.defineProperty(e.prototype,"map",{get:function(){return this.uniforms.mapSampler},set:function(t){this.uniforms.mapSampler=t},enumerable:!1,configurable:!0}),e}(X.wn),or=function(t,e){return or=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},or(t,e)},ar=function(t){function e(){return t.call(this,"\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputSize;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n')||this}return function(t,e){function i(){this.constructor=t}or(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}(e,t),e}(X.wn),hr=function(t,e){return hr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},hr(t,e)},ur=function(t){function e(e,i){void 0===e&&(e=.5),void 0===i&&(i=Math.random());var r=t.call(this,X.Y9,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",{uNoise:0,uSeed:0})||this;return r.noise=e,r.seed=i,r}return function(t,e){function i(){this.constructor=t}hr(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}(e,t),Object.defineProperty(e.prototype,"noise",{get:function(){return this.uniforms.uNoise},set:function(t){this.uniforms.uNoise=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"seed",{get:function(){return this.uniforms.uSeed},set:function(t){this.uniforms.uSeed=t},enumerable:!1,configurable:!0}),e}(X.wn);!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(Gi||(Gi={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(Ui||(Ui={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL"}(ji||(ji={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(Xi||(Xi={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(zi||(zi={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(Hi||(Hi={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(Vi||(Vi={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(Yi||(Yi={})),function(t){t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT"}(Wi||(Wi={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}($i||($i={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(qi||(qi={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL"}(Zi||(Zi={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(Ki||(Ki={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT"}(Ji||(Ji={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(Qi||(Qi={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(tr||(tr={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(er||(er={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH"}(ir||(ir={})),function(t){t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(rr||(rr={}));var cr=new T.y3;C.prototype._cacheAsBitmap=!1,C.prototype._cacheData=null,C.prototype._cacheAsBitmapResolution=null,C.prototype._cacheAsBitmapMultisample=ir.NONE;var lr=function(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null};Object.defineProperties(C.prototype,{cacheAsBitmapResolution:{get:function(){return this._cacheAsBitmapResolution},set:function(t){t!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get:function(){return this._cacheAsBitmapMultisample},set:function(t){t!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){var e;this._cacheAsBitmap!==t&&(this._cacheAsBitmap=t,t?(this._cacheData||(this._cacheData=new lr),(e=this._cacheData).originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((e=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea))}}}),C.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))},C.prototype._initCachedDisplayObject=function(t){var e;if(!this._cacheData||!this._cacheData.sprite){var i=this.alpha;this.alpha=1,t.batch.flush();var r=this.getLocalBounds(null,!0).clone();if(this.filters){var n=this.filters[0].padding;r.pad(n)}r.ceil(E.X.RESOLUTION);var s=t.renderTexture.current,o=t.renderTexture.sourceFrame.clone(),a=t.renderTexture.destinationFrame.clone(),h=t.projection.transform,u=X.TI.create({width:r.width,height:r.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:null!==(e=this.cacheAsBitmapMultisample)&&void 0!==e?e:t.multisample}),c="cacheAsBitmap_"+(0,x.uid)();this._cacheData.textureCacheId=c,X.VL.addToCache(u.baseTexture,c),X.xE.addToCache(u,c);var l=this.transform.localTransform.copyTo(cr).invert().translate(-r.x,-r.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:u,clear:!0,transform:l,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=h,t.renderTexture.bind(s,o,a),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=i;var p=new ae(u);p.transform.worldTransform=this.transform.worldTransform,p.anchor.x=-r.x/r.width,p.anchor.y=-r.y/r.height,p.alpha=i,p._bounds=this._bounds,this._cacheData.sprite=p,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=p.containsPoint.bind(p)}},C.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))},C.prototype._initCachedDisplayObjectCanvas=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.getLocalBounds(null,!0),i=this.alpha;this.alpha=1;var r=t.context,n=t._projTransform;e.ceil(E.X.RESOLUTION);var s=X.TI.create({width:e.width,height:e.height}),o="cacheAsBitmap_"+(0,x.uid)();this._cacheData.textureCacheId=o,X.VL.addToCache(s.baseTexture,o),X.xE.addToCache(s,o);var a=cr;this.transform.localTransform.copyTo(a),a.invert(),a.tx-=e.x,a.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:s,clear:!0,transform:a,skipUpdateTransform:!1}),t.context=r,t._projTransform=n,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=i;var h=new ae(s);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-e.x/e.width,h.anchor.y=-e.y/e.height,h.alpha=i,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=h.containsPoint.bind(h)}},C.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},C.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},C.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,X.VL.removeFromCache(this._cacheData.textureCacheId),X.xE.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},C.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)},C.prototype.name=null,R.prototype.getChildByName=function(t,e){for(var i=0,r=this.children.length;i<r;i++)if(this.children[i].name===t)return this.children[i];if(e)for(i=0,r=this.children.length;i<r;i++)if(this.children[i].getChildByName){var n=this.children[i].getChildByName(t,!0);if(n)return n}return null},C.prototype.getGlobalPosition=function(t,e){return void 0===t&&(t=new T.E9),void 0===e&&(e=!1),this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};var pr=function(t,e){return pr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},pr(t,e)};function dr(t,e){function i(){this.constructor=t}pr(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var fr=function(t){function e(e,i,r,n){void 0===e&&(e=100),void 0===i&&(i=100),void 0===r&&(r=10),void 0===n&&(n=10);var s=t.call(this)||this;return s.segWidth=r,s.segHeight=n,s.width=e,s.height=i,s.build(),s}return dr(e,t),e.prototype.build=function(){for(var t=this.segWidth*this.segHeight,e=[],i=[],r=[],n=this.segWidth-1,s=this.segHeight-1,o=this.width/n,a=this.height/s,h=0;h<t;h++){var u=h%this.segWidth,c=h/this.segWidth|0;e.push(u*o,c*a),i.push(u/n,c/s)}var l=n*s;for(h=0;h<l;h++){var p=h%n,d=h/n|0,f=d*this.segWidth+p,g=d*this.segWidth+p+1,m=(d+1)*this.segWidth+p,_=(d+1)*this.segWidth+p+1;r.push(f,g,m,g,_,m)}this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(i),this.indexBuffer.data=new Uint16Array(r),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},e}(Ze),gr=function(t){function e(e,i,r){void 0===e&&(e=200),void 0===r&&(r=0);var n=t.call(this,new Float32Array(4*i.length),new Float32Array(4*i.length),new Uint16Array(6*(i.length-1)))||this;return n.points=i,n._width=e,n.textureScale=r,n.build(),n}return dr(e,t),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),e.prototype.build=function(){var t=this.points;if(t){var e=this.getBuffer("aVertexPosition"),i=this.getBuffer("aTextureCoord"),r=this.getIndex();if(!(t.length<1)){e.data.length/4!==t.length&&(e.data=new Float32Array(4*t.length),i.data=new Float32Array(4*t.length),r.data=new Uint16Array(6*(t.length-1)));var n=i.data,s=r.data;n[0]=0,n[1]=0,n[2]=0,n[3]=1;for(var o=0,a=t[0],h=this._width*this.textureScale,u=t.length,c=0;c<u;c++){var l=4*c;if(this.textureScale>0){var p=a.x-t[c].x,d=a.y-t[c].y,f=Math.sqrt(p*p+d*d);a=t[c],o+=f/h}else o=c/(u-1);n[l]=o,n[l+1]=0,n[l+2]=o,n[l+3]=1}var g=0;for(c=0;c<u-1;c++)l=2*c,s[g++]=l,s[g++]=l+1,s[g++]=l+2,s[g++]=l+2,s[g++]=l+1,s[g++]=l+3;i.update(),r.update(),this.updateVertices()}}},e.prototype.updateVertices=function(){var t=this.points;if(!(t.length<1)){for(var e,i=t[0],r=0,n=0,s=this.buffers[0].data,o=t.length,a=0;a<o;a++){var h=t[a],u=4*a;n=-((e=a<t.length-1?t[a+1]:h).x-i.x),r=e.y-i.y;var c=Math.sqrt(r*r+n*n),l=this.textureScale>0?this.textureScale*this._width/2:this._width/2;r/=c,n/=c,r*=l,n*=l,s[u]=h.x+r,s[u+1]=h.y+n,s[u+2]=h.x-r,s[u+3]=h.y-n,i=h}this.buffers[0].update()}},e.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},e}(Ze),mr=function(t){function e(e,i,r){void 0===r&&(r=0);var n=this,s=new gr(e.height,i,r),o=new qe(e);return r>0&&(e.baseTexture.wrapMode=Z.Nt.REPEAT),(n=t.call(this,s,o)||this).autoUpdate=!0,n}return dr(e,t),e.prototype._render=function(e){var i=this.geometry;(this.autoUpdate||i._width!==this.shader.texture.height)&&(i._width=this.shader.texture.height,i.update()),t.prototype._render.call(this,e)},e}($e),_r=function(t){function e(e,i,r){var n=this,s=new fr(e.width,e.height,i,r),o=new qe(X.xE.WHITE);return(n=t.call(this,s,o)||this).texture=e,n.autoResize=!0,n}return dr(e,t),e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID;var t=this.geometry,e=this.shader.texture,i=e.width,r=e.height;!this.autoResize||t.width===i&&t.height===r||(t.width=this.shader.texture.width,t.height=this.shader.texture.height,t.build())},Object.defineProperty(e.prototype,"texture",{get:function(){return this.shader.texture},set:function(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))},enumerable:!1,configurable:!0}),e.prototype._render=function(e){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),t.prototype._render.call(this,e)},e.prototype.destroy=function(e){this.shader.texture.off("update",this.textureUpdated,this),t.prototype.destroy.call(this,e)},e}($e),vr=function(t){function e(e,i,r,n,s){void 0===e&&(e=X.xE.EMPTY);var o=this,a=new Ze(i,r,n);a.getBuffer("aVertexPosition").static=!1;var h=new qe(e);return(o=t.call(this,a,h,null,s)||this).autoUpdate=!0,o}return dr(e,t),Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype._render=function(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),t.prototype._render.call(this,e)},e}($e),yr=function(t){function e(e,i,r,n,s){void 0===i&&(i=10),void 0===r&&(r=10),void 0===n&&(n=10),void 0===s&&(s=10);var o=t.call(this,X.xE.WHITE,4,4)||this;return o._origWidth=e.orig.width,o._origHeight=e.orig.height,o._width=o._origWidth,o._height=o._origHeight,o._leftWidth=i,o._rightWidth=n,o._topHeight=r,o._bottomHeight=s,o.texture=e,o}return dr(e,t),e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype.updateHorizontalVertices=function(){var t=this.vertices,e=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*e,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*e,t[25]=t[27]=t[29]=t[31]=this._height},e.prototype.updateVerticalVertices=function(){var t=this.vertices,e=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*e,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*e,t[6]=t[14]=t[22]=t[30]=this._width},e.prototype._getMinScale=function(){var t=this._leftWidth+this._rightWidth,e=this._width>t?1:this._width/t,i=this._topHeight+this._bottomHeight,r=this._height>i?1:this._height/i;return Math.min(e,r)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftWidth",{get:function(){return this._leftWidth},set:function(t){this._leftWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightWidth",{get:function(){return this._rightWidth},set:function(t){this._rightWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"topHeight",{get:function(){return this._topHeight},set:function(t){this._topHeight=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottomHeight",{get:function(){return this._bottomHeight},set:function(t){this._bottomHeight=t,this._refresh()},enumerable:!1,configurable:!0}),e.prototype._refresh=function(){var t=this.texture,e=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;var i=1/this._origWidth,r=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=i*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-i*this._rightWidth,e[9]=e[11]=e[13]=e[15]=r*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-r*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()},e}(_r),br=i(1034),xr=function(t,e){return xr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},xr(t,e)},Er=function(t){function e(e,i){void 0===i&&(i=!0);var r=t.call(this,e[0]instanceof X.xE?e[0]:e[0].texture)||this;return r._textures=null,r._durations=null,r._autoUpdate=i,r._isConnectedToTicker=!1,r.animationSpeed=1,r.loop=!0,r.updateAnchor=!1,r.onComplete=null,r.onFrameChange=null,r.onLoop=null,r._currentTime=0,r._playing=!1,r._previousFrame=null,r.textures=e,r}return function(t,e){function i(){this.constructor=t}xr(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}(e,t),e.prototype.stop=function(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(N.vB.shared.remove(this.update,this),this._isConnectedToTicker=!1))},e.prototype.play=function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(N.vB.shared.add(this.update,this,N.uF.HIGH),this._isConnectedToTicker=!0))},e.prototype.gotoAndStop=function(t){this.stop();var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()},e.prototype.gotoAndPlay=function(t){var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture(),this.play()},e.prototype.update=function(t){if(this._playing){var e=this.animationSpeed*t,i=this.currentFrame;if(null!==this._durations){var r=this._currentTime%1*this._durations[this.currentFrame];for(r+=e/60*1e3;r<0;)this._currentTime--,r+=this._durations[this.currentFrame];var n=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);r>=this._durations[this.currentFrame];)r-=this._durations[this.currentFrame]*n,this._currentTime+=n;this._currentTime+=r/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):i!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<i||this.animationSpeed<0&&this.currentFrame>i)&&this.onLoop(),this.updateTexture())}},e.prototype.updateTexture=function(){var t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))},e.prototype.destroy=function(e){this.stop(),t.prototype.destroy.call(this,e),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},e.fromFrames=function(t){for(var i=[],r=0;r<t.length;++r)i.push(X.xE.from(t[r]));return new e(i)},e.fromImages=function(t){for(var i=[],r=0;r<t.length;++r)i.push(X.xE.from(t[r]));return new e(i)},Object.defineProperty(e.prototype,"totalFrames",{get:function(){return this._textures.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textures",{get:function(){return this._textures},set:function(t){if(t[0]instanceof X.xE)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentFrame",{get:function(){var t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(N.vB.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(N.vB.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),e}(ae);X.Th.registerPlugin("accessibility",P),X.Th.registerPlugin("extract",$),X.Th.registerPlugin("interaction",j),X.Th.registerPlugin("particle",wt),X.Th.registerPlugin("prepare",Pe),X.Th.registerPlugin("batch",X.Bv),X.Th.registerPlugin("tilingSprite",Xe),q.aN.registerPlugin(ui),q.aN.registerPlugin(nt),q.aN.registerPlugin(dt),q.aN.registerPlugin(vt),q.aN.registerPlugin(De),z.registerPlugin(N.Sb),z.registerPlugin(q.LP);var Tr="6.1.3",Sr={AlphaFilter:li,BlurFilter:ki,BlurFilterPass:Di,ColorMatrixFilter:Fi,DisplacementFilter:sr,FXAAFilter:ar,NoiseFilter:ur}},1795:function(t,e,i){var r;t=i.nmd(t),function(){"use strict";var n={function:!0,object:!0},s=n[typeof window]&&window||this,o=n[typeof e]&&e,a=n.object&&t&&!t.nodeType&&t,h=o&&a&&"object"==typeof i.g&&i.g;!h||h.global!==h&&h.window!==h&&h.self!==h||(s=h);var u=Math.pow(2,53)-1,c=/\bOpera/,l=Object.prototype,p=l.hasOwnProperty,d=l.toString;function f(t){return(t=String(t)).charAt(0).toUpperCase()+t.slice(1)}function g(t){return t=b(t),/^(?:webOS|i(?:OS|P))/.test(t)?t:f(t)}function m(t,e){for(var i in t)p.call(t,i)&&e(t[i],i,t)}function _(t){return null==t?f(t):d.call(t).slice(8,-1)}function v(t){return String(t).replace(/([ -])(?!$)/g,"$1?")}function y(t,e){var i=null;return function(t,e){var i=-1,r=t?t.length:0;if("number"==typeof r&&r>-1&&r<=u)for(;++i<r;)e(t[i],i);else m(t,e)}(t,(function(r,n){i=e(i,r,n,t)})),i}function b(t){return String(t).replace(/^ +| +$/g,"")}var x=function t(e){var i=s,r=e&&"object"==typeof e&&"String"!=_(e);r&&(i=e,e=null);var n=i.navigator||{},o=n.userAgent||"";e||(e=o);var a,h,u,l,p=r?!!n.likeChrome:/\bChrome\b/.test(e)&&!/internal|\n/i.test(d.toString()),f="Object",x=r?f:"ScriptBridgingProxyObject",E=r?f:"Environment",T=r&&i.java?"JavaPackage":_(i.java),S=r?f:"RuntimeObject",w=/\bJava/.test(T)&&i.java,A=w&&_(i.environment)==E,C=w?"a":"",O=w?"b":"",I=i.document||{},R=i.operamini||i.opera,M=c.test(M=r&&R?R["[[Class]]"]:_(R))?M:R=null,P=e,N=[],L=null,D=e==o,k=D&&R&&"function"==typeof R.version&&R.version(),B=y([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],(function(t,i){return t||RegExp("\\b"+(i.pattern||v(i))+"\\b","i").exec(e)&&(i.label||i)})),F=y(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"],(function(t,i){return t||RegExp("\\b"+(i.pattern||v(i))+"\\b","i").exec(e)&&(i.label||i)})),G=X([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),U=y({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}},(function(t,i,r){return t||(i[G]||i[/^[a-z]+(?: +[a-z]+\b)*/i.exec(G)]||RegExp("\\b"+v(r)+"(?:\\b|\\w*\\d)","i").exec(e))&&r})),j=y(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "],(function(t,i){var r=i.pattern||v(i);return!t&&(t=RegExp("\\b"+r+"(?:/[\\d.]+|[ \\w.]*)","i").exec(e))&&(t=function(t,e,i){var r={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return e&&i&&/^Win/i.test(t)&&!/^Windows Phone /i.test(t)&&(r=r[/[\d.]+$/.exec(t)])&&(t="Windows "+r),t=String(t),e&&i&&(t=t.replace(RegExp(e,"i"),i)),g(t.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(t,r,i.label||i)),t}));function X(t){return y(t,(function(t,i){var r=i.pattern||v(i);return!t&&(t=RegExp("\\b"+r+" *\\d+[.\\w_]*","i").exec(e)||RegExp("\\b"+r+" *\\w+-[\\w]*","i").exec(e)||RegExp("\\b"+r+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(e))&&((t=String(i.label&&!RegExp(r,"i").test(i.label)?i.label:t).split("/"))[1]&&!/[\d.]+/.test(t[0])&&(t[0]+=" "+t[1]),i=i.label||i,t=g(t[0].replace(RegExp(r,"i"),i).replace(RegExp("; *(?:"+i+"[_-])?","i")," ").replace(RegExp("("+i+")[-_.]?(\\w)","i"),"$1 $2"))),t}))}function z(t){return y(t,(function(t,i){return t||(RegExp(i+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(e)||0)[1]||null}))}if(B&&(B=[B]),/\bAndroid\b/.test(j)&&!G&&(a=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(e))&&(G=b(a[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),U&&!G?G=X([U]):U&&G&&(G=G.replace(RegExp("^("+v(U)+")[-_.\\s]","i"),U+" ").replace(RegExp("^("+v(U)+")[-_.]?(\\w)","i"),U+" $2")),(a=/\bGoogle TV\b/.exec(G))&&(G=a[0]),/\bSimulator\b/i.test(e)&&(G=(G?G+" ":"")+"Simulator"),"Opera Mini"==F&&/\bOPiOS\b/.test(e)&&N.push("running in Turbo/Uncompressed mode"),"IE"==F&&/\blike iPhone OS\b/.test(e)?(U=(a=t(e.replace(/like iPhone OS/,""))).manufacturer,G=a.product):/^iP/.test(G)?(F||(F="Safari"),j="iOS"+((a=/ OS ([\d_]+)/i.exec(e))?" "+a[1].replace(/_/g,"."):"")):"Konqueror"==F&&/^Linux\b/i.test(j)?j="Kubuntu":U&&"Google"!=U&&(/Chrome/.test(F)&&!/\bMobile Safari\b/i.test(e)||/\bVita\b/.test(G))||/\bAndroid\b/.test(j)&&/^Chrome/.test(F)&&/\bVersion\//i.test(e)?(F="Android Browser",j=/\bAndroid\b/.test(j)?j:"Android"):"Silk"==F?(/\bMobi/i.test(e)||(j="Android",N.unshift("desktop mode")),/Accelerated *= *true/i.test(e)&&N.unshift("accelerated")):"UC Browser"==F&&/\bUCWEB\b/.test(e)?N.push("speed mode"):"PaleMoon"==F&&(a=/\bFirefox\/([\d.]+)\b/.exec(e))?N.push("identifying as Firefox "+a[1]):"Firefox"==F&&(a=/\b(Mobile|Tablet|TV)\b/i.exec(e))?(j||(j="Firefox OS"),G||(G=a[1])):!F||(a=!/\bMinefield\b/i.test(e)&&/\b(?:Firefox|Safari)\b/.exec(F))?(F&&!G&&/[\/,]|^[^(]+?\)/.test(e.slice(e.indexOf(a+"/")+8))&&(F=null),(a=G||U||j)&&(G||U||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(j))&&(F=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(j)?j:a)+" Browser")):"Electron"==F&&(a=(/\bChrome\/([\d.]+)\b/.exec(e)||0)[1])&&N.push("Chromium "+a),k||(k=z(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",v(F),"(?:Firefox|Minefield|NetFront)"])),(a=("iCab"==B&&parseFloat(k)>3?"WebKit":/\bOpera\b/.test(F)&&(/\bOPR\b/.test(e)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(e)&&!/^(?:Trident|EdgeHTML)$/.test(B)&&"WebKit"||!B&&/\bMSIE\b/i.test(e)&&("Mac OS"==j?"Tasman":"Trident")||"WebKit"==B&&/\bPlayStation\b(?! Vita\b)/i.test(F)&&"NetFront")&&(B=[a]),"IE"==F&&(a=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(e)||0)[1])?(F+=" Mobile",j="Windows Phone "+(/\+$/.test(a)?a:a+".x"),N.unshift("desktop mode")):/\bWPDesktop\b/i.test(e)?(F="IE Mobile",j="Windows Phone 8.x",N.unshift("desktop mode"),k||(k=(/\brv:([\d.]+)/.exec(e)||0)[1])):"IE"!=F&&"Trident"==B&&(a=/\brv:([\d.]+)/.exec(e))&&(F&&N.push("identifying as "+F+(k?" "+k:"")),F="IE",k=a[1]),D){if("global",l=null!=(u=i)?typeof u.global:"number",/^(?:boolean|number|string|undefined)$/.test(l)||"object"==l&&!u.global)_(a=i.runtime)==x?(F="Adobe AIR",j=a.flash.system.Capabilities.os):_(a=i.phantom)==S?(F="PhantomJS",k=(a=a.version||null)&&a.major+"."+a.minor+"."+a.patch):"number"==typeof I.documentMode&&(a=/\bTrident\/(\d+)/i.exec(e))?(k=[k,I.documentMode],(a=+a[1]+4)!=k[1]&&(N.push("IE "+k[1]+" mode"),B&&(B[1]=""),k[1]=a),k="IE"==F?String(k[1].toFixed(1)):k[0]):"number"==typeof I.documentMode&&/^(?:Chrome|Firefox)\b/.test(F)&&(N.push("masking as "+F+" "+k),F="IE",k="11.0",B=["Trident"],j="Windows");else if(w&&(P=(a=w.lang.System).getProperty("os.arch"),j=j||a.getProperty("os.name")+" "+a.getProperty("os.version")),A){try{k=i.require("ringo/engine").version.join("."),F="RingoJS"}catch(t){(a=i.system)&&a.global.system==i.system&&(F="Narwhal",j||(j=a[0].os||null))}F||(F="Rhino")}else"object"==typeof i.process&&!i.process.browser&&(a=i.process)&&("object"==typeof a.versions&&("string"==typeof a.versions.electron?(N.push("Node "+a.versions.node),F="Electron",k=a.versions.electron):"string"==typeof a.versions.nw&&(N.push("Chromium "+k,"Node "+a.versions.node),F="NW.js",k=a.versions.nw)),F||(F="Node.js",P=a.arch,j=a.platform,k=(k=/[\d.]+/.exec(a.version))?k[0]:null));j=j&&g(j)}if(k&&(a=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(k)||/(?:alpha|beta)(?: ?\d)?/i.exec(e+";"+(D&&n.appMinorVersion))||/\bMinefield\b/i.test(e)&&"a")&&(L=/b/i.test(a)?"beta":"alpha",k=k.replace(RegExp(a+"\\+?$"),"")+("beta"==L?O:C)+(/\d+\+?/.exec(a)||"")),"Fennec"==F||"Firefox"==F&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(j))F="Firefox Mobile";else if("Maxthon"==F&&k)k=k.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(G))"Xbox 360"==G&&(j=null),"Xbox 360"==G&&/\bIEMobile\b/.test(e)&&N.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(F)&&(!F||G||/Browser|Mobi/.test(F))||"Windows CE"!=j&&!/Mobi/i.test(e))if("IE"==F&&D)try{null===i.external&&N.unshift("platform preview")}catch(t){N.unshift("embedded")}else(/\bBlackBerry\b/.test(G)||/\bBB10\b/.test(e))&&(a=(RegExp(G.replace(/ +/g," *")+"/([.\\d]+)","i").exec(e)||0)[1]||k)?(j=((a=[a,/BB10/.test(e)])[1]?(G=null,U="BlackBerry"):"Device Software")+" "+a[0],k=null):this!=m&&"Wii"!=G&&(D&&R||/Opera/.test(F)&&/\b(?:MSIE|Firefox)\b/i.test(e)||"Firefox"==F&&/\bOS X (?:\d+\.){2,}/.test(j)||"IE"==F&&(j&&!/^Win/.test(j)&&k>5.5||/\bWindows XP\b/.test(j)&&k>8||8==k&&!/\bTrident\b/.test(e)))&&!c.test(a=t.call(m,e.replace(c,"")+";"))&&a.name&&(a="ing as "+a.name+((a=a.version)?" "+a:""),c.test(F)?(/\bIE\b/.test(a)&&"Mac OS"==j&&(j=null),a="identify"+a):(a="mask"+a,F=M?g(M.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(a)&&(j=null),D||(k=null)),B=["Presto"],N.push(a));else F+=" Mobile";(a=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(e)||0)[1])&&(a=[parseFloat(a.replace(/\.(\d)$/,".0$1")),a],"Safari"==F&&"+"==a[1].slice(-1)?(F="WebKit Nightly",L="alpha",k=a[1].slice(0,-1)):k!=a[1]&&k!=(a[2]=(/\bSafari\/([\d.]+\+?)/i.exec(e)||0)[1])||(k=null),a[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(e)||0)[1],537.36==a[0]&&537.36==a[2]&&parseFloat(a[1])>=28&&"WebKit"==B&&(B=["Blink"]),D&&(p||a[1])?(B&&(B[1]="like Chrome"),a=a[1]||((a=a[0])<530?1:a<532?2:a<532.05?3:a<533?4:a<534.03?5:a<534.07?6:a<534.1?7:a<534.13?8:a<534.16?9:a<534.24?10:a<534.3?11:a<535.01?12:a<535.02?"13+":a<535.07?15:a<535.11?16:a<535.19?17:a<536.05?18:a<536.1?19:a<537.01?20:a<537.11?"21+":a<537.13?23:a<537.18?24:a<537.24?25:a<537.36?26:"Blink"!=B?"27":"28")):(B&&(B[1]="like Safari"),a=(a=a[0])<400?1:a<500?2:a<526?3:a<533?4:a<534?"4+":a<535?5:a<537?6:a<538?7:a<601?8:a<602?9:a<604?10:a<606?11:a<608?12:"12"),B&&(B[1]+=" "+(a+="number"==typeof a?".x":/[.+]/.test(a)?"":"+")),"Safari"==F&&(!k||parseInt(k)>45)?k=a:"Chrome"==F&&/\bHeadlessChrome/i.test(e)&&N.unshift("headless")),"Opera"==F&&(a=/\bzbov|zvav$/.exec(j))?(F+=" ",N.unshift("desktop mode"),"zvav"==a?(F+="Mini",k=null):F+="Mobile",j=j.replace(RegExp(" *"+a+"$"),"")):"Safari"==F&&/\bChrome\b/.exec(B&&B[1])?(N.unshift("desktop mode"),F="Chrome Mobile",k=null,/\bOS X\b/.test(j)?(U="Apple",j="iOS 4.3+"):j=null):/\bSRWare Iron\b/.test(F)&&!k&&(k=z("Chrome")),k&&0==k.indexOf(a=/[\d.]+$/.exec(j))&&e.indexOf("/"+a+"-")>-1&&(j=b(j.replace(a,""))),j&&-1!=j.indexOf(F)&&!RegExp(F+" OS").test(j)&&(j=j.replace(RegExp(" *"+v(F)+" *"),"")),B&&!/\b(?:Avant|Nook)\b/.test(F)&&(/Browser|Lunascape|Maxthon/.test(F)||"Safari"!=F&&/^iOS/.test(j)&&/\bSafari\b/.test(B[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(F)&&B[1])&&(a=B[B.length-1])&&N.push(a),N.length&&(N=["("+N.join("; ")+")"]),U&&G&&G.indexOf(U)<0&&N.push("on "+U),G&&N.push((/^on /.test(N[N.length-1])?"":"on ")+G),j&&(a=/ ([\d.+]+)$/.exec(j),h=a&&"/"==j.charAt(j.length-a[0].length-1),j={architecture:32,family:a&&!h?j.replace(a[0],""):j,version:a?a[1]:null,toString:function(){var t=this.version;return this.family+(t&&!h?" "+t:"")+(64==this.architecture?" 64-bit":"")}}),(a=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(P))&&!/\bi686\b/i.test(P)?(j&&(j.architecture=64,j.family=j.family.replace(RegExp(" *"+a),"")),F&&(/\bWOW64\b/i.test(e)||D&&/\w(?:86|32)$/.test(n.cpuClass||n.platform)&&!/\bWin64; x64\b/i.test(e))&&N.unshift("32-bit")):j&&/^OS X/.test(j.family)&&"Chrome"==F&&parseFloat(k)>=39&&(j.architecture=64),e||(e=null);var H={};return H.description=e,H.layout=B&&B[0],H.manufacturer=U,H.name=F,H.prerelease=L,H.product=G,H.ua=e,H.version=F&&k,H.os=j||{architecture:null,family:null,version:null,toString:function(){return"null"}},H.parse=t,H.toString=function(){return this.description||""},H.version&&N.unshift(k),H.name&&N.unshift(F),j&&F&&(j!=String(j).split(" ")[0]||j!=F.split(" ")[0]&&!G)&&N.push(G?"("+j+")":"on "+j),N.length&&(H.description=N.join(" ")),H}();s.platform=x,void 0===(r=function(){return x}.call(e,i,e,t))||(t.exports=r)}.call(this)},2587:t=>{"use strict";function e(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,i,r,n){i=i||"&",r=r||"=";var s={};if("string"!=typeof t||0===t.length)return s;var o=/\+/g;t=t.split(i);var a=1e3;n&&"number"==typeof n.maxKeys&&(a=n.maxKeys);var h=t.length;a>0&&h>a&&(h=a);for(var u=0;u<h;++u){var c,l,p,d,f=t[u].replace(o,"%20"),g=f.indexOf(r);g>=0?(c=f.substr(0,g),l=f.substr(g+1)):(c=f,l=""),p=decodeURIComponent(c),d=decodeURIComponent(l),e(s,p)?Array.isArray(s[p])?s[p].push(d):s[p]=[s[p],d]:s[p]=d}return s}},2361:t=>{"use strict";var e=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,i,r,n){return i=i||"&",r=r||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map((function(n){var s=encodeURIComponent(e(n))+r;return Array.isArray(t[n])?t[n].map((function(t){return s+encodeURIComponent(e(t))})).join(i):s+encodeURIComponent(e(t[n]))})).join(i):n?encodeURIComponent(e(n))+r+encodeURIComponent(e(t)):""}},7673:(t,e,i)=>{"use strict";e.decode=e.parse=i(2587),e.encode=e.stringify=i(2361)},7719:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.reconstructPacket=e.deconstructPacket=void 0;const r=i(2986);function n(t,e){if(!t)return t;if(r.isBinary(t)){const i={_placeholder:!0,num:e.length};return e.push(t),i}if(Array.isArray(t)){const i=new Array(t.length);for(let r=0;r<t.length;r++)i[r]=n(t[r],e);return i}if("object"==typeof t&&!(t instanceof Date)){const i={};for(const r in t)t.hasOwnProperty(r)&&(i[r]=n(t[r],e));return i}return t}function s(t,e){if(!t)return t;if(t&&t._placeholder)return e[t.num];if(Array.isArray(t))for(let i=0;i<t.length;i++)t[i]=s(t[i],e);else if("object"==typeof t)for(const i in t)t.hasOwnProperty(i)&&(t[i]=s(t[i],e));return t}e.deconstructPacket=function(t){const e=[],i=t.data,r=t;return r.data=n(i,e),r.attachments=e.length,{packet:r,buffers:e}},e.reconstructPacket=function(t,e){return t.data=s(t.data,e),t.attachments=void 0,t}},5485:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Decoder=e.Encoder=e.PacketType=e.protocol=void 0;const r=i(8767),n=i(7719),s=i(2986),o=i(1227)("socket.io-parser");var a;e.protocol=5,function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"}(a=e.PacketType||(e.PacketType={})),e.Encoder=class{encode(t){return o("encoding packet %j",t),t.type!==a.EVENT&&t.type!==a.ACK||!s.hasBinary(t)?[this.encodeAsString(t)]:(t.type=t.type===a.EVENT?a.BINARY_EVENT:a.BINARY_ACK,this.encodeAsBinary(t))}encodeAsString(t){let e=""+t.type;return t.type!==a.BINARY_EVENT&&t.type!==a.BINARY_ACK||(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data&&(e+=JSON.stringify(t.data)),o("encoded %j as %s",t,e),e}encodeAsBinary(t){const e=n.deconstructPacket(t),i=this.encodeAsString(e.packet),r=e.buffers;return r.unshift(i),r}};class h extends r{constructor(){super()}add(t){let e;if("string"==typeof t)e=this.decodeString(t),e.type===a.BINARY_EVENT||e.type===a.BINARY_ACK?(this.reconstructor=new u(e),0===e.attachments&&super.emit("decoded",e)):super.emit("decoded",e);else{if(!s.isBinary(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emit("decoded",e))}}decodeString(t){let e=0;const i={type:Number(t.charAt(0))};if(void 0===a[i.type])throw new Error("unknown packet type "+i.type);if(i.type===a.BINARY_EVENT||i.type===a.BINARY_ACK){const r=e+1;for(;"-"!==t.charAt(++e)&&e!=t.length;);const n=t.substring(r,e);if(n!=Number(n)||"-"!==t.charAt(e))throw new Error("Illegal attachments");i.attachments=Number(n)}if("/"===t.charAt(e+1)){const r=e+1;for(;++e&&","!==t.charAt(e)&&e!==t.length;);i.nsp=t.substring(r,e)}else i.nsp="/";const r=t.charAt(e+1);if(""!==r&&Number(r)==r){const r=e+1;for(;++e;){const i=t.charAt(e);if(null==i||Number(i)!=i){--e;break}if(e===t.length)break}i.id=Number(t.substring(r,e+1))}if(t.charAt(++e)){const r=function(t){try{return JSON.parse(t)}catch(t){return!1}}(t.substr(e));if(!h.isPayloadValid(i.type,r))throw new Error("invalid payload");i.data=r}return o("decoded %s as %j",t,i),i}static isPayloadValid(t,e){switch(t){case a.CONNECT:return"object"==typeof e;case a.DISCONNECT:return void 0===e;case a.CONNECT_ERROR:return"string"==typeof e||"object"==typeof e;case a.EVENT:case a.BINARY_EVENT:return Array.isArray(e)&&e.length>0;case a.ACK:case a.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}e.Decoder=h;class u{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const t=n.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}},2986:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.hasBinary=e.isBinary=void 0;const i="function"==typeof ArrayBuffer,r=Object.prototype.toString,n="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===r.call(Blob),s="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===r.call(File);function o(t){return i&&(t instanceof ArrayBuffer||(t=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer)(t))||n&&t instanceof Blob||s&&t instanceof File}e.isBinary=o,e.hasBinary=function t(e,i){if(!e||"object"!=typeof e)return!1;if(Array.isArray(e)){for(let i=0,r=e.length;i<r;i++)if(t(e[i]))return!0;return!1}if(o(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return t(e.toJSON(),!0);for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&t(e[i]))return!0;return!1}},6069:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AnalyzeTagArg=void 0,e.AnalyzeTagArg=class{constructor(){this.REG_TAGARG=/;[^\n]*|(?<key>\w+)(?:\s|;[^\n]*\n)*=(?:\s|;[^\n]*\n)*(?:(?<val>[^\s"'#|;]+)|(["'#])(?<val2>.*?)\3)(?:\|(?:(?<def>[^\s"'#;]+)|(["'#])(?<def2>.*?)\6))?|(?<literal>[^\s;]+)/g,this.$hPrm={},this.$isKomeParam=!1}go(t){if(this.$hPrm={},this.$isKomeParam=!1,!t)return;let e=null;for(;e=this.REG_TAGARG.exec(t);){const t=e?.groups;t&&(t.key?this.$hPrm[t.key]={val:t.val??t.val2,def:t.def??t.def2}:t.literal&&("*"===t.literal?this.$isKomeParam=!0:this.$hPrm[t.literal]={val:"1"}))}}get hPrm(){return this.$hPrm}get isKomeParam(){return this.$isKomeParam}}},9630:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Areas=void 0,e.Areas=class{constructor(){this.hAreas={}}clear(){this.hAreas={}}search(t){for(const e in this.hAreas)if(!(t<parseInt(e))&&t<=this.hAreas[e])return!0;return!1}record(t){if(!this.search(t)){for(const e in this.hAreas)if(this.hAreas[e]+1===t)return void(t+1 in this.hAreas?(this.hAreas[e]=this.hAreas[t+1],delete this.hAreas[t+1]):this.hAreas[e]=t);if(t+1 in this.hAreas)return this.hAreas[t]=this.hAreas[t+1],void delete this.hAreas[t+1];this.hAreas[t]=t}}erase(t){if(this.search(t)){if(t in this.hAreas)return this.hAreas[t]>t&&(this.hAreas[t+1]=this.hAreas[t]),void delete this.hAreas[t];for(const e in this.hAreas)if(!(t<parseInt(e)||this.hAreas[e]<t))return this.hAreas[e]===t||(this.hAreas[t+1]=this.hAreas[e]),void(this.hAreas[e]=t-1)}}get count(){return Object.keys(this.hAreas).length}toString(){let t="";const e=[];for(const t in this.hAreas)e.push(parseInt(t));return e.sort((function(t,e){return t-e})),e.forEach((e=>{t+=","+e+(e===this.hAreas[e])?"":0})),""!==t&&(t=t.slice(1)),t}}},6761:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Button=void 0;const r=i(6841),n=i(6841),s=i(4965),o=i(7007),a=i(1481),h=i(4412);class u extends r.Container{constructor(t,e,i,n){super(),this.hArg=t,this.evtMng=e,this.resolve=i,this.canFocus=n,this.sp_b_pic=null,this.sp_pic=null,s.CmnLib.isDbg&&(this.makeDesignCast=t=>t(this.idc),this.cvsResize=()=>this.idc.cvsResize()),this.name=JSON.stringify(t);let c={x:this.x=(0,s.uint)(t.left??0),y:this.y=(0,s.uint)(t.top??0),rotation:this.angle=(0,s.argChk_Num)(t,"rotation",this.angle),pivot_x:this.pivot.x=(0,s.argChk_Num)(t,"pivot_x",this.pivot.x),pivot_y:this.pivot.y=(0,s.argChk_Num)(t,"pivot_y",this.pivot.y),scale_x:this.scale.x=(0,s.argChk_Num)(t,"scale_x",this.scale.x),scale_y:this.scale.y=(0,s.argChk_Num)(t,"scale_y",this.scale.y)};const l=c.enabled=(0,s.argChk_Boolean)(t,"enabled",!0);if("text"in t){const p=(0,s.argChk_Num)(t,"height",30),d=new r.TextStyle({align:"center",dropShadow:!0,dropShadowAlpha:.7,dropShadowColor:"#ffffff",dropShadowBlur:7,dropShadowDistance:0,fill:"black",fontFamily:u.fontFamily,fontSize:p,padding:5});if(t.style)try{const e=JSON.parse(t.style);for(const t in e)d[t]=e[t]}catch(t){throw new Error(`[button] styleJSON" err:${t}`)}const f=new r.Text(t.text??"",d);f.alpha=(0,s.argChk_Num)(t,"alpha",f.alpha),f.width=(0,s.argChk_Num)(t,"width",100),f.height=p,t.height=p,c.type="text",c={...c,...d},c.alpha=f.alpha,c.text=f.text,c.width=f.width,c.height=f.height,this.idc=new h.TxtBtnDesignCast(this,t,f);let g=!1;if(t.b_pic&&(c.b_pic=t.b_pic,g=o.GrpLayer.csv2Sprites(t.b_pic,this,(t=>this.loaded_b_pic(t,f)),(e=>{a.Layer.setBlendmode(this,t),e&&i()}))),f.name=JSON.stringify(c),this.addChild(f),t.b_pic||a.Layer.setBlendmode(this,t),u.procMasume4txt(this,f),!l)return void(g||i());const m=d.clone();if(t.style_hover)try{const e=JSON.parse(t.style_hover);for(const t in e)m[t]=e[t]}catch(t){throw new Error(`[button] style_hoverJSON" err:${t}`)}else m.fill="white";const _=m.clone();if(t.style_clicked)try{const e=JSON.parse(t.style_clicked);for(const t in e)_[t]=e[t]}catch(t){throw new Error(`[button] style_clickedJSON" err:${t}`)}else _.dropShadow=!1;return e.button(t,this,(()=>f.style=d),(()=>!!n()&&(f.style=m,!0)),(()=>f.style=_)),void(g||i())}if(!t.pic)throw"textpic";c.type="pic",this.idc=new h.PicBtnDesignCast(this,t),o.GrpLayer.csv2Sprites(t.pic,this,(t=>this.loaded_pic(t,c)),(t=>{t&&i()}))||i()}static init(t){t.oCfg.debug.masume&&(u.procMasume4txt=(t,e)=>{const i=new n.Graphics;i.clear(),i.beginFill(8926088,.2),i.lineStyle(1,8926088,1),i.drawRect(e.x,e.y,e.width,e.height),i.endFill(),t.addChild(i)},u.procMasume4pic=(t,e,i,r)=>{const s=new n.Graphics;s.clear(),s.beginFill(8926088,.2),s.lineStyle(1,8926088,1),s.drawRect(e.x,e.y,i,r),s.endFill(),t.addChild(s)})}makeDesignCast(t){}showDesignCast(){this.idc.visible=!0}cvsResize(){}update_b_pic(t,e){const i=JSON.parse(e.name??"{}");this.sp_b_pic&&this.removeChild(this.sp_b_pic),this.hArg.b_pic=i.b_pic=t,e.name=JSON.stringify(i),t&&o.GrpLayer.csv2Sprites(t,this,(t=>this.loaded_b_pic(t,e)),(()=>a.Layer.setBlendmode(this,this.hArg)))}loaded_b_pic(t,e){this.sp_b_pic=t,this.setChildIndex(t,0),t.alpha=e.alpha,t.setTransform(e.x,e.y,1,1,e.rotation,0,0,(t.width-e.width)/2,(t.height-e.height)/2)}update_pic(t,e){const i=JSON.parse(e.name??"{}");this.sp_pic&&this.removeChild(this.sp_pic),this.hArg.pic=i.pic=t,e.name=JSON.stringify(i),t&&o.GrpLayer.csv2Sprites(t,this,(t=>this.loaded_pic(t,i)),(()=>a.Layer.setBlendmode(this,this.hArg)))}loaded_pic(t,e){this.sp_pic=t,e.alpha=t.alpha=(0,s.argChk_Num)(this.hArg,"alpha",t.alpha),this.idc.setSp(t);const i=t.width/3,n=t.height,o=t.texture.baseTexture,a=new r.Texture(o,new r.Rectangle(0,0,i,n)),h=new r.Texture(o,new r.Rectangle(i,0,i,n)),c=new r.Texture(o,new r.Rectangle(2*i,0,i,n)),l=()=>t.texture=a;l(),e.enabled&&this.evtMng.button(this.hArg,this,l,(()=>!!this.canFocus()&&(t.texture=c,!0)),(()=>t.texture=h)),"width"in this.hArg?(e.width=(0,s.uint)(this.hArg.width),this.scale.x*=e.width/i):e.width=i,"height"in this.hArg?(e.height=(0,s.uint)(this.hArg.height),this.scale.y*=e.height/i):e.height=i,t.name=JSON.stringify(e),u.procMasume4pic(this,t,i,n)}}e.Button=u,u.fontFamily="'Hiragino Sans', 'Hiragino Kaku Gothic ProN', ' Medium', meiryo, sans-serif",u.procMasume4txt=(t,e)=>{},u.procMasume4pic=(t,e,i,r)=>{}},9824:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CallStack=void 0,e.CallStack=class{constructor(t="",e=0,i=null){this.$fn=t,this.$idx=e,this.$hArg=i,this.toString=()=>`[fn:${this.$fn}, idx:${this.$idx}, hArg:${this.$hArg}]`}get fn(){return this.$fn}get idx(){return this.$idx}get csArg(){return this.$hArg}}},4965:(t,e,i)=>{"use strict";function r(t){return parseInt(String(t),10)}Object.defineProperty(e,"__esModule",{value:!0}),e.CmnLib=e.getExt=e.getFn=e.argChk_Boolean=e.argChk_Num=e.addStyle=e.initStyle=e.cnvTweenArg=e.hMemberCnt=e.getDateStr=e.uint=e.int=void 0,e.int=r,e.uint=function(t){const e=parseInt(String(t),10);return e<0?-e:e},"toInt"in String.prototype||(String.prototype.toInt=function(){return r(this)}),"toUint"in String.prototype||(String.prototype.toUint=function(){const t=r(this);return t<0?-t:t}),e.getDateStr=function(t="/",e=" ",i=":",r=""){const n=new Date;return n.getFullYear()+t+String(100+n.getMonth()+1).slice(1,3)+t+String(100+n.getDate()).slice(1,3)+e+String(100+n.getHours()).slice(1,3)+i+String(100+n.getMinutes()).slice(1,3)+(""===r?"":r+String(n.getMilliseconds()))},e.hMemberCnt={alpha:0,height:0,rotation:0,scale_x:0,scale_y:0,pivot_x:0,pivot_y:0,width:0,x:0,y:0},e.cnvTweenArg=function(t,i){const r={};for(const n in e.hMemberCnt){if(!(n in t))continue;const e=String(t[n]),s=("="===e.charAt(0)?e.slice(1):e).split(","),o=r[n]=parseFloat(s[0]);s.length>1&&(r[n]+=Math.round(Math.random()*(parseFloat(s[1])-o+1))),"="===e.charAt(0)&&(r[n]+=parseFloat(i[n]))}return r};const n="/* SKYNovel */";function s(t,e,i){if(!(e in t))return t[e]=i;const r=t[e];if(null===r)return!1;const n=String(r);return t[e]="false"!==n&&Boolean(n)}e.initStyle=function(){const t=document.getElementsByTagName("head")[0];for(let e=t.children.length-1;e>=0;--e){const i=t.children[e];i instanceof HTMLStyleElement&&i.innerText.slice(0,14)===n&&t.removeChild(i)}},e.addStyle=function(t){const e=document.createElement("style");e.innerHTML=n+t,document.getElementsByTagName("head")[0].appendChild(e)},e.argChk_Num=function(t,e,i){const r=t[e];if(!(e in t)){if(isNaN(i))throw`[${t.}] ${e} `;return t[e]=i,i}const n="0x"===String(r).slice(0,2)?parseInt(r):parseFloat(r);if(isNaN(n))throw`[${t.}] ${e} ${r}`;return t[e]=n},e.argChk_Boolean=s;const o=/^[^\/\.]+$|[^\/]+(?=\.)/;e.getFn=function(t){return(t.match(o)??[""])[0]};const a=/(?<=\.)[^\.]+$/;e.getExt=function(t){return(t.match(a)??[""])[0]};const h=i(1795);class u{static cvsResize(t){const e=u.cvsWidth,i=u.cvsHeight;let r=globalThis.innerWidth,n=globalThis.innerHeight;const o=(screen.orientation?.angle??0)%180==0?"p":"l";if(u.isMobile&&("p"===o&&r>n||"l"===o&&r<n)&&([r,n]=[n,r]),s(u.hDip,"expanding",!0)||u.stageW>r||u.stageH>n){u.stageW/u.stageH<=r/n?(u.cvsHeight=n,u.cvsWidth=u.stageW/u.stageH*n):(u.cvsWidth=r,u.cvsHeight=u.stageH/u.stageW*r),u.cvsScale=u.cvsWidth/u.stageW;const e=t.getBoundingClientRect();u.ofsPadLeft_Dom2PIXI=(u.isMobile?(globalThis.innerWidth-u.cvsWidth)/2:e.left)*(1-u.cvsScale),u.ofsPadTop_Dom2PIXI=(u.isMobile?(globalThis.innerHeight-u.cvsHeight)/2:e.top)*(1-u.cvsScale)}else u.cvsWidth=u.stageW,u.cvsHeight=u.stageH,u.cvsScale=1,u.ofsPadLeft_Dom2PIXI=0,u.ofsPadTop_Dom2PIXI=0;if(t.parentElement){const e=t.parentElement.style;e.position="relative";const i=t.style;e.width=i.width=`${u.cvsWidth}px`,e.height=i.height=`${u.cvsHeight}px`}return e!==u.cvsWidth||i!==u.cvsHeight}}e.CmnLib=u,u.stageW=0,u.stageH=0,u.ofsPadLeft_Dom2PIXI=0,u.ofsPadTop_Dom2PIXI=0,u.cvsWidth=0,u.cvsHeight=0,u.cvsScale=1,u.debugLog=!1,u.isSafari="Safari"===h.name,u.isFirefox="Firefox"===h.name,u.isMac=new RegExp("OS X").test(h.os?.family??""),u.isMobile=!new RegExp("(Windows|OS X)").test(h.os?.family??""),u.hDip={},u.isDbg=!1,u.isPackaged=!1,u.isRetina=!1,u.isDarkMode=!1,u.retinaRate=1,u.SN_ID="skynovel"},8566:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CmnTween=void 0;const r=i(6194);class n{static ease(t){if(!t)return t=>r.Easing.Linear.None(t);if(!(t in n.hEase))throw"ease";return n.hEase[t]}}e.CmnTween=n,n.hEase={"Back.In":t=>r.Easing.Back.In(t),"Back.InOut":t=>r.Easing.Back.InOut(t),"Back.Out":t=>r.Easing.Back.Out(t),"Bounce.In":t=>r.Easing.Bounce.In(t),"Bounce.InOut":t=>r.Easing.Bounce.InOut(t),"Bounce.Out":t=>r.Easing.Bounce.Out(t),"Circular.In":t=>r.Easing.Circular.In(t),"Circular.InOut":t=>r.Easing.Circular.InOut(t),"Circular.Out":t=>r.Easing.Circular.Out(t),"Cubic.In":t=>r.Easing.Cubic.In(t),"Cubic.InOut":t=>r.Easing.Cubic.InOut(t),"Cubic.Out":t=>r.Easing.Cubic.Out(t),"Elastic.In":t=>r.Easing.Elastic.In(t),"Elastic.InOut":t=>r.Easing.Elastic.InOut(t),"Elastic.Out":t=>r.Easing.Elastic.Out(t),"Exponential.In":t=>r.Easing.Exponential.In(t),"Exponential.InOut":t=>r.Easing.Exponential.InOut(t),"Exponential.Out":t=>r.Easing.Exponential.Out(t),"Linear.None":t=>r.Easing.Linear.None(t),"Quadratic.In":t=>r.Easing.Quadratic.In(t),"Quadratic.InOut":t=>r.Easing.Quadratic.InOut(t),"Quadratic.Out":t=>r.Easing.Quadratic.Out(t),"Quartic.In":t=>r.Easing.Quartic.In(t),"Quartic.InOut":t=>r.Easing.Quartic.InOut(t),"Quartic.Out":t=>r.Easing.Quartic.Out(t),"Quintic.In":t=>r.Easing.Quintic.In(t),"Quintic.InOut":t=>r.Easing.Quintic.InOut(t),"Quintic.Out":t=>r.Easing.Quintic.Out(t),"Sinusoidal.In":t=>r.Easing.Sinusoidal.In(t),"Sinusoidal.InOut":t=>r.Easing.Sinusoidal.InOut(t),"Sinusoidal.Out":t=>r.Easing.Sinusoidal.Out(t)}},3422:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Config=void 0;const r=i(4965);class n{constructor(t){this.sys=t,this.oCfg={save_ns:"",coder:{len:864},window:{width:300,height:300},book:{title:"",creator:"",cre_url:"",publisher:"",pub_url:"",detail:"",version:"1.0"},log:{max_len:1024},init:{bg_color:0,tagch_msecwait:10,auto_msecpagewait:3500,escape:""},debug:{devtool:!1,token:!1,tag:!1,putCh:!1,debugLog:!1,baseTx:!1,masume:!1,variable:!1},code:{},debuger_token:""},this.userFnTail="",this.hPathFn2Exts={},this.$existsBreakline=!1,this.$existsBreakpage=!1,this.regPath=/([^\/\s]+)\.([^\d]\w+)/}static async generate(t){const e=new n(t),i=t.cur+"prj.json",r=await(await t.fetch(i)).text(),s=JSON.parse(t.decStr(i,r));return await e.load(s),e}async load(t){if(this.oCfg.save_ns=t?.save_ns??this.oCfg.save_ns,this.oCfg.coder=t?.coder??this.oCfg.coder,r.CmnLib.stageW=this.oCfg.window.width=Number(t?.window?.width??this.oCfg.window.width),r.CmnLib.stageH=this.oCfg.window.height=Number(t?.window?.height??this.oCfg.window.height),this.oCfg.book={...this.oCfg.book,...t.book},this.oCfg.log.max_len=t.log?.max_len?.max_len??this.oCfg.log.max_len,this.oCfg.init={...this.oCfg.init,...t.init},"init"in t)for(const t in this.oCfg.init){const e=String(this.oCfg.init[t]);"#"===e.charAt(0)&&(this.oCfg.init[t]=parseInt(e.slice(1),16))}if(this.oCfg.debug={...this.oCfg.debug,...t.debug},r.CmnLib.debugLog=this.oCfg.debug.debugLog,this.oCfg.debuger_token=t.debuger_token,await this.sys.loadPath(this.hPathFn2Exts,this),this.$existsBreakline=this.matchPath("^breakline$",n.EXT_SPRITE).length>0,this.$existsBreakpage=this.matchPath("^breakpage$",n.EXT_SPRITE).length>0,this.sys.crypto)for(const t in this.hPathFn2Exts){const e=this.hPathFn2Exts[t];for(const t in e){if(":RIPEMD160"!==t.slice(-10))continue;const i=e[t].slice(e[t].lastIndexOf("/")+1),r=e[t.slice(0,-10)],n=await this.sys.fetch(r),s=await n.text();if(i!==this.sys.hash(s))throw` fn:${r}`}}}get existsBreakline(){return this.$existsBreakline}get existsBreakpage(){return this.$existsBreakpage}getNs(){return`skynovel.${this.oCfg.save_ns} - `}searchPath(t,e=""){if(!t)throw"[searchPath] fn";if("http://"===t.slice(0,7))return t;if("downloads:/"===t.slice(0,11)){const e=this.sys.path_downloads+t.slice(11);return this.sys.ensureFileSync(e),e}if("userdata:/"===t.slice(0,10)){const e=this.sys.path_userdata+"storage/"+t.slice(10);return this.sys.ensureFileSync(e),e}const i=t.match(this.regPath);let n=i?i[1]:t;const s=i?i[2]:"";if(this.userFnTail){const t=n+"@@"+this.userFnTail;if(t in this.hPathFn2Exts)if(""===e)n=t;else for(let i in this.hPathFn2Exts[t])if(-1!==`|${e}|`.indexOf(`|${i}|`)){n=t;break}}const o=this.hPathFn2Exts[n];if(!o)throw`${t}`;let a="";if(!s){const i=(0,r.int)(o[":cnt"]);if(""===e){if(i>1)throw`${t}${e}`;return t}const n=`|${e}|`;if(i>1){let i=0;for(const r in o)if(-1!==n.indexOf(`|${r}|`)&&++i>1)throw`${t}${e}`}for(let t in o)if(-1!==n.indexOf(`|${t}|`))return o[t];throw`${e}=${t}`}if(""!==e&&-1===`|${e}|`.indexOf(`|${s}|`))throw`${s}${e}=${t}`;if(a=o[s],!a)throw`${s}=${t}${e}`;return a}matchPath(t,e=""){const i=[],r=new RegExp(t),n=new RegExp(e);for(let t in this.hPathFn2Exts){if(-1===t.search(r))continue;const s=this.hPathFn2Exts[t];if(""===e){i.push(s);continue}const o={};let a=!1;for(const e in s)-1!==e.search(n)&&(o[e]=t,a=!0);a&&i.push(o)}return i}addPath(t,e){const i={};for(const t in e)i[t]=(":"===t.charAt(0)?"":this.sys.cur)+e[t];this.hPathFn2Exts[t]=i}}e.Config=n,n.EXT_SPRITE="png|jpg|jpeg|json|svg|webp|mp4|webm",n.EXT_SCRIPT="sn|ssn",n.EXT_FONT="woff2|otf|ttf",n.EXT_SOUND="mp3|m4a|ogg|aac|flac|wav",n.EXT_HTML="htm|html"},7307:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DebugMng=void 0;const r=i(4965),n=i(1795);class s{constructor(t,e,i){this.sys=t,this.first=!0,s.scrItr=i,s.hTag=e,s.title=e.title,s.myTrace=s.trace,e.log=t=>this.log(t),e.trace=t=>this.trace(t),s.spnDbg=document.createElement("span"),s.spnDbg.hidden=!0,s.spnDbg.textContent="",s.spnDbg.style.cssText=`\tz-index: ${Number.MAX_SAFE_INTEGER};\n\t\t\tposition: absolute; left: 0; top: 0;\n\t\t\tcolor: black;\n\t\t\tbackground-color: rgba(255, 255, 255, 0.7);`,document.body.appendChild(s.spnDbg)}destroy(){s.title=()=>!1,document.body.removeChild(s.spnDbg),s.myTrace=s.trace_beforeNew}log(t){let e="";return this.first&&(this.first=!1,e=`== ${n.description} ==\n`),this.sys.appendFile(this.sys.path_downloads+"log.txt",`${e}--- ${(0,r.getDateStr)("-","_","")} [fn:${s.scrItr.scriptFn} line:${s.scrItr.lineNum}] prj:${this.sys.cur}\n${t.text||`(text is ${t.text})`}\n`,(t=>{t&&console.log(t)})),!1}trace(t){return s.myTrace(t.text||`(text is ${t.text})`,"I"),!1}static trace_beforeNew(t,e="E"){let i=`{${e}} `+t,n="";switch(e){case"D":n=`color:#${r.CmnLib.isDarkMode?"49F":"05A"};`;break;case"W":n="color:#FF8800;";break;case"F":n="color:#BB0000;";break;case"ET":throw i;case"E":return void console.error("%c"+i,"color:#FF3300;");default:n="color:black;",i=" "+i}console.info("%c"+i,n)}static trace(t,e="E"){let i=`{${e}} `;s.scrItr&&s.scrItr.lineNum>0&&(i+=`(fn:${s.scrItr.scriptFn} line:${s.scrItr.lineNum}) `),i+=t,s.dspDbg(i,e);let n="";switch(e){case"D":n=`color:#${r.CmnLib.isDarkMode?"49F":"05A"};`;break;case"W":n="color:#F80;";break;case"F":n="color:#B00;";break;case"ET":case"E":if(s.title({text:t}),this.hTag.dump_lay({}),this.hTag.dump_val({}),s.scrItr.dumpErrForeLine(),this.hTag.dump_stack({}),"ET"===e)throw i;return void console.error("%c"+i,"color:#F30;");default:n="",i=" "+i}console.info("%c"+i,n)}static dspDbg(t,e){let i="";switch(e){case"D":i="color:#05A;";break;case"W":i="color:#F80;";break;case"F":i="color:#B00;";break;case"ET":case"E":i="color:#F30;";break;default:i=""}s.spnDbg.innerHTML+=`<span style='${i}'>${t}</span><br/>`,s.spnDbg.hidden=!1}}e.DebugMng=s,s.myTrace=s.trace_beforeNew},4412:function(t,e,i){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.PicBtnDesignCast=e.TxtBtnDesignCast=e.BtnDesignCast=e.TxtLayPadDesignCast=e.TxtLayDesignCast=e.GrpLayDesignCast=e.DesignCast=void 0;const n=i(4965),s=i(5785),o=i(7307),a=i(3422),h=i(6841),u=r(i(5586));class c{constructor(t,e=!1){this.bg_col=t,this.isLay=e,this.hArg={},this.id_tag="",this.hDesignArg={rotation:0,pivot_x:0,pivot_y:0,left:0,center:0,right:0,s_right:0,top:0,middle:0,bottom:0,s_bottom:0,width:0,height:0},this.fncLay=()=>{},this.mov=null,this.div=null,this.lx=0,this.ly=0,this.rect=h.Rectangle.EMPTY,this.pivot=new h.Point(0,0),this.scale=new h.Point(1,1),this.rotation=0,this.oldFn=()=>"",this.rotatable=!0}static init(t,e,i,r,s,o,a){t.view.insertAdjacentHTML("beforebegin",`<div id="${c.ID_DESIGNMODE}" style="width: ${n.CmnLib.stageW*n.CmnLib.cvsScale}px; height: ${n.CmnLib.stageH*n.CmnLib.cvsScale}px; background: rgba(0,0,0,0); position: absolute; touch-action: none; user-select: none; display: none;"></div>`),c.divDesignRoot=document.getElementById(c.ID_DESIGNMODE),c.divHint.classList.add("sn_design_hint"),document.body.appendChild(c.divHint),c.sys=e,c.scrItr=i,c.prpPrs=r,c.alzTagArg=s,c.cfg=o,c.hPages=a,(0,n.addStyle)("\n.sn_design_cast {\n\tposition: absolute; touch-action: none; user-select: none;\n\topacity: 0.6; border-radius: 8px;\n}\n\n.sn_design_cast.drag_border {\n\tline-height: 1.8;\n\tborder: dashed 5px #333;\n}\n\n.sn_design_hint {\n\tposition: absolute;\n\tleft: 0;\n\ttop: 0;\n\tpadding: 5px;\n\tborder-radius: 5px;\n\tbackground: #333;\n\tz-index: 10;\n\tcolor: #fff;\n\tfont-weight: bold;\n\tfont-size: 12px;\n\tdisplay: none;\n}\n")}static setHint(t,e,i,r){c.divHint.innerHTML=t;const n=window.getComputedStyle(c.divHint),s=parseFloat(n.width),o=parseFloat(n.height);c.divHint.style.cssText=`display: block; left: ${Math.max(10,r.lx+e-s)}px;\n\t\ttop: ${Math.max(10,r.ly+i-o-10)}px;`}static cvsResizeDesign(){const t=c.divDesignRoot.style;t.width=n.CmnLib.stageW*n.CmnLib.cvsScale+"px",t.height=n.CmnLib.stageH*n.CmnLib.cvsScale+"px"}destroy(){this.div=null,this.mov?.destroy(),this.mov=null}gethArg(){return this.hArg}sethArg(t){if(!this.includeDesignArg(t))return;this.id_tag||(this.id_tag=t[":id_tag"]??""),this.hArg=t;const e=t[":id_dc"]??this.id_tag;c.hId2dc[e]=this;const i=this.hArg.layer??"";this.fncLay=this.parent||this.child||!i?()=>{}:()=>{const t=c.hPages[i].fore;this.lx=t.x*n.CmnLib.cvsScale,this.ly=t.y*n.CmnLib.cvsScale}}includeDesignArg(t){for(const e in t)if(e in this.hDesignArg)return!0;return!1}getRect(){return h.Rectangle.EMPTY}cnvPosArg(t,e){return{}}cnvSizeArg(t,e){return{}}setPos(t,e){}setSize(t,e){}setOther(t){}adopt(t){this.child=t,t.parent=this}static enterMode(){c.leaveMode(),c.divDesignRoot.style.display="inline",c.cntDesignCast=0,c.hId2dc={}}static allHide(){c.aDC.forEach((t=>t.visible=!1))}set visible(t){this.div&&this.mov&&(this.div.style.display=t?"inline":"none",this.mov.updateTarget())}static leaveMode(){c.divDesignRoot.textContent="",c.divDesignRoot.style.display="none",c.aDC.forEach((t=>t.destroy())),c.aDC=[]}cvsResize(){this.resizeDiv(),this.mov?.updateTarget()}resizeDiv(){this.fncLay(),this.div&&Object.assign(this.div.style,{left:`${this.lx+this.rect.x*n.CmnLib.cvsScale}px`,top:`${this.ly+this.rect.y*n.CmnLib.cvsScale}px`,width:this.rect.width*n.CmnLib.cvsScale+"px",height:this.rect.height*n.CmnLib.cvsScale+"px",transformOrigin:`${this.pivot.x*n.CmnLib.cvsScale}px ${this.pivot.y*n.CmnLib.cvsScale}px`,transform:`scale(${this.scale.x}, ${this.scale.y}) rotate(${this.rotation}deg)`})}onDragStart(){}make(){const t=this.hArg[":id_dc"]??this.id_tag;c.hId2dc[t]=this;const e=this.div=document.createElement("div");e.id=c.ID_DESIGNMODE+"_"+ ++c.cntDesignCast,e.classList.add("sn_design_cast"),e.dataset.id_dc=t,e.style.backgroundColor=`${this.bg_col}`,e.style.display="none",this.rect=this.getRect(),this.resizeDiv(),(this.parent?document.querySelector(`[data-id_dc="${this.parent.id_tag}"]`)??c.divDesignRoot:c.divDesignRoot).appendChild(e);const i={aPos:[0,0],roDeg:0,trOrg:"",origin:[0,0]},r=()=>{i.aPos=[NaN,NaN],i.roDeg=this.rotation;const t=this.pivot.x*n.CmnLib.cvsScale,e=this.pivot.y*n.CmnLib.cvsScale;i.trOrg=`${t}px ${e}px`,i.origin=[t,e],Object.assign(this.mov,{verticalGuidelines:[],horizontalGuidelines:[]})},s=t=>{c.sys.send2Dbg("_changeCast",{...t,":id_tag":this.id_tag}),c.divHint.style.display="none"},o=()=>{const[t,e]=i.aPos;if(isNaN(t))return void(c.divHint.style.display="none");const r=(0,n.int)(this.rect.x+=t/n.CmnLib.cvsScale+this.pivot.x),o=(0,n.int)(this.rect.y+=e/n.CmnLib.cvsScale+this.pivot.y);this.setPos(r,o);const a=(0,n.uint)(this.rect.width),h=(0,n.uint)(this.rect.height);this.setSize(a,h),s({...this.cnvPosArg(r,o),...this.cnvSizeArg(a,h)})};let h;this.mov=new u.default(document.body,{target:e,draggable:!0,resizable:!0,rotatable:this.rotatable,originDraggable:this.rotatable,snappable:!0}).on("dragStart",(t=>{r(),this.onDragStart();const e=this.child?.mov;e&&(h=e.target,e.isInside(t.clientX,t.clientY)&&(e.target=void 0))})).on("drag",(t=>{i.aPos=t.beforeTranslate,this.procDragHint(t,t.left,t.top)})).on("dragEnd",(()=>{o(),this.child?.mov&&(this.child.mov.target=h),this.parent?.mov&&(this.parent.mov.target=this.parent.div)})).on("resizeStart",r).on("resize",(t=>{e.style.width=`${t.width}px`,e.style.height=`${t.height}px`,i.aPos=t.drag.beforeTranslate,this.rect.width=t.width/n.CmnLib.cvsScale,this.rect.height=t.height/n.CmnLib.cvsScale,this.procResizeHint(t,t.drag.left,t.drag.top)})).on("resizeEnd",o).on("rotateStart",(t=>{r(),t.set(i.roDeg)})).on("rotate",(t=>{i.roDeg=t.beforeRotate,c.setHint((0,n.int)(i.roDeg)+"",t.drag.left,t.drag.top,this)})).on("rotateEnd",(()=>{this.rotation=i.roDeg,this.setOther({}),s({rotation:(0,n.int)(i.roDeg)})})).on("dragOriginStart",(()=>r)).on("dragOrigin",(t=>{i.trOrg=t.transformOrigin,i.origin=t.origin})).on("dragOriginEnd",(()=>{const[t,e]=i.origin;i.trOrg=`${t}px ${e}px`;const r=this.pivot.x=t/n.CmnLib.cvsScale,o=this.pivot.y=e/n.CmnLib.cvsScale;this.setOther({});const a=(0,n.int)(this.rect.x+r),h=(0,n.int)(this.rect.y+o);this.setPos(a,h),s({...this.cnvPosArg(a,h),pivot_x:(0,n.int)(r),pivot_y:(0,n.int)(o)})})).on("render",(()=>{const{aPos:t,roDeg:r,trOrg:n}=i;e.style.transformOrigin=n,e.style.transform=`translate(${t[0]}px, ${t[1]}px) rotate(${r}deg)`})),c.aDC.push(this),e.addEventListener("dragenter",(()=>e.classList.add("drag_border"))),e.addEventListener("dragover",(t=>{t.stopPropagation(),t.preventDefault(),t.dataTransfer&&(t.dataTransfer.dropEffect="copy")})),e.addEventListener("dragleave",(()=>e.classList.remove("drag_border"))),e.addEventListener("drop",(t=>{t.stopPropagation(),t.preventDefault(),e.classList.remove("drag_border");const i=t.dataTransfer;if(!i||0===i.files.length)return;const r=i.files[0],s={":id_tag":this.id_tag,fn:(0,n.getFn)(r.name),ext:(0,n.getExt)(r.name),url:"",buf:new ArrayBuffer(0),old_fn:this.oldFn(),old_url:c.cfg.searchPath(this.oldFn(),a.Config.EXT_SPRITE)};r.arrayBuffer().then((t=>{s.buf=t;try{s.url=c.scrItr.cnvPath4Dbg(c.cfg.searchPath(r.name,a.Config.EXT_SPRITE))}catch{}c.sys.send2Dbg("_dropFile",s)})).catch((t=>console.error("drop2dc %o",t)))})),e.addEventListener("dblclick",(t=>{t.preventDefault(),c.sys.send2Dbg("_focusScript",this.hArg)}))}procDragHint(t,e,i){const[r,s]=t.beforeTranslate;c.setHint(`(${(0,n.int)(this.rect.x+r/n.CmnLib.cvsScale)}, ${(0,n.int)(this.rect.y+s/n.CmnLib.cvsScale)})`,e,i,this)}procResizeHint(t,e,i){c.setHint(`(${(0,n.int)(t.drag.left)}, ${(0,n.int)(t.drag.top)})<br/>${(0,n.int)(this.rect.width)} x ${(0,n.int)(this.rect.height)}`,e,i,this)}static replaceToken(t){const e=t[":id_tag"],i=c.hId2dc[e];if(!document.querySelector(`div[data-id_dc='${e}']`)||!i)return;const r=t[":token"];c.scrItr.replace(t[":idx_tkn"],r);const[a,h]=(0,s.tagToken2Name_Args)(r);i.child&&(i.child.hArg[":token"]=i.hArg[":token"]),c.alzTagArg.go(h);const u=c.alzTagArg.hPrm;if("pivot_x"in u||"pivot_y"in u){const e=Number(c.prpPrs.getValAmpersand(u.pivot_x.val??"0")),n=Number(c.prpPrs.getValAmpersand(u.pivot_y.val??"0"));(isNaN(e)||isNaN(n))&&o.DebugMng.myTrace(`pivot_xpivot_y\n(fn:${t[":path"].slice(13)} ln:${t[":ln"]})\n${r}`,"F"),i.pivot.set(e,n)}if("left"in u||"top"in u||"x"in u||"y"in u){const e=(0,n.int)(c.prpPrs.getValAmpersand(u.left.val??u.x.val??"0")),s=(0,n.int)(c.prpPrs.getValAmpersand(u.top.val??u.y.val??"0"));(isNaN(e)||isNaN(s))&&o.DebugMng.myTrace(`widthheight\n(fn:${t[":path"].slice(13)} ln:${t[":ln"]})\n${r}`,"F"),i.rect.x=e-i.pivot.x,i.rect.y=s-i.pivot.y,i.setPos(e,s)}if("width"in u||"height"in u){const e=(0,n.int)(c.prpPrs.getValAmpersand(u.width.val??"0")),s=(0,n.int)(c.prpPrs.getValAmpersand(u.height.val??"0"));(isNaN(e)||isNaN(s))&&o.DebugMng.myTrace(`widthheight\n(fn:${t[":path"].slice(13)} ln:${t[":ln"]})\n${r}`,"F"),i.rect.width=e,i.rect.height=s,i.setSize(e,s)}if("scale_x"in u||"scale_y"in u){const e=Number(c.prpPrs.getValAmpersand(u.scale_x.val??"0")),n=Number(c.prpPrs.getValAmpersand(u.scale_y.val??"0"));(isNaN(e)||isNaN(n))&&o.DebugMng.myTrace(`scale_xscale_y\n(fn:${t[":path"].slice(13)} ln:${t[":ln"]})\n${r}`,"F"),i.scale.set(e,n)}if("rotation"in u){const e=Number(c.prpPrs.getValAmpersand(u.rotation.val??"0"));isNaN(e)&&o.DebugMng.myTrace(`rotation\n(fn:${t[":path"].slice(13)} ln:${t[":ln"]})\n${r}`,"F"),i.rotation=e}i.setOther(u),i.cvsResize()}}e.DesignCast=c,c.divHint=document.createElement("div"),c.ID_DESIGNMODE="DesignMode",c.cntDesignCast=0,c.hId2dc={},c.aDC=[],e.GrpLayDesignCast=class extends c{constructor(t,e){super("#29e",!0),this.spLay=t,this.gl=e,this.oldFn=()=>this.hArg.fn??""}setSp(t){this.sp=t}getRect(){return new h.Rectangle(this.spLay.x,this.spLay.y,this.sp?.width??0,this.sp?.height??0)}cnvPosArg(t,e){return{left:t,top:e}}cnvSizeArg(t,e){return{width:t,height:e}}setPos(t,e){this.spLay.x=t,this.spLay.y=e}setSize(t,e){this.sp.width=t,this.sp.height=e}setOther(t){if("fn"in t){const e=c.prpPrs.getValAmpersand(t.fn.val??"");this.gl.lay({fn:e})}this.spLay.pivot.copyFrom(this.pivot),this.spLay.scale.copyFrom(this.scale),this.spLay.angle=this.rotation}},e.TxtLayDesignCast=class extends c{constructor(t,e){super("#29e",!0),this.spLay=t,this.ts=e,this.hDesignArg={rotation:0,pivot_x:0,pivot_y:0,left:0,center:0,right:0,s_right:0,top:0,middle:0,bottom:0,s_bottom:0,width:0,height:0,pl:0,pr:0,pt:0,pb:0}}getRect(){const t=this.ts.getInfTL();return new h.Rectangle(this.spLay.x,this.spLay.y,t.$width,t.$height)}cnvPosArg(t,e){return{left:t,top:e}}cnvSizeArg(t,e){return{width:t,height:e}}setPos(t,e){this.spLay.position.set(t,e),this.ts.lay(this.cnvPosArg(t,e))}setSize(t,e){this.ts.lay(this.cnvSizeArg(t,e))}setOther(t){this.child?.setOther(t),this.spLay.pivot.copyFrom(this.pivot),this.spLay.scale.copyFrom(this.scale),this.spLay.angle=this.rotation}},e.TxtLayPadDesignCast=class extends c{constructor(t){super("#9e2"),this.ts=t,this.rotatable=!1}getRect(){const t=this.ts.getInfTL();return new h.Rectangle(t.pad_left,t.pad_top,t.$width-t.pad_left-t.pad_right,t.$height-t.pad_top-t.pad_bottom)}cnvPosArg(t,e){return{pl:t,pt:e}}cnvSizeArg(t,e){const i=this.ts.getInfTL();return{pr:i.$width-i.pad_left-t,pb:i.$height-i.pad_top-e}}setPos(t,e){this.ts.lay(this.cnvPosArg(t,e))}setSize(t,e){this.ts.lay({...this.cnvSizeArg(t,e),":redraw":!0})}setOther(t){const e=this.ts.getInfTL();if(("pl"in t||"pt"in t)&&(this.setPos(this.rect.x=parseFloat(c.prpPrs.getValAmpersand(t.pl?.val??`${e.pad_left}`)),this.rect.y=parseFloat(c.prpPrs.getValAmpersand(t.pt?.val??`${e.pad_top}`))),this.cvsResize()),"pr"in t||"pb"in t){this.ts.lay({pr:parseFloat(c.prpPrs.getValAmpersand(t.pr?.val??`${e.pad_right}`)),pb:parseFloat(c.prpPrs.getValAmpersand(t.pb?.val??`${e.pad_bottom}`))});const i=this.getRect();this.setSize(this.rect.width=i.width,this.rect.height=i.height),this.cvsResize()}}procDragHint(t,e,i){const[r,n]=t.beforeTranslate;this.procHint(e,i,r,n)}procResizeHint(t,e,i){const[r,n]=t.drag.beforeTranslate;this.procHint(e,i,r,n)}procHint(t,e,i,r){const s=this.rect.x,o=this.rect.y,a=this.rect.width,h=this.rect.height,u=this.ts.getInfTL(),l=(0,n.int)(s+i/n.CmnLib.cvsScale),p=(0,n.int)(o+r/n.CmnLib.cvsScale),d=(0,n.int)(u.$width-l-a),f=(0,n.int)(u.$height-p-h),g=t=>"&nbsp;".repeat(t);c.setHint(g(11)+`=${p}<br/>\n\t\t\t=${l+g(10)}=${d}<br/>`+g(5)+` ${(0,n.int)(a)} x ${(0,n.int)(h)}<br/>`+g(10)+`=${f}`,t,e,this)}};class l extends c{constructor(t,e){super("#e92"),this.btn=t,this.hArg=e,this.pivot.x=(0,n.argChk_Num)(e,"pivot_x",this.pivot.x),this.pivot.y=(0,n.argChk_Num)(e,"pivot_y",this.pivot.y),this.scale.x=(0,n.argChk_Num)(e,"scale_x",this.scale.x),this.scale.y=(0,n.argChk_Num)(e,"scale_y",this.scale.y),this.rotation=(0,n.argChk_Num)(e,"rotation",this.rotation),this.sethArg(e)}cnvPosArg(t,e){return{left:t,top:e}}cnvSizeArg(t,e){return{width:t,height:e}}setPos(t,e){this.btn.x=t,this.btn.y=e}setOther(t){this.btn.pivot.copyFrom(this.pivot),this.btn.scale.copyFrom(this.scale),this.btn.angle=this.rotation}onDragStart(){const t=this.btn.parent.children.filter((t=>t!==this.btn));Object.assign(this.mov,{verticalGuidelines:t.map((t=>this.lx+t.x*n.CmnLib.cvsScale)),horizontalGuidelines:t.map((t=>this.ly+t.y*n.CmnLib.cvsScale))})}}e.BtnDesignCast=l,e.TxtBtnDesignCast=class extends l{constructor(t,e,i){super(t,e),this.txt=i,this.oldFn=()=>this.hArg.b_pic??"",(0,n.argChk_Boolean)(e,"design",!0)||(this.setPos=()=>{},this.setSize=()=>{})}getRect(){return new h.Rectangle(this.btn.x,this.btn.y,this.txt.width,this.txt.height)}setSize(t,e){this.txt.width=t,this.txt.height=e}setOther(t){if(super.setOther(t),"b_pic"in t){const e=c.prpPrs.getValAmpersand(t.b_pic.val??"");this.btn.update_b_pic(e,this.txt)}}},e.PicBtnDesignCast=class extends l{constructor(t,e){super(t,e),this.oldFn=()=>this.hArg.pic??""}setSp(t){this.sp=t}getRect(){return new h.Rectangle(this.btn.x,this.btn.y,this.sp.width,this.sp.height)}setSize(t,e){this.sp.width=t,this.sp.height=e}setOther(t){if(super.setOther(t),"pic"in t){const e=c.prpPrs.getValAmpersand(t.pic.val??"");this.btn.update_pic(e,this.sp)}}}},5097:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EventListenerCtn=void 0;const r=i(6841);e.EventListenerCtn=class{constructor(){this.vctEvt=[]}add(t,e,i,n={}){if(t instanceof r.BaseTexture)switch(e){case"loaded":case"update":case"error":case"dispose":t.on(e,i,n),this.vctEvt.push((()=>t.off(e,i,n)))}else{if(t instanceof r.utils.EventEmitter)return t.on(e,i,n),void this.vctEvt.push((()=>t.off(e,i,n)));t.addEventListener(e,i,n),this.vctEvt.push((()=>t.removeEventListener(e,i,{capture:n.capture??!1})))}}clear(){this.vctEvt.forEach((t=>t())),this.vctEvt=[]}}},8526:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EventMng=void 0;const r=i(4965),n=i(1028),s=i(5097),o=i(6761),a=i(5455),h=i(6194),u=i(6841),c=i(3422),{GamepadListener:l}=i(7042);e.EventMng=class{constructor(t,e,i,h,p,d,f,g,m){if(this.cfg=t,this.hTag=e,this.appPixi=i,this.main=h,this.layMng=p,this.val=d,this.sndMng=f,this.scrItr=g,this.sys=m,this.elc=new s.EventListenerCtn,this.gamepad=new l({analog:!1,deadZone:.3}),this.fcs=new a.FocusMng,this.resvFlameEvent4Wheel=t=>{},this.wheeling=!1,this.extend_wheel=!1,this.hLocalEvt2Fnc={},this.hGlobalEvt2Fnc={},this.isDbgBreak=!1,this.isWait=!1,this.getEvt2Fnc=t=>this.hLocalEvt2Fnc[t]??this.hGlobalEvt2Fnc[t],this.firstWait=()=>{this.firstWait=()=>{},this.scrItr.firstWait()},this.procWheel4wle=(t,e)=>{},this.elcWLE=new s.EventListenerCtn,this.goTxt=()=>this.layMng.goTxt(),this.fncCancelSkip=()=>{},this.hDownKeys={Alt:0,Meta:0,Control:0,ArrowDown:0,End:0,Enter:0,Escape:0," ":0,GoBack:0},e.clear_event=t=>this.clear_event(t),e.event=t=>this.event(t),e.l=t=>this.l(t),e.p=t=>this.p(t),e.s=()=>(this.waitEventBase((()=>{}),!1,!0),!0),e.set_cancel_skip=()=>this.set_cancel_skip(),e.set_focus=t=>this.set_focus(t),e.wait=t=>this.wait(t),e.waitclick=()=>this.waitclick(),f.setEvtMng(this),g.setOtherObj(this,p),n.TxtLayer.setEvtMng(h,this),p.setEvtMng(this),m.setFire(((t,e)=>this.fire(t,e))),r.CmnLib.isDbg){const t={pause:()=>{if(this.isDbgBreak=!0,!this.isWait)return;const t={};this.scrItr.recodeDesign(t),this.sys.callHook("_enterDesign",t),this.sys.send2Dbg("_enterDesign",t)},stopOnBreakpoint:()=>this.isDbgBreak=!0,stopOnDataBreakpoint:()=>this.isDbgBreak=!0,continue:()=>this.isDbgBreak=!1,disconnect:()=>this.isDbgBreak=!1};t.attach=t.stopOnEntry=t.stopOnStep=t.stopOnStepIn=t.stopOnStepOut=t.stopOnBackstep=t.pause,m.addHook((e=>t[e]?.()))}let _="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAyBAMAAABYG2ONAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGuGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDIgNzkuMTY0NDYwLCAyMDIwLzA1LzEyLTE2OjA0OjE3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjEuMiAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMjAtMDgtMTlUMDM6MDk6MjUrMDk6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDIwLTA4LTE5VDIzOjUyOjI5KzA5OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIwLTA4LTE5VDIzOjUyOjI5KzA5OjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI5ZjM1YWNlLTc0NzMtNGI3My05OGJjLWQ1OTk4ZDk5MjQzNiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDphY2U0MDcwOS04ZTQxLTQ1YjYtYTMwZi05NDU1YWM1OTAwMmEiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDphY2U0MDcwOS04ZTQxLTQ1YjYtYTMwZi05NDU1YWM1OTAwMmEiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmFjZTQwNzA5LThlNDEtNDViNi1hMzBmLTk0NTVhYzU5MDAyYSIgc3RFdnQ6d2hlbj0iMjAyMC0wOC0xOVQwMzowOToyNSswOTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjIgKE1hY2ludG9zaCkiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjA3Mzg4MzYwLWJjMjctNDRkZi1hMTYwLTk5N2M4ODNmYTA0ZCIgc3RFdnQ6d2hlbj0iMjAyMC0wOC0xOVQyMjo0NTozNiswOTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjIgKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjI5ZjM1YWNlLTc0NzMtNGI3My05OGJjLWQ1OTk4ZDk5MjQzNiIgc3RFdnQ6d2hlbj0iMjAyMC0wOC0xOVQyMzo1MjoyOSswOTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjIgKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+WWAYXwAAACdQTFRF////PDIlPDIlPDIlPDIlPDIlPDIlPDIlPDIlPDIlPDIlPDIlPDIlCOA6SAAAAA10Uk5TACB/MID/EJBA8NCwYDCdv6cAAABoSURBVHgBYxicYBQIKZEIlJmMSQWGTKS7a8RpGdUyqmVUy6iWUS3y7zGBAlwai+wnrOZwTA2FgBnE220F0RFlQLwWtq1gLdtI8SI7SEc4acFyMjQ08gBpgWzlAEKkgayoBJJj7AAuCQAm1kUjHh83WgAAAABJRU5ErkJggg==";try{_=t.searchPath("hint",c.Config.EXT_SPRITE)}catch{}this.hint=new o.Button({enabled:!1,text:"hint",style:'{"fill": "white", "fontSize": "21px"}',b_pic:_,width:80,design:!1},this,(()=>{}),(()=>!1)),this.hint.visible=!1,i.stage.addChild(this.hint);const v=this.hint.getBounds();this.zxHint=this.hint.x-v.x,this.zyHint=this.hint.y-v.y,i.stage.interactive=!0,r.CmnLib.isMobile?i.stage.on("pointerdown",(t=>this.fire("click",t))):this.elc.add(i.stage,"pointerdown",(t=>{switch(t.data.button){case 0:this.fire("click",t);break;case 1:this.fire("middleclick",t)}})),this.elc.add(window,"keydown",(t=>this.ev_keydown(t))),this.elc.add(i.view,"contextmenu",(t=>this.ev_contextmenu(t)));const y=t=>{r.CmnLib.isDarkMode=t.matches,d.setVal_Nochk("tmp","const.sn.isDarkMode",r.CmnLib.isDarkMode)},b=globalThis.matchMedia("(prefers-color-scheme: dark)");y(b),b.addEventListener("change",(t=>{y(t),this.fire("sn:chgDarkMode",t)})),"WheelEvent"in window&&(this.elc.add(i.view,"wheel",(t=>this.ev_wheel(t)),{passive:!0}),this.resvFlameEvent4Wheel=t=>t.addEventListener("wheel",(t=>this.ev_wheel(t)),{passive:!0}),this.procWheel4wle=(t,e)=>t.add(i.view,"wheel",(t=>{t.isComposing||t.deltaY<=0||(t.stopPropagation(),e())}))),r.CmnLib.debugLog&&(this.gamepad.on("gamepad:connected",(t=>console.log(`<'gamepad:connected' index:${t.detail.index} id:${t.detail.gamepad.id}`))),this.gamepad.on("gamepad:disconnected",(t=>console.log(`<'gamepad:disconnected' index:${t.detail.index} id:${t.detail.gamepad.id}`))));const x=["","ArrowUp","","ArrowLeft","","ArrowRight","","ArrowDown",""],E=[0,0];this.gamepad.on("gamepad:axis",(t=>{if(!document.hasFocus()||0!==t.detail.stick)return;E[t.detail.axis]=t.detail.value;const e=3*(E[1]+1)+(E[0]+1),i=x[e];if(!i)return;const r=this.fcs.getFocus();(!r||r instanceof u.Container?globalThis:r).dispatchEvent(new KeyboardEvent("keydown",{key:i,bubbles:!0})),!r||r instanceof u.Container||"range"===r.getAttribute("type")&&r.dispatchEvent(new InputEvent("input",{bubbles:!0}))})),this.gamepad.on("gamepad:button",(t=>{if(document.hasFocus()&&0!==t.detail.value)if(t.detail.button%2==0){const t=this.fcs.getFocus();(!t||t instanceof u.Container?globalThis:t).dispatchEvent(new KeyboardEvent("keydown",{key:"Enter",bubbles:!0}))}else i.view.dispatchEvent(new Event("contextmenu"))})),this.gamepad.start(),this.elc.add(window,"keyup",(t=>{t.isComposing||t.key in this.hDownKeys&&(this.hDownKeys[t.key]=0)})),d.defTmp("const.sn.key.alternate",(()=>this.hDownKeys.Alt>0)),d.defTmp("const.sn.key.command",(()=>this.hDownKeys.Meta>0)),d.defTmp("const.sn.key.control",(()=>this.hDownKeys.Control>0)),d.defTmp("const.sn.key.end",(()=>this.hDownKeys.End>0)),d.defTmp("const.sn.key.escape",(()=>this.hDownKeys.Escape>0)),d.defTmp("const.sn.key.back",(()=>this.hDownKeys.GoBack>0))}resvFlameEvent(t){t.addEventListener("keydown",(t=>this.ev_keydown(t))),t.addEventListener("contextmenu",(t=>this.ev_contextmenu(t))),this.resvFlameEvent4Wheel(t)}ev_keydown(t){if(t.isComposing)return;t.key in this.hDownKeys&&(this.hDownKeys[t.key]=t.repeat?2:1);const e=(t.altKey?"Alt"===t.key?"":"alt+":"")+(t.ctrlKey?"Control"===t.key?"":"ctrl+":"")+(t.shiftKey?"Shift"===t.key?"":"shift+":"")+t.key;this.fire(e,t)}ev_contextmenu(t){const e=(t.altKey?"Alt"===t.key?"":"alt+":"")+(t.ctrlKey?"Control"===t.key?"":"ctrl+":"")+(t.shiftKey?"Shift"===t.key?"":"shift+":"")+"rightclick";this.fire(e,t),t.preventDefault()}ev_wheel(t){if(t.isComposing)return;if(this.wheeling)return void(this.extend_wheel=!0);this.wheeling=!0,this.ev_wheel_waitstop();const e=(t.altKey?"alt+":"")+(t.ctrlKey?"ctrl+":"")+(t.shiftKey?"shift+":"")+(t.deltaY>0?"downwheel":"upwheel");this.fire(e,t)}ev_wheel_waitstop(){setTimeout((()=>{if(this.extend_wheel)return this.extend_wheel=!1,void this.ev_wheel_waitstop();this.wheeling=!1}),250)}destroy(){this.fcs.destroy(),this.elc.clear()}fire(t,e){if(this.isDbgBreak)return;if(!this.isWait)return;const i=t.toLowerCase();if(r.CmnLib.debugLog&&console.log(` fire<(key:\`${i}\` type:${e.type} e:%o)`,{...e}),"enter"===i){const t=this.fcs.getFocus();if(t&&t instanceof u.Container)return void t.emit("pointerdown",new Event("pointerdown"))}const n=this.getEvt2Fnc(i);if(n)"wheel"!==i.slice(-5)&&e.preventDefault?.(),e.stopPropagation(),"dom="!==i.slice(0,4)&&this.layMng.clickTxtLay(),this.isWait=!1,n(e),this.hint.visible=!1;else if("swipe"===i.slice(0,5)){const t=e;globalThis.scrollBy(-(t.deltaX??0),-(t.deltaY??0))}}popLocalEvts(){const t=this.hLocalEvt2Fnc;return this.hLocalEvt2Fnc={},t}pushLocalEvts(t){this.hLocalEvt2Fnc=t}waitEvent(t,e=!0,i=!1){if(e&&i)throw"canskipglobaltrue";if(this.val.getVal("tmp:sn.skip.enabled")){if(this.val.getVal("tmp:sn.skip.all")||this.scrItr.isNextKidoku)return t(),!1;this.fncCancelSkip()}return this.waitEventBase(t,e,i),!0}waitEventBase(t,e=!0,i=!0){this.goTxt(),this.val.saveKidoku(),e?(this.hLocalEvt2Fnc.click=t,this.hLocalEvt2Fnc.enter=t,this.hLocalEvt2Fnc.arrowdown=t,this.hLocalEvt2Fnc["wheel.y>0"]=t):(delete this.hLocalEvt2Fnc.click,delete this.hLocalEvt2Fnc.enter,delete this.hLocalEvt2Fnc.arrowdown,delete this.hLocalEvt2Fnc["wheel.y>0"]),this.getEvt2Fnc=i?t=>this.hLocalEvt2Fnc[t]??this.hGlobalEvt2Fnc[t]:t=>this.hLocalEvt2Fnc[t],this.isWait=!0,this.firstWait()}button(t,e,i,n,s){t.fn||t.label||this.main.errScript("fnlabel"),e.interactive=e.buttonMode=!0;const o=t.key?.toLowerCase()??" ";t.fn||(t.fn=this.scrItr.scriptFn);const a=(0,r.argChk_Boolean)(t,"global",!1);a?this.hGlobalEvt2Fnc[o]=()=>this.main.resumeByJumpOrCall(t):this.hLocalEvt2Fnc[o]=()=>this.main.resumeByJumpOrCall(t);const h=e;h.on("pointerdown",(t=>this.fire(o,t)));const u=t.hint?()=>this.dispHint(t,e):()=>{},l=()=>{i(),this.hint.visible=!1},p=()=>(u(),n());if(h.on("pointerover",p),h.on("pointerout",(()=>{this.fcs.isFocus(e)?p():l()})),h.on("pointerdown",s),h.on("pointerup",r.CmnLib.isMobile?l:()=>{this.fcs.isFocus(e)?p():l()}),this.fcs.add(e,p,l),t.clickse&&(this.cfg.searchPath(t.clickse,c.Config.EXT_SOUND),h.on("pointerdown",(()=>{const e={fn:t.clickse,join:!1};t.clicksebuf&&(e.buf=t.clicksebuf),this.hTag.playse(e)}))),t.enterse&&(this.cfg.searchPath(t.enterse,c.Config.EXT_SOUND),h.on("pointerover",(()=>{const e={fn:t.enterse,join:!1};t.entersebuf&&(e.buf=t.entersebuf),this.hTag.playse(e)}))),t.leavese&&(this.cfg.searchPath(t.leavese,c.Config.EXT_SOUND),h.on("pointerout",(()=>{const e={fn:t.leavese,join:!1};t.leavesebuf&&(e.buf=t.leavesebuf),this.hTag.playse(e)}))),t.onenter){const e=o+t.onenter.toLowerCase(),i={fn:t.fn,label:t.onenter,call:!0,key:e};a?this.hGlobalEvt2Fnc[e]=()=>this.main.resumeByJumpOrCall(i):this.hLocalEvt2Fnc[e]=()=>this.main.resumeByJumpOrCall(i),h.on("pointerover",(t=>this.fire(e,t)))}if(t.onleave){const e=o+t.onleave.toLowerCase(),i={fn:t.fn,label:t.onleave,call:!0,key:e};a?this.hGlobalEvt2Fnc[e]=()=>this.main.resumeByJumpOrCall(i):this.hLocalEvt2Fnc[e]=()=>this.main.resumeByJumpOrCall(i),h.on("pointerout",(t=>this.fire(e,t)))}this.sndMng.loadAheadSnd(t)}dispHint(t,e){const i=this.hint,n=i.children[1];if(!n)return;n.text=t.hint;const s=e.name?.includes('"b_pic":'),o=e.name?.includes('"pic":'),a="link"===t.;i.parent?.removeChild(i),(a?e.parent:e).addChild(i),(0,r.argChk_Boolean)(t,"hint_tate",!1)?i.setTransform(o?e.width/e.scale.x:(s?(i.width-e.width)/2-this.zxHint:0)+(a?e.x:0)+e.width,o?e.height/2/e.scale.y:s?i.height/2:(a?e.y:0)+e.height/2+this.zyHint,1,1,1.570796327,0,0,i.width/2,i.height-2*this.zxHint):i.setTransform(o?(e.width-i.width+this.zxHint)/2:s?0:(a?e.x:0)+(e.width-i.width)/2,o?0:s?(i.height-e.height)/2:a?e.y:0,1,1,0,0,0,-this.zxHint/2,i.height-10),i.visible=!0}waitLimitedEvent(t,e){this.goTxt(),this.val.saveKidoku();const i=()=>{this.elcWLE.clear(),e()};if(this.val.getVal("tmp:sn.skip.enabled")){if(this.val.getVal("tmp:sn.skip.all")||this.scrItr.isNextKidoku)return i(),!1;this.fncCancelSkip()}return!(0,r.argChk_Boolean)(t,"canskip",!0)||(this.elcWLE.add(window,"pointerdown",(t=>{t.stopPropagation(),i()})),this.elcWLE.add(window,"keydown",(t=>{t.isComposing||(t.stopPropagation(),i())})),this.procWheel4wle(this.elcWLE,i),!0)}clear_event(t){const e=(0,r.argChk_Boolean)(t,"global",!1),i=e?this.hGlobalEvt2Fnc:this.hLocalEvt2Fnc;for(const t in i)this.clear_eventer(t,i[t]);return e?this.hGlobalEvt2Fnc={}:this.hLocalEvt2Fnc={},!1}clear_eventer(t,e){"dom="===t.slice(0,4)&&this.getHtmlElmList(t).el.forEach((t=>t.removeEventListener("click",e)))}event(t){const e=t.key;if(!e)throw"key";const i=e.toLowerCase(),n=(0,r.argChk_Boolean)(t,"call",!1),s=(0,r.argChk_Boolean)(t,"global",!1)?this.hGlobalEvt2Fnc:this.hLocalEvt2Fnc;if((0,r.argChk_Boolean)(t,"del",!1)){if(t.fn||t.label||n)throw"fn/label/calldel";return this.clear_eventer(e,s[i]),delete s[i],!1}if(t.fn??=this.scrItr.scriptFn,"dom="===e.slice(0,4)){const i=this.getHtmlElmList(e);if(0===i.el.length){if((0,r.argChk_Boolean)(t,"need_err",!0))throw`HTML${i.sel}need_err=false `;return!1}let n=["click","keydown"];switch(i.el[0].type??""){case"checkbox":case"range":n=["input"];break;case"text":case"textarea":n=["input","change"]}n.forEach(((t,r)=>i.el.forEach((n=>{this.elc.add(n,t,(r=>{if(!this.isWait||this.layMng.getFrmDisabled(i.id))return;if("keydown"===t&&"Enter"!==r.key)return;const s=n.dataset;for(const t in s)s.hasOwnProperty(t)&&this.val.setVal_Nochk("tmp",`sn.event.domdata.${t}`,s[t]);this.fire(e,r)})),0===r&&this.fcs.add(n,(()=>!!this.canFocus(n)&&(n.focus(),!0)),(()=>{}))}))))}return s[i]=()=>this.main.resumeByJumpOrCall(t),!1}canFocus(t){if(null===t.offsetParent)return!1;let e=t;do{if("none"===getComputedStyle(e).display||"false"===e.dataset.focus||e?.disabled)return!1;e=e.parentElement}while(null!==e);return!0}getHtmlElmList(t){const e=t.indexOf(":");let i="";if(e>=0){const r=t.slice(4,e),n=`const.sn.frm.${r}`;if(!this.val.getVal(`tmp:${n}`,0))throw`HTML${r}`;const s=document.getElementById(r).contentWindow;return i=t.slice(e+1),{el:s.document.querySelectorAll(i),id:r,sel:i}}return i=t.slice(4),{el:document.querySelectorAll(i),id:"",sel:i}}l(t){if(!this.val.getVal("tmp:sn.tagL.enabled"))return this.goTxt(),!1;if(this.val.getVal("tmp:sn.skip.enabled"))if(this.val.getVal("tmp:sn.skip.all")||this.scrItr.isNextKidoku){if("ps".includes(String(this.val.getVal("sys:sn.skip.mode"))))return!1}else this.fncCancelSkip();return this.val.getVal("tmp:sn.auto.enabled")?this.wait({time:Number(this.scrItr.isKidoku?this.val.getVal("sys:sn.auto.msecLineWait_Kidoku"):this.val.getVal("sys:sn.auto.msecLineWait"))}):((0,r.argChk_Boolean)(t,"visible",!0)&&this.layMng.breakLine(),this.waitEventBase((()=>this.main.resume())),!0)}p(t){if(this.val.getVal("tmp:sn.skip.enabled"))if(this.val.getVal("tmp:sn.skip.all")||this.scrItr.isNextKidoku){if("s"===String(this.val.getVal("sys:sn.skip.mode")))return this.goTxt(),!1}else this.fncCancelSkip();return this.val.getVal("tmp:sn.auto.enabled")?this.wait({time:Number(this.scrItr.isKidoku?this.val.getVal("sys:sn.auto.msecPageWait_Kidoku"):this.val.getVal("sys:sn.auto.msecPageWait"))}):((0,r.argChk_Boolean)(t,"visible",!0)&&this.layMng.breakPage(),this.waitEventBase(this.layMng.getCurrentTxtlayFore()&&(0,r.argChk_Boolean)(t,"er",!1)?()=>{this.hTag.er(t),this.main.resume()}:()=>this.main.resume()),!0)}set_cancel_skip(){return this.fncCancelSkip=()=>{this.fncCancelSkip=()=>{},this.val.setVal_Nochk("tmp","sn.tagL.enabled",!0),this.val.setVal_Nochk("tmp","sn.skip.enabled",!1),this.val.setVal_Nochk("tmp","sn.auto.enabled",!1),this.layMng.setNormalWaitTxtLayer()},this.unregisterClickEvts(),!1}unregisterClickEvts(){const t=this.scrItr.lenCallStk;for(let e=0;e<t;++e){const t=this.scrItr.getCallStk(e);if(!t)continue;const i=t.hEvt1Time;i&&(delete i.Click,delete i.Enter,delete i.ArrowDown,delete i["wheel.y>0"])}}set_focus(t){const e=t.add;if("dom="===e?.slice(0,4)){const i=this.getHtmlElmList(e);if(0===i.el.length&&(0,r.argChk_Boolean)(t,"need_err",!0))throw`HTML${i.sel}need_err=false `;return i.el.forEach((t=>this.fcs.add(t,(()=>!!this.canFocus(t)&&(t.focus(),!0)),(()=>{})))),!1}const i=t.del;if("dom="===i?.slice(0,4)){const e=this.getHtmlElmList(i);if(0===e.el.length&&(0,r.argChk_Boolean)(t,"need_err",!0))throw`HTML${e.sel}need_err=false `;return e.el.forEach((t=>this.fcs.remove(t))),!1}const n=t.to;if(!n)throw"[set_focus] add  to ";switch(n){case"null":this.fcs.blur();break;case"next":this.fcs.next();break;case"prev":this.fcs.prev()}return!1}wait(t){if(this.val.getVal("tmp:sn.skip.enabled")){if(this.val.getVal("tmp:sn.skip.all")||this.scrItr.isNextKidoku)return!1;this.fncCancelSkip()}const e=new h.Tween({}).to({},(0,r.uint)((0,r.argChk_Num)(t,"time",NaN))).onComplete((()=>{e.stop(),this.main.resume()})).start();return this.waitEvent((()=>e.end()),(0,r.argChk_Boolean)(t,"canskip",!0),(0,r.argChk_Boolean)(t,"global",!1))}waitclick(){if(this.val.getVal("tmp:sn.skip.enabled")){if(this.val.getVal("tmp:sn.skip.all")||this.scrItr.isNextKidoku)return!1;this.fncCancelSkip()}return this.waitEventBase((()=>this.main.resume())),!0}isSkipKeyDown(){for(const t in this.hDownKeys)if(2===this.hDownKeys[t])return!0;return!1}}},5455:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FocusMng=void 0;const r=i(4965),n=i(6841);e.FocusMng=class{constructor(){this.aBtn=[],this.idx=-1,this.logFocus=r.CmnLib.debugLog?t=>console.log(` <FocusMng idx:${t} btn:%o`,this.aBtn[t].btn):()=>{}}destroy(){this.aBtn=[],this.idx=-1}add(t,e,i){if(this.aBtn.findIndex((e=>e.btn===t))>=0)return;if(t instanceof n.Container)return t.on("pointerdown",(()=>{for(let e=this.aBtn.length-1;e>=0;--e)if(this.aBtn[e].btn===t)return void(this.idx=e);this.idx=-1})),void this.aBtn.push({btn:t,on:e,off:i});t.addEventListener("focus",(()=>{for(let e=this.aBtn.length-1;e>=0;--e)if(this.aBtn[e].btn===t)return void(this.idx=e);this.idx=-1}));let r=t=>{},s="button"===t.localName||"a"===t.localName?t=>!t.isTrusted&&"Enter"===t.key:t=>"Enter"===t.key;const o=t;switch(o.type??""){case"checkbox":r=()=>o.checked=!o.checked;break;case"":t.querySelectorAll("input[type]").length>0&&(r=e=>this.radio_next(t,e.key),s=()=>!1);break;case"range":r=t=>{t.isTrusted||("ArrowUp"===t.key?o.stepUp():o.stepDown())};break;case"text":case"textarea":r=t=>{if(t.isTrusted)return;let e=(o.selectionStart??0)+("ArrowUp"===t.key?-1:1);e<0&&(e=0),o.setSelectionRange(e,e)}}t.addEventListener("keydown",(e=>{"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key||(e.stopPropagation(),e.stopImmediatePropagation(),s(e)?t.dispatchEvent(new MouseEvent("click")):r(e))}),{passive:!0}),t.hasAttribute("tabindex")||(t.tabIndex=0),this.aBtn.push({btn:t,on:e,off:i})}remove(t){const e=this.aBtn.findIndex((e=>e.btn===t));e<0||(this.aBtn.splice(e,1),0===this.aBtn.length?this.idx=-1:e<=this.idx&&--this.idx)}radio_next(t,e){const i=t.querySelectorAll("input[type]"),r=i.length;for(let t=0;t<r;++t)if(i[t].checked){i[(t+r+("ArrowUp"===e?-1:1))%r].checked=!0;break}}isFocus(t){return!(this.idx<0)&&this.aBtn[this.idx].btn===t}prev(){this.allOff();const t=this.aBtn.length;if(0!==t){--this.idx<0&&(this.idx=t-1);for(let e=t;e>=1;--e){const i=(this.idx+e)%t;if(this.aBtn[i].on())return this.idx=i,void this.logFocus(i)}this.idx=-1}}next(){this.allOff();const t=this.aBtn.length;if(0!==t){++this.idx>=t&&(this.idx=0);for(let e=0;e<t;++e){const i=(this.idx+e)%t;if(this.aBtn[i].on())return this.idx=i,void this.logFocus(i)}this.idx=-1}}getFocus(){if(this.idx<0)return null;this.allOff(),this.idx>=this.aBtn.length&&(this.idx=0);const t=this.aBtn[this.idx];return t.on()?t.btn:null}blur(){this.allOff(),this.idx=-1,globalThis.focus()}allOff(){for(let t=this.aBtn.length-1;t>=0;--t){const e=this.aBtn[t];e.btn instanceof n.Container&&!e.btn.parent?this.aBtn.splice(t,1):e.off()}}}},9552:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FrameMng=void 0;const r=i(4965),n=i(8566),s=i(3422),o=i(6194),a=i(6841);e.FrameMng=class{constructor(t,e,i,r,n,s,o){this.cfg=t,this.appPixi=i,this.val=r,this.main=n,this.sys=s,this.hTwInf=o,this.hIfrm=Object.create(null),this.hDisabled=Object.create(null),this.hAEncImg=Object.create(null),this.hEncImgOUrl=Object.create(null),e.add_frame=t=>this.add_frame(t),e.let_frame=t=>this.let_frame(t),e.set_frame=t=>this.set_frame(t),e.frame=t=>this.frame(t),e.tsy_frame=t=>this.tsy_frame(t)}setEvtMng(t){this.evtMng=t}destroy(){for(const t in this.hIfrm){const e=this.hIfrm[t];e.parentElement.removeChild(e)}this.hIfrm=Object.create(null)}add_frame(t){const e=t.id;if(!e)throw"id";const i=t.src;if(!i)throw"src";const n=`const.sn.frm.${e}`;if(this.val.getVal(`tmp:${n}`))throw`frame${e}`;const o=(0,r.argChk_Num)(t,"alpha",1),h=(0,r.argChk_Num)(t,"scale_x",1),u=(0,r.argChk_Num)(t,"scale_y",1),c=(0,r.argChk_Num)(t,"rotate",0),l=(0,r.argChk_Boolean)(t,"visible",!0),p=t.b_color?` background-color: ${t.b_color};`:"",d=this.rect(t),f=this.sys.reso4frame*r.CmnLib.cvsScale;this.appPixi.view.insertAdjacentHTML("beforebegin",`<iframe id="${e}" sandbox="allow-scripts allow-same-origin" style="opacity: ${o}; position: absolute; left:${this.sys.ofsLeft4frm+d.x*f}px; top: ${this.sys.ofsTop4frm+d.y*f}px; z-index: 1; ${p} border: 0px; overflow: hidden; display: ${l?"inline":"none"}; transform: scale(${h}, ${u}) rotate(${c}deg);" width="${d.width*f}" height="${d.height*f}"></iframe>`);const g=this.cfg.searchPath(i,s.Config.EXT_HTML),m=(new a.Loader).add({name:i,url:g,xhrType:a.LoaderResource.XHR_RESPONSE_TYPE.TEXT});return this.sys.crypto&&m.use(((t,e)=>{try{t.data=this.sys.decStr(t.extension,t.data)}catch(e){this.main.errScript(`[add_frame]Html  src:${t.name} ${e}`,!1)}e?.()})),m.load(((t,r)=>{const p=document.getElementById(e);this.hIfrm[e]=p,this.hDisabled[e]=!1,p.srcdoc=String(r[i]?.data).replace("sn_repRes();","").replace(/\s(?:src|href)=(["'])(\S+)\1/g,((t,e,i)=>"../"===i.slice(0,3)?this.sys.cur+i.slice(4):t.replace(e,e+g.slice(0,g.lastIndexOf("/")+1)))),p.onload=()=>{this.val.setVal_Nochk("tmp",n,!0),this.val.setVal_Nochk("tmp",n+".alpha",o),this.val.setVal_Nochk("tmp",n+".x",d.x),this.val.setVal_Nochk("tmp",n+".y",d.y),this.val.setVal_Nochk("tmp",n+".scale_x",h),this.val.setVal_Nochk("tmp",n+".scale_y",u),this.val.setVal_Nochk("tmp",n+".rotate",c),this.val.setVal_Nochk("tmp",n+".width",d.width),this.val.setVal_Nochk("tmp",n+".height",d.height),this.val.setVal_Nochk("tmp",n+".visible",l);const t=p.contentWindow;this.evtMng.resvFlameEvent(t),t.sn_repRes?.((t=>{const e=(t.dataset.src??"").replace(/(.+\/|\..+)/g,""),i=this.hEncImgOUrl[e];if(i)return void(t.src=i);const r=this.hAEncImg[e];if(r)return void r.push(t);this.hAEncImg[e]=[t];const n=this.cfg.searchPath(e,s.Config.EXT_SPRITE),o=(new a.Loader).add({name:e,url:n,xhrType:a.LoaderResource.XHR_RESPONSE_TYPE.BUFFER});this.sys.crypto&&o.use(((t,e)=>{this.sys.dec(t.extension,t.data).then((i=>{"bin"===t.extension?(t.data=i,i instanceof HTMLImageElement&&(t.type=a.LoaderResource.TYPE.IMAGE),e?.()):e?.()})).catch((e=>this.main.errScript(`Graphic  fn:${t.name} ${e}`,!1)))})),o.load(((t,e)=>{for(const t in e){const i=this.hEncImgOUrl[t]=e[t].data.src;this.hAEncImg[t].forEach((t=>t.src=i)),delete this.hAEncImg[t]}}))})),this.main.resume()}})),!0}getFrmDisabled(t){return this.hDisabled[t]}rect(t){const e={...t},i=this.sys.resolution;return new DOMRect((0,r.argChk_Num)(e,"x",0)*i,(0,r.argChk_Num)(e,"y",0)*i,(0,r.argChk_Num)(e,"width",r.CmnLib.stageW)*i,(0,r.argChk_Num)(e,"height",r.CmnLib.stageH)*i)}cvsResize(){const t=this.sys.reso4frame*r.CmnLib.cvsScale;for(const e in this.hIfrm){const i=this.hIfrm[e],r=Number(this.val.getVal(`const.sn.frm.${e}.x`)),n=Number(this.val.getVal(`const.sn.frm.${e}.y`)),s=Number(this.val.getVal(`const.sn.frm.${e}.width`)),o=Number(this.val.getVal(`const.sn.frm.${e}.height`));i.style.left=this.sys.ofsLeft4frm+r*t+"px",i.style.top=this.sys.ofsTop4frm+n*t+"px",i.width=String(s*t),i.height=String(o*t)}}let_frame(t){const e=t.id;if(!e)throw"id";const i=document.getElementById(e);if(!i)throw`id${e}`;const n=`const.sn.frm.${e}`;if(!this.val.getVal(`tmp:${n}`))throw`frame${e}`;const s=t.var_name;if(!s)throw"var_name";const o=i.contentWindow;if(!o.hasOwnProperty(s))throw`frame${e}/${s} var`;const a=o[s];return this.val.setVal_Nochk("tmp",n+"."+s,(0,r.argChk_Boolean)(t,"function",!1)?a():a),!1}set_frame(t){const e=t.id;if(!e)throw"id";const i=document.getElementById(e);if(!i)throw`id${e}`;const r=`const.sn.frm.${e}`;if(!this.val.getVal(`tmp:${r}`))throw`frame${e}`;const n=t.var_name;if(!n)throw"var_name";const s=t.text;if(!s)throw"text";return this.val.setVal_Nochk("tmp",r+"."+n,s),i.contentWindow[n]=s,!1}frame(t){const e=t.id;if(!e)throw"id";const i=document.getElementById(e);if(!i)throw`id${e}`;const n=`const.sn.frm.${e}`;if(!this.val.getVal(`tmp:${n}`))throw`frame${e}`;if("alpha"in t){const e=String(t.alpha);i.style.opacity=e,this.val.setVal_Nochk("tmp",n+".alpha",e)}const s=this.rect(t),o=this.sys.reso4frame*r.CmnLib.cvsScale;if(("x"in t||"y"in t)&&(i.style.left=this.sys.ofsLeft4frm+s.x*o+"px",i.style.top=this.sys.ofsTop4frm+s.y*o+"px",this.val.setVal_Nochk("tmp",n+".x",s.x),this.val.setVal_Nochk("tmp",n+".y",s.y)),"scale_x"in t||"scale_y"in t||"rotate"in t){const e=(0,r.argChk_Num)(t,"scale_x",1),s=(0,r.argChk_Num)(t,"scale_y",1),o=(0,r.argChk_Num)(t,"rotate",0);i.style.transform=`scale(${e}, ${s}) rotate(${o}deg)`,this.val.setVal_Nochk("tmp",n+".scale_x",e),this.val.setVal_Nochk("tmp",n+".scale_y",s),this.val.setVal_Nochk("tmp",n+".rotate",o)}if("width"in t&&(i.width=String(s.width*o),this.val.setVal_Nochk("tmp",n+".width",s.width)),"height"in t&&(i.height=String(s.height*o),this.val.setVal_Nochk("tmp",n+".height",s.height)),"visible"in t){const e=(0,r.argChk_Boolean)(t,"visible",!0);i.style.display=e?"inline":"none",this.val.setVal_Nochk("tmp",n+".visible",e)}if("b_color"in t&&(i.style.backgroundColor=t.b_color),"disabled"in t){const n=this.hDisabled[e]=(0,r.argChk_Boolean)(t,"disabled",!0);i.contentDocument.body.querySelectorAll("input,select").forEach((t=>t.disabled=n))}return!1}tsy_frame(t){const e=t.id;if(!e)throw"id";const i=document.getElementById(e);if(!i)throw`id${e}`;const s=`const.sn.frm.${e}`;if(!this.val.getVal(`tmp:${s}`,0))throw`frame${e}`;const a={};"alpha"in t&&(a.a=i.style.opacity),("x"in t||"y"in t||"scale_x"in t||"scale_y"in t||"rotate"in t)&&(a.x=Number(this.val.getVal(`tmp:${s}.x`)),a.y=Number(this.val.getVal(`tmp:${s}.y`)),a.sx=Number(this.val.getVal(`tmp:${s}.scale_x`)),a.sy=Number(this.val.getVal(`tmp:${s}.scale_y`)),a.r=Number(this.val.getVal(`tmp:${s}.rotate`))),"width"in t&&(a.w=this.val.getVal(`tmp:${s}.width`)),"height"in t&&(a.h=this.val.getVal(`tmp:${s}.height`));const h=(0,r.cnvTweenArg)(t,a),u={},c=(0,r.argChk_Num)(t,"repeat",1);let l=()=>{};"alpha"in t&&(u.a=(0,r.argChk_Num)(h,"alpha",0),l=()=>{i.style.opacity=a.a,this.val.setVal_Nochk("tmp","alpha",a.a)});let p=()=>{};const d=this.rect(h),f=this.sys.reso4frame*r.CmnLib.cvsScale;("x"in t||"y"in t||"scale_x"in t||"scale_y"in t||"rotate"in t)&&(u.x=d.x,u.y=d.y,u.sx=(0,r.argChk_Num)(h,"scale_x",1),u.sy=(0,r.argChk_Num)(h,"scale_y",1),u.r=(0,r.argChk_Num)(h,"rotate",0),p=()=>{i.style.left=this.sys.ofsLeft4frm+a.x*f+"px",i.style.top=this.sys.ofsTop4frm+a.y*f+"px",i.style.transform=`scale(${a.sx}, ${a.sy}) rotate(${a.r}deg)`,this.val.setVal_Nochk("tmp",s+".x",a.x),this.val.setVal_Nochk("tmp",s+".y",a.y),this.val.setVal_Nochk("tmp",s+".scale_x",a.sx),this.val.setVal_Nochk("tmp",s+".scale_y",a.sy),this.val.setVal_Nochk("tmp",s+".rotate",a.r)});let g=()=>{};"width"in t&&(u.w=d.width,g=()=>{i.width=a.w*f+"px",this.val.setVal_Nochk("tmp",s+".width",a.w)});let m=()=>{};"height"in t&&(u.h=d.height,m=()=>{i.height=a.h*f+"px",this.val.setVal_Nochk("tmp",s+".height",a.h)}),this.appPixi.stage.interactive=!1;const _=`frm\n${t.id}`,v=new o.Tween(a).to(u,(0,r.argChk_Num)(t,"time",NaN)*(Boolean(this.val.getVal("tmp:sn.skip.enabled"))?0:1)).delay((0,r.argChk_Num)(t,"delay",0)).easing(n.CmnTween.ease(t.ease)).repeat(0===c?1/0:c-1).yoyo((0,r.argChk_Boolean)(t,"yoyo",!1)).onUpdate((()=>{l(),p(),g(),m()})).onComplete((()=>{this.appPixi.stage.interactive=!0;const t=this.hTwInf[_];t&&(delete this.hTwInf[_],t.tw?.stop(),t.resume&&this.main.resume(),t.onEnd?.())}));if("chain"in t){const e=this.hTwInf[t.chain??""];if(!e||!e.tw)throw`${t.chain}`;delete e.onEnd,e.tw.chain(v)}else v.start();return this.hTwInf[_]={tw:v,resume:!1},!1}}},5785:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Grammar=e.splitAmpersand=e.tagToken2Name=e.tagToken2Name_Args=e.REG_TAG=void 0;const r=i(8911);e.REG_TAG=/(?<name>[^\s;\]]+)/,e.tagToken2Name_Args=function(t){const i=e.REG_TAG.exec(t.slice(1,-1))?.groups;if(!i)throw`${t}()`;const r=i.name;return[r,t.slice(1+r.length,-1)]},e.tagToken2Name=function(t){const i=e.REG_TAG.exec(t.slice(1))?.groups;if(!i)throw`${t}()`;return i.name},e.splitAmpersand=function(t){const e=t.replaceAll("==","").replaceAll("!=","").split("="),i=e.length;if(i<2||i>3)throw"&=";if("&"===e[1].charAt(0))throw"&&";return{name:e[0].replaceAll("","==").replaceAll("","!="),text:e[1].replaceAll("","==").replaceAll("","!="),cast:3===i?e[2].trim():null}},e.Grammar=class{constructor(){this.regC2M=new RegExp(""),this.regStrC2M="",this.regStrC2M4not="",this.replaceScr_C2M_And_let_ml=(t,e=0)=>{if(this.hC2M){for(let i=t.len-1;i>=e;--i){const e=t.aToken[i];if(this.REG_TOKEN_NOTXT.lastIndex=0,this.REG_TOKEN_NOTXT.test(e.charAt(0)))continue;const r=t.aLNum[i],n=e.match(this.regC2M);if(!n)continue;let s=1;for(let e=n.length-1;e>=0;--e){let o=n[e];const a=this.hC2M[o.charAt(0)];a&&(o=a+("]"===a.slice(-1)?"":`'${o.slice(1,-1)}']`)),t.aToken.splice(i,s,o),t.aLNum.splice(i,s,r),s=0}}t.len=t.aToken.length}},this.setEscape("")}setEscape(t){if(this.hC2M&&t in this.hC2M)throw"[] char"+t+"";this.REG_TOKEN=new RegExp((t?`\\${t}\\S|`:"")+"\\n+|\\t+|\\[let_ml\\s+[^\\]]+\\].+?(?=\\[endlet_ml[\\]\\s])|\\[(?:[^\"'#;\\]]+|([\"'#]).*?\\1|;[^\\n]*)*?]|;[^\\n]*|&[^&\\n]+&|&&?[^;\\n\\t&]+|^\\*\\w+"+`|[^\\n\\t\\[;${t?`\\${t}`:""}]+`,"gs"),r.RubySpliter.setEscape(t),this.REG_CANTC2M=new RegExp(`[\\w\\s;[\\]*=&${t?`\\${t}`:""}]`),this.REG_TOKEN_NOTXT=new RegExp(`[\\n\\t;\\[*&${t?`\\${t}`:""}]`)}bracket2macro(t,e,i){const r=t.name;if(!r)throw"[bracket2macro] name";const n=t.text;if(!n)throw"[bracket2macro] text";if(2!==n.length)throw"[bracket2macro] text";this.hC2M??={};const s=n.charAt(0),o=n.charAt(1);if(s in this.hC2M)throw"[bracket2macro] text"+s+"";if(o in this.hC2M)throw"[bracket2macro] text"+o+"";if(this.REG_CANTC2M.lastIndex=0,this.REG_CANTC2M.test(s))throw"[bracket2macro] text"+s+"";if(this.REG_CANTC2M.lastIndex=0,this.REG_CANTC2M.test(o))throw"[bracket2macro] text"+o+"";this.hC2M[o]="0",this.hC2M[s]=`[${r} text=`,this.addC2M(`\\${s}[^\\${o}]*\\${o}`,`\\${s}\\${o}`),this.replaceScr_C2M_And_let_ml(e,i)}char2macro(t,e,i,r){const n=t.char;if(!n)throw"[char2macro] char";if(this.hC2M??={},n in this.hC2M)throw"[char2macro] char"+n+"";if(this.REG_CANTC2M.lastIndex=0,this.REG_CANTC2M.test(n))throw"[char2macro] char"+n+"";const s=t.name;if(!s)throw"[char2macro] name";if(!(s in e))throw`[char2macro] [${s}]`;this.hC2M[n]=`[${s}]`,this.addC2M(`\\${n}`,`\\${n}`),this.replaceScr_C2M_And_let_ml(i,r)}addC2M(t,e){this.regStrC2M+=`${t}|`,this.regStrC2M4not+=`${e}`,this.regC2M=new RegExp(`(${this.regStrC2M}[^${this.regStrC2M4not}]+)`,"g")}}},7007:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GrpLayer=void 0;const r=i(1481),n=i(4965),s=i(3422),o=i(6841),a=i(5097),h=i(4412);class u extends r.Layer{constructor(){super(),this.idc=new h.GrpLayDesignCast(this.spLay,this),this.csvFn="",this.sBkFn="",this.sBkFace="",this.lay=t=>this.laySub(t,(t=>{t&&u.main.resume()})),this.record=()=>Object.assign(super.record(),{sBkFn:this.sBkFn,sBkFace:this.sBkFace,idc_hArg:this.idc.gethArg()}),this.dump=()=>super.dump()+`, "pic":"${this.csvFn}"`,n.CmnLib.isDbg&&(this.setSp=t=>this.idc.setSp(t),this.cvsResize=()=>{super.cvsResize(),this.idc.cvsResize()})}static init(t,e,i,r){u.main=t,u.cfg=e,u.sys=i;const n=()=>{const t=u.glbVol*u.movVol;for(const e in u.hFn2VElm)u.hFn2VElm[e].volume=t};r.setNoticeChgVolume((t=>{u.glbVol=t,n()}),(t=>{u.movVol=t,n()})),u.sys.crypto&&(u.dec2cache=u.dec2cache4Cripto)}static setEvtMng(t){u.evtMng=t}static destroy(){u.elc.clear(),u.hFace={},u.hFn2ResAniSpr={},u.hFn2VElm={}}setSp(t){}laySub(t,e){const i=t.fn,s=t.face??"";if(this.idc.sethArg(t),!i)return super.lay(t),this.spLay.children.length>0&&this.setPos(t),this.sBkFn="",this.csvFn=this.sBkFace=s,e(!1),!1;const o="fn"in t,a="face"in t;this.clearLay({filter:"true"}),o&&(this.sBkFn=i),a&&(this.sBkFace=s),super.lay(t),t.dx=0,t.dy=0;const h=u.csv2Sprites(this.csvFn=i+(s?","+s:""),this.spLay,(e=>{("width"in t||"height"in t)&&(e.width=(0,n.argChk_Num)(t,"width",0),e.height=(0,n.argChk_Num)(t,"height",0)),r.Layer.setXY(e,t,this.spLay,!0),this.setSp(e)}),(i=>{r.Layer.setBlendmode(this.spLay,t),e(i)}));return h||e(!1),h}static csv2Sprites(t,e,i,r=(()=>{})){let n=!1;if("data:"===t.slice(0,5)){const s=()=>{const s=o.Sprite.from(t);e?.addChild(s),i(s),r(n)};return t in o.utils.TextureCache?s():(n=!0,(new o.Loader).add(t,t).load(s)),n}const a=[],h=new o.Loader;t.split(",").forEach(((t,e)=>{if(!t)throw"face";const r=u.hFace[t]||{fn:t,dx:0,dy:0,blendmode:o.BLEND_MODES.NORMAL},c=0===e?i:t=>{t.x=r.dx,t.y=r.dy,t.blendMode=r.blendmode};if(a.push({fn:r.fn,fnc:c}),r.fn in u.hFn2ResAniSpr)return;if(r.fn in o.utils.TextureCache)return;if(r.fn in o.Loader.shared.resources)return;n=!0;const l=u.cfg.searchPath(r.fn,s.Config.EXT_SPRITE),p=this.sys.crypto?{xhrType:".json"===l.slice(-5)?o.LoaderResource.XHR_RESPONSE_TYPE.TEXT:o.LoaderResource.XHR_RESPONSE_TYPE.BUFFER}:{};h.add({...p,name:r.fn,url:l})}));const c=t=>{for(const i of a){const r=u.mkSprite(i.fn,t);e?.addChild(r),i.fnc(r)}r(n)};return n?h.use(((t,e)=>{this.sys.dec(t.extension,t.data).then((i=>u.dec2cache(i,t,(()=>e?.())))).catch((e=>this.main.errScript(`Graphic  fn:${t.name} ${e}`,!1)))})).load(((t,e)=>c(e))):c({}),n}static sortAFrameName(t){const e=/([^\d]+)\d+\.(\w+)/.exec(t[0]);if(!e)return;const i=e[1].length,r=-e[2].length-1;t.sort(((t,e)=>(0,n.int)(t.slice(i,r))>(0,n.int)(e.slice(i,r))?1:-1))}static dec2cache4Cripto(t,e,i){if(e.data=t,"bin"===e.extension&&(t instanceof HTMLImageElement?(e.texture=o.Texture.fromLoader(t,e.url,e.name),e.type=o.LoaderResource.TYPE.IMAGE,URL.revokeObjectURL(t.src)):t instanceof HTMLVideoElement&&(t.volume=u.glbVol,u.hFn2VElm[e.name]=t,e.type=o.LoaderResource.TYPE.VIDEO,URL.revokeObjectURL(t.src))),"json"!==e.extension)return void i();if("string"!=typeof t)return void i();const r=e.data=JSON.parse(t);if(e.type=o.LoaderResource.TYPE.JSON,!r.meta?.image)return void i();const a=(0,n.getFn)(r.meta.image),h=u.cfg.searchPath(a,s.Config.EXT_SPRITE);(new o.Loader).use(((t,e)=>{this.sys.dec(t.extension,t.data).then((i=>{t.data=i,i instanceof HTMLImageElement&&(t.type=o.LoaderResource.TYPE.IMAGE,URL.revokeObjectURL(i.src)),e?.()})).catch((e=>this.main.errScript(`Graphic  dec2res4Cripto fn:${t.name} ${e}`,!1)))})).add({name:a,url:h,xhrType:o.LoaderResource.XHR_RESPONSE_TYPE.BUFFER}).load(((t,n)=>{for(const i in t.resources){const n=o.Texture.from(t.resources[i].data).baseTexture,s=Object.values(r.frames);u.sortAFrameName(s),u.hFn2ResAniSpr[e.name]={aTex:s.map((t=>new o.Texture(n,new o.Rectangle(t.frame.x,t.frame.y,t.frame.w,t.frame.h)))),meta:r.meta}}i()}))}static mkSprite(t,e){const i=u.hFn2ResAniSpr[t];if(i){const t=new o.AnimatedSprite(i.aTex);return t.animationSpeed=i.meta.animationSpeed??1,t.play(),t}return t in o.utils.TextureCache?o.Sprite.from(t):t in u.hFn2VElm?o.Sprite.from(u.hFn2VElm[t]):t in e?new o.Sprite(e[t].texture):new o.Sprite}static wv(t){const e=t.fn;if(!e)throw"fn";const i=u.hFn2VElm[e];if(!i||i.loop)return!1;if(i.ended)return delete u.hFn2VElm[e],!1;const r=()=>{i.removeEventListener("ended",r),delete u.hFn2VElm[e],this.main.resume()};return i.addEventListener("ended",r,{once:!0,passive:!0}),u.evtMng.waitEvent((()=>{i.pause(),r()}),(0,n.argChk_Boolean)(t,"canskip",!0),(0,n.argChk_Boolean)(t,"global",!1))}setPos(t){r.Layer.setXY(0===this.spLay.children.length?this.spLay:this.spLay.children[0],t,this.spLay,!0)}static add_face(t){const e=t.name;if(!e)throw"name";if(e in u.hFace)throw"name"+e+"";const i=t.fn??e;return u.hFace[e]={fn:i,dx:(0,n.argChk_Num)(t,"dx",0)*n.CmnLib.retinaRate,dy:(0,n.argChk_Num)(t,"dy",0)*n.CmnLib.retinaRate,blendmode:r.Layer.getBlendmodeNum(t.blendmode||"")},!1}static clearFace2Name(){u.hFace={}}clearLay(t){super.clearLay(t);for(const t of this.spLay.removeChildren())t.destroy();this.sBkFn="",this.sBkFace="",this.csvFn=""}playback(t,e){if(super.playback(t,e),""===t.sBkFn&&""===t.sBkFace)return this.sBkFn=t.sBkFn,this.sBkFace=t.sBkFace,void this.idc.sethArg(t.idc_hArg);e.push(new Promise((e=>this.laySub({fn:t.sBkFn,face:t.sBkFace,left:t.x,top:t.y,alpha:t.alpha,blendmode:t.blendMode,rotation:t.rotation,scale_x:t.scale_x,scale_y:t.scale_y},(i=>{this.spLay.position.set(t.x,t.y),e()})))))}makeDesignCast(t){this.spLay.visible&&t(this.idc)}cvsResize(){super.cvsResize()}showDesignCast(){this.idc.visible=!0}}e.GrpLayer=u,u.elc=new a.EventListenerCtn,u.hFace={},u.glbVol=1,u.movVol=1,u.hFn2ResAniSpr={},u.dec2cache=(t,e,i)=>{switch(e.type){case o.LoaderResource.TYPE.JSON:const t=e.spritesheet._frameKeys;u.sortAFrameName(t),u.hFn2ResAniSpr[e.name]={aTex:t.map((t=>o.Texture.from(t))),meta:e.data.meta};break;case o.LoaderResource.TYPE.VIDEO:const i=e.data;i.volume=u.glbVol,u.hFn2VElm[e.name]=i}i()},u.hFn2VElm={}},1481:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Layer=void 0;const r=i(6841),n=i(4965);class s{constructor(){this.layname="",this.name_="",this.spLay=new r.Sprite(r.Texture.EMPTY)}set name(t){this.name_=t}get name(){return this.name_}get alpha(){return this.spLay.alpha}set alpha(t){this.spLay.alpha=t}get height(){return this.spLay.height}get rotation(){return this.spLay.angle}set rotation(t){this.spLay.angle=t}get scale_x(){return this.spLay.scale.x}set scale_x(t){this.spLay.scale.x=t}get scale_y(){return this.spLay.scale.y}set scale_y(t){this.spLay.scale.y=t}get width(){return this.spLay.width}get x(){return this.spLay.x}set x(t){this.spLay.x=t}get y(){return this.spLay.y}set y(t){this.spLay.y=t}destroy(){}lay(t){return"alpha"in t&&(this.spLay.alpha=(0,n.argChk_Num)(t,"alpha",1)),s.setBlendmode(this.spLay,t),("pivot_x"in t||"pivot_y"in t)&&this.spLay.pivot.set((0,n.argChk_Num)(t,"pivot_x",this.spLay.pivot.x),(0,n.argChk_Num)(t,"pivot_y",this.spLay.pivot.y)),"rotation"in t&&(this.spLay.angle=(0,n.argChk_Num)(t,"rotation",0)),("scale_x"in t||"scale_y"in t)&&this.spLay.scale.set((0,n.argChk_Num)(t,"scale_x",this.spLay.scale.x),(0,n.argChk_Num)(t,"scale_y",this.spLay.scale.y)),"visible"in t&&(this.spLay.visible=(0,n.argChk_Boolean)(t,"visible",!0)),!1}static setBlendmode(t,e){const i=e.blendmode;if(!i)return;const r=s.getBlendmodeNum(i);t&&(t.blendMode=r),t.children.forEach((t=>{t&&(t.blendMode=r)}))}static getBlendmodeNum(t){if(!t)return r.BLEND_MODES.NORMAL;const e=s.hBlendmode[t];if(void 0!==e)return e;throw`${t}  blendmode `}clearLay(t){this.spLay.alpha=1,this.spLay.blendMode=r.BLEND_MODES.NORMAL,this.spLay.pivot.set(0,0),this.spLay.angle=0,this.spLay.scale.set(1,1),(0,n.argChk_Boolean)(t,"filter",!1)&&(this.spLay.filters=[])}copy(t,e){const i=this.name_;this.playback(t.record(),e),this.name=i}record(){return{name:this.name_,idx:this.spLay.parent.getChildIndex(this.spLay),alpha:this.spLay.alpha,blendMode:this.spLay.blendMode,rotation:this.spLay.angle,scale_x:this.spLay.scale.x,scale_y:this.spLay.scale.y,pivot_x:this.spLay.pivot.x,pivot_y:this.spLay.pivot.y,x:this.spLay.x,y:this.spLay.y,visible:this.spLay.visible}}playback(t,e){this.name=t.name,this.clearLay({filter:"true"}),this.spLay.alpha=t.alpha,this.spLay.blendMode=t.blendMode,this.spLay.angle=t.rotation,this.spLay.scale.set(t.scale_x,t.scale_y),this.spLay.pivot.set(t.pivot_x,t.pivot_y),this.spLay.position.set(t.x,t.y),this.spLay.visible=t.visible}snapshot(t,e){t.render(this.spLay,{clear:!1}),e()}snapshot_end(){}makeDesignCast(t){}makeDesignCastChildren(t){}showDesignCast(){}showDesignCastChildren(){}cvsResize(){}cvsResizeChildren(){}dump(){return` "idx":${this.spLay.parent.getChildIndex(this.spLay)}, "visible":"${this.spLay.visible}", "left":${this.spLay.x}, "top":${this.spLay.y}, "alpha":${this.spLay.alpha}, "rotation":${this.spLay.angle}, "name":"${this.name_}", "scale_x":${this.spLay.scale.x}, "scale_y":${this.spLay.scale.y}`}static setXY(t,e,i,r=!1,o=!1){if(e.pos)return void s.setXYByPos(t,e.pos,i);const a=t.getBounds(),h=i.scale.x<0?-i.scale.x:i.scale.x,u=1===h?a.width:a.width*h,c=i.scale.y<0?-i.scale.y:i.scale.y,l=1===c?a.height:a.height*c;let p=i.x;"left"in e?(p=(0,n.argChk_Num)(e,"left",0),p>-1&&p<1&&(p*=n.CmnLib.stageW)):"center"in e?(p=(0,n.argChk_Num)(e,"center",0),p>-1&&p<1&&(p*=n.CmnLib.stageW),p-=(o?u/3:u)/2):"right"in e?(p=(0,n.argChk_Num)(e,"right",0),p>-1&&p<1&&(p*=n.CmnLib.stageW),p-=o?u/3:u):"s_right"in e&&(p=(0,n.argChk_Num)(e,"s_right",0),p>-1&&p<1&&(p*=n.CmnLib.stageW),p=n.CmnLib.stageW-p-(o?u/3:u)),i.x=(0,n.int)((i.scale.x<0?p+(o?u/3:u):p)*n.CmnLib.retinaRate);let d=i.y;"top"in e?(d=(0,n.argChk_Num)(e,"top",0),d>-1&&d<1&&(d*=n.CmnLib.stageH)):"middle"in e?(d=(0,n.argChk_Num)(e,"middle",0),d>-1&&d<1&&(d*=n.CmnLib.stageH),d-=l/2):"bottom"in e?(d=(0,n.argChk_Num)(e,"bottom",0),d>-1&&d<1&&(d*=n.CmnLib.stageH),d-=l):"s_bottom"in e&&(d=(0,n.argChk_Num)(e,"s_bottom",0),d>-1&&d<1&&(d*=n.CmnLib.stageH),d=n.CmnLib.stageH-d-l),i.y=(0,n.int)((i.scale.y<0?d+l:d)*n.CmnLib.retinaRate),r&&("left"in e||"center"in e||"right"in e||"s_right"in e||"top"in e||"middle"in e||"bottom"in e||"s_bottom"in e||s.setXYByPos(t,"c",i))}static setXYByPos(t,e,i){if("stay"===e)return;if(null===t)throw"setXYByPos base === null";if(null===i)throw"setXYByPos result === null";const r=t.getBounds(),s=i.scale.x<0?-i.scale.x:i.scale.x,o=1===s?r.width:r.width*s,a=i.scale.y<0?-i.scale.y:i.scale.y,h=1===a?r.height:r.height*a;let u=0;u=e&&"c"!==e?"r"===e?n.CmnLib.stageW-.5*o:"l"===e?.5*o:(0,n.int)(e)*n.CmnLib.retinaRate:.5*n.CmnLib.stageW,i.x=(0,n.int)(u-.5*o),i.y=n.CmnLib.stageH-h,i.scale.x<0&&(i.x+=o),i.scale.y<0&&(i.y+=h)}static setXYCenter(t){const e=t.getBounds();t.x=.5*(n.CmnLib.stageW-e.width),t.y=.5*(n.CmnLib.stageH-e.height)}}e.Layer=s,s.hBlendmode={normal:r.BLEND_MODES.NORMAL,add:r.BLEND_MODES.ADD,multiply:r.BLEND_MODES.MULTIPLY,screen:r.BLEND_MODES.SCREEN}},5844:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LayerMng=void 0;const r=i(4965),n=i(8566),s=i(4040),o=i(7007),a=i(1028),h=i(8911),u=i(7411),c=i(9552),l=i(6761),p=i(4412),d=i(6194),f=i(6841);class g{constructor(t,e,i,n,s,h,u,g,m,_){this.cfg=t,this.hTag=e,this.appPixi=i,this.val=n,this.main=s,this.scrItr=h,this.sys=u,this.sndMng=g,this.alzTagArg=m,this.prpPrs=_,this.fore=new f.Container,this.back=new f.Container,this.fncTicker=()=>(0,d.update)(),this.hProcDbgRes={attach:t=>(p.DesignCast.leaveMode(),!1),continue:t=>(p.DesignCast.leaveMode(),!1),disconnect:t=>(p.DesignCast.leaveMode(),!1),_enterDesign:t=>(p.DesignCast.enterMode(),this.aLayName.forEach((t=>{const e=this.hPages[t].fore;e.makeDesignCastChildren((t=>t.make())),e.makeDesignCast((t=>t.make()))})),this.selectNode(this.curTxtlay),!1),_replaceToken:(t,e)=>(p.DesignCast.replaceToken(e),!1),_selectNode:(t,e)=>(this.selectNode(e.node),!1)},this.modeLn="",this.modeLnSub="",this.getFrmDisabled=t=>this.frmMng.getFrmDisabled(t),this.grpCover=null,this.cmdTxt=(t,e=this.getCurrentTxtlayForeNeedErr(),i=!0)=>e.tagCh(""+t+""),this.goTxt=()=>{},this.breakLine=()=>{},this.breakPage=()=>{},this.hPages={},this.aLayName=[],this.curTxtlay="",this.firstGrplay="",this.srcRuleTransFragment="\nprecision mediump float;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform sampler2D rule;\nuniform float vague;\nuniform float tick;\n\nuniform vec4 inputPixel;\nuniform highp vec4 outputFrame;\nvec2 getUV(vec2 coord) {\n\treturn coord * inputPixel.xy / outputFrame.zw;\n}\n\nvoid main(void) {\n\tvec4 fg = texture2D(uSampler, vTextureCoord);\n\tvec4 ru = texture2D(rule, getUV(vTextureCoord));\n\n\tfloat v = ru.r - tick;\n\tif (abs(v) < vague) {\n\t\tfloat f_a = fg.a *(0.5 +v /vague *0.5);\n\n\t\tgl_FragColor.rgb = fg.rgb *f_a;\n\t\tgl_FragColor.a = f_a;\n\t}\n\telse {\n\t\tgl_FragColor = (v >= 0.0)? fg : vec4(0);\n\t}\n}",this.ufRuleTrans={rule:f.Texture.EMPTY,vague:0,tick:0},this.fltRule=new f.Filter(void 0,this.srcRuleTransFragment,this.ufRuleTrans),this.rtTransBack=f.RenderTexture.create({width:r.CmnLib.stageW,height:r.CmnLib.stageH}),this.spTransBack=new f.Sprite(this.rtTransBack),this.rtTransFore=f.RenderTexture.create({width:r.CmnLib.stageW,height:r.CmnLib.stageH}),this.spTransFore=new f.Sprite(this.rtTransFore),this.aBackTransAfter=[],this.tiTrans={tw:null,resume:!1},this.hTwInf={},this.getTxtLayer=t=>{throw this.fncChkTxtLay(),0},this.current=t=>{throw this.fncChkTxtLay(),0},this.fncChkTxtLay=()=>{throw"[add_lay layer= class=txt]"},this.oLastPage={text:""},this.aPageLog=[];const v=document.getElementById(r.CmnLib.SN_ID),y=()=>{r.CmnLib.cvsResize(v)&&(this.cvsResizeDesign(),this.modeLnSub?this.aLayName.forEach((t=>this.hPages[t].fore.cvsResizeChildren())):this.aLayName.forEach((t=>this.hPages[t].fore.cvsResize())),this.frmMng.cvsResize())};if(r.CmnLib.isMobile)globalThis.addEventListener("orientationchange",y,{passive:!0});else{let t=0;globalThis.addEventListener("resize",(()=>{t||(t=setTimeout((()=>{t=0,y()}),500))}),{passive:!0})}r.CmnLib.cvsResize(v),a.TxtLayer.init(t,e,n,(t=>this.recText(t)),(t=>this.hPages[t.layname].fore===t)),o.GrpLayer.init(s,t,u,g),l.Button.init(t),this.frmMng=new c.FrameMng(this.cfg,this.hTag,this.appPixi,this.val,s,this.sys,this.hTwInf),u.hFactoryCls.grp=()=>new o.GrpLayer,u.hFactoryCls.txt=()=>new a.TxtLayer,e.loadplugin=t=>this.loadplugin(t),e.snapshot=t=>this.snapshot(t),e.add_lay=t=>this.add_lay(t),e.clear_lay=t=>this.clear_lay(t),e.finish_trans=()=>this.finish_trans(),e.lay=t=>this.lay(t),e.trans=t=>this.trans(t),e.wt=t=>this.wt(t),e.quake=t=>this.quake(t),e.stop_quake=t=>e.finish_trans(t),e.wq=t=>e.wt(t),e.pause_tsy=t=>this.pause_tsy(t),e.resume_tsy=t=>this.resume_tsy(t),e.stop_tsy=t=>this.stop_tsy(t),e.tsy=t=>this.tsy(t),e.wait_tsy=t=>this.wait_tsy(t),e.ch=t=>this.ch(t),e.clear_text=t=>this.clear_text(t),e.current=t=>this.current(t),e.endlink=t=>this.endlink(t),e.er=t=>this.er(t),e.graph=t=>this.graph(t),e.link=t=>this.link(t),e.r=t=>this.r(t),e.rec_ch=t=>this.rec_ch(t),e.rec_r=()=>this.rec_r(),e.reset_rec=t=>this.reset_rec(t),e.ruby2=t=>this.ruby2(t),e.span=t=>this.span(t),e.tcy=t=>this.tcy(t),e.add_face=t=>o.GrpLayer.add_face(t),e.wv=t=>o.GrpLayer.wv(t),e.dump_lay=t=>this.dump_lay(t),e.enable_event=t=>this.enable_event(t),e.button=t=>this.button(t),t.existsBreakline&&(this.breakLine=()=>this.cmdTxt('grp{"id":"break","pic":"breakline"}')),t.existsBreakpage&&(this.breakPage=()=>this.cmdTxt('grp{"id":"break","pic":"breakpage"}'));const b=new f.Graphics;b.beginFill(t.oCfg.init.bg_color,1),b.lineStyle(0,t.oCfg.init.bg_color),b.drawRect(0,0,r.CmnLib.stageW,r.CmnLib.stageH),b.endFill(),this.fore.addChild(b.clone()),this.back.addChild(b),this.back.visible=!1,this.stage=this.appPixi.stage,this.stage.addChild(this.back),this.stage.addChild(this.fore),this.stage.addChild(this.spTransBack),this.stage.addChild(this.spTransFore),this.appPixi.ticker.add(this.fncTicker);const x=(t,e)=>{this.foreachRedrawTxtLayBack(Number(e))};x(0,n.getVal("sys:TextLayer.Back.Alpha",1)),n.defValTrg("sys:TextLayer.Back.Alpha",x);const E=(t,e)=>l.Button.fontFamily=e;E(0,n.getVal("tmp:sn.button.fontFamily",l.Button.fontFamily)),n.defValTrg("tmp:sn.button.fontFamily",E),n.defTmp("const.sn.log.json",(()=>JSON.stringify(this.oLastPage.text?[...this.aPageLog,this.oLastPage]:this.aPageLog))),n.defTmp("const.sn.last_page_text",(()=>this.getCurrentTxtlayFore()?.pageText??"")),r.CmnLib.isDbg&&(p.DesignCast.init(this.appPixi,u,h,_,m,this.cfg,this.hPages),this.cvsResizeDesign=()=>p.DesignCast.cvsResizeDesign(),u.addHook(((t,e)=>{this.hProcDbgRes[t]?.(t,e)&&delete this.hProcDbgRes[t]})))}cvsResizeDesign(){}selectNode(t){[this.modeLn,this.modeLnSub=""]=t.split("/");const e=this.hPages[this.modeLn];e&&(p.DesignCast.allHide(),this.modeLnSub?e.fore.showDesignCastChildren():e.fore.showDesignCast())}cover(t,e=0){this.grpCover&&(this.stage.removeChild(this.grpCover),this.grpCover.destroy(),this.grpCover=null),t&&(this.grpCover=new f.Graphics,this.grpCover.beginFill(e),this.grpCover.lineStyle(0,e),this.grpCover.drawRect(0,0,r.CmnLib.stageW,r.CmnLib.stageH),this.grpCover.endFill(),this.stage.addChild(this.grpCover))}setEvtMng(t){this.evtMng=t,this.frmMng.setEvtMng(t),o.GrpLayer.setEvtMng(t)}before_destroy(){for(const t in this.hPages)this.hPages[t].destroy()}destroy(){o.GrpLayer.destroy(),h.RubySpliter.destroy(),u.TxtStage.destroy(),this.frmMng.destroy(),(0,d.removeAll)(),this.appPixi.ticker.remove(this.fncTicker),g.$msecChWait=10}foreachRedrawTxtLayBack(t){this.getLayers().forEach((e=>{const i=this.hPages[e];i.fore instanceof a.TxtLayer&&(i.fore.chgBackAlpha(t),i.back.chgBackAlpha(t))}))}clearBreak(){this.getCurrentTxtlayFore()&&(this.clearBreak=()=>this.cmdTxt("delbreak"),this.clearBreak())}clickTxtLay(){if(!this.getCurrentTxtlayFore())return;const t=this.getLayers(),e=t.length;for(let i=0;i<e;++i){const e=t[i],r=this.hPages[e];if(r.fore instanceof a.TxtLayer&&!r.fore.click())break}}snapshot(t){const e=t.fn?"userdata:/"===t.fn.slice(0,10)?t.fn:`downloads:/${t.fn+(0,r.getDateStr)("-","_","","_")}.png`:`downloads:/snapshot${(0,r.getDateStr)("-","_","","_")}.png`,i=this.cfg.searchPath(e);if(this.sys.canCapturePage(i))return!1;const n=(0,r.getExt)(i),s=t.b_color??this.cfg.oCfg.init.bg_color,o=(0,f.autoDetectRenderer)({width:(0,r.argChk_Num)(t,"width",r.CmnLib.stageW),height:(0,r.argChk_Num)(t,"height",r.CmnLib.stageH),backgroundAlpha:s>16777216&&"png"===n?0:1,antialias:(0,r.argChk_Boolean)(t,"smoothing",!1),preserveDrawingBuffer:!0,backgroundColor:16777215&(0,r.uint)(s),autoDensity:!0}),a=[],h="back"!==t.page?"fore":"back";return this.tiTrans.tw?a.push(new Promise((t=>{this.back.visible=!0,this.aBackTransAfter.forEach((t=>o.render(t,{clear:!1}))),this.back.visible=!1,this.spTransBack.visible=!0,this.fore.filters=this.spTransFore.filters,this.fore.visible=!0,o.render(this.fore,{clear:!1}),this.fore.visible=!1,this.fore.filters=[],t()}))):this.getLayers(t.layer).forEach((t=>a.push(new Promise((e=>this.hPages[t][h].snapshot(o,(()=>e()))))))),Promise.all(a).then((async()=>{const e=f.RenderTexture.create({width:o.width,height:o.height,transform:!0});o.render(this.stage,{renderTexture:e}),await this.sys.savePic(i,o.plugins.extract.base64(f.Sprite.from(e))),this.tiTrans.tw||this.getLayers(t.layer).forEach((t=>this.hPages[t][h].snapshot_end())),o.destroy(!0)})),!1}loadplugin(t){const e=t.fn;if(!e)throw"fn";const i=(0,r.argChk_Boolean)(t,"join",!0);if("css"!==(0,r.getExt)(e))throw"";return(async()=>{const t=await fetch(e);if(!t.ok)throw new Error("Network response was not ok.");(0,r.addStyle)(await t.text()),i&&this.main.resume()})(),i}add_lay(t){const e=t.layer;if(!e)throw"layer";if(e.includes(","))throw"layer,";if(e in this.hPages)throw`layer${e}`;const i=t.class;if(!i)throw"cls";const r={isWait:!1};switch(this.hPages[e]=new s.Pages(e,i,this.fore,this.back,t,this.sys,this.val,r),this.aLayName.push(e),i){case"txt":this.curTxtlay||(this.fncChkTxtLay=()=>{},this.getTxtLayer=this.$getTxtLayer,this.current=this.$current,this.hTag.current({layer:e}),this.goTxt=()=>{this.val.getVal("sn.skip.enabled")?g.$msecChWait=0:this.setNormalWaitTxtLayer(),this.getLayers().forEach((t=>{const e=this.hPages[t];e.fore instanceof a.TxtLayer&&this.cmdTxt("gotxt",e.fore,!1)}))}),this.val.setVal_Nochk("save","const.sn.layer."+(e??this.curTxtlay)+".enabled",!0);break;case"grp":if(this.firstGrplay)break;this.firstGrplay=e}return this.scrItr.recodeDesign(t),r.isWait}lay(t){const e=this.argChk_layer(t),i=this.hPages[e],n=i.back.spLay,s=i.fore.spLay;if((0,r.argChk_Boolean)(t,"float",!1))this.back.setChildIndex(n,this.back.children.length-1),this.fore.setChildIndex(s,this.fore.children.length-1),this.rebuildLayerRankInfo();else if(t.index)(0,r.argChk_Num)(t,"index",0)&&(this.back.setChildIndex(n,(0,r.uint)(t.index)),this.fore.setChildIndex(s,(0,r.uint)(t.index)),this.rebuildLayerRankInfo());else if(t.dive){const i=t.dive;let r=0;if(e===i)throw"[lay]  layerdive"+i+"";const o=this.hPages[i];if(!o)throw"[lay]  dive"+i+"";const a=o.back,h=o.fore,u=this.back.getChildIndex(a.spLay),c=this.fore.getChildIndex(h.spLay);r=u<c?u:c,r>this.back.getChildIndex(n)&&--r,this.fore.setChildIndex(s,r),this.back.setChildIndex(n,r),this.rebuildLayerRankInfo()}return t[":id_tag"]=i.fore.name.slice(0,-7),this.scrItr.recodeDesign(t),i.lay(t)}rebuildLayerRankInfo(){this.aLayName=this.sortLayers()}clear_lay(t){return this.foreachLayers(t,(e=>{const i=this.hPages[this.argChk_layer({layer:e})];"both"===t.page?(i.fore.clearLay(t),i.back.clearLay(t)):i.getPage(t).clearLay(t)})),!1}trans(t){this.finish_trans();const e=n.CmnTween.ease(t.ease);this.aBackTransAfter=[];const i={};this.getLayers(t.layer).forEach((t=>i[t]=!0)),this.getLayers().forEach((t=>this.aBackTransAfter.push(this.hPages[t][i[t]?"back":"fore"].spLay))),this.rtTransBack.resize(r.CmnLib.stageW,r.CmnLib.stageH),this.appPixi.renderer.render(this.back,{renderTexture:this.rtTransBack}),this.rtTransFore.resize(r.CmnLib.stageW,r.CmnLib.stageH),this.appPixi.renderer.render(this.fore,{renderTexture:this.rtTransFore});const s=()=>{this.back.visible=!0,this.aBackTransAfter.forEach((t=>{this.appPixi.renderer.render(t,{renderTexture:this.rtTransBack,clear:!1})})),this.back.visible=!1,this.spTransBack.visible=!0,this.fore.visible=!0,this.appPixi.renderer.render(this.fore,{renderTexture:this.rtTransFore}),this.fore.visible=!1,this.spTransFore.visible=!0};this.spTransFore.alpha=1;const a=()=>{this.appPixi.ticker&&this.appPixi.ticker.remove(s),[this.fore,this.back]=[this.back,this.fore];const t=[];for(const e in this.hPages){const r=this.hPages[e];if(i[e]){r.transPage(t);continue}const n=this.fore.getChildIndex(r.back.spLay);this.fore.removeChild(r.back.spLay),this.back.removeChild(r.fore.spLay),this.fore.addChildAt(r.fore.spLay,n),this.back.addChildAt(r.back.spLay,n)}Promise.allSettled(t),this.fore.visible=!0,this.back.visible=!1,this.spTransBack.visible=!1,this.spTransFore.visible=!1,this.tiTrans.tw?.stop(),this.tiTrans.resume&&this.main.resume(),this.tiTrans={tw:null,resume:!1}};this.tiTrans={tw:null,resume:!1};const h=(0,r.argChk_Num)(t,"time",0);if(0===h||this.evtMng.isSkipKeyDown())return a(),!1;const u="glsl"in t;if(!u&&!("rule"in t))return this.spTransFore.filters=[],this.tiTrans.tw=new d.Tween(this.spTransFore).to({alpha:0},h).delay((0,r.argChk_Num)(t,"delay",0)).easing(e).onComplete(a).start(),this.appPixi.ticker.add(s),!1;const c=u?new f.Filter(void 0,t.glsl,this.ufRuleTrans):this.fltRule;if(c.uniforms.vague=(0,r.argChk_Num)(t,"vague",.04),c.uniforms.tick=0,this.tiTrans.tw=new d.Tween(c.uniforms).to({tick:1},h).delay((0,r.argChk_Num)(t,"delay",0)).easing(e).onComplete(a),this.spTransFore.filters=[c],u)return this.tiTrans.tw.start(),this.appPixi.ticker.add(s),!1;if(!t.rule)throw"rule";return o.GrpLayer.csv2Sprites(t.rule,null,(t=>{c.uniforms.rule=t.texture,t.destroy(),this.tiTrans.tw?.start(),this.appPixi.ticker.add(s)})),!1}getLayers(t=""){return t?t.split(","):this.aLayName}foreachLayers(t,e){const i=this.getLayers(t.layer);return i.forEach((t=>{if(!t)return;const i=this.hPages[t];if(!i)throw"layer"+t+"";e(t,i)})),i}sortLayers(t=""){return this.getLayers(t).sort(((t,e)=>{const i=this.fore.getChildIndex(this.hPages[t].fore.spLay),r=this.fore.getChildIndex(this.hPages[e].fore.spLay);return i<r?-1:i>r?1:0}))}wt(t){return!!this.tiTrans.tw&&(this.tiTrans.resume=!0,this.evtMng.waitLimitedEvent(t,(()=>this.finish_trans())))}finish_trans(){return this.tiTrans.tw?.end(),!1}quake(t){if(this.finish_trans(),this.val.getVal("tmp:sn.skip.enabled"))return!1;if(this.evtMng.isSkipKeyDown())return!1;const e=[];this.getLayers(t.layer).forEach((t=>{e.push(this.hPages[t].fore.spLay)})),this.rtTransFore.resize(r.CmnLib.stageW,r.CmnLib.stageH);const i=()=>{this.fore.visible=!0,e.forEach((t=>this.appPixi.renderer.render(t,{renderTexture:this.rtTransFore,clear:!1}))),this.fore.visible=!1};this.spTransFore.visible=!0,this.spTransFore.alpha=1;const s=n.CmnTween.ease(t.ease),o=(0,r.uint)((0,r.argChk_Num)(t,"hmax",10)),a=(0,r.uint)((0,r.argChk_Num)(t,"vmax",10)),h=0===o?()=>{}:()=>this.spTransFore.x=Math.round(Math.random()*o*2)-o,u=0===a?()=>{}:()=>this.spTransFore.y=Math.round(Math.random()*a*2)-a;this.spTransFore.filters=[];const c=(0,r.argChk_Num)(t,"repeat",1),l=new d.Tween(this.spTransFore).to({x:0,y:0},(0,r.argChk_Num)(t,"time",NaN)).delay((0,r.argChk_Num)(t,"delay",0)).easing(s).onUpdate((()=>{h(),u()})).repeat(0===c?1/0:c-1).yoyo((0,r.argChk_Boolean)(t,"yoyo",!1)).onComplete((()=>{this.appPixi.ticker?.remove(i),this.fore.visible=!0,this.spTransFore.visible=!1,this.spTransFore.x=0,this.spTransFore.y=0,this.tiTrans.tw?.stop(),this.tiTrans.resume&&this.main.resume(),this.tiTrans={tw:null,resume:!1}})).start();return this.tiTrans={tw:l,resume:!1},this.appPixi.ticker.add(i),!1}tsy(t){if(!t.layer)throw"layer";const e=this.argChk_layer(t),i=this.hPages[e].fore,s=(0,r.cnvTweenArg)(t,i),o=(0,r.argChk_Num)(t,"repeat",1),a=t.name??t.layer,h=new d.Tween(i).to(s,(0,r.argChk_Num)(t,"time",NaN)*(Boolean(this.val.getVal("tmp:sn.skip.enabled"))?0:1)).delay((0,r.argChk_Num)(t,"delay",0)).easing(n.CmnTween.ease(t.ease)).repeat(0===o?1/0:o-1).yoyo((0,r.argChk_Boolean)(t,"yoyo",!1)).onComplete((()=>{const t=this.hTwInf[a];t&&(delete this.hTwInf[a],t.tw?.stop(),t.resume&&this.main.resume(),t.onEnd?.())}));if("chain"in t){const e=this.hTwInf[t.chain??""];if(!e?.tw)throw`${t.chain}`;delete e.onEnd,e.tw.chain(h)}else h.start();const u=(0,r.argChk_Boolean)(t,"arrive",!1),c=(0,r.argChk_Boolean)(t,"backlay",!1);return this.hTwInf[a]={tw:h,resume:!1,onEnd:()=>{if(u&&Object.assign(i,s),c){const t=this.hPages[e].back.spLay;for(const e in r.hMemberCnt)t[e]=i[e]}}},!1}wait_tsy(t){const e="id"in t?`frm\n${t.id}`:t.name??t.layer;if(!e)throw"";const i=this.hTwInf[e];return!!i?.tw&&(i.resume=this.evtMng.waitEvent((()=>i.tw?.end()),(0,r.argChk_Boolean)(t,"canskip",!0),(0,r.argChk_Boolean)(t,"global",!1)))}stop_tsy(t){const e="id"in t?`frm\n${t.id}`:t.name??t.layer;if(!e)throw"";return this.hTwInf[e]?.tw?.end(),!1}pause_tsy(t){const e="id"in t?`frm\n${t.id}`:t.name??t.layer;if(!e)throw"";return this.hTwInf[e]?.tw?.pause(),!1}resume_tsy(t){const e="id"in t?`frm\n${t.id}`:t.name??t.layer;if(!e)throw"";return this.hTwInf[e]?.tw?.resume(),!1}static get msecChWait(){return g.$msecChWait}static set msecChWait(t){g.$msecChWait=t}ch(t){const e=t.text;if(!e)throw"text";let i=(0,r.argChk_Num)(t,"wait",-1);i>0&&this.val.getVal("tmp:sn.skip.enabled")&&(i=0),t.wait=i;const n=this.getTxtLayer(t);delete t.text,i>=0&&this.cmdTxt("add"+JSON.stringify(t),n);const s=(0,r.argChk_Boolean)(t,"record",!0),o=this.val.doRecLog();return s||this.val.setVal_Nochk("save","sn.doRecLog",s),n.tagCh(e.replaceAll("[r]","\n")),s||this.val.setVal_Nochk("save","sn.doRecLog",o),i>=0&&this.cmdTxt("add_close",n),!1}$getTxtLayer(t){const e=this.argChk_layer(t,this.curTxtlay),i=this.hPages[e].getPage(t);if(!(i instanceof a.TxtLayer))throw e+"TxtLayer";return i}setNormalWaitTxtLayer(){g.$msecChWait=this.scrItr.normalWait}$current(t){const e=t.layer;if(!e)throw"[current] layer";if(this.pgTxtlay=this.hPages[e],!(this.pgTxtlay.getPage(t)instanceof a.TxtLayer))throw`${e}TxtLayer`;return this.recText("",!0),this.curTxtlay=e,this.val.setVal_Nochk("save","const.sn.mesLayer",e),this.getLayers().forEach((t=>{const i=this.hPages[t];i.fore instanceof a.TxtLayer&&(i.fore.isCur=i.back.isCur=t===e)})),!1}getCurrentTxtlayForeNeedErr(){return this.fncChkTxtLay(),this.getCurrentTxtlayFore()}getCurrentTxtlayFore(){if(this.pgTxtlay)return this.pgTxtlay.fore}argChk_layer(t,e=""){const i=t.layer??e;if(i.includes(","))throw"layer,";if(!(i in this.hPages))throw" layer"+i+"";return t.layer=i}recText(t,e=!1){const i=this.oLastPage;if(e)return i.text&&(i.text=String(i.text).replaceAll("</span><span class='sn_ch'>",""),this.aPageLog.push(i)>this.cfg.oCfg.log.max_len&&(this.aPageLog=this.aPageLog.slice(-this.cfg.oCfg.log.max_len))),void(this.oLastPage={text:""});i.text=t.replace(/\\`/,"`"),this.val.setVal_Nochk("save","const.sn.sLog",String(this.val.getVal("const.sn.log.json")))}clear_text(t){const e=this.getTxtLayer(t);return t.layer===this.curTxtlay&&"fore"===t.page&&this.recText("",!0),e.clearText(),!1}endlink(t){return this.cmdTxt("endlink",this.getTxtLayer(t)),!1}er(t){return(0,r.argChk_Boolean)(t,"rec_page_break",!0)&&this.recText("",!0),this.pgTxtlay&&(this.pgTxtlay.fore.clearLay(t),this.pgTxtlay.back.clearLay(t)),!1}graph(t){if(!t.pic)throw"[graph] pic";return t.text="grp"+JSON.stringify(t)+"",this.ch(t)}link(t){return t.style??="background-color: rgba(255,0,0,0.5);",t.style_hover??="background-color: rgba(255,0,0,0.9);",t.style_clicked??=t.style,this.cmdTxt("link"+JSON.stringify(t),this.getTxtLayer(t)),!1}r(t){return t.text="\n",this.ch(t)}rec_r(){return this.recText("\n"),!1}rec_ch(t){return this.oLastPage=t,this.recText(t.text??""),!1}reset_rec(t){return this.aPageLog=[],this.oLastPage={text:t.text??""},this.val.setVal_Nochk("save","const.sn.sLog",t.text?`[{text:"${t.text}"}]`:"[]"),!1}ruby2(t){const e=t.t;if(!e)throw"[ruby2] t";const i=t.r;if(!i)throw"[ruby2] r";return t.text=""+e+""+i+"",this.ch(t)}span(t){return this.cmdTxt("span"+JSON.stringify(t),this.getTxtLayer(t)),!1}tcy(t){if(!t.t)throw"[tcy] t";return t.text="tcy"+t.t+""+(t.r??"")+"",this.ch(t)}dump_lay(t){return console.group(" [dump_lay]"),this.getLayers(t.layer).forEach((t=>{const e=this.hPages[t];try{console.info(`%c${e.fore.name.slice(0,-7)} %o`,`color:#${r.CmnLib.isDarkMode?"49F":"05A"};`,JSON.parse(`{"back":{${e.back.dump()}}, "fore":{${e.fore.dump()}}}`))}catch(t){console.error("dump_lay err:%o",t),console.error(`   back:${e.back.dump()}`),console.error(`   fore:${e.fore.dump()}`)}})),console.groupEnd(),!1}enable_event(t){const e=this.argChk_layer(t,this.curTxtlay),i=(0,r.argChk_Boolean)(t,"enabled",!0);return this.getTxtLayer(t).enabled=i,this.val.setVal_Nochk("save","const.sn.layer."+e+".enabled",i),!1}button(t){return s.Pages.argChk_page(t,"back"),t.clicksebuf??="SYS",t.entersebuf??="SYS",t.leavesebuf??="SYS",t.fn||(t.fn=this.scrItr.scriptFn),this.getTxtLayer(t).addButton(t),this.scrItr.recodeDesign(t),!1}record(){const t={};return this.aLayName.forEach((e=>{const i=this.hPages[e];t[e]={cls:i.cls,fore:i.fore.record(),back:i.back.record()}})),t}playback(t,e){this.aPageLog=JSON.parse(String(this.val.getVal("save:const.sn.sLog"))),this.oLastPage={text:""};const i=[],r=[];for(const e in t){const n=t[e];r.push({layer:e,idx:n.fore.idx});const o=this.hPages[e]||=new s.Pages(e,n.cls,this.fore,this.back,{},this.sys,this.val,{isWait:!1});o.fore.playback(n.fore,i),o.back.playback(n.back,i)}const n=this.fore.children.length;Promise.allSettled(i).then((()=>{r.sort((function(t,e){return t.idx<e.idx?-1:t.idx>e.idx?1:0})),r.forEach((t=>{const e=this.hPages[t.layer];if(!e)return;const i=n>t.idx?t.idx:n-1;this.fore.setChildIndex(e.fore.spLay,i),this.back.setChildIndex(e.back.spLay,i)})),e()})).catch((t=>console.error("fn:LayerMng.ts playback e:%o",t)))}}e.LayerMng=g,g.$msecChWait=10},5681:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Main=void 0;const r=i(4965),n=i(3422),s=i(5785),o=i(6069),a=i(7177),h=i(7307),u=i(7408),c=i(3497),l=i(5844),p=i(8526),d=i(3690),f=i(6841);e.Main=class{constructor(t){this.sys=t,this.hTag=Object.create(null),this.fncNext=()=>{},this.alzTagArg=new o.AnalyzeTagArg,this.inited=!1,this.fncTicker=()=>this.fncNext(),this.fncresume=(t=this.runAnalyze)=>{this.destroyed||(this.layMng.clearBreak(),this.fncNext=t,this.resume=(t=this.runAnalyze)=>{this.fncNext=t},this.scrItr.noticeBreak(!1))},this.resume=this.fncresume,this.stop=()=>{this.fncNext=()=>{},this.resume=this.fncresume,this.scrItr.noticeBreak(!0)},this.isLoop=!0,this.destroyed=!1,this.isDestroyed=()=>this.destroyed,f.utils.skipHello(),n.Config.generate(t).then((t=>this.cfg=t)).then((()=>this.init())).catch((t=>console.error("load err fn:prj.json e:%o",t)))}async init(){const t={width:this.cfg.oCfg.window.width,height:this.cfg.oCfg.window.height,backgroundColor:this.cfg.oCfg.init.bg_color,resolution:globalThis.devicePixelRatio??1,autoResize:!0},e=document.getElementById(r.CmnLib.SN_ID);e&&(this.clone_cvs=e.cloneNode(!0),this.clone_cvs.id=r.CmnLib.SN_ID,t.view=e),this.appPixi=new f.Application(t),e||(document.body.appendChild(this.appPixi.view),this.appPixi.view.id=r.CmnLib.SN_ID),this.val=new u.Variable(this.cfg,this.hTag),this.prpPrs=new a.PropParser(this.val),await Promise.all(this.sys.init(this.hTag,this.appPixi,this.val,this)),this.hTag.title({text:this.cfg.oCfg.book.title||"SKYNovel"}),this.sndMng=new c.SoundMng(this.cfg,this.hTag,this.val,this,this.sys),this.scrItr=new d.ScriptIterator(this.cfg,this.hTag,this,this.val,this.alzTagArg,(()=>this.runAnalyze()),this.prpPrs,this.sndMng,this.sys),this.dbgMng=new h.DebugMng(this.sys,this.hTag,this.scrItr),this.layMng=new l.LayerMng(this.cfg,this.hTag,this.appPixi,this.val,this,this.scrItr,this.sys,this.sndMng,this.alzTagArg,this.prpPrs),this.evtMng=new p.EventMng(this.cfg,this.hTag,this.appPixi,this,this.layMng,this.val,this.sndMng,this.scrItr,this.sys),this.appPixi.ticker.add(this.fncTicker),this.resumeByJumpOrCall({fn:"main"}),this.inited=!0}errScript(t,e=!0){if(this.stop(),h.DebugMng.myTrace(t),r.CmnLib.debugLog&&console.log(" SKYNovel err!"),e)throw t}resumeByJumpOrCall(t){t.url?globalThis.open(t.url):(this.val.setVal_Nochk("tmp","sn.eventArg",t.arg??""),this.val.setVal_Nochk("tmp","sn.eventLabel",t.label??""),(0,r.argChk_Boolean)(t,"call",!1)?(this.scrItr.subIdxToken(),this.resume((()=>this.hTag.call(t)))):(this.hTag.clear_event({}),this.resume((()=>this.hTag.jump(t)))))}setLoop(t,e=""){(this.isLoop=t)?this.resume():this.stop(),this.sys.setTitleInfo(e?` -- ${e}`:"")}runAnalyze(){for(;this.isLoop;){let t=this.scrItr.nextToken();if(!t)break;const e=t.charCodeAt(0);if(9!==e)if(10!==e){if(91===e){if(this.scrItr.isBreak(t))return;try{const e=(t.match(/\n/g)??[]).length;if(e>0&&this.scrItr.addLineNum(e),this.scrItr.(t)){this.stop();break}continue}catch(e){if(e instanceof Error){const i=e;let r=` mes=${i.message}(${i.name})`;r=`[${(0,s.tagToken2Name)(t)}]`+r,this.errScript(r,!1)}else this.errScript(String(e),!1);return}}if(38===e)try{if("&"!==t.slice(-1)){if(this.scrItr.isBreak(t))return;const e=(0,s.splitAmpersand)(t.slice(1));e.name=this.prpPrs.getValAmpersand(e.name),e.text=String(this.prpPrs.parse(e.text)),this.hTag.let(e);continue}if("&"===t.charAt(1))throw new Error("&&&");t=String(this.prpPrs.parse(t.slice(1,-1)))}catch(t){return void this.errScript(t instanceof Error?`&  mes=${t.message}(${t.name})`:t,!1)}else{if(59===e)continue;if(42===e&&t.length>1)continue}try{this.layMng.getCurrentTxtlayForeNeedErr().tagCh(t)}catch(t){return void this.errScript(t instanceof Error?` mes=${t.message}(${t.name})`:t,!1)}}else this.scrItr.addLineNum(t.length)}}async destroy(t=0){this.destroyed||(this.destroyed=!0,this.inited&&(this.stop(),this.isLoop=!1,await this.layMng.before_destroy(),t>0&&await new Promise((e=>setTimeout(e,t))),this.hTag={},this.evtMng.destroy(),this.scrItr.destroy(),this.layMng.destroy(),this.dbgMng.destroy(),this.appPixi.ticker.remove(this.fncTicker),this.clone_cvs&&this.appPixi&&this.appPixi.view.parentElement.insertBefore(this.clone_cvs,this.appPixi.view),f.utils.clearTextureCache(),this.appPixi.destroy(!0)))}}},4040:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Pages=void 0;const r=i(4965);class n{constructor(t,e,i,s,o,a,h,u){this.cls_=e,this.lay=t=>this.getPage(t).lay(t),this.getPage=t=>"back"!==n.argChk_page(t,"fore")?this.pg.fore:this.pg.back;const c=a.hFactoryCls[e];if(!c)throw` class${e}`;this.pg={fore:c(),back:c()},this.pg.fore.layname=this.pg.back.layname=t;const l=o[":id_tag"]=`layer:${t} cls:${e}`;this.pg.fore.name=`${l} page:A`,this.pg.back.name=`${l} page:B`,i.addChild(this.fore.spLay),s.addChild(this.back.spLay),(0,r.argChk_Boolean)(o,"visible",!0),(0,r.argChk_Boolean)(o,"visible",!0),u.isWait=this.fore.lay(o)||this.back.lay(o);const p=`const.sn.lay.${t}`;h.setVal_Nochk("tmp",p,!0),h.defTmp(p+".fore.alpha",(()=>this.pg.fore.alpha)),h.defTmp(p+".back.alpha",(()=>this.pg.back.alpha)),h.defTmp(p+".fore.height",(()=>this.pg.fore.height)),h.defTmp(p+".back.height",(()=>this.pg.back.height)),h.defTmp(p+".fore.visible",(()=>this.pg.fore.spLay.visible)),h.defTmp(p+".back.visible",(()=>this.pg.back.spLay.visible)),h.defTmp(p+".fore.width",(()=>this.pg.fore.width)),h.defTmp(p+".back.width",(()=>this.pg.back.width)),h.defTmp(p+".fore.x",(()=>this.pg.fore.x)),h.defTmp(p+".back.x",(()=>this.pg.back.x)),h.defTmp(p+".fore.y",(()=>this.pg.fore.y)),h.defTmp(p+".back.y",(()=>this.pg.back.y))}destroy(){this.pg.fore.destroy(),this.pg.back.destroy()}static argChk_page(t,e){const i=t.page??e;if("fore"===i)return t.page=i;if("back"===i)return t.page=i;throw Error(" page"+i+"")}get cls(){return this.cls_}get fore(){return this.pg.fore}get back(){return this.pg.back}transPage(t){[this.pg.back,this.pg.fore]=[this.pg.fore,this.pg.back],this.pg.back.copy(this.pg.fore,t)}}e.Pages=n},7177:function(t,e,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),n=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&r(e,t,i);return n(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.PropParser=void 0;const o=s(i(7864)),a=i(4965);class h{constructor(t){function e(t){const e=[];return t.forEach((t=>e.push((t instanceof RegExp?o.regex(t):o.string(t)).trim(o.optWhitespace)))),o.alt.apply(null,e)}function i(t,e){const i=o.lazy((()=>o.seq(t,i).or(e)));return i}function r(t,e){let i=o.lazy((()=>e.chain((e=>o.seq(t,o.of(e),i).or(o.of(e))))));return i}function n(t,e){return o.seqMap(e,o.seq(t,e).many(),((t,e)=>e.reduce(((t,e)=>[e[0],t,e[1]]),t)))}this.val=t,this.parser=null,this.hFnc={"!num!":t=>t.shift(),"!str!":t=>this.procEmbedVar(t.shift()),"!bool!":t=>t.shift(),"!":t=>{const e=t.shift();return"!bool!"===e[0]?!Boolean(e[1]):!("true"===String(this.calc(e)))},"~":t=>~Number(this.calc(t.shift())),"**":t=>Number(this.calc(t.shift()))**Number(this.calc(t.shift())),"*":t=>Number(this.calc(t.shift()))*Number(this.calc(t.shift())),"/":t=>Number(this.calc(t.shift()))/Number(this.calc(t.shift())),"":t=>Math.floor(this.hFnc["/"](t)),"%":t=>Number(this.calc(t.shift()))%Number(this.calc(t.shift())),"+":t=>{const e=this.calc(t.shift()),i=this.calc(t.shift());return"[object String]"===Object.prototype.toString.call(e)||"[object String]"===Object.prototype.toString.call(i)?String(e)+String(i):Number(e)+Number(i)},"-":t=>Number(this.calc(t.shift()))-Number(this.calc(t.shift())),int:t=>(0,a.int)(this.fncSub_ChkNum(t.shift())),parseInt:t=>(0,a.int)(this.hFnc.Number(t)),Number:t=>{const e=this.calc(t.shift());return"[object String]"!==Object.prototype.toString.call(e)?Number(e):this.fncSub_ChkNum(this.parser.parse(String(e)).value)},ceil:t=>Math.ceil(this.fncSub_ChkNum(t.shift())),floor:t=>Math.floor(this.fncSub_ChkNum(t.shift())),round:t=>Math.round(this.fncSub_ChkNum(t.shift())),"<<":t=>Number(this.calc(t.shift()))<<Number(this.calc(t.shift())),">>":t=>Number(this.calc(t.shift()))>>Number(this.calc(t.shift())),">>>":t=>Number(this.calc(t.shift()))>>>Number(this.calc(t.shift())),"<":t=>Number(this.calc(t.shift()))<Number(this.calc(t.shift())),"<=":t=>Number(this.calc(t.shift()))<=Number(this.calc(t.shift())),">":t=>Number(this.calc(t.shift()))>Number(this.calc(t.shift())),">=":t=>Number(this.calc(t.shift()))>=Number(this.calc(t.shift())),"==":t=>{const e=this.calc(t.shift()),i=this.calc(t.shift());return null!=e||null!=i||e&&i?String(e)===String(i):e==i},"!=":t=>!this.hFnc["=="](t),"===":t=>{const e=this.calc(t.shift()),i=this.calc(t.shift());return Object.prototype.toString.call(e)==Object.prototype.toString.call(i)&&String(e)===String(i)},"!==":t=>!this.hFnc["==="](t),"&":t=>Number(this.calc(t.shift()))&Number(this.calc(t.shift())),"^":t=>Number(this.calc(t.shift()))^Number(this.calc(t.shift())),"|":t=>Number(this.calc(t.shift()))|Number(this.calc(t.shift())),"&&":t=>"true"===String(this.calc(t.shift()))&&"true"===String(this.calc(t.shift())),"||":t=>"true"===String(this.calc(t.shift()))||"true"===String(this.calc(t.shift())),"?":t=>{const e=t.shift();let i=!1;if("!bool!"===e[0])i=Boolean(e[1]);else{const t=String(this.calc(e));i="true"!==t&&"false"!==t?0!==(0,a.int)(t):"true"===t}const r=t.shift();if(":"!==r[0])throw Error("(PropParser): ");return this.calc(r[i?1:2])},":":()=>{throw Error("(PropParser)? ")}},this.REG_EMBEDVAR=/(\$((tmp|sys|save|mp):)?[^\s!--\/:-@[-^`{-~]+|\#\{[^\}]+})/g,this.getValAmpersand=t=>"&"===t.charAt(0)?String(this.parse(t.slice(1))):t;const s=o.alt(o.alt(o.regex(/-?(0|[1-9][0-9]*)\.[0-9]+/),o.regex(/0x[0-9a-fA-F]+/)).map(Number),o.alt(o.regex(/-?(0|[1-9][0-9]*)/)).map((t=>(0,a.int)(t)))).map((t=>["!num!",t])).desc("number"),h=o.string("null").map((()=>["!str!",null])),u=o.regex(/(true|false)/).map((t=>["!bool!","true"===t])).desc("boolean"),c=o.regex(/("|'|#).*?\1/).map((t=>["!str!",t.slice(1,-1)])).desc("string"),l=/\[[^\]]+\]/g,p=o.regex(/-?(?:(?:tmp|sys|save|mp):)?[^\s!-\/:-@[-^`{-~]+(?:\.[^\s!-\/:-@[-^`{-~]+|\[[^\]]+\])*(?:@str)?/).map((t=>{const e=String(t).replace(l,(t=>"."+this.parse(t.slice(1,-1))));if("-"===e.charAt(0)){const t=this.val.getVal(e.slice(1));if(null==t||"null"===String(t))throw Error("(PropParser)-");return["!num!",-Number(t)]}const i=this.val.getVal(e);return null==i?["!str!",i]:"boolean"==typeof i?["!bool!",i]:"[object String]"===Object.prototype.toString.call(i)?["!str!",String(i)]:["!num!",Number(i)]})).desc("string"),d=o.lazy((()=>o.string("(").then(this.parser).skip(o.string(")")).or(s).or(h).or(u).or(c).or(p))),f=[{type:i,ops:e([/[A-Za-z_][A-Za-z0-9_]*(?=\()/])},{type:i,ops:e([/(!(?!=)|~)/])},{type:r,ops:e(["**"])},{type:n,ops:e(["*","/","","%"])},{type:n,ops:e(["+","-"])},{type:n,ops:e([/(>>>|<<|>>)/])},{type:n,ops:e([/(<=|<|>=|>)/])},{type:n,ops:e([/(===|!==|==|!=)/])},{type:n,ops:e([/&(?!&)/])},{type:n,ops:e(["^"])},{type:n,ops:e([/\|(?!\|)/])},{type:n,ops:e(["&&"])},{type:n,ops:e(["||"])},{type:r,ops:e([":"])},{type:r,ops:e(["?"])}].reduce(((t,e)=>e.type(e.ops,t)),d);this.parser=f.trim(o.optWhitespace)}parse(t){const e=this.parser.parse(t);if(!e.status)throw Error("(PropParser)"+t+"");const i=e.value;return"!str!"===i[0]?this.procEmbedVar(i[1]):this.calc(i)}calc(t){const e=t.shift();if(e instanceof Array)return this.calc(e);const i=this.hFnc[e];return i?i(t):Object(null)}fncSub_ChkNum(t){const e=this.calc(t);if("[object Number]"!==Object.prototype.toString.call(e))throw Error("(PropParser)"+e+"");return Number(e)}procEmbedVar(t){return null==t?t:String(t).replace(this.REG_EMBEDVAR,(t=>"$"===t.charAt(0)?this.val.getVal(t.slice(1)):this.parse(t.slice(2,-1))))}static getValName(t){const e=this.REG_VAL.exec(t.trim())?.groups;if(e)return{scope:e.scope||"tmp",name:h.getValName_B2D(e.name),at:e.at??""}}static getValName_B2D(t){let e=0,i=0;for(;;){if(e=t.indexOf('["'),e<0){if(e=t.indexOf("['"),e<0)break;i=t.indexOf("']",e+2)}else i=t.indexOf('"]',e+2);if(i<0)break;t=t.slice(0,e)+"."+t.slice(e+2,i)+t.slice(i+2),e=i-2}return t}}e.PropParser=h,h.REG_VAL=/^((?<scope>\w+?):)?(?<name>[^\s :@]+)(?<at>\@str)?$/},8911:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RubySpliter=void 0;class i{constructor(){this.putCh=()=>{}}static setting(t){t.sesame&&(i.sesame=t.sesame)}static getSesame(){return i.sesame}static destroy(){i.sesame=""}init(t){this.putCh=t}static setEscape(t){i.REG_RUBY=new RegExp((t?`(?<ce>\\${t}\\S)|`:"")+"(?<str>[^\\n]+)(?<ruby>[^\\n]+)|(?:(?<kan>[---]+[-]*|[^\\n])(?<kan_ruby>[^\\n]+))|(?<txt>[\ud800-\udbff][\udc00-\udfff]|[^]+(?=)|[^]*[-](?=[---]+)|.)","gs")}putTxt(t){let e=null;for(;e=i.REG_RUBY.exec(t);){const t=e?.groups;if(!t)continue;const i=t.ruby;if(i){this.putTxtRb(t.str,i);continue}const r=t.kan_ruby;r?this.putTxtRb(t.kan,r):t.ce?this.putCh(t.ce.slice(1),""):Array.from(t.txt??"").forEach((t=>this.putCh(t,"")))}}putTxtRb(t,e){const r=Array.from(t),n=r.length;if("*"===e.charAt(0)&&e.length<=2){const t="center"+("*"===e?i.sesame:e.charAt(1));for(let e=0;e<n;++e)this.putCh(r[e],t);return}if(1===n||-1===e.indexOf(" "))return void this.putCh(t,e.replaceAll("\t"," "));const s=e.split(" "),o=s.length,a=o>n?o:n;for(let t=0;t<a;++t)this.putCh(t<n?r[t]:"",t<o?s[t].replaceAll("\t"," "):"")}}e.RubySpliter=i,i.sesame=""},3690:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ScriptIterator=void 0;const r=i(4965),n=i(3422),s=i(9824),o=i(5785),a=i(6841),h=i(7307);var u;!function(t){t[t.running=0]="running",t[t.wait=1]="wait",t[t.break=2]="break",t[t.breaking=3]="breaking",t[t.step=4]="step",t[t.stepping=5]="stepping",t[t.stepouting=6]="stepouting",t[t.stepout=7]="stepout"}(u||(u={}));class c{constructor(t,e,i,s,a,h,l,p,d){if(this.cfg=t,this.hTag=e,this.main=i,this.val=s,this.alzTagArg=a,this.runAnalyze=h,this.prpPrs=l,this.sndMng=p,this.sys=d,this.script={aToken:[""],len:1,aLNum:[1]},this.scriptFn_="",this.idxToken_=0,this.lineNum_=0,this.addLineNum=t=>this.lineNum_+=t,this.aCallStk=[],this.getCallStk=t=>this.aCallStk[t].csArg,this.grm=new o.Grammar,this.firstWait=()=>{},this.hHook={disconnect:()=>{c.hFn2hLineBP={},c.hFuncBP={},this.isBreak=()=>!1,this.hHook.continue({}),this.breakState=u.running},restart:()=>this.isBreak=()=>!1,add_break:t=>this.regBreakPoint(t.fn,t.o),data_break:t=>{this.breakState===u.running&&(this.breakState=u.wait,this.main.setLoop(!1,` ${t.dataId}${t.old_v}${t.new_v}`),this.sys.callHook("stopOnDataBreakpoint",{}),this.sys.send2Dbg("stopOnDataBreakpoint",{}))},set_func_break:t=>{c.hFuncBP={},t.a.forEach((t=>c.hFuncBP[t.name]=1)),this.sys.send2Dbg(t.ri,{})},stack:t=>this.sys.send2Dbg(t.ri,{a:this.aStack()}),eval:t=>{this.sys.send2Dbg(t.ri,{v:this.prpPrs.parse(t.txt)})},continue:()=>{this.isIdxOverLast()||(this.idxToken_-=this.idxDx4Dbg,this.breakState=u.breaking,this.main.setLoop(!0),this.main.resume())},stepover:t=>this.go_stepover(t),stepin:()=>{if(this.isIdxOverLast())return;const t=this.script.aToken[this.idxToken_-this.idxDx4Dbg];this.sys.callHook("stopOnStep"+(this.regStepin.test(t)?"In":""),{}),this.idxToken_-=this.idxDx4Dbg,this.breakState=this.breakState===u.wait?u.step:u.stepping,this.main.setLoop(!0),this.main.resume()},stepout:t=>{this.isIdxOverLast()||(this.lenCallStk>0?this.go_stepout(!0):this.go_stepover(t))},pause:()=>{this.breakState=u.step,this.main.setLoop(!1,""),this.sys.send2Dbg("stopOnStep",{})},stopOnEntry:()=>{this.breakState=u.step,this.main.setLoop(!1,""),this.sys.send2Dbg("stopOnEntry",{})}},this.cnvSnPath=t=>this.cfg.searchPath(t,n.Config.EXT_SCRIPT),this.cnvSnPath4Dbg=t=>(this.sys.pathBaseCnvSnPath4Dbg+this.cnvSnPath(t)).replace(c.REG4CODE_FN,`$1/prj/$2/${this.scriptFn_}$3`),this.cnvPath4Dbg=t=>this.sys.pathBaseCnvSnPath4Dbg+t.replace("/crypto_prj/","/prj/"),this.csDepth_macro_esc=0,this.breakState=u.running,this.isBreak=t=>!1,this.procDebugtag=t=>{},this.fncSet=()=>{},this.fncBreak=()=>{},this.fnLastBreak="",this.hScrCache4Dump={},this.noticeBreak=t=>{},this.dumpErrLine=5,this.aIfStk=[-1],this.resvToken="",this.skipLabel="",this.nextToken=()=>"",this.dbgToken=t=>{},this.REG_NONAME_LABEL=/(\*{2,})(.*)/,this.REG_TOKEN_MACRO_BEGIN=/\[macro\s/,this.REG_TOKEN_MACRO_END=/\[endmacro[\s\]]/,this.REG_TAG_LET_ML=/^\[let_ml\s/g,this.REG_TAG_ENDLET_ML=/^\[endlet_ml\s*]/g,this.hScript=Object.create(null),this.REG_WILDCARD=/^\[(call|loadplugin)\s/,this.REG_WILDCARD2=/\bfn\s*=\s*[^\s\]]+/,this.replaceScript_Wildcard=()=>{for(let t=this.script.len-1;t>=0;--t){const e=this.script.aToken[t];if(this.REG_WILDCARD.lastIndex=0,!this.REG_WILDCARD.test(e))continue;const[i,n]=(0,o.tagToken2Name_Args)(e);this.alzTagArg.go(n);const s=this.alzTagArg.hPrm.fn;if(!s)continue;const a=s.val;if(!a||"*"!==a.slice(-1))continue;const h="loadplugin"===i?"css":"sn",u=this.cfg.matchPath("^"+a.slice(0,-1)+".*",h);this.script.aToken.splice(t,1,"\t","; "+e),this.script.aLNum.splice(t,1,NaN,NaN);for(const i of u){const n=e.replace(this.REG_WILDCARD2,"fn="+decodeURIComponent((0,r.getFn)(i[h])));this.script.aToken.splice(t,0,n),this.script.aLNum.splice(t,0,NaN)}}this.script.len=this.script.aToken.length},this.isKidoku_=!1,this.strStepin="call",this.regStepin=/\[(call)\b/,this.mark={hSave:{},hPages:{},aIfStk:[-1]},e.let_ml=t=>this.let_ml(t),e.dump_stack=()=>this.dump_stack(),e.dump_script=t=>this.dump_script(t),e.else=e.elsif=e.endif=()=>this.endif(),e.if=t=>this.if(t),e.call=t=>this.call(t),e.jump=t=>this.jump(t),e.pop_stack=t=>this.pop_stack(t),e.return=()=>this.return(),e.bracket2macro=t=>this.bracket2macro(t),e.char2macro=t=>this.char2macro(t),e.endmacro=()=>this.return(),e.macro=t=>this.macro(t),e.load=t=>this.load(t),e.reload_script=t=>this.reload_script(t),e.record_place=()=>this.record_place(),e.save=t=>this.save(t),t.oCfg.debug.token&&(this.dbgToken=t=>console.log(`  fn:${this.scriptFn_} idxToken:${this.idxToken_} ln:${this.lineNum} token${t}`)),s.defTmp("const.sn.vctCallStk.length",(()=>this.aCallStk.length)),this.grm.setEscape(t.oCfg.init.escape),r.CmnLib.isDbg){d.addHook(((t,e)=>this.hHook[t]?.(e))),this.isBreak=this.isBreak_base;const t=this.analyzeInit;this.analyzeInit=()=>{this.analyzeInit=()=>{},this.sys.send2Dbg("hi",{})},this.hHook.auth=e=>{const i=e.hBreakpoint.hFn2hLineBP;for(const t in i)this.regBreakPoint(t,i[t]);if(c.hFuncBP={},e.hBreakpoint.aFunc.forEach((t=>c.hFuncBP[t.name]=1)),e.stopOnEntry){for(;;){let t=this.nextToken();if(!t)break;const e=t.charCodeAt(0);if(91===e)break;if(38===e)break;if(42===e&&1===t.length)break;10===e&&this.addLineNum(t.length)}this.sys.callHook("stopOnEntry",{}),this.analyzeInit=t,this.analyzeInit()}else this.firstWait=()=>{this.sys.callHook("stopOnEntry",{})},this.analyzeInit=t,this.analyzeInit()}}else this.recodeDesign=()=>{};t.oCfg.debug.tag&&(this.procDebugtag=t=>console.log(`  fn:${this.scriptFn_} lnum:${this.lineNum_} [${t} %o]`,this.alzTagArg.hPrm))}get scriptFn(){return this.scriptFn_}subIdxToken(){--this.idxToken_}get lineNum(){return this.lineNum_}get lenCallStk(){return this.aCallStk.length}get lastHArg(){return this.aCallStk[this.lenCallStk-1].csArg}regBreakPoint(t,e){c.hFn2hLineBP[this.cnvSnPath4Dbg(t)]=e}destroy(){this.isBreak=()=>!1}go_stepover(t){if(this.isIdxOverLast())return;const e=this.script.aToken[this.idxToken_-this.idxDx4Dbg];this.regStepin.test(e)?this.go_stepout(!1):(this.sys.callHook("stopOnStep",{}),this.hHook.stepin(t))}go_stepout(t){this.sys.callHook("stopOnStep"+(t?"Out":""),{}),this.csDepth_macro_esc=this.lenCallStk-(t?1:0),this.idxToken_-=this.idxDx4Dbg,this.breakState=t?u.stepout:u.stepouting,this.main.setLoop(!0),this.main.resume()}get idxDx4Dbg(){return this.breakState===u.break||this.breakState===u.step?1:0}isIdxOverLast(){return!(this.idxToken_<this.script.len||(this.sys.callHook("stopOnEntry",{}),this.main.setLoop(!1,""),0))}isBreak_base(t){switch(this.breakState){case u.stepouting:this.subHitCondition(),this.breakState=u.stepout;break;case u.stepout:if(this.lenCallStk!==this.csDepth_macro_esc)break;return this.breakState=u.step,this.main.setLoop(!1,""),this.sys.send2Dbg("stopOnStep",{}),!0;case u.stepping:this.subHitCondition(),this.breakState=u.step;break;case u.step:return this.subHitCondition(),this.main.setLoop(!1,""),this.sys.send2Dbg("stopOnStep",{}),!0;case u.breaking:this.subHitCondition(),this.breakState=u.running;break;default:if((0,o.tagToken2Name)(t)in c.hFuncBP)return this.breakState=u.break,this.main.setLoop(!1,` ${t} `),this.sys.callHook("stopOnBreakpoint",{}),this.sys.send2Dbg("stopOnBreakpoint",{}),!0;{const t=c.hFn2hLineBP[this.cnvSnPath4Dbg(this.scriptFn_)];if(!t)break;const e=t[this.lineNum_];if(!e)break;if(e.condition){if(!this.prpPrs.parse(e.condition))break}else if("hitCondition"in e&&--e.hitCondition>0)break;const i=this.breakState===u.running;this.breakState=u.break,this.main.setLoop(!1,i?(e.condition?"":"")+"":"");const r=i?"stopOnBreakpoint":"stopOnStep";this.sys.callHook(r,{}),this.sys.send2Dbg(r,{})}return!0}return!1}subHitCondition(){const t=c.hFn2hLineBP[(0,r.getFn)(this.scriptFn_)]?.[this.lineNum_];t?.hitCondition&&--t.hitCondition}aStack(){const t=this.breakState===u.breaking?1:0,e=this.script.aToken[this.idxToken_-1+t],i=this.cnvSnPath4Dbg(this.scriptFn_),r=(0,o.tagToken2Name)(e),n=r?`[${r}]`:e,s=this.val.getVal("mp:const.sn.macro")??"{}";if(0===this.idxToken_)return[{fn:i,ln:1,col:1,nm:n,ma:s}];const a=this.cnvIdx2lineCol(this.script,this.idxToken_),h=[{fn:i,ln:a.ln,col:a.col_s+1,nm:n,ma:s}],c=this.aCallStk.length;if(0===c)return h;for(let t=c-1;t>=0;--t){const e=this.aCallStk[t];if(!e.csArg)continue;const i=this.hScript[e.fn],r=i.aToken[e.idx-1],n=this.cnvIdx2lineCol(i,e.idx),s=(0,o.tagToken2Name)(r);h.push({fn:this.cnvSnPath4Dbg(e.fn),ln:n.ln,col:n.col_s+1,nm:s?`[${s}]`:r,ma:e.csArg.hMp["const.sn.macro"]??"{}"})}return h}(t){const[e,i]=(0,o.tagToken2Name_Args)(t),r=this.hTag[e];if(!r)throw`${e}`;this.alzTagArg.go(i),this.procDebugtag(e);const n=this.alzTagArg.hPrm;if(n.cond){const t=n.cond.val;if(!t||"&"===t.charAt(0))throw"cond&";const e=this.prpPrs.parse(t),i=String(e);if("null"===i||"undefined"===i)return!1;if(!e)return!1}let s={};const a=this.aCallStk.length;if(this.alzTagArg.isKomeParam){if(0===a)throw"*";if(!this.lastHArg)throw"*";s={...s,...this.lastHArg}}for(const t in n){let e=n[t].val;if(e&&"%"===e.charAt(0)){if(0===a)throw"%";const i=this.lastHArg[e.slice(1)];if(i){s[t]=i;continue}if(e=n[t].def,!e||"null"===e)continue}if(e=this.prpPrs.getValAmpersand(e??""),"undefined"!==e){s[t]=e;continue}const i=n[t].def;void 0!==i&&(e=this.prpPrs.getValAmpersand(i),"undefined"!==e&&(s[t]=e))}return s.=e,r(s)}setOtherObj(t,e){this.evtMng=t,this.layMng=e}let_ml(t){if(!t.name)throw"name";let e="";const i=this.script.len;for(;this.idxToken_<i&&(e=this.script.aToken[this.idxToken_],""===e);++this.idxToken_);return t.text=e,t.cast="str",this.hTag.let(t),this.idxToken_+=2,this.lineNum_+=(e.match(/\n/g)??[]).length,!1}dump_stack(){if(0===this.idxToken_)return console.group(` [dump_stack]  fn:${this.scriptFn_} line:1 col:0`),console.groupEnd(),!1;const t=this.cnvIdx2lineCol(this.script,this.idxToken_),e=` fn:${this.scriptFn_} line:${t.ln} col:${t.col_s+1}`;console.group(` [dump_stack] ${e}`);const i=this.aCallStk.length;if(i>0){console.info(e);for(let t=i-1;t>=0;--t){const e=this.aCallStk[t];if(!e.csArg)continue;const r=e.csArg.hMp,n=r?r[""]:null,s=e.csArg.,o=this.cnvIdx2lineCol(this.hScript[e.fn],e.idx);console.info(`${i-t} fn:${e.fn} line:${o.ln} col:${o.col_s+1}`+(n?"["+n+"]":" ")+` [${s} ...]`)}}return console.groupEnd(),!1}cnvIdx2lineCol(t,e){const i={ln:1,col_s:0,col_e:0};if(!t)return i;let r=e-1;const n=i.ln=t.aLNum[r];for(;t.aLNum[r]===n;){if("\n"!==t.aToken[r].charAt(0)){const e=t.aToken[r].length;i.col_e>0&&(i.col_s+=e),i.col_e+=e}if(--r<0)break}return i}dump_script(t){const e=t.set_fnc;if(!e)throw"set_fnc";if(this.fncSet=globalThis[e],!this.fncSet){if((0,r.argChk_Boolean)(t,"need_err",!0))throw`HTML${e}`;return this.fncSet=()=>{},!1}this.noticeBreak=t=>{this.fnLastBreak!==this.scriptFn_&&(this.fnLastBreak=this.scriptFn_,this.fncSet(this.hScrCache4Dump[this.scriptFn_]=this.hScrCache4Dump[this.scriptFn_]??this.script.aToken.join(""))),this.fncBreak(this.lineNum_,t)},this.noticeBreak(!0);const i=t.break_fnc;if(!i)return!1;if(this.fncBreak=globalThis[i],!this.fncBreak){if((0,r.argChk_Boolean)(t,"need_err",!0))throw`HTML${i}`;this.fncBreak=()=>{}}return!1}dumpErrForeLine(){if(0===this.idxToken_)return console.group(` Error line (from 0 rows before) fn:${this.scriptFn_}`),void console.groupEnd();let t="";for(let e=this.idxToken_-1;e>=0&&(t=this.script.aToken[e]+t,!((t.match(/\n/g)??[]).length>=this.dumpErrLine));--e);const e=t.split("\n").slice(-this.dumpErrLine),i=e.length;console.group(` Error line (from ${i} rows before) fn:${this.scriptFn_}`);const r=String(this.lineNum_).length,n=this.cnvIdx2lineCol(this.script,this.idxToken_);for(let t=0;t<i;++t){const s=this.lineNum_-i+t+1,o=`${String(s).padStart(r," ")}: %c`,a=e[t],h=a.length>75?a.slice(0,75)+"":a;t===i-1?console.info(o+h.slice(0,n.col_s)+"%c"+h.slice(n.col_s),"color: black; background-color: skyblue;","color: black; background-color: pink;"):console.info(o+h,"color: black; background-color: skyblue;")}console.groupEnd()}endif(){if(-1===this.aIfStk[0])throw"if";return this.idxToken_=this.aIfStk[0],this.lineNum_=this.script.aLNum[this.idxToken_-1],this.aIfStk.shift(),!1}if(t){const e=t.exp;if(!e)throw"exp";if("&"===e.charAt(0))throw"exp&";let i=0,r=this.prpPrs.parse(e)?this.idxToken_:-1;for(;this.idxToken_<this.script.len;++this.idxToken_){this.script.aLNum[this.idxToken_]||(this.script.aLNum[this.idxToken_]=this.lineNum_);const t=this.script.aToken[this.idxToken_];if(!t)continue;const e=t.charCodeAt(0);if(10===e){this.addLineNum(t.length);continue}if(91!==e)continue;const[n,s]=(0,o.tagToken2Name_Args)(t);if(!(n in this.hTag))throw`[${n}]`;switch(this.alzTagArg.go(s),n){case"if":++i;break;case"elsif":if(i>0)break;if(r>-1)break;const t=this.alzTagArg.hPrm.exp.val??"";if("&"===t.charAt(0))throw"exp&";this.prpPrs.parse(t)&&(r=this.idxToken_+1);break;case"else":if(i>0)break;-1===r&&(r=this.idxToken_+1);break;case"endif":if(i>0){--i;break}return-1===r?(++this.idxToken_,this.script.aLNum[this.idxToken_]=this.lineNum_):(this.aIfStk.unshift(this.idxToken_+1),this.idxToken_=r,this.lineNum_=this.script.aLNum[this.idxToken_]),!1}}throw"[endif]"}call(t){(0,r.argChk_Boolean)(t,"count",!1)||this.eraseKidoku();const e=t.fn;return e&&this.cnvSnPath(e),this.callSub({hEvt1Time:this.evtMng.popLocalEvts(),hMp:this.val.cloneMp()}),(0,r.argChk_Boolean)(t,"clear_local_event",!1)&&this.hTag.clear_event({}),this.jumpWork(e,t.label),!0}callSub(t){this.script.aLNum[this.idxToken_]=this.lineNum_,this.resvToken||(t.resvToken="",this.clearResvToken()),this.aCallStk.push(new s.CallStack(this.scriptFn_,this.idxToken_,t)),this.aIfStk.unshift(-1)}jump(t){return(0,r.argChk_Boolean)(t,"count",!0)||this.eraseKidoku(),this.aIfStk[0]=-1,this.jumpWork(t.fn,t.label),!0}pop_stack(t){if((0,r.argChk_Boolean)(t,"clear",!1))this.aCallStk=[];else if(!this.aCallStk.pop())throw"[pop_stack] ";return this.clearResvToken(),this.aIfStk=[-1],this.val.setMp({}),!1}return(){const t=this.aCallStk.pop();if(!t)throw"[return] ";const e=t.csArg;if(!e)return!1;this.aIfStk.shift();const i=e.hMp;i&&this.val.setMp(i);const r=e.resvToken;return r?this.nextToken=()=>(this.clearResvToken(),r):this.clearResvToken(),e.hEvt1Time&&this.evtMng.pushLocalEvts(e.hEvt1Time),t.fn in this.hScript?(this.jump_light(t),!1):(this.jumpWork(t.fn,"",t.idx),!0)}clearResvToken(){this.resvToken="",this.nextToken=this.nextToken_Proc}jumpWork(t="",e="",i=0){if(t||e||this.main.errScript("[jump] fnlabel"),e?("*"!==e.charAt(0)&&this.main.errScript("[jump] label*"),this.skipLabel=e,"**"!==this.skipLabel.slice(0,2)&&(this.idxToken_=i)):(this.skipLabel="",this.idxToken_=i),!t)return void this.analyzeInit();const r=this.cnvSnPath(t);if(t===this.scriptFn_)return void this.analyzeInit();this.scriptFn_=t;const n=this.hScript[this.scriptFn_];if(n)return this.script=n,void this.analyzeInit();(new a.Loader).add({name:this.scriptFn_,url:r}).use(((t,e)=>{try{t.data=this.sys.decStr(t.extension,t.data)}catch(e){this.main.errScript(`[jump]sn fn:${t.name} ${e}`,!1)}e?.()})).load(((e,i)=>{this.nextToken=this.nextToken_Proc,this.lineNum_=1,this.resolveScript(i[t].data),this.hTag.record_place({}),this.main.resume((()=>this.analyzeInit()))})),this.main.stop()}analyzeInit(){const t=this.seekScript(this.script,Boolean(this.val.getVal("mp:const.sn.macro.name")),this.lineNum_,this.skipLabel,this.idxToken_);this.idxToken_=t.idx,this.lineNum_=t.lineNum,this.runAnalyze()}nextToken_Proc(){if(this.errOverScr())return"";this.recordKidoku(),this.script.aLNum[this.idxToken_]||(this.script.aLNum[this.idxToken_]=this.lineNum_);const t=this.script.aToken[this.idxToken_];return this.dbgToken(t),++this.idxToken_,t}errOverScr(){return!(this.idxToken_<this.script.len||(this.main.errScript(""),0))}seekScript(t,e,i,r,n){const s=t.aToken.length;if(!r){if(this.errOverScr())return{idx:n,lineNum:i};if(t.aLNum[n])i=t.aLNum[n];else{i=1;for(let e=0;e<n;++e){t.aLNum[e]||(t.aLNum[e]=i);const r=t.aToken[e];10===r.charCodeAt(0)&&(i+=r.length)}t.aLNum[n]=i}return{idx:n,lineNum:i}}t.aLNum[0]=1;const o=r.match(this.REG_NONAME_LABEL);if(o){r=o[1];let a=n;switch(o[2]){case"before":for(;t.aToken[--a]!==r;)0===a&&h.DebugMng.myTrace("[jump before] "+i+""+(e?"":"")+""+r+"","ET"),e&&t.aToken[a].search(this.REG_TOKEN_MACRO_BEGIN)>-1&&h.DebugMng.myTrace("[jump before] "+r+"","ET");return{idx:a+1,lineNum:t.aLNum[a]};case"after":for(;t.aToken[++a]!==r;)a===s&&h.DebugMng.myTrace("[jump after] "+i+""+r+"","ET"),t.aToken[a].search(this.REG_TOKEN_MACRO_END)>-1&&h.DebugMng.myTrace("[jump after] "+i+""+r+"","ET");return{idx:a+1,lineNum:t.aLNum[a]};default:h.DebugMng.myTrace("[jump] label="+r+"","ET")}}i=1;const a=new RegExp("^"+r.replaceAll("*","\\*")+"(?:\\s|;|\\[|$)");let u=!1;for(let e=0;e<s;++e){t.aLNum[e]||(t.aLNum[e]=i);const r=t.aToken[e],n=r.charCodeAt(0);if(42===n){if(r.search(a)>-1)return{idx:e+1,lineNum:i}}else if(u){if(this.REG_TAG_ENDLET_ML.lastIndex=0,this.REG_TAG_ENDLET_ML.test(r)){u=!1;continue}i+=(r.match(/\n/g)??[]).length}else{if(this.REG_TAG_LET_ML.lastIndex=0,this.REG_TAG_LET_ML.test(r)){u=!0;continue}10===n&&(i+=r.length)}}if(u)throw"[let_ml][endlet_ml]";throw h.DebugMng.myTrace("[jump] "+r+"","ET"),"Dummy"}resolveScript(t){const e=t.replace(/(\r\n|\r)/g,"\n").match(this.grm.REG_TOKEN)??[];for(let t=e.length-1;t>=0;--t){const i=e[t];if(this.REG_TAG_LET_ML.lastIndex=0,this.REG_TAG_LET_ML.test(i)){const r=i.indexOf("]")+1;if(0===r)throw"[let_ml]]";const n=i.slice(0,r),s=i.slice(r);e.splice(t,1,n,s)}}this.script={aToken:e,len:e.length,aLNum:[]};let i="";try{i="ScriptIterator.replaceScriptChar2macro",this.grm.replaceScr_C2M_And_let_ml(this.script),i="ScriptIterator.replaceScript_Wildcard",this.replaceScript_Wildcard()}catch(t){if(t instanceof Error){const e=t;i+=" mes="+e.message+"("+e.name+")"}else i=t;this.main.errScript(i,!1)}this.hScript[this.scriptFn_]=this.script,this.val.loadScrWork(this.scriptFn_)}jump_light(t){this.scriptFn_=t.fn,this.idxToken_=t.idx;const e=this.hScript[this.scriptFn_];e&&(this.script=e),this.lineNum_=this.script.aLNum[t.idx]}recordKidoku(){const t=this.val.getAreaKidoku(this.scriptFn_);if(!t)throw`recordKidoku fn:'${this.scriptFn_}' (areas === null)`;this.aCallStk.length>0?t.record(this.idxToken_):(this.isKidoku_=t.search(this.idxToken_),this.val.setVal_Nochk("tmp","const.sn.isKidoku",this.isKidoku_),this.isKidoku_||t.record(this.idxToken_))}get isKidoku(){return this.isKidoku_}eraseKidoku(){this.val.getAreaKidoku(this.scriptFn_)?.erase(this.idxToken_),this.isKidoku_=!1}get isNextKidoku(){let t=this.scriptFn,e=this.idxToken_,i=this.script.len;if(this.aCallStk.length>0){const r=this.aCallStk[0];t=r.fn,e=r.idx;const n=this.hScript[t];n&&(i=n.len)}const r=this.val.getAreaKidoku(t);return!!r&&e!==i&&r.search(e)}get normalWait(){return this.isKidoku_?this.val.getVal("sys:sn.tagCh.doWait_Kidoku")?(0,r.uint)(this.val.getVal("sys:sn.tagCh.msecWait_Kidoku")):0:this.val.getVal("sys:sn.tagCh.doWait")?(0,r.uint)(this.val.getVal("sys:sn.tagCh.msecWait")):0}bracket2macro(t){return this.grm.bracket2macro(t,this.script,this.idxToken_),!1}char2macro(t){return this.grm.char2macro(t,this.hTag,this.script,this.idxToken_),!1}macro(t){const e=t.name;if(!e)throw"name";if(e in this.hTag)throw`[${e}]`;const i=this.lineNum_,r=new s.CallStack(this.scriptFn_,this.idxToken_);for(this.strStepin+="|"+e,this.regStepin=new RegExp(`\\[(${this.strStepin})\\b`),this.hTag[e]=e=>(e.design_unit=t.design_unit,this.callSub({...e,hMp:this.val.cloneMp()}),this.val.setMp(e),this.val.setVal_Nochk("mp","const.sn.macro",JSON.stringify(t)),this.val.setVal_Nochk("mp","const.sn.me_call_scriptFn",this.scriptFn_),this.lineNum_=i,this.jump_light(r),!1);this.idxToken_<this.script.len;++this.idxToken_){this.script.aLNum[this.idxToken_]||(this.script.aLNum[this.idxToken_]=this.lineNum_);const t=this.script.aToken[this.idxToken_];if(t.search(this.REG_TOKEN_MACRO_END)>-1)return++this.idxToken_,!1;const e=t.charCodeAt(0);10===e?this.lineNum_+=t.length:91===e&&(this.lineNum_+=(t.match(/\n/g)??[]).length)}throw`[${e}][endmacro]`}load(t){if(!("place"in t))throw"place";const e=Number(t.place);if("fn"in t!="label"in t)throw"fnlabel";const i=this.val.getMark(e);if(!i)throw`place${e}`;return this.loadFromMark(t,i)}loadFromMark(t,e,i=!0){this.layMng.cover(!0),this.hTag.clear_event({}),this.val.mark2save(e),this.val.setMp({}),this.layMng.recText("",!0),i&&this.sndMng.playLoopFromSaveObj(),(0,r.argChk_Boolean)(t,"do_rec",!0)&&(this.mark={hSave:this.val.cloneSave(),hPages:{...e.hPages},aIfStk:[...e.aIfStk]});const n={enabled:this.val.getVal("save:const.sn.autowc.enabled"),text:String(this.val.getVal("save:const.sn.autowc.text")),time:String(this.val.getVal("save:const.sn.autowc.time"))};this.hTag.autowc(n);const s=String(this.val.getVal("save:const.sn.scriptFn")),o=Number(this.val.getVal("save:const.sn.scriptIdx"));return delete this.hScript[s],this.aIfStk=[...this.mark.aIfStk],this.aCallStk=[],this.layMng.playback(this.mark.hPages,"label"in t?()=>{this.layMng.cover(!1),this.scriptFn_=s,this.idxToken_=o,this.hTag.call({fn:t.fn,label:t.label})}:()=>{this.layMng.cover(!1),this.jumpWork(s,"",o)}),!0}reload_script(t){const e=this.val.getMark(0);return delete this.hScript[(0,r.getFn)(e.hSave["const.sn.scriptFn"])],t.do_rec=!1,this.loadFromMark(t,e,!1)}record_place(){if(this.main.isDestroyed())return!1;const t=this.aCallStk.length;return 0===t?(this.val.setVal_Nochk("save","const.sn.scriptFn",this.scriptFn),this.val.setVal_Nochk("save","const.sn.scriptIdx",this.idxToken_)):(this.val.setVal_Nochk("save","const.sn.scriptFn",this.aCallStk[0].fn),this.val.setVal_Nochk("save","const.sn.scriptIdx",this.aCallStk[0].idx)),this.mark={hSave:this.val.cloneSave(),hPages:this.layMng.record(),aIfStk:this.aIfStk.slice(t)},!1}save(t){if(!("place"in t))throw"place";const e=Number(t.place);delete t.,delete t.place,t.text=(t.text??"").replace(/^(<br\/>)+/,""),this.mark.json=t,this.val.setMark(e,this.mark);const i=Number(this.val.getVal("sys:const.sn.save.place"));return e===i&&this.val.setVal_Nochk("sys","const.sn.save.place",i+1),!1}recodeDesign(t){let e="",i=0;const r=this.aCallStk.length;if(t.design_unit&&r>0){const t=this.aCallStk[r-1];e=t.fn,i=t.idx}else e=this.scriptFn_,i=this.idxToken_;t[":path"]=this.cnvSnPath4Dbg(e);const n=this.cnvIdx2lineCol(this.hScript[e],i);t[":ln"]=n.ln,t[":col_s"]=n.col_s,t[":col_e"]=n.col_e;const s=i-1;t[":idx_tkn"]=s,t[":token"]=this.hScript[e].aToken[s],this.sys.send2Dbg("_recodeDesign",t)}replace(t,e){this.script.aToken[t]=e}}e.ScriptIterator=c,c.REG4CODE_FN=/(.+)\/crypto_prj\/([^\/]+)\/[^\.]+(\.\w+)/,c.hFn2hLineBP={},c.hFuncBP={}},3497:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SoundMng=void 0;const r=i(4965),n=i(8566),s=i(3422),o=i(2292),a=i(6841),h=i(6194);class u{constructor(t,e,i,r,n){this.cfg=t,this.val=i,this.main=r,this.sys=n,this.hSndBuf={},this.hLP={},this.initVol=()=>{o.sound.volumeAll=Number(this.val.getVal("sys:sn.sound.global_volume",1)),this.initVol=()=>{}},e.volume=t=>this.volume(t),e.fadebgm=t=>this.fadebgm(t),e.fadeoutbgm=t=>this.fadeoutbgm(t),e.fadeoutse=t=>this.fadeoutse(t),e.fadese=t=>this.fadese(t),e.playbgm=t=>this.playbgm(t),e.playse=t=>this.playse(t),e.stop_allse=()=>this.stop_allse(),e.stopbgm=t=>this.stopbgm(t),e.stopse=t=>this.stopse(t),e.wb=t=>this.wb(t),e.wf=t=>this.wf(t),e.stopfadese=t=>this.stopfadese(t),e.wl=t=>this.wl(t),e.ws=t=>this.ws(t),e.xchgbuf=t=>this.xchgbuf(t),this.val.setVal_Nochk("save","const.sn.loopPlaying","{}"),i.setVal_Nochk("tmp","const.sn.sound.codecs",JSON.stringify(o.utils.supported))}setEvtMng(t){this.evtMng=t}setNoticeChgVolume(t,e){this.val.defValTrg("sys:sn.sound.global_volume",((e,i)=>t(o.sound.volumeAll=Number(i)))),this.val.defValTrg("sys:sn.sound.movie_volume",((t,i)=>e(Number(i)))),this.val.setVal_Nochk("sys","sn.sound.global_volume",this.val.getVal("sys:sn.sound.global_volume",1)),this.val.setVal_Nochk("sys","sn.sound.movie_volume",this.val.getVal("sys:sn.sound.movie_volume",1))}volume(t){const e="const.sn.sound."+(t.buf??"SE")+".volume",i=this.getVol(t,1);return Number(this.val.getVal("sys:"+e))!==i&&(this.val.setVal_Nochk("sys",e,i),this.val.flush(),t.time=0,t.volume=Number(this.val.getVal("save:"+e)),this.fadese(t))}getVol(t,e){const i=(0,r.argChk_Num)(t,"volume",e);return i<0?0:i>1?1:i}fadeoutbgm(t){return t.volume=0,this.fadebgm(t)}fadeoutse(t){return t.volume=0,this.fadese(t)}fadebgm(t){return t.buf="BGM",this.fadese(t)}fadese(t){this.stopfadese(t);const e=t.buf??"SE",i=this.hSndBuf[e];if(!i?.playing()||!i.snd)return!1;const s="const.sn.sound."+e+".volume",o=this.getVol(t,NaN);this.val.setVal_Nochk("save",s,o);const a=o*Number(this.val.getVal("sys:"+s,1)),u=(0,r.argChk_Boolean)(t,"stop",0===o);if(u&&(this.delLoopPlay(e),this.val.setVal_Nochk("save","const.sn.sound."+e+".fn","")),this.val.flush(),0===(0,r.argChk_Num)(t,"time",NaN))return i.snd.volume=a,u&&this.stopse(t),!1;const c=n.CmnTween.ease(t.ease),l=(0,r.argChk_Num)(t,"repeat",1);return i.twFade=new h.Tween({v:i.snd.volume}).to({v:a},(0,r.argChk_Num)(t,"time",NaN)).delay((0,r.argChk_Num)(t,"delay",0)).easing(c).repeat(0===l?1/0:l-1).yoyo((0,r.argChk_Boolean)(t,"yoyo",!1)).onUpdate((t=>{i.playing()&&(i.snd.volume=t.v)})).onComplete((()=>{const e=this.hSndBuf[t.buf=i.now_buf];e?.twFade&&(delete e.twFade,u&&this.stopse(t),e.resumeFade&&this.main.resume())})).start(),!1}playbgm(t){return t.buf="BGM",t.canskip=!1,(0,r.argChk_Boolean)(t,"loop",!0),this.playse(t)}playse(t){const e=t.buf??"SE";this.stopse({buf:e});const i=t.fn;if(!i)throw"[playse] fn(buf="+e+")";if((0,r.argChk_Boolean)(t,"canskip",!0)&&this.evtMng.isSkipKeyDown())return!1;const n=(0,r.argChk_Boolean)(t,"loop",!1);this.addLoopPlay(e,n);const s="const.sn.sound."+e+".";this.val.setVal_Nochk("save",s+"fn",i);const a=this.getVol(t,1);this.val.setVal_Nochk("save",s+"volume",a);const h=a*Number(this.val.getVal("sys:"+s+"volume",1)),c=(0,r.argChk_Num)(t,"start_ms",0),l=(0,r.argChk_Num)(t,"end_ms",u.MAX_END_MS),p=(0,r.argChk_Num)(t,"ret_ms",0);if(c<0)throw`[playse] start_ms:${c} `;if(p<0)throw`[playse] ret_ms:${p} `;if(l>0){if(c>=l)throw`[playse] start_ms:${c} >= end_ms:${l} `;if(p>=l)throw`[playse] ret_ms:${p} >= end_ms:${l} `}this.val.setVal_Nochk("save",s+"start_ms",c),this.val.setVal_Nochk("save",s+"end_ms",l),this.val.setVal_Nochk("save",s+"ret_ms",p),this.val.flush();const d=o.sound.find(i),f=this.hSndBuf[e]={now_buf:e,snd:d,loop:n,start_ms:c,end_ms:l,ret_ms:p,resume:!1,playing:()=>!0,onend:()=>{const e=this.hSndBuf[t.buf=f.now_buf];e&&(delete this.hSndBuf[t.buf],e.playing=()=>!1,this.stopfadese(t),e.resume&&this.main.resume())}},g={loop:n,volume:h,speed:(0,r.argChk_Num)(t,"speed",1),sprites:{},loaded:(t,e)=>{if(t)return void this.main.errScript(`Sound a fn:${i} ${t}`,!1);if(!e)return;const r=this.hSndBuf[f.now_buf];r&&(r.snd=e)}};let m="";if(c>0||l<u.MAX_END_MS){m=`${i};${c};${l};${p}`;const t=g.sprites[m]={start:c/1e3,end:l/1e3};g.preload=!0;const e=g.loaded;g.loaded=(r,n)=>{if(r)return void this.main.errScript(`Sound b fn:${i} ${r}`,!1);if(!n)return;const s=n.duration;if(e?.(r,n),t.end<0){if(t.end+=s,n.removeSprites(m),n.addSprites(m,t),t.start>=t.end)throw`[playse] start_ms:${c} >= end_ms:${l}(${1e3*t.end}) `;if(p>=1e3*t.end)throw`[playse] ret_ms:${p} >= end_ms:${l}(${1e3*t.end}) `}if(t.start>=s)throw`[playse] start_ms:${c} >= :${s} `;if(l!==u.MAX_END_MS&&t.end>=s)throw`[playse] end_ms:${l} >= :${s} `;n.play(m,g.complete)}}else g.autoPlay=!0;if(n?0!==p&&(g.loop=!1,g.complete=t=>{const e=t.duration,r=`${i};loop2;${l};${p}`,n={preload:!0,loop:!0,volume:h,speed:g.speed,sprites:{},loaded:(t,e)=>{if(!e)return;const i=this.hSndBuf[f.now_buf];i&&(i.snd=e),e.play(r)}},s=n.sprites[r]={start:p/1e3,end:l/1e3};if(s.end<0&&(s.end+=e,t.removeSprites(r),t.addSprites(r,s)),s.start>=e)throw`[playse] ret_ms:${p} >= :${e} `;this.playseSub(i,n,r)}):g.complete=()=>this.hSndBuf[f.now_buf]?.onend(),this.initVol(),d)return d.volume=h,m?this.playseSub(i,g,m):d.isPlayable&&(f.snd=o.Sound.from({...g,url:d.options.url,source:d.options.source})),!1;const _=(0,r.argChk_Boolean)(t,"join",!0);if(_){const t=g.loaded;g.loaded=(e,i)=>{this.main.resume(),t?.(e,i)}}return this.playseSub(i,g,m),_}playseSub(t,e,i){const r=this.cfg.searchPath(t,s.Config.EXT_SOUND);if(".bin"!==r.slice(-4))return e.url=r,void(i?o.Sound.from(e):o.sound.add(t,e));(new a.Loader).add({name:t,url:r,xhrType:a.LoaderResource.XHR_RESPONSE_TYPE.BUFFER}).use(((t,e)=>{this.sys.dec(t.extension,t.data).then((i=>{t.data=i,e?.()})).catch((e=>this.main.errScript(`Sound  fn:${t.name} ${e}`,!1)))})).load(((r,n)=>{e.source=n[t]?.data,i?o.Sound.from(e):o.sound.add(t,e)}))}stop_allse(){for(const t in this.hSndBuf)this.stopse({buf:t});return this.hSndBuf={},!1}stopbgm(t){return t.buf="BGM",this.stopse(t)}stopse(t){const e=t.buf??"SE";return this.stopfadese(t),this.delLoopPlay(e),this.hSndBuf[e]?.snd?.stop(),!1}wb(t){return t.buf="BGM",this.wf(t)}wf(t){const e=t.buf??"SE",i=this.hSndBuf[e];return!(!i?.twFade||!i.playing())&&(i.resumeFade=this.evtMng.waitEvent((()=>this.stopfadese(t)),(0,r.argChk_Boolean)(t,"canskip",!0),(0,r.argChk_Boolean)(t,"global",!1)))}stopfadese(t){const e=t.buf??"SE";return this.hSndBuf[e]?.twFade?.stop().end(),!1}wl(t){return t.buf="BGM",this.ws(t)}ws(t){const e=t.buf??"SE",i=this.hSndBuf[e];return!(!i?.playing()||i.loop)&&(i.resume=this.evtMng.waitEvent((()=>{t.buf=i.now_buf,this.stopse(t);const e=this.hSndBuf[t.buf];e?.playing()&&!e.loop&&e.onend()}),(0,r.argChk_Boolean)(t,"canskip",!1),(0,r.argChk_Boolean)(t,"global",!1)))}xchgbuf(t){const e=t.buf??"SE",i=t.buf2??"SE";if(e===i)return!1;const r=this.hSndBuf[e];r&&(r.now_buf=i);const n=this.hSndBuf[i];n&&(n.now_buf=e),[this.hSndBuf[e],this.hSndBuf[i]]=[n,r];const s="const.sn.sound."+e+".",o=Number(this.val.getVal("save:"+s+"volume")),a=Number(this.val.getVal("save:"+s+"fn")),h="const.sn.sound."+i+".",u=Number(this.val.getVal("save:"+h+"volume")),c=Number(this.val.getVal("save:"+h+"fn"));return this.val.setVal_Nochk("save",s+"volume",u),this.val.setVal_Nochk("save",h+"volume",o),this.val.setVal_Nochk("save",s+"fn",c),this.val.setVal_Nochk("save",h+"fn",a),e in this.hLP==i in this.hLP&&(e in this.hLP?(delete this.hLP[e],this.hLP[i]=0):(delete this.hLP[i],this.hLP[e]=0),this.val.setVal_Nochk("save","const.sn.loopPlaying",JSON.stringify(this.hLP))),this.val.flush(),!1}loadAheadSnd(t){[t.clickse,t.enterse,t.leavese].forEach((t=>{t&&!o.sound.exists(t)&&this.playseSub(t,{preload:!0,autoPlay:!1},"")}))}playLoopFromSaveObj(){const t=String(this.val.getVal("save:const.sn.loopPlaying","{}"));if(this.val.flush(),"{}"===t)return void this.stop_allse();const e=[];this.hLP=JSON.parse(t);for(const t in this.hLP){const i="save:const.sn.sound."+t+".",r={fn:String(this.val.getVal(i+"fn")),buf:t,join:!1,loop:!0,volume:Number(this.val.getVal(i+"volume")),start_ms:Number(this.val.getVal(i+"start_ms")),end_ms:Number(this.val.getVal(i+"end_ms")),ret_ms:Number(this.val.getVal(i+"ret_ms"))};e.push((()=>{"BGM"===r.buf?this.playbgm(r):this.playse(r)}))}this.stop_allse(),e.forEach((t=>t()))}addLoopPlay(t,e){e?(this.hLP[t]=0,this.val.setVal_Nochk("save","const.sn.loopPlaying",JSON.stringify(this.hLP)),this.val.flush()):this.delLoopPlay(t)}delLoopPlay(t){delete this.hLP[t],this.val.setVal_Nochk("save","const.sn.loopPlaying",JSON.stringify(this.hLP)),this.val.flush()}}e.SoundMng=u,u.MAX_END_MS=999e3},5041:function(t,e,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),n=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&r(e,t,i);return n(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.SysApp=void 0;const o=i(5810),a=i(7529),h=i(4965),u=i(5681),c=i(2264),{to_app:l}=window;class p extends o.SysNode{constructor(t={},e={cur:"prj/",crypto:!1,dip:""}){super(t,e),this.hInfo={getAppPath:"",isPackaged:!1,downloads:"",userData:"",getVersion:"",env:{},screenResolutionX:0,screenResolutionY:0},this.readFileSync=l.readFileSync,this.writeFileSync=l.writeFileSync,this.appendFile=l.appendFile,this.ensureFileSync=l.ensureFileSync,this.$path_userdata="",this.$path_downloads="",this.copyBMFolder=async(t,e)=>{const i=`${this.$path_userdata}storage/${t}/`,r=`${this.$path_userdata}storage/${e}/`;await l.existsSync(i)&&await l.copySync(i,r)},this.eraseBMFolder=async t=>{await l.removeSync(`${this.$path_userdata}storage/${t}/`)},this.close=()=>(l.win_close(),!1),this._export=()=>((async()=>{const t=await l.tarFs_pack(this.$path_userdata+"storage/");t.on("end",(()=>{h.CmnLib.debugLog&&console.log(""),this.fire("sn:exported",new Event("click"))})),t.pipe(await l.createWriteStream(this.$path_downloads+(this.crypto?"":"no_crypto_")+this.cfg.getNs()+(0,h.getDateStr)("-","_","")+".spd"))})(),!1),this._import=()=>{const t=this.flush;return new Promise(((t,e)=>{const i=document.createElement("input");i.type="file",i.accept=".spd, text/plain",i.onchange=()=>{i.files?t(i.files[0].path):e()},i.click()})).then((async e=>{this.flush=()=>{};const i=this.$path_userdata+"storage/";await l.removeSync(i),await l.ensureDirSync(i),(await l.createReadStream(e)).on("end",(async()=>{const e=this.$path_userdata+"storage/data.json"+(this.crypto?"_":""),i=await l.readFileSync(e),r=JSON.parse(this.crypto?this.decStr("json",i):i);if(!r.sys||!r.mark||!r.kidoku)throw new Error("");r.sys[a.SysBase.VALNM_CFG_NS]===this.cfg.oCfg.save_ns?(this.data.sys=r.sys,this.data.mark=r.mark,this.data.kidoku=r.kidoku,this.flush=t,this.flush(),this.val.updateData(r),h.CmnLib.debugLog&&console.log(""),this.fire("sn:imported",new Event("click"))):console.error(`=${r.sys[a.SysBase.VALNM_CFG_NS]}`)})).pipe(await l.tarFs_extract(i))})),!1},this.navigate_to=t=>{const e=t.url;if(!e)throw"[navigate_to] url";return l.navigate_to(e),!1},this.tgl_full_scr=t=>{if(!t.key)return this.tgl_full_scr_sub(),!1;const e=t.key.toLowerCase();return document.addEventListener("keydown",(t=>{(t.altKey?"Alt"===t.key?"":"alt+":"")+(t.ctrlKey?"Control"===t.key?"":"ctrl+":"")+(t.shiftKey?"Shift"===t.key?"":"shift+":"")+t.key.toLowerCase()===e&&(t.stopPropagation(),this.tgl_full_scr_sub())}),{passive:!0}),!1},this.tgl_full_scr_sub=async()=>{if(await l.isSimpleFullScreen())await l.setSimpleFullScreen(!1),await l.win_setSize(h.CmnLib.stageW,h.CmnLib.stageH),this.appPixi.view.style.width=h.CmnLib.stageW+"px",this.appPixi.view.style.height=h.CmnLib.stageH+"px",this.appPixi.view.style.marginLeft="0px",this.appPixi.view.style.marginTop="0px",this.window({}),this.reso4frame=1;else{const t=this.hInfo.screenResolutionX,e=this.hInfo.screenResolutionY,i=t/h.CmnLib.stageW,r=e/h.CmnLib.stageH,n=i<r?i:r;await l.win_setSize(h.CmnLib.stageW*n,h.CmnLib.stageH*n),this.appPixi.view.style.width=h.CmnLib.stageW*n+"px",this.appPixi.view.style.height=h.CmnLib.stageH*n+"px",i<r?this.appPixi.view.style.marginTop=(e-h.CmnLib.stageH*n)/2+"px":this.appPixi.view.style.marginLeft=(t-h.CmnLib.stageW*n)/2+"px",await l.setSimpleFullScreen(!0),await l.win_setContentSize(screen.width,screen.height);const s=this.appPixi.view.getBoundingClientRect();this.reso4frame=s.width/h.CmnLib.stageW}this.resizeFrames()},this.update_check=t=>{const e=t.url;if(!e)throw"[update_check] url";if("/"!==e.slice(-1))throw"[update_check] url/";return(async()=>{const t=await this.fetch(e+`latest${h.CmnLib.isMac?"-mac":""}.yml`);if(!t.ok)return;h.CmnLib.debugLog&&console.log(`[update_check] yml url=${e}`);const r=await t.text(),n=/version: (.+)/.exec(r);if(!n)throw"[update_check] version";const o=n[1],a=this.hInfo.getVersion;if(o===a)return void(h.CmnLib.debugLog&&console.log(`[update_check]  ver:${a}`));h.CmnLib.debugLog&&console.log(`[update_check] ver=${a} ver=${o}`);const u={title:"",icon:this.hInfo.getAppPath+"/app/icon.png",buttons:["OK","Cancel"],defaultId:0,cancelId:1,message:`${this.cfg.oCfg.book.title}\n`,detail:`ver ${a}\nver ${o}`};h.CmnLib.debugLog&&console.log("[update_check] ");const p=/path: (.+)/.exec(r);if(!p)throw"[update_check] path";const d=p[1],f=/sha512: (.+)/.exec(r);if(!f)throw"[update_check] sha512";const g=f[1],m=await this.fetch(e+d);if(!m.ok)return;const _=this.hInfo.downloads+"/"+d,v=await(async t=>{const e=t.body.getReader(),{Readable:r}=await Promise.resolve().then((()=>s(i(7649)))),n=new r;return n._read=async()=>{const{done:t,value:i}=await e.read();t?n.push(null):n.push(Buffer.from(i))},n})(m);v.on("end",(()=>{h.CmnLib.debugLog&&console.log("[update_check] "),l.readFile(_,(async(t,e)=>{if(t)throw t;const i=(0,c.createHash)("SHA512");i.update(e);const r=String(i.digest("base64")),n=g===r;h.CmnLib.debugLog&&console.log(`[update_check] SHA512 Checksum:${n}`,g,r),n||await l.removeSync(_),u.buttons.pop(),u.message=`${this.cfg.oCfg.book.title}\n`+(n?"":"\n")}))})),v.pipe(await l.createWriteStream(_))})(),!1},this.window=t=>{const e=(0,h.argChk_Num)(t,"x",Number(this.val.getVal("sys:const.sn.nativeWindow.x",0))),i=(0,h.argChk_Num)(t,"y",Number(this.val.getVal("sys:const.sn.nativeWindow.y",0)));return l.window((0,h.argChk_Boolean)(t,"centering",!1),e,i,h.CmnLib.stageW,h.CmnLib.stageH),this.val.setVal_Nochk("sys","const.sn.nativeWindow.x",e),this.val.setVal_Nochk("sys","const.sn.nativeWindow.y",i),this.flush(),!1},this.canCapturePage=t=>(l.capturePage(t),!0),globalThis.addEventListener("DOMContentLoaded",(async()=>this.loaded(t,e)),{once:!0,passive:!0})}async loaded(t,e){await super.loaded(t,e),this.hInfo=await l.getInfo(),h.CmnLib.isPackaged=this.hInfo.isPackaged,this.arg=e={...e,cur:this.hInfo.getAppPath.replaceAll("\\","/")+(h.CmnLib.isPackaged?"/doc/":"/")+e.cur},this.$path_downloads=this.hInfo.downloads.replaceAll("\\","/")+"/",h.CmnLib.isDbg=Boolean(this.hInfo.env.SKYNOVEL_DBG)&&!h.CmnLib.isPackaged,h.CmnLib.isDbg&&(this.extPort=(0,h.uint)(this.hInfo.env.SKYNOVEL_PORT??"3776")),this.run()}initVal(t,e,i){e["const.sn.isDebugger"]=!1,e["const.sn.screenResolutionX"]=this.hInfo.screenResolutionX,e["const.sn.screenResolutionY"]=this.hInfo.screenResolutionY,this.val.defTmp("const.sn.displayState",(async()=>await l.isSimpleFullScreen())),this.$path_userdata=h.CmnLib.isDbg?this.hInfo.getAppPath.slice(0,-3)+".vscode/":this.hInfo.userData.replaceAll("\\","/")+"/",l.Store({cwd:this.$path_userdata+"storage",name:this.arg.crypto?"data_":"data",encryptionKey:this.arg.crypto?this.stk():void 0}),this.flush=()=>l.flush(this.data),(async()=>{if(e["const.sn.isFirstBoot"]=await l.Store_isEmpty())this.data.sys=t.sys,this.data.mark=t.mark,this.data.kidoku=t.kidoku,this.flush();else{const t=await l.Store_get();this.data.sys=t.sys,this.data.mark=t.mark,this.data.kidoku=t.kidoku}i(this.data)})()}async run(){if(this.main){const t=10;this.main.destroy(t),await new Promise((e=>setTimeout(e,t)))}this.main=new u.Main(this)}init(t,e,i,r){return super.init(t,e,i,r),this.cfg.oCfg.debug.devtool?l.openDevTools():l.win_ev_devtools_opened((()=>{console.error("DevTooldevtoolON"),r.destroy()})),l.win_setContentSize(h.CmnLib.stageW,h.CmnLib.stageH),[]}titleSub(t){l.win_setTitle(t)}}e.SysApp=p},7529:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SysBase=void 0;const r=i(4965),n=i(4428);class s{constructor(t={},e){this.hPlg=t,this.arg=e,this.hFactoryCls={},this.fetch=t=>fetch(t),this.resolution=1,this.reso4frame=1,this.data={sys:{},mark:{},kidoku:{}},this.extPort=3776,this.sk=null,this.hHook={auth:t=>{t.t===this.cfg.oCfg.debuger_token?this.toast(""):this.end()},continue:()=>this.toast(""),disconnect:()=>this.toast(""),restart:t=>{this.send2Dbg(t?.ri??"",{}),this.end(),this.run()},pause:()=>this.toast(""),stopOnEntry:()=>this.toast(""),stopOnDataBreakpoint:()=>this.toast(""),stopOnBreakpoint:()=>this.toast(""),stopOnStep:()=>this.toast(""),stopOnStepIn:()=>this.toast(""),stopOnStepOut:()=>this.toast(""),stopOnBackstep:()=>this.toast(""),_addPath:t=>this.cfg.addPath(t.fn,t.o)},this.pathBaseCnvSnPath4Dbg="",this.aFncHook=[],this.callHook=(t,e)=>{},this.send2Dbg=(t,e)=>{this.sk?.emit("data",t,e)},this.copyBMFolder=(t,e)=>{},this.eraseBMFolder=t=>{},this.close=()=>!1,this._export=()=>!1,this._import=()=>!1,this.navigate_to=()=>!1,this.title=t=>{const e=t.text;if(!e)throw"[title] text";return this.main_title=e,this.titleSub(this.main_title+this.info_title),!1},this.main_title="",this.tgl_full_scr=()=>!1,this.update_check=()=>!1,this.window=()=>!1,this.info_title="",this.preFromPlg=(t,e)=>({ret:e.toString(),ext_num:0}),this.hN2Ext={1:{ext:"jpeg",fnc:t=>this.genImage(t),mime:"image/jpeg"},2:{ext:"png",fnc:t=>this.genImage(t),mime:"image/png"},3:{ext:"svg",fnc:t=>this.genImage(t),mime:"image/svg+xml"},4:{ext:"webp",fnc:t=>this.genImage(t),mime:"image/webp"},10:{ext:"mp3",fnc:t=>t.arrayBuffer(),mime:"audio/mpeg"},11:{ext:"m4a",fnc:t=>t.arrayBuffer(),mime:"audio/aac"},12:{ext:"ogg",fnc:t=>t.arrayBuffer(),mime:"audio/ogg"},13:{ext:"aac",fnc:t=>t.arrayBuffer(),mime:"audio/aac"},14:{ext:"flac",fnc:t=>t.arrayBuffer(),mime:"audio/flac"},15:{ext:"wav",fnc:t=>t.arrayBuffer(),mime:"audio/wav"},20:{ext:"mp4",fnc:t=>this.genVideo(t),mime:"video/mp4"},21:{ext:"webm",fnc:t=>this.genVideo(t),mime:"video/webm"},22:{ext:"ogv",fnc:t=>this.genVideo(t),mime:"video/ogv"}},this.genImage=t=>new Promise(((e,i)=>{const r=new Image;r.onload=()=>e(r),r.onerror=t=>i(t),r.src=URL.createObjectURL(t)})),this.genVideo=t=>new Promise(((e,i)=>{const r=document.createElement("video");r.addEventListener("error",(()=>i(r?.error?.message??""))),r.addEventListener("canplay",(()=>e(r))),r.src=URL.createObjectURL(t)})),this.enc=t=>t,this.stk=()=>"",this.hash=t=>"",this.isApp=!1,this.$path_downloads="",this.$path_userdata="",this.canCapturePage=t=>!1,this.ofsLeft4frm=0,this.ofsTop4frm=0}async loaded(t,e){const i=t.snsys_pre;return delete t.snsys_pre,i?.init({addTag:()=>{},addLayCls:()=>{},searchPath:()=>"",getVal:()=>({}),resume:()=>{},render:()=>{},setDec:t=>this.preFromPlg=t,setEnc:t=>this.enc=t,getStK:t=>this.stk=t,getHash:t=>this.hash=t})}get cur(){return this.arg.cur}get crypto(){return this.arg.crypto}async loadPath(t,e){this.cfg=e}initVal(t,e,i){}flush(){}async run(){}init(t,e,i,n){this.val=i,this.appPixi=e;let o="";try{this.val.setSys(this),o="sys",o+=Number(this.val.getVal("sys:TextLayer.Back.Alpha",1)),o="kidoku",this.val.saveKidoku()}catch(t){console.error(`${o} %o`,t)}t.close=t=>this.close(t),t.export=t=>this._export(t),t.import=t=>this._import(t),t.navigate_to=t=>this.navigate_to(t),t.title=t=>this.title(t),t.toggle_full_screen=t=>this.tgl_full_scr(t),t.update_check=t=>this.update_check(t),t.window=t=>this.window(t),i.setVal_Nochk("tmp","const.sn.isApp",(()=>this.isApp)),i.setVal_Nochk("tmp","const.sn.isDbg",(()=>r.CmnLib.isDbg)),i.setVal_Nochk("tmp","const.sn.isPackaged",(()=>r.CmnLib.isPackaged)),i.setVal_Nochk("sys",s.VALNM_CFG_NS,this.cfg.oCfg.save_ns),i.flush(),r.CmnLib.isDbg&&this.attach_debug(n),this.hFactoryCls={};const a=[];for(const e in this.hPlg)a.push(this.hPlg[e].init({addTag:(e,i)=>{if(t[e])throw`[${e}]`;t[e]=i},addLayCls:(t,e)=>{if(this.hFactoryCls[t])throw`cls${t}`;this.hFactoryCls[t]=e},searchPath:(t,e="")=>this.cfg.searchPath(t,e),getVal:i.getVal,resume:()=>n.resume(),render:(t,e,i=!1)=>this.appPixi.renderer.render(t,{renderTexture:e,clear:i}),setDec:t=>this.preFromPlg=t,setEnc:t=>this.enc=t,getStK:t=>this.stk=t,getHash:t=>this.hash=t}));return a}attach_debug(t){this.attach_debug=()=>{};const e=document.createElement("style");e.innerHTML="/* SKYNovel Dbg */\n.sn_BounceInOut { animation: sn_kfBounceInOut linear 1.5s; }\n@keyframes sn_kfBounceInOut{\n0%\t{opacity: 0;\ttransform: scaleX(0.30) scaleY(0.30);}\n10%\t{opacity: 1;\ttransform: scaleX(1.10) scaleY(1.10);}\n20%\t{\t\t\t\ttransform: scaleX(0.95) scaleY(0.95);}\n30%\t{\t\t\t\ttransform: scaleX(1.00) scaleY(1.00);}\n70%\t{opacity: 1;}\n100%{opacity: 0;}\n}\n.sn_BounceIn { animation: sn_kfBounceIn linear 0.3s; }\n@keyframes sn_kfBounceIn{\n0%\t{opacity: 0;\ttransform: scaleX(0.30) scaleY(0.30);}\n50%\t{opacity: 1;\ttransform: scaleX(1.10) scaleY(1.10);}\n100%{\t\t\t\ttransform: scaleX(0.95) scaleY(0.95);}\n}\n.sn_HopIn { animation: sn_kfHopIn linear 0.8s; }\n@keyframes sn_kfHopIn{\n0%\t{transform:\ttranslate(0px,   0px);}\n15% {transform:\ttranslate(0px, -25px);}\n30% {transform:\ttranslate(0px,   0px);}\n45% {transform:\ttranslate(0px, -15px);}\n60% {transform:\ttranslate(0px,   0px);}\n75% {transform:\ttranslate(0px,  -5px);}\n100%{transform:\ttranslate(0px,   0px);}\n}",document.getElementsByTagName("head")[0].appendChild(e),this.addHook(((t,e)=>this.hHook[t]?.(e))),this.sk=(0,n.io)(`http://localhost:${this.extPort}`),this.sk.on("data",((t,e)=>{this.callHook(t,e)})).on("disconnect",(()=>t.setLoop(!0))),this.callHook=(t,e)=>this.aFncHook.forEach((i=>i(t,e)))}end(){this.sk?.disconnect(),this.sk=null}toast(t){const e=document.getElementById(r.CmnLib.SN_ID);if(!e)return;const i=e.parentNode;i.querySelectorAll(".sn_BounceIn, .sn_HopIn").forEach((t=>i.removeChild(t)));const n=document.createElement("img"),o=s.hToastDat[t];n.src=`data:image/svg+xml;base64,${o.dat}`;const a=Math.min(r.CmnLib.stageW,r.CmnLib.stageH)/4*r.CmnLib.cvsScale;n.width=n.height=a,n.style.cssText=`position: absolute;\nleft: ${(r.CmnLib.stageW-a)/2*r.CmnLib.cvsScale+a*(o.dx??0)}px;\ntop: ${(r.CmnLib.stageH-a)/2*r.CmnLib.cvsScale+a*(o.dy??0)}px;`,n.classList.add("sn_toast",o.ease??"sn_BounceInOut"),o.ease||n.addEventListener("animationend",(()=>i.removeChild(n)),{once:!0,passive:!0}),i.insertBefore(n,e)}setFire(t){this.fire=t}addHook(t){this.aFncHook.push(t)}titleSub(t){}setTitleInfo(t){this.info_title=t,this.titleSub(this.main_title+this.info_title)}decStr(t,e){return this.preFromPlg(t,e).ret}async dec(t,e){const{ret:i,ext_num:r}=this.preFromPlg(t,e),n=this.hN2Ext[r];return n?.fnc?await n.fnc(new Blob([i],{type:n.mime})):i}get path_downloads(){return this.$path_downloads}get path_userdata(){return this.$path_userdata}async savePic(t,e){}async appendFile(t,e,i){}async ensureFileSync(t){}resizeFrames(){const t=this.appPixi.view.getBoundingClientRect(),e=document.getElementsByTagName("iframe"),i=e.length;for(let r=0;r<i;++r){const i=e[r],n=`const.sn.frm.${i.id}`;i.style.left=this.ofsLeft4frm+t.left+Number(this.val.getVal(`tmp:${n}.x`))*this.reso4frame+"px",i.style.top=this.ofsTop4frm+t.top+Number(this.val.getVal(`tmp:${n}.y`))*this.reso4frame+"px",i.width=String(Number(this.val.getVal(`tmp:${n}.width`))*this.reso4frame),i.height=String(Number(this.val.getVal(`tmp:${n}.height`))*this.reso4frame)}}}e.SysBase=s,s.VALNM_CFG_NS="const.sn.cfg.ns",s.hToastDat={:{dx:-1,dat:"PHN2ZyBoZWlnaHQ9IjY0MCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQgbWVldCIgdmlld0JveD0iMCAwIDY0MCA2NDAiIHdpZHRoPSI2NDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxwYXRoIGlkPSJhIiBkPSJtNjQwIDMyMGMwIDE3Ni43My0xNDMuMjcgMzIwLTMyMCAzMjBzLTMyMC0xNDMuMjctMzIwLTMyMCAxNDMuMjctMzIwIDMyMC0zMjAgMzIwIDE0My4yNyAzMjAgMzIweiIvPjxwYXRoIGlkPSJiIiBkPSJtMCAyOTJ2NTUuODhoMTI3LjEzYzEyLjM3IDQ2IDU0LjEyIDc5Ljg3IDEwNCA3OS44N2g3Ny44N3YtMjE1LjYyYy00Ni43MyAwLTcyLjY4IDAtNzcuODggMC00OS43NCAwLTkxLjYyIDMzLjg3LTEwMy45OSA3OS44Ny0xNi45NSAwLTU5LjMzIDAtMTI3LjEzIDB6Ii8+PHBhdGggaWQ9ImMiIGQ9Im01MTIuODggMjkyYy0xMi4zOC00Ni01NC4xMy03OS44Ny0xMDQtNzkuODctNS4yMSAwLTMxLjIxIDAtNzggMHYyMTUuNzRoNzcuODdjNDkuODggMCA5MS43NS0zMy44NyAxMDQtNzkuODdoMTI3LjI1di01NmMtNzYuMjcgMC0xMTguNjUgMC0xMjcuMTIgMHoiLz48L2RlZnM+PHVzZSBmaWxsPSIjMmUyZTJlIiB4bGluazpocmVmPSIjYSIvPjx1c2UgZmlsbD0ibm9uZSIgeGxpbms6aHJlZj0iI2EiLz48dXNlIGZpbGw9IiMzYWFiZDIiIHhsaW5rOmhyZWY9IiNiIi8+PHVzZSBmaWxsPSJub25lIiB4bGluazpocmVmPSIjYiIvPjx1c2UgZmlsbD0iIzNhYWJkMiIgeGxpbms6aHJlZj0iI2MiLz48dXNlIGZpbGw9Im5vbmUiIHhsaW5rOmhyZWY9IiNjIi8+PC9zdmc+"},:{dat:"PHN2ZyBoZWlnaHQ9IjY0MCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQgbWVldCIgdmlld0JveD0iMCAwIDY0MCA2NDAiIHdpZHRoPSI2NDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxwYXRoIGlkPSJhIiBkPSJtNjQwIDMyMGMwIDE3Ni43My0xNDMuMjcgMzIwLTMyMCAzMjBzLTMyMC0xNDMuMjctMzIwLTMyMCAxNDMuMjctMzIwIDMyMC0zMjAgMzIwIDE0My4yNyAzMjAgMzIweiIvPjxwYXRoIGlkPSJiIiBkPSJtMTkxLjUzIDIyMS4yNGMtNDUuNjggMC04NC4wMSAzMS4wNC05NS4zIDczLjE2LTYuNDEgMC0zOC40OSAwLTk2LjIzIDB2NTEuMjFoOTYuMjNjMTEuMyA0Mi4xMSA0OS42MyA3My4xNiA5NS4zIDczLjE2aDcxLjMzdi00OC4yNGg1My43OHYtMTAxLjA1aC01My43OHYtNDguMjRjLTQyLjggMC02Ni41NyAwLTcxLjMzIDB6Ii8+PHBhdGggaWQ9ImMiIGQ9Im00NDguNDcgMjIxLjIzYy00Ljc2IDAtMjguNTMgMC03MS4zMyAwdjE5Ny41M2g3MS4zM2M0NS42OCAwIDgzLjk5LTMxLjA0IDk1LjI5LTczLjE1aDk2LjI0di01MS4yMWgtOTYuMjRjLTMzLjA4LTQ4Ljc4LTY0Ljg0LTczLjE3LTk1LjI5LTczLjE3eiIvPjwvZGVmcz48dXNlIGZpbGw9IiMyZTJlMmUiIHhsaW5rOmhyZWY9IiNhIi8+PHVzZSBmaWxsPSJub25lIiB4bGluazpocmVmPSIjYSIvPjx1c2UgZmlsbD0iI2RmNTY1NiIgeGxpbms6aHJlZj0iI2IiLz48dXNlIGZpbGw9Im5vbmUiIHhsaW5rOmhyZWY9IiNiIi8+PHVzZSBmaWxsPSIjZGY1NjU2IiB4bGluazpocmVmPSIjYyIvPjx1c2UgZmlsbD0ibm9uZSIgeGxpbms6aHJlZj0iI2MiLz48L3N2Zz4="},:{dat:"PHN2ZyBoZWlnaHQ9IjY0MCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQgbWVldCIgdmlld0JveD0iMCAwIDY0MCA2NDAiIHdpZHRoPSI2NDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxwYXRoIGlkPSJhIiBkPSJtMCAzMjBjMCAxNzYuNzIgMTQzLjI4IDMyMCAzMjAgMzIwczMyMC0xNDMuMjggMzIwLTMyMC0xNDMuMjgtMzIwLTMyMC0zMjAtMzIwIDE0My4yOC0zMjAgMzIwem0yNTguODMgMTExLjA1Yy0xLjI5Ljc5LTIuOTMuODMtNC4yNi4wNC0xLjI5LS43NC0yLjExLTIuMTItMi4xMS0zLjY3IDAtNy4xNiAwLTQyLjk3IDAtMTA3LjQzczAtMTAwLjI3IDAtMTA3LjQzYzAtMS41My44Mi0yLjkzIDIuMTEtMy42OCAxLjMzLS43NiAyLjk3LS43MiA0LjI2LjA0IDE4IDEwLjc1IDE2MiA5Ni43MSAxODAgMTA3LjQ2IDEuMjkuNzMgMi4wNSAyLjE0IDIuMDUgMy42MSAwIDEuNDktLjc2IDIuODgtMi4wNSAzLjYzLTM2IDIxLjQ5LTE2MiA5Ni42OS0xODAgMTA3LjQzeiIvPjwvZGVmcz48cGF0aCBkPSJtMTU0LjU3IDE3MC4xOWgzNDYuMTV2MzA3LjY5aC0zNDYuMTV6IiBmaWxsPSIjZmZmIi8+PHVzZSBmaWxsPSIjMmUyZTJlIiB4bGluazpocmVmPSIjYSIvPjx1c2UgZmlsbD0ibm9uZSIgeGxpbms6aHJlZj0iI2EiLz48L3N2Zz4="},:{dat:"PHN2ZyBoZWlnaHQ9IjY0MCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQgbWVldCIgdmlld0JveD0iMCAwIDY0MCA2NDAiIHdpZHRoPSI2NDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxwYXRoIGlkPSJhIiBkPSJtMCAzMjBjMCAxNzYuNzIgMTQzLjI4IDMyMCAzMjAgMzIwczMyMC0xNDMuMjggMzIwLTMyMC0xNDMuMjgtMzIwLTMyMC0zMjAtMzIwIDE0My4yOC0zMjAgMzIwem0yMDAgMTAwdi0yMDBoODB2MjAwem0xNjAgMHYtMjAwaDgwdjIwMHoiLz48L2RlZnM+PHBhdGggZD0ibTE0Ny40OSAxODAuNDFoMzUyLjR2MjgyLjY5aC0zNTIuNHoiIGZpbGw9IiNmZmYiLz48dXNlIGZpbGw9IiMyZTJlMmUiIHhsaW5rOmhyZWY9IiNhIi8+PHVzZSBmaWxsPSJub25lIiB4bGluazpocmVmPSIjYSIvPjwvc3ZnPg=="},:{ease:"sn_HopIn",dat:"PHN2ZyBoZWlnaHQ9IjY0MCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQgbWVldCIgdmlld0JveD0iMCAwIDY0MCA2NDAiIHdpZHRoPSI2NDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxwYXRoIGlkPSJhIiBkPSJtMzQzLjM0IDI5LjJjLTEwLjM3LTE3Ljk3LTM2LjMxLTE3Ljk3LTQ2LjY5IDAtMjkuMyA1MC43NS0yNjMuNyA0NTYuNzQtMjkzIDUwNy40OS0xMC4zNyAxNy45NyAyLjU5IDQwLjQ0IDIzLjM0IDQwLjQ0aDU4Ni4wMWMyMC43NSAwIDMzLjcyLTIyLjQ2IDIzLjM1LTQwLjQ0LTU4LjYtMTAxLjUtMjYzLjctNDU2Ljc0LTI5My4wMS01MDcuNDl6bS0yMy4zNCA0ODIuODNjLTE0LjUyIDAtMjYuMjktMi43MS0yNi4yOS02LjA2IDAtNC4yMSAwLTM3Ljg2IDAtNDIuMDcgMC0zLjM1IDExLjc3LTYuMDcgMjYuMjktNi4wN3MyNi4yOSAyLjcyIDI2LjI5IDYuMDd2NDIuMDdjLTcuODQgNC4wNC0xNi42MSA2LjA2LTI2LjI5IDYuMDZ6bTIxLjk5LTEwMy44NGMwIDUuNDMtOS44NSA5LjgzLTIxLjk5IDkuODMtMTIuMTUgMC0yMS45OS00LjQtMjEuOTktOS44MyAwLS4xMy4wNy0uMjUuMDgtLjM4LTEuMzctMTcuNTYtMTIuMy0xNTguMDYtMTMuNjctMTc1LjYyIDAtNS40MyAxNS45My05Ljg0IDM1LjU4LTkuODRzMzUuNTggNC40MSAzNS41OCA5Ljg0Yy0uOTEgMTEuNy01LjQ3IDcwLjI1LTEzLjY3IDE3NS42Mi4wNi4xNi4wOC4yOS4wOC4zOHoiLz48L2RlZnM+PHBhdGggZD0ibTI0MS4yOSAxOTEuNDRoMTQ1LjQ5djM1MS42NmgtMTQ1LjQ5eiIgZmlsbD0iI2ZmZiIvPjx1c2UgZmlsbD0iI2QyYmYzYSIgeGxpbms6aHJlZj0iI2EiLz48dXNlIGZpbGw9Im5vbmUiIHhsaW5rOmhyZWY9IiNhIi8+PC9zdmc+"},:{ease:"sn_BounceIn",dat:"PHN2ZyBoZWlnaHQ9IjY0MCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQgbWVldCIgdmlld0JveD0iMCAwIDY0MCA2NDAiIHdpZHRoPSI2NDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxwYXRoIGlkPSJhIiBkPSJtMCAzMjBjMCAxNzYuNzIgMTQzLjI4IDMyMCAzMjAgMzIwczMyMC0xNDMuMjggMzIwLTMyMC0xNDMuMjgtMzIwLTMyMC0zMjAtMzIwIDE0My4yOC0zMjAgMzIwem0zNzYuOTMgOTEuOTdjMC01My41MSAwLTgzLjI0IDAtODkuMTktLjE1LjE0LS4yNS4zNC0uNDQuNDUtMTYuMTEgOS42Mi0xNDQuOTUgODYuNTQtMTYxLjA2IDk2LjE1LTEuMTUuNjktMi42Mi43My0zLjgxLjAyLTEuMTUtLjY0LTEuODktMS44OS0xLjg5LTMuMjggMC02LjQxIDAtMzguNDQgMC05Ni4xMSAwLTU3LjY5IDAtODkuNzQgMC05Ni4xNSAwLTEuMzUuNzQtMi42MiAxLjg5LTMuMjkgMS4xOS0uNjggMi42Ni0uNjQgMy44MS4wNCAxNi4xMSA5LjYyIDE0NC45NSA4Ni41NCAxNjEuMDYgOTYuMTYuMTkuMS4yOS4zMS40NC40NSAwLTYuMTMgMC0zNi43NyAwLTkxLjkyaDUzLjMydjE4Ni42N3oiLz48L2RlZnM+PHBhdGggZD0ibTE0Ny40OSAxNTQuMmgzNTIuNHYzMDguOWgtMzUyLjR6IiBmaWxsPSIjZmZmIi8+PHVzZSBmaWxsPSIjMmUyZTJlIiB4bGluazpocmVmPSIjYSIvPjx1c2UgZmlsbD0ibm9uZSIgeGxpbms6aHJlZj0iI2EiLz48L3N2Zz4="},:{ease:"sn_BounceIn",dat:"PHN2ZyBoZWlnaHQ9IjY0MCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQgbWVldCIgdmlld0JveD0iMCAwIDY0MCA2NDAiIHdpZHRoPSI2NDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxwYXRoIGlkPSJhIiBkPSJtMCAzMjBjMCAxNzYuNzIgMTQzLjI4IDMyMCAzMjAgMzIwczMyMC0xNDMuMjggMzIwLTMyMC0xNDMuMjgtMzIwLTMyMC0zMjAtMzIwIDE0My4yOC0zMjAgMzIwem00MzAuMjcgOTYuMTRjMCAxLjM1LS43NCAyLjYyLTEuODkgMy4yOC0xLjE5LjY5LTIuNjYuNjUtMy44MS0uMDMtMTYuMTEtOS42Mi0xNDQuOTUtODYuNTQtMTYxLjA1LTk2LjE2LS4yLS4xLS4yOS0uMzEtLjQ1LS40NXY5MS45MmgtNTMuMzJ2LTE4Ni42N2g1My4zMnY4OS4xOWMuMTYtLjE0LjI1LS4zNC40NS0uNDUgMTYuMS05LjYyIDE0NC45NC04Ni41NCAxNjEuMDUtOTYuMTYgMS4xNS0uNjggMi42Mi0uNzIgMy44MS0uMDEgMS4xNS42NCAxLjg5IDEuODkgMS44OSAzLjI4djk2LjExeiIvPjwvZGVmcz48cGF0aCBkPSJtMTQ3LjQ5IDE1NC4yaDM1Mi40djMwOC45aC0zNTIuNHoiIGZpbGw9IiNmZmYiLz48dXNlIGZpbGw9IiMyZTJlMmUiIHhsaW5rOmhyZWY9IiNhIi8+PHVzZSBmaWxsPSJub25lIiB4bGluazpocmVmPSIjYSIvPjwvc3ZnPg=="},:{ease:"sn_BounceIn",dat:"PHN2ZyBoZWlnaHQ9IjY0MCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQgbWVldCIgdmlld0JveD0iMCAwIDY0MCA2NDAiIHdpZHRoPSI2NDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxwYXRoIGlkPSJhIiBkPSJtMCAzMTkuOTljMCAxNzYuNzQgMTQzLjI3IDMyMC4wMSAzMjAuMDEgMzIwLjAxIDE3Ni43MiAwIDMxOS45OS0xNDMuMjcgMzE5Ljk5LTMyMC4wMSAwLTE3Ni43Mi0xNDMuMjctMzE5Ljk5LTMxOS45OS0zMTkuOTktMTc2Ljc0IDAtMzIwLjAxIDE0My4yNy0zMjAuMDEgMzE5Ljk5em0xNTMuMDUtMjkuNzIgNTUuMTItNTUuMTMgMTExLjg0IDExMS44MiAxMTEuODItMTExLjgyIDU1LjEyIDU1LjEyLTE2Ni45NCAxNjYuOTd6Ii8+PC9kZWZzPjxwYXRoIGQ9Im0xNDcuNDkgMTU0LjJoMzUyLjR2MzA4LjloLTM1Mi40eiIgZmlsbD0iI2ZmZiIvPjx1c2UgZmlsbD0iIzJlMmUyZSIgeGxpbms6aHJlZj0iI2EiLz48dXNlIGZpbGw9Im5vbmUiIHhsaW5rOmhyZWY9IiNhIi8+PC9zdmc+"},:{ease:"sn_BounceIn",dat:"PHN2ZyBoZWlnaHQ9IjY0MCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQgbWVldCIgdmlld0JveD0iMCAwIDY0MCA2NDAiIHdpZHRoPSI2NDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxwYXRoIGlkPSJhIiBkPSJtMCAzMjAuMDFjMCAxNzYuNzIgMTQzLjI3IDMxOS45OSAzMTkuOTkgMzE5Ljk5IDE3Ni43NCAwIDMyMC4wMS0xNDMuMjcgMzIwLjAxLTMxOS45OSAwLTE3Ni43NC0xNDMuMjctMzIwLjAxLTMyMC4wMS0zMjAuMDEtMTc2LjcyIDAtMzE5Ljk5IDE0My4yNy0zMTkuOTkgMzIwLjAxem0zMTkuOTktMjYuOTgtMTExLjgyIDExMS44My01NS4xMi01NS4xMyAxNjYuOTQtMTY2Ljk2IDE2Ni45NiAxNjYuOTYtNTUuMTIgNTUuMTN6Ii8+PC9kZWZzPjxwYXRoIGQ9Im0xNDcuNDkgMTU0LjJoMzUyLjR2MzA4LjloLTM1Mi40eiIgZmlsbD0iI2ZmZiIvPjx1c2UgZmlsbD0iIzJlMmUyZSIgeGxpbms6aHJlZj0iI2EiLz48dXNlIGZpbGw9Im5vbmUiIHhsaW5rOmhyZWY9IiNhIi8+PC9zdmc+"}}},5810:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SysNode=void 0;const r=i(7529),n=i(4965);class s extends r.SysBase{constructor(){super(...arguments),this.isApp=!0}async loadPath(t,e){await super.loadPath(t,e);const i=this.arg.cur+"path.json",r=await this.readFileSync(i),n=JSON.parse(this.decStr(i,r));for(const e in n){const i=t[e]=n[e];for(const t in i)":cnt"!==t&&(i[t]=this.arg.cur+i[t])}}async savePic(t,e){const i=e.slice(e.indexOf(",",20)+1);try{await this.writeFileSync(t,Buffer.from(i,"base64")),n.CmnLib.debugLog&&console.log(` ${t} `)}catch(t){throw t}}async readFileSync(t){return""}async writeFileSync(t,e,i){}}e.SysNode=s},1028:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TxtLayer=void 0;const r=i(1481),n=i(4965),s=i(7411),o=i(3422),a=i(8911),h=i(7007),u=i(6761),c=i(5844),l=i(6841);class p extends r.Layer{constructor(){super(),this.infTL={fontsize:24,$width:0,$height:0,pad_left:0,pad_right:0,pad_top:0,pad_bottom:0},this.b_color=0,this.b_alpha=0,this.b_alpha_isfixed=!1,this.b_do=null,this.b_pic="",this.txs=new s.TxtStage(this.infTL,this.spLay,(()=>this.canFocus())),this.rbSpl=new a.RubySpliter,this.cntBtn=new l.Container,this.ch_in_style="",this.ch_in_join=!0,this.ch_out_style="",this.ffs="",this.fncFFSStyle=t=>"",this.fncFFSSpan=t=>t,this.strNoFFS="",this.regNoFFS=new RegExp("[]"),this.isCur=!1,this.ruby_pd=()=>"",this.r_align="",this.needGoTxt=!1,this.putCh=(t,e)=>{p.cfg.oCfg.debug.putCh&&console.log(`  text:\`${t}\` ruby:\`${e}\` name:\`${this.name_}\``);const i=e.split("");let r="";const o=p.evtMng.isSkipKeyDown();switch(i.length){case 1:if(this.needGoTxt=!0,"\n"===t){if(this.aSpan_bk)return r=this.aSpan_bk.slice(-1)[0],this.autoCloseSpan(),this.aSpan.push(p.rec("<br/>")),this.aSpan.push(r),this.aSpan_bk=this.aSpan,void(this.aSpan=[]);this.firstCh?(this.firstCh=!1,r="<ruby><rt></rt></ruby><br/>"):r="<br/>";break}this.firstCh&&(this.firstCh=!1,""===e&&(e="")),r=this.tagCh_sub(t,e,o,this.r_align);break;case 2:switch(i[0]){case"start":case"left":case"center":case"right":case"justify":case"121":case"even":case"1ruby":this.firstCh=!1,this.needGoTxt=!0,r=this.tagCh_sub(t,i[1],o,i[0]);break;case"gotxt":if(this.autoCloseSpan(),this.isCur&&p.recText(this.aSpan.join("").replace(/^<ruby><rt><\/rt><\/ruby>(<br\/>)+/,"").replace(/style='(anim\S+ \S+?;\s*)+/g,"style='").replace(/( style=''| data-(add|arg|cmd)='.+?'|\n+|\t+)/g,"").replace(/class='sn_ch .+?'/g,"class='sn_ch'").replaceAll("class='offrec'","style='display: none;'").replaceAll("`","\\`")),!this.needGoTxt)return;return this.txs.goTxt([...this.aSpan,this.tagCh_sub("","",!1,"")]),this.needGoTxt=!1,void(this.cumDelay=0);case"add":{const t=JSON.parse(i[1]);if(t.style??="",this.beginSpan(t),this.aSpan_bk)this.autoCloseSpan();else{o&&(this.cumDelay=0);const e=Number(t.wait??-1),i=0===e?"":` sn_ch_in_${this.ch_in_style}`,r=e<0?"":` animation-duration: ${e}ms;`;this.aSpan.push(`<span class='sn_ch${i}' style='animation-delay: ${this.cumDelay}ms;${r} ${t.style}' data-add='${JSON.stringify(t)}'>`)}this.aSpan_bk=this.aSpan,this.aSpan=[]}return;case"add_close":return void this.autoCloseSpan();case"grp":this.needGoTxt=!0;{o&&(this.cumDelay=0);const t=(i[1]?i[1].slice(0,-1)+",":"{")+`"delay": ${this.cumDelay}}`;this.ch_in_join&&(this.cumDelay+=p.doAutoWc?0:c.LayerMng.msecChWait);const e=JSON.parse(t);if(e.style??="","id"in e||(e.id=this.aSpan.length),"break"===e.id)return void this.txs.dispBreak(e.pic);r=`<span data-cmd='grp' data-id='${e.id}' data-arg='${t}'`;const n=Number(e.wait??-1),s=n<0?"":` animation-duration: ${n}ms;`;if(r+=` class='sn_ch${0===n?"":` sn_ch_in_${this.ch_in_style}`}' style='animation-delay: ${this.cumDelay}ms;${s} ${e.style}' data-add='{"ch_in_style":"${this.ch_in_style}", "ch_out_style":"${this.ch_out_style}"}'></span>`,this.firstCh&&(this.firstCh=!1,r=`<ruby>${r}<rt></rt></ruby>`),this.aSpan.slice(-1)[0]===r)return}break;case"del":if("break"!==i[1])throw"delid=break";return void s.TxtStage.delBreak();case"span":this.autoCloseSpan(),this.needGoTxt=!0;{const t=JSON.parse(i[1]);if(this.beginSpan(t),!t.style)return;o&&(this.cumDelay=0);const e=Number(t.wait??-1),r=0===e?"":` sn_ch_in_${this.ch_in_style}`,n=e<0?"":` animation-duration: ${e}ms;`;this.aSpan.push(`<span class='sn_ch${r}' style='animation-delay: ${this.cumDelay}ms;${n} ${t.style}' data-add='{"ch_in_style":"${this.ch_in_style}", "ch_out_style":"${this.ch_out_style}"}'>`),this.aSpan_bk=this.aSpan,this.aSpan=[]}return;case"link":this.autoCloseSpan(),this.needGoTxt=!0;{const t=JSON.parse(i[1]);t.style??="",this.beginSpan(t),o&&(this.cumDelay=0);const e=Number(t.wait??-1),r=0===e?"":` sn_ch_in_${this.ch_in_style}`,n=e<0?"":` animation-duration: ${e}ms;`;this.aSpan_link=` data-cmd='link' data-arg='${i[1]}'`,this.aSpan.push(`<span${this.aSpan_link} class='sn_ch${r}' style='animation-delay: ${this.cumDelay}ms;${n} ${t.style}' data-add='{"ch_in_style":"${this.ch_in_style}", "ch_out_style":"${this.ch_out_style}"}'>`),this.aSpan_bk=this.aSpan,this.aSpan=[]}return;case"endlink":return this.needGoTxt=!0,this.aSpan_bk&&(this.aSpan=this.aSpan.map((t=>t.replace(/ data-cmd='linkrsv'/,this.aSpan_link)))),void this.autoCloseSpan();default:this.needGoTxt=!0,r=this.tagCh_sub(t,e,o,this.r_align)}break;case 3:if(this.firstCh=!1,this.needGoTxt=!0,"tcy"!==i[0])throw` putCh(text: ${t}, ruby: ${e})`;{p.val.doRecLog()&&(this.page_text+=t+(e?`${e}`:""));const s=i[1],a=s.length>1?this.aSpan.length+1:"",h=n.CmnLib.isSafari?i[2].replace(/[A-Za-z0-9]/g,(t=>String.fromCharCode(t.charCodeAt(0)+65248))):i[2];o&&(this.cumDelay=0);const u=this.mkStyle_r_align(s,h,this.r_align);r=h?this.aSpan_bk?`<ruby><span data-tcy='${a}' style='\n\t\t\t\t\t\t\t\ttext-combine-upright: all;\n\t\t\t\t\t\t\t\t-webkit-text-combine: horizontal;\n\t\t\t\t\t\t\t\t${this.fncFFSStyle(s)}\n\t\t\t\t\t\t\t' data-add='{"ch_in_style":"${this.ch_in_style}", "ch_out_style":"${this.ch_out_style}"}' data-cmd='linkrsv'>${s}</span><rt${u}>${h}</rt></ruby>`:`<span class='sn_ch sn_ch_in_${this.ch_in_style}' style='animation-delay: ${this.cumDelay}ms;'><ruby><span data-tcy='${a}' style='\n\t\t\t\t\t\t\t\t\ttext-combine-upright: all;\n\t\t\t\t\t\t\t\t\t-webkit-text-combine: horizontal;\n\t\t\t\t\t\t\t\t\t${this.fncFFSStyle(s)}\n\t\t\t\t\t\t\t\t' data-add='{"ch_in_style":"${this.ch_in_style}", "ch_out_style":"${this.ch_out_style}"}'>${s}</span><rt${u}>${h}</rt></ruby></span>`:this.aSpan_bk?`<span data-tcy='${a}' style='\n\t\t\t\t\t\t\ttext-combine-upright: all;\n\t\t\t\t\t\t\t-webkit-text-combine: horizontal;\n\t\t\t\t\t\t\t${this.fncFFSStyle(s)}\n\t\t\t\t\t\t' data-add='{"ch_in_style":"${this.ch_in_style}", "ch_out_style":"${this.ch_out_style}"}' data-cmd='linkrsv'>${s}</span>`:`<span data-tcy='${a}' style='\n\t\t\t\t\t\t\ttext-combine-upright: all;\n\t\t\t\t\t\t\t-webkit-text-combine: horizontal;\n\t\t\t\t\t\t\tanimation-delay: ${this.cumDelay}ms;\n\t\t\t\t\t\t\theight: 1em;\n\t\t\t\t\t\t\t${this.fncFFSStyle(s)}\n\t\t\t\t\t\t' class='sn_ch sn_ch_in_${this.ch_in_style}' data-add='{"ch_in_style":"${this.ch_in_style}", "ch_out_style":"${this.ch_out_style}"}'>${s}</span>`,this.ch_in_join&&(this.cumDelay+=p.doAutoWc?p.hAutoWc[t.charAt(0)]??0:c.LayerMng.msecChWait)}}this.aSpan.push(p.rec(r))},this.cumDelay=0,this.firstCh=!0,this.aSpan=[],this.aSpan_bk=null,this.aSpan_link="",this.hSpanBk={ch_in_style:"",ch_out_style:"",r_align:""},this.click=()=>!this.spLay.interactiveChildren||!this.spLay.visible||this.txs.skipChIn(),this.page_text="",this.addButton=t=>new Promise((e=>{t.key=`btn=[${this.cntBtn.children.length}] `+this.name_,t[":id_tag"]=t.key.slice(0,-7),(0,n.argChk_Boolean)(t,"hint_tate",this.txs.tategaki);const i=new u.Button(t,p.evtMng,(()=>e()),(()=>this.canFocus()));i.name=JSON.stringify(t).replaceAll('"',"'"),this.cntBtn.addChild(i)})),this.record=()=>Object.assign(super.record(),{enabled:this.enabled,r_align:this.r_align,b_do:null===this.b_do?null:this.b_do instanceof l.Sprite?"Sprite":"Graphics",b_pic:this.b_pic,b_color:this.b_color,b_alpha:this.b_alpha,b_alpha_isfixed:this.b_alpha_isfixed,ffs:this.ffs,txs:this.txs.record(),strNoFFS:this.strNoFFS,btns:this.cntBtn.children.map((t=>t.name))}),this.spLay.addChild(this.txs),this.rbSpl.init(this.putCh),this.spLay.addChild(this.cntBtn),this.cntBtn.name="cntBtn";const t=16*n.CmnLib.retinaRate;this.lay({style:`width: ${n.CmnLib.stageW}px; height: ${n.CmnLib.stageH}px; font-family: 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', ' Medium', meiryo, sans-serif; color: white; font-size: 24px; line-height: 1.5; padding: ${t}px;`,in_style:"default",out_style:"default",back_clear:"true"})}static init(t,e,i,r,a){p.cfg=t,s.TxtStage.init(t),p.val=i,p.recText=r,p.isPageFore=a,i.setDoRecProc(p.chgDoRec),e.autowc=t=>p.autowc(t),e.autowc({enabled:"false",text:"",time:""}),e.ch_in_style=t=>p.ch_in_style(t),e.ch_out_style=t=>p.ch_out_style(t),s.TxtStage.initChStyle(),(0,n.initStyle)();let h="";t.matchPath(".+",o.Config.EXT_FONT).forEach((t=>{for(const e in t)h+=`\n@font-face {\n\tfont-family: '${t[e]}';\n\tsrc: url('${this.cfg.searchPath(t[e],o.Config.EXT_FONT)}');\n}\n`})),h+="\n.sn_tx {\n\tpointer-events: none;\n\tuser-select: none;\n\t-webkit-touch-callout: none;\n\tbox-sizing: border-box;\n}\n.sn_ch {\n\tposition: relative;\n\tdisplay: inline-block;\n}\n",(0,n.addStyle)(h),p.ch_in_style({name:"default",wait:500,alpha:0,x:"=0.3",y:"=0",scale_x:1,scale_y:1,rotate:0,join:!0,ease:"ease-out"}),p.ch_out_style({name:"default",wait:0,alpha:0,x:"=0",y:"=0",scale_x:1,scale_y:1,rotate:0,join:!1,ease:"ease-out"})}static ch_in_style(t){const e=s.TxtStage.ch_in_style(t),i="="===e.x.charAt(0)?100*e.nx+"%":`${e.nx}px`,r="="===e.y.charAt(0)?100*e.ny+"%":`${e.ny}px`,o=t.name;return(0,n.addStyle)(`\n.sn_ch_in_${o} {\n\tposition: relative;\n\tdisplay: inline-block;\n}\n.go_ch_in_${o} {\n\topacity: ${e.alpha};\n\tposition: relative;\n\tdisplay: inline-block;\n\tanimation: sn_ch_in_${o} ${e.wait}ms ${e.ease} 0s both;\n}\n@keyframes sn_ch_in_${o} {\n\tfrom {transform: rotate(${e.rotate}deg) scale(${e.scale_x}, ${e.scale_y}) translate(${i}, ${r});}\n\tto {opacity: 1; transform: none;}\n}\n`),!1}static ch_out_style(t){const e=s.TxtStage.ch_out_style(t),i="="===e.x.charAt(0)?100*e.nx+"%":`${e.nx}px`,r="="===e.y.charAt(0)?100*e.ny+"%":`${e.ny}px`,o=t.name;return(0,n.addStyle)(`\n.go_ch_out_${o} {\n\tposition: relative;\n\tdisplay: inline-block;\n\tanimation: go_ch_out_${o} ${e.wait}ms ${e.ease} 0s both;\n}\n@keyframes go_ch_out_${o} {\n\tto {\n\t\topacity: ${e.alpha};\n\t\ttransform: rotate(${e.rotate}deg) scale(${e.scale_x}, ${e.scale_y}) translate(${i}, ${r});\n\t}\n`),!1}static setEvtMng(t,e){p.main=t,p.evtMng=e,s.TxtStage.setEvtMng(e)}static autowc(t){p.doAutoWc=(0,n.argChk_Boolean)(t,"enabled",p.doAutoWc),p.val.setVal_Nochk("save","const.sn.autowc.enabled",p.doAutoWc);const e=t.text;if("text"in t!="time"in t)throw"[autowc] texttime";if(p.val.setVal_Nochk("save","const.sn.autowc.text",e),!e)return p.val.setVal_Nochk("save","const.sn.autowc.time",""),!1;const i=e.length;if(p.doAutoWc&&0===i)throw'[autowc] enabled === false  text === "" ';const r=String(t.time).split(",");if(r.length!==i)throw"[autowc] texttime";return p.hAutoWc={},r.forEach(((t,i)=>p.hAutoWc[e[i]]=(0,n.uint)(t))),p.val.setVal_Nochk("save","const.sn.autowc.time",t.time),!1}destroy(){this.b_do&&(this.spLay.removeChild(this.b_do).destroy(),this.b_do=null),this.clearText(),this.txs.destroy(),p.doAutoWc=!1,p.hAutoWc={},p.rec=t=>t}set name(t){this.name_=t,this.txs.name=t}get name(){return this.name_}cvsResize(){this.txs.cvsResize()}cvsResizeChildren(){this.cntBtn.children.forEach((t=>t.cvsResize()))}lay(t){return super.lay(t),r.Layer.setXY(this.spLay,t,this.spLay),t[":id_tag"]=this.name_.slice(0,-7),a.RubySpliter.setting(t),this.setFfs(t),this.txs.lay(t),"r_align"in t&&(this.r_align=t.r_align??""),this.ruby_pd=n.CmnLib.isSafari?this.txs.tategaki?(t,e)=>`text-align: start; height: ${e}em; padding-top: ${t}; padding-bottom: ${t};`:(t,e)=>`text-align: start; width: ${e}em; padding-left: ${t}; padding-right: ${t};`:this.txs.tategaki?t=>`text-align: justify; text-align-last: justify; padding-top: ${t}; padding-bottom: ${t};`:t=>`text-align: justify; text-align-last: justify; padding-left: ${t}; padding-right: ${t};`,n.CmnLib.isFirefox&&(this.mkStyle_r_align=this.mkStyle_r_align4ff),"alpha"in t&&this.cntBtn.children.forEach((t=>t.alpha=this.spLay.alpha)),this.set_ch_in(t),this.set_ch_out(t),this.drawBack(t,(t=>{t&&p.main.resume()}))}set_ch_in(t){const e=t.in_style;if(!e)return;const i=s.TxtStage.getChInStyle(e);if(!i)throw`in_style${e}`;this.ch_in_style=e,this.ch_in_join=i.join}get width(){return this.txs.getWidth()}get height(){return this.txs.getHeight()}set_ch_out(t){const e=t.out_style;if(e){if(!s.TxtStage.getChOutStyle(e))throw`out_style${e}`;this.ch_out_style=e}}drawBack(t,e){if("back_clear"in t)return(0,n.argChk_Boolean)(t,"back_clear",!1)&&(this.b_color=0,this.b_alpha=0,this.b_alpha_isfixed=!1,this.b_pic=""),e(!1),!1;this.b_alpha=(0,n.argChk_Num)(t,"b_alpha",this.b_alpha),this.b_alpha_isfixed=(0,n.argChk_Boolean)(t,"b_alpha_isfixed",this.b_alpha_isfixed);const i=(this.b_alpha_isfixed?1:Number(p.val.getVal("sys:TextLayer.Back.Alpha")))*this.b_alpha;if(t.b_pic){if(this.b_pic!==t.b_pic)return this.b_pic=t.b_pic,this.b_do&&(this.spLay.removeChild(this.b_do),this.b_do.destroy()),h.GrpLayer.csv2Sprites(this.b_pic,this.spLay,(t=>{this.b_do=t,t.name="back(pic)",t.visible=i>0,t.alpha=i,this.txs.setSize(t.width,t.height),this.spLay.setChildIndex(t,0),e(!0)}))}else if("b_color"in t){this.b_color=parseInt(t.b_color||"0"),this.b_do&&(this.spLay.removeChild(this.b_do),this.b_do.destroy()),this.b_pic="";const e=this.b_do=new l.Graphics;e.name="back(color)",e.beginFill(this.b_color),e.lineStyle(void 0),e.drawRect(0,0,this.infTL.$width,this.infTL.$height),e.endFill(),this.spLay.addChildAt(e,0)}return this.b_do&&(this.b_do.visible=i>0,this.b_do.alpha=i),e(!1),!1}chgBackAlpha(t){const e=this.b_alpha_isfixed?this.b_alpha:t*this.b_alpha;if(this.b_do instanceof l.Graphics){this.b_do&&(this.spLay.removeChild(this.b_do),this.b_do.destroy());const t=this.b_do=new l.Graphics;t.name="back(color)",t.beginFill(this.b_color),t.lineStyle(void 0),t.drawRect(0,0,this.infTL.$width,this.infTL.$height),t.endFill(),this.spLay.addChildAt(t,0)}this.b_do&&(this.b_do.visible=e>0,this.b_do.alpha=e)}setFfs(t){"noffs"in t&&(this.strNoFFS=t.noffs??"",this.regNoFFS=new RegExp(`[${this.strNoFFS}]`)),"ffs"in t&&(this.ffs??="",""===this.ffs?(this.fncFFSStyle=()=>"",this.fncFFSSpan=t=>t):(this.fncFFSStyle=t=>this.regNoFFS.test(t)?"":` font-feature-settings: ${this.ffs};`,this.fncFFSSpan=t=>this.regNoFFS.test(t)?t:`<span style='font-feature-settings: ${this.ffs};'>${t}</span>`))}static chgDoRec(t){p.rec=t?t=>t:t=>`<span class='offrec'>${t}</span>`}mkStyle_r_align(t,e,i){if(!i)return"";const r=2*t.length;if(r-e.length<0)return` style='text-align: ${i};'`;let n="";switch(i){case"justify":n=this.ruby_pd("0",r);break;case"121":n=this.ruby_pd(`calc(${(r-e.length)/(2*e.length)}em)`,r);break;case"even":n=this.ruby_pd(`calc(${(r-e.length)/(e.length+1)}em)`,r);break;case"1ruby":n=this.ruby_pd("1em",r);break;default:n=`text-align: ${i};`}return` style='${n}'`}mkStyle_r_align4ff(t,e,i){if(!i)return"";const r=2*t.length;if(r-e.length<0)return` style='text-align: ${i};'`;let n="";switch(i){case"left":n="ruby-align: start;";break;case"center":n="ruby-align: center;";break;case"right":n="ruby-align: start;";break;case"justify":n="ruby-align: space-between;";break;case"121":n="ruby-align: space-around;";break;case"even":const t=(r-e.length)/(e.length+1);n="ruby-align: space-between; "+(this.txs.tategaki?`padding-top: ${t}em; padding-bottom: ${t}em;`:`padding-left: ${t}em; padding-right: ${t}em;`);break;case"1ruby":n="ruby-align: space-between; "+(this.txs.tategaki?"padding-top: 1em; padding-bottom: 1em;":"padding-left: 1em; padding-right: 1em;");break;default:n=`text-align: ${i};`}return` style='${n}'`}tagCh(t){this.rbSpl.putTxt(t)}tagCh_sub(t,e,i,r){" "===t&&(t="&nbsp;"),p.val.doRecLog()&&(this.page_text+=t+(e?`${e}`:""));let n="";const s=this.mkStyle_r_align(t,e,r);return i&&(this.cumDelay=0),n=e?this.aSpan_bk?`<ruby style='${this.fncFFSStyle(t)}' data-add='{"ch_in_style":"${this.ch_in_style}", "ch_out_style":"${this.ch_out_style}"}' data-cmd='linkrsv'>${t}<rt${s}>${e}</rt></ruby>`:`<span class='sn_ch sn_ch_in_${this.ch_in_style}' style='animation-delay: ${this.cumDelay}ms;${this.fncFFSStyle(t)}'><ruby data-add='{"ch_in_style":"${this.ch_in_style}", "ch_out_style":"${this.ch_out_style}"}'>${t}<rt${s}>${e}</rt></ruby></span>`:this.aSpan_bk?this.fncFFSSpan(t):`<span class='sn_ch sn_ch_in_${this.ch_in_style}' style='animation-delay: ${this.cumDelay}ms;${this.fncFFSStyle(t)}' data-add='{"ch_in_style":"${this.ch_in_style}", "ch_out_style":"${this.ch_out_style}"}'>${t}</span>`,this.ch_in_join&&(this.cumDelay+=p.doAutoWc?p.hAutoWc[t.charAt(0)]??0:c.LayerMng.msecChWait),n}beginSpan(t){this.hSpanBk.ch_in_style=this.ch_in_style,this.set_ch_in(t),this.hSpanBk.ch_out_style=this.ch_out_style,this.set_ch_out(t),this.hSpanBk.r_align=this.r_align,"r_align"in t&&(this.r_align=t.r_align)}autoCloseSpan(){this.aSpan_bk&&(this.aSpan_bk.push(this.aSpan,"</span>"),this.aSpan=Array.prototype.concat.apply([],this.aSpan_bk),this.aSpan_bk=null,this.set_ch_in({in_style:this.hSpanBk.ch_in_style}),this.set_ch_out({out_style:this.hSpanBk.ch_out_style}),this.r_align=this.hSpanBk.r_align)}clearText(){this.spLay.addChild(this.txs=this.txs.reNew()),this.cumDelay=0,this.firstCh=!0,this.aSpan=[],this.aSpan_bk=null,this.page_text="",p.recText("",!0)}get pageText(){return this.page_text.replace("","")}get enabled(){return this.spLay.interactiveChildren}set enabled(t){this.spLay.interactiveChildren=t}canFocus(){return(this.spLay.interactiveChildren??!1)&&this.spLay.visible&&p.isPageFore(this)}clearLay(t){super.clearLay(t),this.clearText(),this.cntBtn.removeChildren().forEach((t=>t.destroy()))}playback(t,e){super.playback(t,e),this.enabled=t.enabled,this.r_align=t.r_align,this.cvsResize(),this.b_alpha=t.b_alpha,this.b_alpha_isfixed=t.b_alpha_isfixed,e.push(new Promise((e=>{this.drawBack(t.b_do?"Sprite"===t.b_do?{b_pic:t.b_pic}:{b_color:t.b_color}:{b_pic:""},(t=>{t&&e()}))||e()}))),this.setFfs(t),this.txs.playback(t.txs);const i=t.btns;e=e.concat(i.map((t=>this.addButton(JSON.parse(t.replaceAll("'",'"'))))))}snapshot(t,e){t.render(this.spLay,void 0,!1),this.txs.snapshot(t,e)}snapshot_end(){this.txs.snapshot_end()}makeDesignCast(t){this.spLay.visible&&this.txs.makeDesignCast(t)}makeDesignCastChildren(t){this.spLay.visible&&this.cntBtn.children.forEach((e=>e.makeDesignCast(t)))}showDesignCast(){this.txs.showDesignCast()}showDesignCastChildren(){this.cntBtn.children.forEach((t=>t.showDesignCast()))}dump(){return this.putCh("","gotxt"),super.dump()+`, "enabled":"${this.enabled}", ${this.txs.dump()}, "b_pic":"${this.b_pic}", "b_color":"${this.b_color}", "b_alpha":${this.b_alpha}, "b_alpha_isfixed":"${this.b_alpha_isfixed}", "b_width":${this.infTL.$width}, "b_height":${this.infTL.$height}, "pixi_obj":[${this.spLay.children.map((t=>`{"class":"${t instanceof l.Sprite?"Sprite":t instanceof l.Graphics?"Graphics":t instanceof l.Container?"Container":"?"}", "name":"${t.name}", "alpha":${t.alpha}, "x":${t.x}, "y":${t.y}, "visible":"${t.visible}"}`)).join(",")}], "button":[${this.cntBtn.children.map((t=>t.children[0].name)).join(",")}]`}}e.TxtLayer=p,p.doAutoWc=!1,p.hAutoWc={},p.rec=t=>t},7411:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TxtStage=void 0;const r=i(4965),n=i(8566),s=i(7007),o=i(7307),a=i(4412),h=i(6841),u=i(6194);class c extends h.Container{constructor(t,e,i){super(),this.infTL=t,this.spLay=e,this.canFocus=i,this.htmTxt=document.createElement("span"),this.cntTxt=new h.Container,this.grpDbgMasume=new h.Graphics,this.idc=new a.TxtLayDesignCast(this.spLay,this),this.idcCh=new a.TxtLayPadDesignCast(this),this.left=0,this.isTategaki=!1,this.padTx4x=0,this.padTx4y=0,this.aSpTw=[],this.aRect=[],this.lenHtmTxt=0,this.beforeHTMLElm=null,this.rctm=new h.Rectangle,this.regDs=/animation\-duration: (?<ms>\d+)ms;/,this.fncEndChIn=()=>{},this.isChInIng=!1,this.lh_half=0,this.fi_easing="Quadratic.Out",this.fo_easing="Quadratic.Out",this.sss=null,this.htmTxt.classList.add("sn_tx"),this.htmTxt.style.position="absolute",c.cvs.parentElement.appendChild(this.htmTxt),this.addChild(this.cntTxt),this.addChild(this.grpDbgMasume),this.grpDbgMasume.name="grpDbgMasume",this.idc.adopt(this.idcCh)}static init(t){c.cfg=t,c.cvs=document.getElementById(r.CmnLib.SN_ID),c.reg=/[!?]/,c.reg=/[]/,c.reg=/[]/}static setEvtMng(t){c.evtMng=t}static destroy(){c.hWarning={backgroundColor:0,borderBottomWidth:0,borderLeftWidth:0,borderRightWidth:0,borderTopWidth:0,marginBottom:0,marginLeft:0,marginRight:0,marginTop:0},c.hChInStyle=Object.create(null),c.hChOutStyle=Object.create(null),c.cntBreak=new h.Container}getInfTL(){return this.infTL}lay(t){const e=this.htmTxt.style;if(t.style){const i=document.createElement("span");i.style.cssText=t.style;const r=i.style.length;for(let t=0;t<r;++t){const r=i.style[t];r in c.hWarning?o.DebugMng.myTrace(`${r}`,"W"):e[r]=i.style[r]}!i.style.opacity&&"alpha"in t&&(e.opacity=String(this.spLay.alpha))}else"alpha"in t&&(e.opacity=String(this.spLay.alpha));if("width"in t&&(e.width=(t.width??"0")+"px"),"height"in t&&(e.height=(t.height??"0")+"px"),"pl"in t&&(e.paddingLeft=(t.pl??"0")+"px"),"pr"in t&&(e.paddingRight=(t.pr??"0")+"px"),"pt"in t&&(e.paddingTop=(t.pt??"0")+"px"),"pb"in t&&(e.paddingBottom=(t.pb??"0")+"px"),this.lay_sub(),this.idc.sethArg(t),this.left=this.spLay.position.x-(r.CmnLib.isSafari&&!r.CmnLib.isMobile&&this.isTategaki?this.infTL.pad_left+this.infTL.pad_right:0),e.transformOrigin=`${this.spLay.pivot.x}px ${this.spLay.pivot.y}px`,this.cvsResize(),e.display=this.spLay.visible?"inline":"none",e.textShadow=t.filter??e.textShadow??"",":redraw"in t&&this.lenHtmTxt>0){const t=[this.htmTxt.innerHTML.replace(/(animation-delay: )\d+ms/g,"$10ms"),"<span class='sn_ch' data-add='{\"ch_in_style\":\"default\"}'></span>"];this.clearText(),this.goTxt(t)}}lay_sub(){const t=this.htmTxt.style,e=parseFloat(t.fontSize||"0");this.infTL.fontsize=e,this.infTL.pad_left=parseFloat(t.paddingLeft||"0"),this.infTL.pad_right=parseFloat(t.paddingRight||"0"),this.infTL.pad_top=parseFloat(t.paddingTop||"0"),this.infTL.pad_bottom=parseFloat(t.paddingBottom||"0"),this.infTL.$width=parseFloat(t.width||"0"),this.infTL.$height=parseFloat(t.height||"0"),this.position.set(this.infTL.pad_left,this.infTL.pad_top),this.isTategaki="vertical-rl"===t.writingMode,this.padTx4x=0,this.padTx4y=0;const i=t.lineHeight??"0";this.lh_half=this.isTategaki?0:("px"===i.slice(-2)?parseFloat(i):e*parseFloat(i)-e)/2}cvsResize(){const t=this.htmTxt.style;t.left=this.left*r.CmnLib.cvsScale+"px",t.top=this.spLay.position.y*r.CmnLib.cvsScale+"px",t.transform=`rotate(${this.spLay.angle}deg) scale(${this.spLay.scale.x*r.CmnLib.cvsScale}, ${this.spLay.scale.y*r.CmnLib.cvsScale}`,this.idc.cvsResize(),this.idcCh.cvsResize()}get tategaki(){return this.isTategaki}getWidth(){return this.infTL.$width}getHeight(){return this.infTL.$height}setSize(t,e){this.infTL.$width=t,this.infTL.$height=e,this.htmTxt.style.width=this.infTL.$width+"px",this.htmTxt.style.height=this.infTL.$height+"px"}htm2tx(t,e=!0){const i={escape:t=>t.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1"),mimeType:t=>{const e=function(t){return/\.([^\.\/]*?)$/g.exec(t)?.[1]??""}(t).toLowerCase();return function(){const t="application/font-woff",e="image/jpeg";return{woff:t,woff2:t,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:e,jpeg:e,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}()[e]||""},dataAsUrl:function(t,e){return"data:"+e+";base64,"+t},isDataUrl:function(t){return-1!==t.search(/^(data:)/)},resolveUrl:function(t,e){const i=document.implementation.createHTMLDocument(),r=i.createElement("base");i.head.appendChild(r);const n=i.createElement("a");return i.body.appendChild(n),r.href=e,n.href=t,n.href},getAndEncode:function(t){return new Promise((function(e){const i=new XMLHttpRequest;function r(t){console.error(t),e("")}i.onreadystatechange=function(){if(4!==i.readyState)return;if(200!==i.status)return void r("cannot fetch resource: "+t+", status: "+i.status);const n=new FileReader;n.onloadend=function(){const t=n.result.toString().split(/,/)[1];e(t)},n.readAsDataURL(i.response)},i.ontimeout=function(){r("timeout of 30000ms occured while fetching resource: "+t)},i.responseType="blob",i.timeout=3e4,i.open("GET",t,!0),i.send()}))},asArray:t=>{const e=[],i=t.length;for(let r=0;r<i;++r)e.push(t[r]);return e}},r=function(){const t=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:function(t,i,s){return e(t)?Promise.resolve(t).then(r).then((e=>{let r=Promise.resolve(t);for(const t of e)r=r.then((e=>n(e,t,i,s)));return r})):Promise.resolve(t)},shouldProcess:e};function e(e){return-1!==e.search(t)}function r(e){const r=[];let n;for(;n=t.exec(e);)r.push(n[1]);return r.filter((function(t){return!i.isDataUrl(t)}))}function n(t,e,r,n){return Promise.resolve(e).then((t=>r?i.resolveUrl(t,r):t)).then(n||i.getAndEncode).then((t=>i.dataAsUrl(t,i.mimeType(e)))).then((r=>t.replace(function(t){return new RegExp("(url\\(['\"]?)("+i.escape(t)+")(['\"]?\\))","g")}(e),"$1"+r+"$3")))}}(),n=function(){return{resolveAll:function(){return t().then((t=>Promise.all(t.map((t=>t.resolve()))))).then((t=>t.join("\n")))},impl:{readAll:t}};function t(){return Promise.resolve(i.asArray(document.styleSheets)).then((function(t){const e=[];for(const r of t)try{if(r.href)continue;i.asArray(r.cssRules||[]).forEach(e.push.bind(e))}catch(t){console.error("Error while reading CSS rules from "+r.href,t.toString())}return e})).then((function(t){return t.filter((t=>t.type===CSSRule.FONT_FACE_RULE)).filter((t=>r.shouldProcess(t.style.getPropertyValue("src"))))})).then((e=>e.map(t)));function t(t){return{resolve:function(){const e=(t.parentStyleSheet||{}).href;return r.inlineAll(t.cssText,e)},src:function(){return t.style.getPropertyValue("src")}}}}}();Promise.resolve(this.htmTxt).then((t=>{const i=t.cloneNode(!0);return i.style.padding="0px",i.style.paddingRight=this.padTx4x+"px",i.style.paddingTop=this.padTx4y+"px",i.style.left="0px",i.style.top="0px",i.style.width=this.infTL.$width-this.infTL.pad_left-this.infTL.pad_right+"px",i.style.height=this.infTL.$height-this.infTL.pad_top-this.infTL.pad_bottom+"px",this.htmTxt.hidden=e,i})).then((function(t){return n.resolveAll().then((e=>{const i=document.createElement("style");return t.appendChild(i),i.appendChild(document.createTextNode(e)),t}))})).then((t=>{t.setAttribute("xmlns","http://www.w3.org/1999/xhtml");const e=new Image;return e.src=`data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="${this.infTL.$width}px" height="${this.infTL.$height}px"><foreignObject x="0" y="0" width="100%" height="100%">${(new XMLSerializer).serializeToString(t).replaceAll("#","%23").replaceAll("\n","%0A")}</foreignObject></svg>`,new Promise((t=>e.onload=()=>t(e)))})).then((t=>new Promise((e=>setTimeout((()=>e(t)),100))))).then((e=>{const i=document.createElement("canvas");i.width=this.infTL.$width,i.height=this.infTL.$height,i.getContext("2d").drawImage(e,0,0),i.toBlob((e=>{const i=URL.createObjectURL(e);h.Texture.from(i).once("update",(e=>{t(e),URL.revokeObjectURL(i)}))}))})).catch((t=>o.DebugMng.myTrace(`goTxt() = ${t}`)))}goTxt(t){c.cntBreak.visible=!1;const e=this.aRect.length;c.cfg.oCfg.debug.masume&&0===e&&(r.CmnLib.debugLog&&console.log(` masume ${this.name} v:${this.visible} l:${this.x} t:${this.y} a:${this.alpha} pl:${this.infTL.pad_left} pr:${this.infTL.pad_right} pt:${this.infTL.pad_top} pb:${this.infTL.pad_bottom} w:${this.infTL.$width} h:${this.infTL.$height}`),this.grpDbgMasume.clear(),this.grpDbgMasume.beginFill(3407616,.2),this.grpDbgMasume.lineStyle(1,3407616,1),this.grpDbgMasume.drawRect(-this.infTL.pad_left,-this.infTL.pad_top,this.infTL.$width,this.infTL.$height),this.grpDbgMasume.endFill(),this.grpDbgMasume.beginFill(13311,.2),this.grpDbgMasume.lineStyle(2,13311,1),this.grpDbgMasume.drawRect(0,0,this.infTL.$width-this.infTL.pad_left-this.infTL.pad_right,this.infTL.$height-this.infTL.pad_top-this.infTL.pad_bottom),this.grpDbgMasume.endFill()),0===e?this.htmTxt.innerHTML=[...t].join(""):this.htmTxt.insertAdjacentHTML("beforeend",t.slice(this.lenHtmTxt).join("")),this.lenHtmTxt=t.length;let i=0,o=2;do{const t=this.aRect=this.getChRects(this.htmTxt);if(i=t.length,1!==r.CmnLib.cvsScale){const e=r.CmnLib.ofsPadLeft_Dom2PIXI+parseFloat(this.htmTxt.style.left)*(1-r.CmnLib.cvsScale),n=r.CmnLib.ofsPadTop_Dom2PIXI+parseFloat(this.htmTxt.style.top)*(1-r.CmnLib.cvsScale);for(let s=0;s<i;++s){const i=t[s].rect;i.x-=e,i.y-=n,i.x/=r.CmnLib.cvsScale,i.y/=r.CmnLib.cvsScale,i.width/=r.CmnLib.cvsScale,i.height/=r.CmnLib.cvsScale}}if(i<2)break;let e=-1/0;for(;o<i;++o){const n=t[o];if("<rt"===n.elm.outerHTML.slice(0,3))continue;const s=this.tategaki?n.rect.y:n.rect.x;if(e<s){e=s;continue}if(e=-1/0,c.reg.test(t[o-1].ch)&&t[o-1].ch===n.ch)r.CmnLib.debugLog&&console.log(`ch:${n.ch}`),--o;else{if(c.reg.test(t[o-1].ch))r.CmnLib.debugLog&&console.log(`ch:${t[o-1].ch}`),--o;else{if(!c.reg.test(n.ch))continue;for(r.CmnLib.debugLog&&console.log(` Ach:${n.ch}`);o>0&&c.reg.test(t[--o].ch);)r.CmnLib.debugLog&&console.log(` Ach:${t[o].ch}`)}for(;o>0&&c.reg.test(t[o-1].ch);)r.CmnLib.debugLog&&console.log(` Bch:${t[o-1].ch}`),--o}const a=t[o].elm.parentElement,h=document.createElement("br");a.classList.contains("sn_tx")?a.insertBefore(h,t[o].elm):a.parentElement.insertBefore(h,a),o+=2,i=-1;break}}while(i<0);const a=r.CmnLib.debugLog?(t,e)=>console.log(` masume ch:${t.ch} x:${e.x} y:${e.y} w:${e.width} h:${e.height}`):()=>{},u=c.cfg.oCfg.debug.masume?(t,e)=>{a(t,e),this.grpDbgMasume.beginFill(6737151,.5),this.grpDbgMasume.lineStyle(2,16724736,1),this.grpDbgMasume.drawRect(e.x,e.y,e.width,e.height),this.grpDbgMasume.endFill()}:()=>{},l=n.CmnTween.ease(this.fi_easing),p=this.htmTxt.getBoundingClientRect(),d=p.left+globalThis.pageXOffset+this.infTL.pad_left,f=p.top+globalThis.pageYOffset+this.infTL.pad_top;for(let t=e;t<i;++t){const e=this.aRect[t],i=e.rect,r=JSON.parse(e.arg??'{"delay": 0}'),n=JSON.parse(e.add??"{}"),o=c.hChInStyle[n.ch_in_style];switch(i.x-=d,i.y-=f,u(e,i),o&&(this.isTategaki?(i.x+=(i.width-i.height)/2,i.width=i.height):(i.y+=(i.height-i.width)/2,i.height=i.width),this.rctm=i),e.cmd){case"grp":const a=new h.Container;this.cntTxt.addChild(a),s.GrpLayer.csv2Sprites(r.pic,a,(t=>{this.spWork(a,r,n,i,l,o??{}),a.parent||a.removeChild(t)}));break;case"link":const u=new h.Sprite;r.key=`lnk=[${t}] `+this.name,this.spWork(u,r,n,i,l,o??{}),r.hint_tate??=this.isTategaki;const p=e.elm.style.cssText,d=r.style_hover??"",f=r.style_clicked??"",g=this.beforeHTMLElm!==e.elm;c.evtMng.button(r,u,(()=>e.elm.style.cssText=p),g?()=>!!this.canFocus()&&(e.elm.style.cssText=d,!0):()=>!1,(()=>e.elm.style.cssText=f)),this.beforeHTMLElm=e.elm,this.cntTxt.addChild(u)}}this.aRect.slice(0,-1),--this.lenHtmTxt;const g=this.htmTxt.getElementsByTagName("span"),m=g.length;m>0&&this.htmTxt.removeChild(g[m-1]);const _=this.htmTxt.querySelectorAll("span.sn_ch");_.forEach((t=>t.className=t.className.replace(/sn_ch_in_([^\s"]+)/g,"go_ch_in_$1"))),this.isChInIng=!0,this.fncEndChIn=()=>{this.isChInIng=!1,_.forEach((t=>t.className=t.className.replace(/ go_ch_in_[^\s"]+/g,""))),c.cntBreak.position.set(this.rctm.x,this.rctm.y),c.cntBreak.visible=!0,this.fncEndChIn=()=>{}};const v=_.length;if(0===v)return void this.fncEndChIn();let y=null;for(let t=v-1;t>=0;--t){const e=_[t];if("sn_ch"===e.className)break;const i=e.getAttribute("style");if(!i){y=e;break}const r=i.match(this.regDs)?.groups;if(!r||Number(r.ms)>0){y=e;break}}y?y.addEventListener("animationend",this.fncEndChIn,{once:!0,passive:!0}):this.fncEndChIn()}spWork(t,e,i,r,n,s){t.alpha=0,e.x&&(r.x="="===e.x.charAt(0)?r.x+parseInt(e.x.slice(1)):parseInt(e.x)),e.y&&(r.y="="===e.y.charAt(0)?r.y+parseInt(e.y.slice(1)):parseInt(e.y)),e.width&&(r.width=parseInt(e.width)),e.height&&(r.height=parseInt(e.height)),e.wait&&(s.wait=parseInt(e.wait)),t.width=r.width,t.height=r.height,t.position.set("="===s.x.charAt(0)?r.x+t.width*s.nx:s.nx,"="===s.y.charAt(0)?r.y+t.height*s.ny:s.ny);const o={sp:t,tw:new u.Tween(t).to({alpha:1,x:r.x,y:r.y,width:r.width,height:r.height,angle:0},s.wait??0).easing(n).delay((i.wait??0)+(e.delay??0)).onComplete((()=>{o.tw=null})).start()};this.aSpTw.push(o)}skipChIn(){let t=this.isChInIng;return this.fncEndChIn(),this.aSpTw.forEach((e=>{e.tw&&(e.tw.stop().end(),t=!0)})),this.aSpTw=[],t}static initChStyle(){c.hChInStyle=Object.create(null),c.hChOutStyle=Object.create(null)}static getChInStyle(t){return c.hChInStyle[t]}static ch_in_style(t){const e=t.name;if(!e)throw"name";if(c.REG_NG_CHSTYLE_NAME_CHR.lastIndex=0,c.REG_NG_CHSTYLE_NAME_CHR.test(e))throw`name${e}`;if(e in c.hChInStyle)throw`name${e}`;const i=String(t.x??"=0"),n=String(t.y??"=0");return c.hChInStyle[e]={wait:(0,r.argChk_Num)(t,"wait",500),alpha:(0,r.argChk_Num)(t,"alpha",0),x:i,y:n,nx:parseFloat("="===i.charAt(0)?i.slice(1):i),ny:parseFloat("="===n.charAt(0)?n.slice(1):n),scale_x:(0,r.argChk_Num)(t,"scale_x",1),scale_y:(0,r.argChk_Num)(t,"scale_y",1),rotate:(0,r.argChk_Num)(t,"rotate",0),join:(0,r.argChk_Boolean)(t,"join",!0),ease:t.ease??"ease-out"}}static getChOutStyle(t){return c.hChOutStyle[t]}static ch_out_style(t){const e=t.name;if(!e)throw"name";if(c.REG_NG_CHSTYLE_NAME_CHR.lastIndex=0,c.REG_NG_CHSTYLE_NAME_CHR.test(e))throw`name${e}`;if(e in c.hChOutStyle)throw`name${e}`;const i=String(t.x??"=0"),n=String(t.y??"=0");return c.hChOutStyle[e]={wait:(0,r.argChk_Num)(t,"wait",500),alpha:(0,r.argChk_Num)(t,"alpha",0),x:i,y:n,nx:parseFloat("="===i.charAt(0)?i.slice(1):i),ny:parseFloat("="===n.charAt(0)?n.slice(1):n),scale_x:(0,r.argChk_Num)(t,"scale_x",1),scale_y:(0,r.argChk_Num)(t,"scale_y",1),rotate:(0,r.argChk_Num)(t,"rotate",0),join:(0,r.argChk_Boolean)(t,"join",!1),ease:t.ease??"ease-out"}}dispBreak(t){const e=c.cntBreak;e.visible=!1,this.addChild(e),s.GrpLayer.csv2Sprites(t,e,(t=>{e.parent||e.removeChild(t)}))}static delBreak(){const t=c.cntBreak;t.parent&&(t.parent.removeChild(t),t.removeChildren()),c.cntBreak=new h.Container}getChRects(t){const e=[];if(t.nodeType!==t.TEXT_NODE)return t.childNodes.forEach((t=>e.push(this.getChRects(t)))),Array.prototype.concat.apply([],e);const i=t.ownerDocument.createRange();i.selectNodeContents(t);let r=0;const n=i.endOffset;for(;r<n;){i.setStart(t,r),i.setEnd(t,++r);const n=i.getBoundingClientRect(),s=i.startContainer.parentElement;if(!s)throw"fn:TxtStage.ts pe null";const o=i.toString(),a={ch:o,rect:new h.Rectangle(n.left+globalThis.pageXOffset,n.top+globalThis.pageYOffset,n.width,n.height+("gjqy".includes(o)?this.lh_half:0)),elm:s,cmd:s.getAttribute("data-cmd")??void 0,arg:s.getAttribute("data-arg")??void 0,add:s.getAttribute("data-add")??void 0,tcy:s.getAttribute("data-tcy")??void 0};e.push(a)}return i.detach(),e}clearText(){this.grpDbgMasume.clear(),this.aRect=[],this.lenHtmTxt=0,this.skipChIn();const t=this.htmTxt.cloneNode(!0);t.textContent="";const e=this.htmTxt;e.parentElement.insertBefore(t,e);let i=0;e.querySelectorAll("span.sn_ch").forEach((t=>{const e=JSON.parse(t?.getAttribute("data-add")??t?.children[0]?.getAttribute("data-add")??t?.children[0]?.children[0]?.getAttribute("data-add")??"{}");if(!e.ch_out_style)return;const r=c.hChOutStyle[e.ch_out_style];r&&(0!==r.wait?(i+=r.wait,r.join||(t.style.animationDelay="0ms"),t.classList.add(`go_ch_out_${e.ch_out_style}`)):t.style.display="none")}));const r=()=>{e.parentElement.removeChild(e),this.cntTxt.removeChildren().forEach((t=>t.destroy()))};0===i?(this.htmTxt.textContent="",r()):e.lastElementChild?.addEventListener("animationend",r,{once:!0,passive:!0}),this.htmTxt=t}reNew(){this.clearText();const t=new c(this.infTL,this.spLay,(()=>this.canFocus()));return t.htmTxt.style.cssText=this.htmTxt.style.cssText,t.left=this.left,t.name=this.name,t.lay_sub(),t.idc.sethArg(this.idc.gethArg()),t.ch_filter=this.ch_filter,t.fi_easing=this.fi_easing,t.fo_easing=this.fo_easing,this.destroy(),t}record(){return{infTL:this.infTL,cssText:this.htmTxt.style.cssText,left:this.left,idc_hArg:this.idc.gethArg(),ch_filter:this.ch_filter,fi_easing:this.fi_easing,fo_easing:this.fo_easing}}playback(t){this.infTL=t.infTL,this.position.set(this.infTL.pad_left,this.infTL.pad_top),this.htmTxt.style.cssText=t.cssText,this.left=t.left,this.lay_sub(),this.idc.sethArg(t.idc_hArg),this.ch_filter=t.ch_filter,this.fi_easing=t.fi_easing,this.fo_easing=t.fo_easing}snapshot(t,e){this.htm2tx((i=>{this.sss=new h.Sprite(i),this.isTategaki&&(this.sss.x+=r.CmnLib.stageW-(this.left+this.infTL.$width)-(r.CmnLib.isSafari&&!r.CmnLib.isMobile?0:this.infTL.pad_left+this.infTL.pad_right)),this.sss.y-=this.padTx4y,this.sss.texture.frame=new h.Rectangle(0,0,this.infTL.$width-this.left,this.infTL.$height),this.cntTxt.addChild(this.sss),t.render(this.sss,void 0,!1),e()}),!1)}snapshot_end(){this.sss&&(this.cntTxt.removeChild(this.sss),this.sss=null)}makeDesignCast(t){t(this.idc);const e=this.idc.gethArg();this.idcCh.sethArg({...e,":id_dc":e[":id_tag"]+"_pad"}),t(this.idcCh)}showDesignCast(){this.idc.visible=!0,this.idcCh.visible=!0}dump(){const t=[],e=this.htmTxt.style,i=e.length;for(let r=0;r<i;++r){const i=e[r];t.push(`"${i}":"${e[i].replace(/(["\\])/g,"\\$1")}"`)}return`"txt":"${this.htmTxt.textContent.replace(/(["\\])/g,"\\$1")}", "style":{${t.join(",")}}`}destroy(){c.delBreak(),this.htmTxt.parentElement.removeChild(this.htmTxt),this.removeChild(this.cntTxt),this.removeChild(this.grpDbgMasume),super.destroy()}}e.TxtStage=c,c.hWarning={backgroundColor:0,borderBottomWidth:0,borderLeftWidth:0,borderRightWidth:0,borderTopWidth:0,marginBottom:0,marginLeft:0,marginRight:0,marginTop:0},c.hChInStyle=Object.create(null),c.REG_NG_CHSTYLE_NAME_CHR=/[\s\.,]/,c.hChOutStyle=Object.create(null),c.cntBreak=new h.Container},7408:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Variable=void 0;const r=i(4965),n=i(9630),s=i(7177),o=i(1795);class a{constructor(t,e){if(this.cfg=t,this.hScopes={sys:{},save:{},tmp:{},mp:{}},this.hSave=this.hScopes.save,this.hTmp=this.hScopes.tmp,this.data={sys:{},mark:{},kidoku:{}},this.hAreaKidoku={},this.hProcDbgRes={auth:(t,e)=>this.set_data_break(e.hBreakpoint.aData),var:(t,e)=>this.sys.send2Dbg(e.ri,{v:this.hScopes[e.scope]??{}}),set_var:(t,e)=>{try{this.setVal(e.nm,e.val),this.sys.send2Dbg(e.ri,{})}catch{}},set_data_break:(t,e)=>{this.set_data_break(e.a),this.sys.send2Dbg(e.ri,{})},disconnect:t=>a.hSetEvent={}},this.flush_=()=>{},this.doRecProc=t=>{},this.getMark=t=>this.data.mark[t],this.getAreaKidoku=t=>this.hAreaKidoku[t],this.setVal=(t,e,i=!0)=>{if(!t)throw"[] name";if(null==e)throw"[] textOK";const r=s.PropParser.getValName(t);if(void 0===r)throw"[] name("+t+")";const n=this.hScopes[r.scope];if(!n)throw"[] scope"+r.scope+"";const o=r.name;if("const."===o.slice(0,6)&&o in n)throw"[] "+o+"";this.setVal_Nochk(r.scope,o,e,i)},this.getVal=(t,e)=>{if(!t)throw"[] name";const i=s.PropParser.getValName(t);if(void 0===i)throw"[] name("+t+")";const r=this.hScopes[i.scope];if(!r)throw"[] scope"+i.scope+"";const n=i.name;let o=r[n];if(!(n in r)){o=e;let t="";const i=n.split("."),s=i.length;for(let n=0;n<s;++n,t+="."){if(t+=i[n],!(t in r))continue;let a=JSON.parse(r[t]);if("[object Object]"!==Object.prototype.toString.call(a)){if(n+1===s){o=a;break}continue}let h=n;for(;++h<s;){if(!(i[h]in a)){o=e;break}if(a=a[i[h]],"[object Object]"!==Object.prototype.toString.call(a)||h+1===s){o=a;break}}o instanceof Object&&(o=JSON.stringify(o));break}}return o instanceof Function&&(o=o()),"@str"===i.at?o:this.castAuto(o)},this.REG_NUMERICLITERAL=/^-?[\d\.]+$/,this.dump_val=()=>{const t={tmp:{},sys:{},save:{},mp:{}};for(let e in t){const i=this.hScopes[e],r=t[e];for(let t in i){const e=i[t];"[object Function]"===Object.prototype.toString.call(e)?r[t]=e():r[t]=e}}return console.info(" [dump_val]",t),!1},this.$doRecLog=!1,this.hValTrg={"sys:sn.tagCh.doWait":t=>this.runFirst_Bool_hSysVal_true(t),"sys:sn.tagCh.doWait_Kidoku":t=>this.runFirst_Bool_hSysVal_true(t),"sys:sn.tagCh.msecWait":t=>this.runFirst_sys_an_tagCh_msecWait(t),"sys:sn.tagCh.msecWait_Kidoku":t=>this.runFirst_sys_an_tagCh_msecWait_Kidoku(t),"sys:sn.tagCh.canskip":t=>this.runFirst_Bool_hSysVal_true(t),"sys:sn.auto.msecPageWait":t=>this.runFirst_sys_an_auto_msecPageWait(t),"sys:sn.auto.msecPageWait_Kidoku":t=>this.runFirst_sys_an_auto_msecPageWait(t),"sys:sn.auto.msecLineWait":t=>this.runFirst_sys_an_auto_msecLineWait(t),"sys:sn.auto.msecLineWait_Kidoku":t=>this.runFirst_sys_an_auto_msecLineWait(t),"save:sn.doRecLog":t=>{this.doRecProc(this.$doRecLog=this.runFirst_Bool_hSaveVal_true(t))},"save:sn.userFnTail":(t,e)=>this.cfg.userFnTail=e,"tmp:sn.tagL.enabled":t=>this.runFirst_Bool_hTmp_true(t),"tmp:sn.skip.all":t=>this.runFirst_Bool_hTmp_false(t),"tmp:sn.skip.enabled":t=>this.runFirst_Bool_hTmp_false(t),"tmp:sn.auto.enabled":t=>this.runFirst_Bool_hTmp_false(t),"tmp:flash.desktop.NativeApplication.nativeApplication.systemIdleMode":()=>{},"tmp:sn.chkFontMode":()=>{this.hTmp["const.sn.onLauncher"]||this.hTmp["const.sn.isDebugger"]}},e.let=t=>this.let(t),e.let_abs=t=>this.let_abs(t),e.let_char_at=t=>this.let_char_at(t),e.let_index_of=t=>this.let_index_of(t),e.let_length=t=>this.let_length(t),e.let_replace=t=>this.let_replace(t),e.let_round=t=>this.let_round(t),e.let_search=t=>this.let_search(t),e.let_substr=t=>this.let_substr(t),e.clearsysvar=()=>this.clearsysvar(),e.clearvar=()=>this.clearvar(),e.dump_val=()=>this.dump_val(),e.copybookmark=t=>this.copybookmark(t),e.erasebookmark=t=>this.erasebookmark(t),this.hSave["sn.userFnTail"]="",this.defTmp("const.sn.bookmark.json",(()=>{const e=[];return Object.keys(this.data.mark).sort().forEach((i=>{const r={...this.data.mark[i].json};for(const e in r){const i=r[e];"string"==typeof i&&"userdata:/"===i.slice(0,10)&&(r[e]=t.searchPath(i))}r.place=i,e.push(r)})),JSON.stringify(e)})),this.hTmp["const.sn.isFirstBoot"]=!0,this.hTmp["sn.tagL.enabled"]=!0,this.hTmp["sn.skip.all"]=!1,this.hTmp["sn.skip.enabled"]=!1,this.hTmp["sn.auto.enabled"]=!1,this.hTmp["const.sn.last_page_text"]="",this.hTmp["const.sn.displayState"]=!1,this.hTmp["const.Date.getTime"]=()=>(new Date).getTime(),this.hTmp["const.Date.getDateStr"]=()=>(0,r.getDateStr)(),this.hTmp["const.sn.platform"]=JSON.stringify(o),this.clearsysvar(),this.clearvar(),this.hTmp["const.sn.config.window.width"]=t.oCfg.window.width,this.hTmp["const.sn.config.window.height"]=t.oCfg.window.height,this.hTmp["const.sn.config.book.title"]=t.oCfg.book.title,this.hTmp["const.sn.config.book.version"]=t.oCfg.book.version,this.hTmp["const.sn.Math.PI"]=Math.PI,"undefined"==typeof window)return;const i=window,n=i.AudioContext??i.webkitAudioContext;this.hTmp["const.sn.needClick2Play"]=()=>"suspended"===(new n).state}setSys(t){this.sys=t,t.initVal(this.data,this.hTmp,(e=>{this.updateData(e),sessionStorage.clear();const i=this.cfg.getNs();this.flush_=this.cfg.oCfg.debug.variable?()=>{const e={};Object.keys(this.hSys).forEach((t=>{const i=this.hSys[t];e["sys:"+t]=i instanceof Function?i():i})),sessionStorage[i+"sys"]=JSON.stringify(e);const r={};Object.keys(this.hSave).forEach((t=>{const e=this.hSave[t];r["save:"+t]=e instanceof Function?e():e})),sessionStorage[i+"save"]=JSON.stringify(r);const n={};Object.keys(this.hTmp).forEach((t=>{const e=this.hTmp[t];n[t]=e instanceof Function?e():e})),sessionStorage[i+"tmp"]=JSON.stringify(n);const s={};Object.keys(this.hScopes.mp).forEach((t=>{const e=this.hScopes.mp[t];s[t]=e instanceof Function?e():e})),sessionStorage[i+"mp"]=JSON.stringify(s);const o={};Object.keys(this.data.mark).forEach((t=>{const e=this.data.mark[t];o[t]=e instanceof Function?e():e})),sessionStorage[i+"mark"]=JSON.stringify(o);const a={};Object.keys(this.data.kidoku).forEach((t=>{const e=this.data.kidoku[t];a[t]=e instanceof Function?e():e})),sessionStorage[i+"kidoku"]=JSON.stringify(a),t.flush()}:()=>t.flush(),this.callHook=(e,i)=>t.callHook(e,i),t.addHook(((t,e)=>this.hProcDbgRes[t]?.(t,e)));const r=this.getVal("sys:sn.tagCh.msecWait",-1);(this.hTmp["const.sn.isFirstBoot"]||-1===r)&&this.clearsysvar()}))}set_data_break(t){a.hSetEvent={},t.forEach((t=>a.hSetEvent[t.dataId]=1))}updateData(t){this.data=t,this.hSys=this.hScopes.sys=this.data.sys,this.hAreaKidoku={};for(const t in this.data.kidoku){const e=new n.Areas;e.hAreas={...this.data.kidoku[t]},this.hAreaKidoku[t]=e}}flush(){this.flush_()}setDoRecProc(t){this.doRecProc=t}defTmp(t,e){this.hTmp[t]=e}cloneMp(){return{...this.hScopes.mp}}setMp(t){this.hScopes.mp=t}setMark(t,e){this.data.mark[t]=e,this.flush()}cloneSave(){return{...this.hScopes.save}}mark2save(t){this.hSave=this.hScopes.save={...t.hSave},this.$doRecLog=this.hSave["sn.doRecLog"]??!1}loadScrWork(t){t in this.hAreaKidoku||(this.hAreaKidoku[t]=new n.Areas)}saveKidoku(){for(const t in this.hAreaKidoku)this.data.kidoku[t]={...this.hAreaKidoku[t].hAreas};this.flush()}copybookmark(t){if(!("from"in t))throw"from";if(!("to"in t))throw"to";const e=Number(t.from),i=Number(t.to);if(e===i)return!1;if(!(e in this.data.mark))throw`from:${e} `;return this.setMark(i,{...this.data.mark[e]}),this.sys.copyBMFolder(e,i),!1}erasebookmark(t){const e=t.place;if(!e)throw"place";return delete this.data.mark[e],this.flush(),this.sys.eraseBMFolder(e),!1}let(t){if(!t.name)throw"name";let e=!0;if(t.cast)switch(t.cast){case"num":(0,r.argChk_Num)(t,"text",NaN);break;case"int":t.text=String((0,r.int)((0,r.argChk_Num)(t,"text",NaN)));break;case"uint":t.text=String((0,r.uint)((0,r.argChk_Num)(t,"text",NaN)));break;case"bool":(0,r.argChk_Boolean)(t,"text",!1);break;case"str":e=!1;break;default:throw"cast"+t.cast+""}return this.setVal(t.name,t.text,e),!1}let_abs(t){const e=(0,r.argChk_Num)(t,"text",0);return t.text=String(e<0?-e:e),this.let(t),!1}let_char_at(t){return t.text=(t.text??"").charAt((0,r.argChk_Num)(t,"pos",0)),this.let(t),!1}let_index_of(t){const e=t.val;if(!e)throw"val";const i=(0,r.argChk_Num)(t,"start",0);return t.text=String((t.text??"").indexOf(e,i)),this.let(t),!1}let_length(t){return t.text=String((t.text??"").length),this.let(t),!1}let_replace(t){if(!t.reg)throw"reg";const e=t.flags,i=e?new RegExp(t.reg,e):new RegExp(t.reg);return t.text=String(t.text??"").replace(i,String(t.val)),this.let(t),!1}let_round(t){const e=(0,r.argChk_Num)(t,"text",0);return t.text=String(Math.round(e)),this.let(t),!1}let_search(t){if(!t.reg)throw"reg";const e=t.flags,i=e?new RegExp(t.reg,e):new RegExp(t.reg);return t.text=String((t.text??"").search(i)),this.let(t),!1}let_substr(t){const e=(0,r.argChk_Num)(t,"pos",0);return t.text="all"!==t.len?(t.text??"").slice(e,e+(0,r.int)((0,r.argChk_Num)(t,"len",1))):(t.text??"").slice(e),this.let(t),!1}clearsysvar(){const t=this.hSys=this.hScopes.sys=this.data.sys={};"undefined"!=typeof process||(this.setVal_Nochk("sys","const.sn.window.x",0),this.setVal_Nochk("sys","const.sn.window.y",0)),this.setVal_Nochk("sys","sn.tagCh.doWait",!0),this.setVal_Nochk("sys","sn.tagCh.doWait_Kidoku",!0),this.setVal_Nochk("sys","sn.tagCh.msecWait",this.cfg.oCfg.init.tagch_msecwait),this.setVal_Nochk("sys","sn.tagCh.msecWait_Kidoku",this.cfg.oCfg.init.tagch_msecwait),this.setVal_Nochk("sys","sn.tagCh.canskip",!0),this.setVal_Nochk("sys","sn.skip.mode","s"),this.setVal_Nochk("sys","sn.auto.msecPageWait",(0,r.argChk_Num)(t,"sn.auto.msecPageWait",this.cfg.oCfg.init.auto_msecpagewait??3500)),this.setVal_Nochk("sys","sn.auto.msecPageWait_Kidoku",(0,r.argChk_Num)(t,"sn.auto.msecPageWait",this.cfg.oCfg.init.auto_msecpagewait??3500)),this.setVal_Nochk("sys","sn.auto.msecLineWait",500),this.setVal_Nochk("sys","sn.auto.msecLineWait_Kidoku",500),this.setVal_Nochk("sys","const.sn.sound.BGM.volume",1),this.setVal_Nochk("sys","const.sn.sound.SE.volume",1),this.setVal_Nochk("sys","const.sn.sound.SYS.volume",1);for(const t in this.data.kidoku)this.data.kidoku[t].hAreas={},this.hAreaKidoku[t].clear();return this.setVal_Nochk("sys","TextLayer.Back.Alpha",.5),this.hScopes.mark=this.data.mark={},this.setVal_Nochk("sys","const.sn.save.place",1),this.flush(),!1}clearvar(){const t=this.hSave["const.sn.mesLayer"]??"",e=this.hSave["sn.doRecLog"]??!1,i=this.hSave["const.sn.sLog"]??"";return this.hSave=this.hScopes.save={},this.setVal_Nochk("save","const.sn.mesLayer",t),this.setVal_Nochk("save","sn.doRecLog",e),this.setVal_Nochk("save","const.sn.sLog",i),!1}setVal_Nochk(t,e,i,r=!1){const n=this.hScopes[t];r&&(i=this.castAuto(i));const s=t+":"+e;if(s in a.hSetEvent){const t=n[e],r=i;t!=r&&this.callHook("data_break",{dataId:s,old_v:t,new_v:r})}n[e]=i,this.hValTrg[s]?.(e,i)}castAuto(t){const e=t;return"true"===e||"false"!==e&&("null"===e?null:"undefined"!==e?(this.REG_NUMERICLITERAL.lastIndex=0,this.REG_NUMERICLITERAL.test(e)?parseFloat(e):t):void 0)}doRecLog(){return this.$doRecLog}defValTrg(t,e){this.hValTrg[t]=e}runFirst_Bool_hSysVal_true(t){(0,r.argChk_Boolean)(this.hSys,t,!0)}runFirst_sys_an_tagCh_msecWait(t){(0,r.argChk_Num)(this.hSys,t,10),this.hSys["sn.tagCh.doWait"]}runFirst_sys_an_tagCh_msecWait_Kidoku(t){(0,r.argChk_Num)(this.hSys,t,void 0===this.cfg.oCfg.init.tagch_msecwait?10:this.cfg.oCfg.init.tagch_msecwait),this.hSys["sn.tagCh.doWait_Kidoku"]}runFirst_sys_an_auto_msecPageWait(t){(0,r.argChk_Num)(this.hSys,t,void 0===this.cfg.oCfg.init.auto_msecpagewait?3500:this.cfg.oCfg.init.auto_msecpagewait)}runFirst_sys_an_auto_msecLineWait(t){(0,r.argChk_Num)(this.hSys,t,500)}runFirst_Bool_hSaveVal_true(t){return(0,r.argChk_Boolean)(this.hSave,t,!0)}runFirst_Bool_hTmp_true(t){(0,r.argChk_Boolean)(this.hTmp,t,!0)}runFirst_Bool_hTmp_false(t){(0,r.argChk_Boolean)(this.hTmp,t,!1)}}e.Variable=a,a.hSetEvent={}},2511:function(t,e,i){var r;t=i.nmd(t),function(n){e&&e.nodeType,t&&t.nodeType;var s="object"==typeof i.g&&i.g;s.global!==s&&s.window!==s&&s.self;var o,a=2147483647,h=36,u=/^xn--/,c=/[^\x20-\x7E]/,l=/[\x2E\u3002\uFF0E\uFF61]/g,p={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},d=Math.floor,f=String.fromCharCode;function g(t){throw RangeError(p[t])}function m(t,e){for(var i=t.length,r=[];i--;)r[i]=e(t[i]);return r}function _(t,e){var i=t.split("@"),r="";return i.length>1&&(r=i[0]+"@",t=i[1]),r+m((t=t.replace(l,".")).split("."),e).join(".")}function v(t){for(var e,i,r=[],n=0,s=t.length;n<s;)(e=t.charCodeAt(n++))>=55296&&e<=56319&&n<s?56320==(64512&(i=t.charCodeAt(n++)))?r.push(((1023&e)<<10)+(1023&i)+65536):(r.push(e),n--):r.push(e);return r}function y(t){return m(t,(function(t){var e="";return t>65535&&(e+=f((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+f(t)})).join("")}function b(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function x(t,e,i){var r=0;for(t=i?d(t/700):t>>1,t+=d(t/e);t>455;r+=h)t=d(t/35);return d(r+36*t/(t+38))}function E(t){var e,i,r,n,s,o,u,c,l,p,f,m=[],_=t.length,v=0,b=128,E=72;for((i=t.lastIndexOf("-"))<0&&(i=0),r=0;r<i;++r)t.charCodeAt(r)>=128&&g("not-basic"),m.push(t.charCodeAt(r));for(n=i>0?i+1:0;n<_;){for(s=v,o=1,u=h;n>=_&&g("invalid-input"),((c=(f=t.charCodeAt(n++))-48<10?f-22:f-65<26?f-65:f-97<26?f-97:h)>=h||c>d((a-v)/o))&&g("overflow"),v+=c*o,!(c<(l=u<=E?1:u>=E+26?26:u-E));u+=h)o>d(a/(p=h-l))&&g("overflow"),o*=p;E=x(v-s,e=m.length+1,0==s),d(v/e)>a-b&&g("overflow"),b+=d(v/e),v%=e,m.splice(v++,0,b)}return y(m)}function T(t){var e,i,r,n,s,o,u,c,l,p,m,_,y,E,T,S=[];for(_=(t=v(t)).length,e=128,i=0,s=72,o=0;o<_;++o)(m=t[o])<128&&S.push(f(m));for(r=n=S.length,n&&S.push("-");r<_;){for(u=a,o=0;o<_;++o)(m=t[o])>=e&&m<u&&(u=m);for(u-e>d((a-i)/(y=r+1))&&g("overflow"),i+=(u-e)*y,e=u,o=0;o<_;++o)if((m=t[o])<e&&++i>a&&g("overflow"),m==e){for(c=i,l=h;!(c<(p=l<=s?1:l>=s+26?26:l-s));l+=h)T=c-p,E=h-p,S.push(f(b(p+T%E,0))),c=d(T/E);S.push(f(b(c,0))),s=x(i,y,r==n),i=0,++r}++i,++e}return S.join("")}o={version:"1.3.2",ucs2:{decode:v,encode:y},decode:E,encode:T,toASCII:function(t){return _(t,(function(t){return c.test(t)?"xn--"+T(t):t}))},toUnicode:function(t){return _(t,(function(t){return u.test(t)?E(t.slice(4).toLowerCase()):t}))}},void 0===(r=function(){return o}.call(e,i,e,t))||(t.exports=r)}()},8575:(t,e,i)=>{"use strict";var r=i(2511),n=i(2502);function s(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}e.Qc=y,e.DB=function(t,e){return y(t,!1,!0).resolve(e)},e.WU=function(t){return n.isString(t)&&(t=y(t)),t instanceof s?t.format():s.prototype.format.call(t)};var o=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,h=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,u=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),c=["'"].concat(u),l=["%","/","?",";","#"].concat(c),p=["/","?","#"],d=/^[+a-z0-9A-Z_-]{0,63}$/,f=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,g={javascript:!0,"javascript:":!0},m={javascript:!0,"javascript:":!0},_={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},v=i(7673);function y(t,e,i){if(t&&n.isObject(t)&&t instanceof s)return t;var r=new s;return r.parse(t,e,i),r}s.prototype.parse=function(t,e,i){if(!n.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var s=t.indexOf("?"),a=-1!==s&&s<t.indexOf("#")?"?":"#",u=t.split(a);u[0]=u[0].replace(/\\/g,"/");var y=t=u.join(a);if(y=y.trim(),!i&&1===t.split("#").length){var b=h.exec(y);if(b)return this.path=y,this.href=y,this.pathname=b[1],b[2]?(this.search=b[2],this.query=e?v.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var x=o.exec(y);if(x){var E=(x=x[0]).toLowerCase();this.protocol=E,y=y.substr(x.length)}if(i||x||y.match(/^\/\/[^@\/]+@[^@\/]+/)){var T="//"===y.substr(0,2);!T||x&&m[x]||(y=y.substr(2),this.slashes=!0)}if(!m[x]&&(T||x&&!_[x])){for(var S,w,A=-1,C=0;C<p.length;C++)-1!==(O=y.indexOf(p[C]))&&(-1===A||O<A)&&(A=O);for(-1!==(w=-1===A?y.lastIndexOf("@"):y.lastIndexOf("@",A))&&(S=y.slice(0,w),y=y.slice(w+1),this.auth=decodeURIComponent(S)),A=-1,C=0;C<l.length;C++){var O;-1!==(O=y.indexOf(l[C]))&&(-1===A||O<A)&&(A=O)}-1===A&&(A=y.length),this.host=y.slice(0,A),y=y.slice(A),this.parseHost(),this.hostname=this.hostname||"";var I="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!I)for(var R=this.hostname.split(/\./),M=(C=0,R.length);C<M;C++){var P=R[C];if(P&&!P.match(d)){for(var N="",L=0,D=P.length;L<D;L++)P.charCodeAt(L)>127?N+="x":N+=P[L];if(!N.match(d)){var k=R.slice(0,C),B=R.slice(C+1),F=P.match(f);F&&(k.push(F[1]),B.unshift(F[2])),B.length&&(y="/"+B.join(".")+y),this.hostname=k.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),I||(this.hostname=r.toASCII(this.hostname));var G=this.port?":"+this.port:"",U=this.hostname||"";this.host=U+G,this.href+=this.host,I&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==y[0]&&(y="/"+y))}if(!g[E])for(C=0,M=c.length;C<M;C++){var j=c[C];if(-1!==y.indexOf(j)){var X=encodeURIComponent(j);X===j&&(X=escape(j)),y=y.split(j).join(X)}}var z=y.indexOf("#");-1!==z&&(this.hash=y.substr(z),y=y.slice(0,z));var H=y.indexOf("?");if(-1!==H?(this.search=y.substr(H),this.query=y.substr(H+1),e&&(this.query=v.parse(this.query)),y=y.slice(0,H)):e&&(this.search="",this.query={}),y&&(this.pathname=y),_[E]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){G=this.pathname||"";var V=this.search||"";this.path=G+V}return this.href=this.format(),this},s.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",i=this.pathname||"",r=this.hash||"",s=!1,o="";this.host?s=t+this.host:this.hostname&&(s=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(s+=":"+this.port)),this.query&&n.isObject(this.query)&&Object.keys(this.query).length&&(o=v.stringify(this.query));var a=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||_[e])&&!1!==s?(s="//"+(s||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):s||(s=""),r&&"#"!==r.charAt(0)&&(r="#"+r),a&&"?"!==a.charAt(0)&&(a="?"+a),e+s+(i=i.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(a=a.replace("#","%23"))+r},s.prototype.resolve=function(t){return this.resolveObject(y(t,!1,!0)).format()},s.prototype.resolveObject=function(t){if(n.isString(t)){var e=new s;e.parse(t,!1,!0),t=e}for(var i=new s,r=Object.keys(this),o=0;o<r.length;o++){var a=r[o];i[a]=this[a]}if(i.hash=t.hash,""===t.href)return i.href=i.format(),i;if(t.slashes&&!t.protocol){for(var h=Object.keys(t),u=0;u<h.length;u++){var c=h[u];"protocol"!==c&&(i[c]=t[c])}return _[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i}if(t.protocol&&t.protocol!==i.protocol){if(!_[t.protocol]){for(var l=Object.keys(t),p=0;p<l.length;p++){var d=l[p];i[d]=t[d]}return i.href=i.format(),i}if(i.protocol=t.protocol,t.host||m[t.protocol])i.pathname=t.pathname;else{for(var f=(t.pathname||"").split("/");f.length&&!(t.host=f.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),i.pathname=f.join("/")}if(i.search=t.search,i.query=t.query,i.host=t.host||"",i.auth=t.auth,i.hostname=t.hostname||t.host,i.port=t.port,i.pathname||i.search){var g=i.pathname||"",v=i.search||"";i.path=g+v}return i.slashes=i.slashes||t.slashes,i.href=i.format(),i}var y=i.pathname&&"/"===i.pathname.charAt(0),b=t.host||t.pathname&&"/"===t.pathname.charAt(0),x=b||y||i.host&&t.pathname,E=x,T=i.pathname&&i.pathname.split("/")||[],S=(f=t.pathname&&t.pathname.split("/")||[],i.protocol&&!_[i.protocol]);if(S&&(i.hostname="",i.port=null,i.host&&(""===T[0]?T[0]=i.host:T.unshift(i.host)),i.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===f[0]?f[0]=t.host:f.unshift(t.host)),t.host=null),x=x&&(""===f[0]||""===T[0])),b)i.host=t.host||""===t.host?t.host:i.host,i.hostname=t.hostname||""===t.hostname?t.hostname:i.hostname,i.search=t.search,i.query=t.query,T=f;else if(f.length)T||(T=[]),T.pop(),T=T.concat(f),i.search=t.search,i.query=t.query;else if(!n.isNullOrUndefined(t.search))return S&&(i.hostname=i.host=T.shift(),(I=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=I.shift(),i.host=i.hostname=I.shift())),i.search=t.search,i.query=t.query,n.isNull(i.pathname)&&n.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i;if(!T.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var w=T.slice(-1)[0],A=(i.host||t.host||T.length>1)&&("."===w||".."===w)||""===w,C=0,O=T.length;O>=0;O--)"."===(w=T[O])?T.splice(O,1):".."===w?(T.splice(O,1),C++):C&&(T.splice(O,1),C--);if(!x&&!E)for(;C--;C)T.unshift("..");!x||""===T[0]||T[0]&&"/"===T[0].charAt(0)||T.unshift(""),A&&"/"!==T.join("/").substr(-1)&&T.push("");var I,R=""===T[0]||T[0]&&"/"===T[0].charAt(0);return S&&(i.hostname=i.host=R?"":T.length?T.shift():"",(I=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=I.shift(),i.host=i.hostname=I.shift())),(x=x||i.host&&T.length)&&!R&&T.unshift(""),T.length?i.pathname=T.join("/"):(i.pathname=null,i.path=null),n.isNull(i.pathname)&&n.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=t.auth||i.auth,i.slashes=i.slashes||t.slashes,i.href=i.format(),i},s.prototype.parseHost=function(){var t=this.host,e=a.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},2502:t=>{"use strict";t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},2281:t=>{"use strict";var e,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),r={},n=0,s=0;function o(t){var e="";do{e=i[t%64]+e,t=Math.floor(t/64)}while(t>0);return e}function a(){var t=o(+new Date);return t!==e?(n=0,e=t):t+"."+o(n++)}for(;s<64;s++)r[i[s]]=s;a.encode=o,a.decode=function(t){var e=0;for(s=0;s<t.length;s++)e=64*e+r[t.charAt(s)];return e},t.exports=a},2264:()=>{},7649:()=>{},4428:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.io=e.Socket=e.Manager=e.protocol=void 0;const r=i(5253),n=i(6530),s=i(1227)("socket.io-client");t.exports=e=a;const o=e.managers={};function a(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};const i=(0,r.url)(t,e.path||"/socket.io"),a=i.source,h=i.id,u=i.path,c=o[h]&&u in o[h].nsps;let l;return e.forceNew||e["force new connection"]||!1===e.multiplex||c?(s("ignoring socket cache for %s",a),l=new n.Manager(a,e)):(o[h]||(s("new io instance for %s",a),o[h]=new n.Manager(a,e)),l=o[h]),i.query&&!e.query&&(e.query=i.queryKey),l.socket(i.path,e)}e.io=a;var h=i(5485);Object.defineProperty(e,"protocol",{enumerable:!0,get:function(){return h.protocol}}),e.connect=a;var u=i(6530);Object.defineProperty(e,"Manager",{enumerable:!0,get:function(){return u.Manager}});var c=i(7055);Object.defineProperty(e,"Socket",{enumerable:!0,get:function(){return c.Socket}}),e.default=a},6530:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Manager=void 0;const r=i(5983),n=i(6839),s=i(7055),o=i(5485),a=i(3598),h=i(3010),u=i(7204),c=i(1227)("socket.io-client:manager");class l extends u.StrictEventEmitter{constructor(t,e){var i;super(),this.nsps={},this.subs=[],t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.opts=e,(0,n.installTimerFunctions)(this,e),this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(i=e.randomizationFactor)&&void 0!==i?i:.5),this.backoff=new h({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this._readyState="closed",this.uri=t;const r=e.parser||o;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=!1!==e.autoConnect,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection}reconnectionAttempts(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(e=this.backoff)||void 0===e||e.setMin(t),this)}randomizationFactor(t){var e;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(e=this.backoff)||void 0===e||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(e=this.backoff)||void 0===e||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(t){if(c("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;c("opening %s",this.uri),this.engine=r(this.uri,this.opts);const e=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;const n=(0,a.on)(e,"open",(function(){i.onopen(),t&&t()})),s=(0,a.on)(e,"error",(e=>{c("error"),i.cleanup(),i._readyState="closed",this.emitReserved("error",e),t?t(e):i.maybeReconnectOnOpen()}));if(!1!==this._timeout){const t=this._timeout;c("connect attempt will timeout after %d",t),0===t&&n();const i=this.setTimeoutFn((()=>{c("connect attempt timed out after %d",t),n(),e.close(),e.emit("error",new Error("timeout"))}),t);this.opts.autoUnref&&i.unref(),this.subs.push((function(){clearTimeout(i)}))}return this.subs.push(n),this.subs.push(s),this}connect(t){return this.open(t)}onopen(){c("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push((0,a.on)(t,"ping",this.onping.bind(this)),(0,a.on)(t,"data",this.ondata.bind(this)),(0,a.on)(t,"error",this.onerror.bind(this)),(0,a.on)(t,"close",this.onclose.bind(this)),(0,a.on)(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){this.decoder.add(t)}ondecoded(t){this.emitReserved("packet",t)}onerror(t){c("error",t),this.emitReserved("error",t)}socket(t,e){let i=this.nsps[t];return i||(i=new s.Socket(this,t,e),this.nsps[t]=i),i}_destroy(t){const e=Object.keys(this.nsps);for(const t of e)if(this.nsps[t].active)return void c("socket %s is still active, skipping close",t);this._close()}_packet(t){c("writing packet %j",t);const e=this.encoder.encode(t);for(let i=0;i<e.length;i++)this.engine.write(e[i],t.options)}cleanup(){c("cleanup"),this.subs.forEach((t=>t())),this.subs.length=0,this.decoder.destroy()}_close(){c("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,"opening"===this._readyState&&this.cleanup(),this.backoff.reset(),this._readyState="closed",this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(t){c("onclose"),this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)c("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();c("will wait %dms before reconnect attempt",e),this._reconnecting=!0;const i=this.setTimeoutFn((()=>{t.skipReconnect||(c("attempting reconnect"),this.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open((e=>{e?(c("reconnect attempt error"),t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",e)):(c("reconnect success"),t.onreconnect())})))}),e);this.opts.autoUnref&&i.unref(),this.subs.push((function(){clearTimeout(i)}))}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}e.Manager=l},3598:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.on=void 0,e.on=function(t,e,i){return t.on(e,i),function(){t.off(e,i)}}},7055:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Socket=void 0;const r=i(5485),n=i(3598),s=i(7204),o=i(1227)("socket.io-client:socket"),a=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class h extends s.StrictEventEmitter{constructor(t,e,i){super(),this.connected=!1,this.disconnected=!0,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,i&&i.auth&&(this.auth=i.auth),this.io._autoConnect&&this.open()}subEvents(){if(this.subs)return;const t=this.io;this.subs=[(0,n.on)(t,"open",this.onopen.bind(this)),(0,n.on)(t,"packet",this.onpacket.bind(this)),(0,n.on)(t,"error",this.onerror.bind(this)),(0,n.on)(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){if(a.hasOwnProperty(t))throw new Error('"'+t+'" is a reserved event name');e.unshift(t);const i={type:r.PacketType.EVENT,data:e,options:{}};i.options.compress=!1!==this.flags.compress,"function"==typeof e[e.length-1]&&(o("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),i.id=this.ids++);const n=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return!this.flags.volatile||n&&this.connected?this.connected?this.packet(i):this.sendBuffer.push(i):o("discard packet as the transport is not currently writable"),this.flags={},this}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){o("transport is open - connecting"),"function"==typeof this.auth?this.auth((t=>{this.packet({type:r.PacketType.CONNECT,data:t})})):this.packet({type:r.PacketType.CONNECT,data:this.auth})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t){o("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emitReserved("disconnect",t)}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case r.PacketType.CONNECT:if(t.data&&t.data.sid){const e=t.data.sid;this.onconnect(e)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case r.PacketType.EVENT:case r.PacketType.BINARY_EVENT:this.onevent(t);break;case r.PacketType.ACK:case r.PacketType.BINARY_ACK:this.onack(t);break;case r.PacketType.DISCONNECT:this.ondisconnect();break;case r.PacketType.CONNECT_ERROR:const e=new Error(t.data.message);e.data=t.data.data,this.emitReserved("connect_error",e)}}onevent(t){const e=t.data||[];o("emitting event %j",e),null!=t.id&&(o("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const i of e)i.apply(this,t)}super.emit.apply(this,t)}ack(t){const e=this;let i=!1;return function(...n){i||(i=!0,o("sending ack %j",n),e.packet({type:r.PacketType.ACK,id:t,data:n}))}}onack(t){const e=this.acks[t.id];"function"==typeof e?(o("calling ack %s with %j",t.id,t.data),e.apply(this,t.data),delete this.acks[t.id]):o("bad ack %s",t.id)}onconnect(t){o("socket connected with id %s",t),this.id=t,this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach((t=>this.emitEvent(t))),this.receiveBuffer=[],this.sendBuffer.forEach((t=>this.packet(t))),this.sendBuffer=[]}ondisconnect(){o("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((t=>t())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(o("performing disconnect (%s)",this.nsp),this.packet({type:r.PacketType.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let i=0;i<e.length;i++)if(t===e[i])return e.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}}e.Socket=h},7204:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StrictEventEmitter=void 0;const r=i(8767);e.StrictEventEmitter=class extends r{on(t,e){return super.on(t,e),this}once(t,e){return super.once(t,e),this}emit(t,...e){return super.emit(t,...e),this}emitReserved(t,...e){return super.emit(t,...e),this}listeners(t){return super.listeners(t)}}},5253:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.url=void 0;const r=i(4187),n=i(1227)("socket.io-client:url");e.url=function(t,e="",i){let s=t;i=i||"undefined"!=typeof location&&location,null==t&&(t=i.protocol+"//"+i.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?i.protocol+t:i.host+t),/^(https?|wss?):\/\//.test(t)||(n("protocol-less url %s",t),t=void 0!==i?i.protocol+"//"+t:"https://"+t),n("parse %s",t),s=r(t)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const o=-1!==s.host.indexOf(":")?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+o+":"+s.port+e,s.href=s.protocol+"://"+o+(i&&i.port===s.port?"":":"+s.port),s}}},e={};function i(r){var n=e[r];if(void 0!==n)return n.exports;var s=e[r]={id:r,loaded:!1,exports:{}};return t[r].call(s.exports,s,s.exports,i),s.loaded=!0,s.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var r in e)i.o(e,r)&&!i.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.nmd=t=>(t.paths=[],t.children||(t.children=[]),t);var r={};return(()=>{"use strict";var t=r;Object.defineProperty(t,"__esModule",{value:!0}),t.argChk_Boolean=t.argChk_Num=t.Layer=t.CmnLib=t.SysApp=void 0;const e=i(5041);Object.defineProperty(t,"SysApp",{enumerable:!0,get:function(){return e.SysApp}});const n=i(4965);Object.defineProperty(t,"CmnLib",{enumerable:!0,get:function(){return n.CmnLib}}),Object.defineProperty(t,"argChk_Num",{enumerable:!0,get:function(){return n.argChk_Num}}),Object.defineProperty(t,"argChk_Boolean",{enumerable:!0,get:function(){return n.argChk_Boolean}});const s=i(1481);Object.defineProperty(t,"Layer",{enumerable:!0,get:function(){return s.Layer}})})(),r})()}));