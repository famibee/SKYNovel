# SKYNovel タグリファレンス Tag Reference
[![License: CC BY 4.0](https://img.shields.io/badge/License-CC%20BY%204.0-lightgrey.svg)](https://creativecommons.org/licenses/by/4.0/)

- 変数操作
	- [[let] 変数代入・演算](#let)
	- [[let_abs] 絶対値](#let_abs)
	- [[let_char_at] 文字列から一字取りだし](#let_char_at)
	- [[let_index_of] 文字列で検索](#let_index_of)
	- [[let_length] 文字列の長さ](#let_length)
	- [[let_ml] インラインテキスト代入](#let_ml)
	- [[let_replace] 正規表現で置換](#let_replace)
	- [[let_round] 四捨五入](#let_round)
	- [[let_search] 正規表現で検索](#let_search)
	- [[let_substr] 文字列から抜きだし](#let_substr)

- プラグイン
	- [[notice] humane.js 通知パネル](#notice)

- レイヤ共通
	- [[add_lay] レイヤを追加する](#add_lay)
	- [[clear_lay] レイヤ設定の消去](#clear_lay)
	- [[finish_trans] トランス強制終了](#finish_trans)
	- [[lay] レイヤ設定](#lay)
	- [[trans] ページ裏表を交換](#trans)
	- [[wt] トランス終了待ち](#wt)

- レイヤトゥイーン
	- [[pause_tsy] 一時停止](#pause_tsy)
	- [[resume_tsy] 一時停止再開](#resume_tsy)
	- [[stop_tsy] トゥイーン中断](#stop_tsy)
	- [[tsy] トゥイーン開始](#tsy)
	- [[wait_tsy] トゥイーン終了待ち](#wait_tsy)

- 文字・文字レイヤ
	- [[autowc] 文字ごとのウェイト](#autowc)
	- [[ch] 文字を追加する](#ch)
	- [[clear_text] 文字消去](#clear_text)
	- [[current] デフォルト文字レイヤ設定](#current)
	- [[endlink] ハイパーリンクの終了](#endlink)
	- [[er] ページ両面の文字消去](#er)
	- [[graph] インライン画像表示](#graph)
	- [[link] ハイパーリンク](#link)
	- [[r] 改行](#r)
	- [[rec_ch] 履歴書き込み](#rec_ch)
	- [[rec_r] 履歴改行](#rec_r)
	- [[reset_rec] 履歴リセット](#reset_rec)
	- [[ruby2] 文字列と複数ルビの追加](#ruby2)
	- [[set_focus] 未作成：フォーカス移動](#set_focus)
	- [[span] インラインスタイル設定](#span)
	- [[tcy] 縦中横を表示する](#tcy)

- 画像・画像レイヤ
	- [[add_face] 差分画像の追加](#add_face)

- HTMLフレーム
	- [[add_frame] フレーム](#add_frame)
	- [[let_frame] フレーム](#let_frame)
	- [[set_frame] フレーム](#set_frame)
	- [[frame] フレーム](#frame)
	- [[tsy_frame] フレーム](#tsy_frame)

- イベント
	- [[clear_event] イベントを全消去](#clear_event)
	- [[enable_event] イベント有無の切替](#enable_event)
	- [[event] イベントを予約](#event)
	- [[l] 行末クリック待ち](#l)
	- [[p] 改ページクリック待ち](#p)
	- [[s] 停止する](#s)
	- [[set_cancel_skip] スキップ中断予約](#set_cancel_skip)
	- [[wait] ウェイトを入れる](#wait)
	- [[waitclick] クリックを待つ](#waitclick)

- ＢＧＭ・効果音
	- [[fadebgm] BGMのフェード](#fadebgm)
	- [[fadeoutbgm] BGMのフェードアウト](#fadeoutbgm)
	- [[fadeoutse] 効果音のフェードアウト](#fadeoutse)
	- [[fadese] 効果音のフェード](#fadese)
	- [[playbgm] BGM の演奏](#playbgm)
	- [[playse] 効果音の再生](#playse)
	- [[stop_allse] 全効果音再生の停止](#stop_allse)
	- [[stopbgm] BGM 演奏の停止](#stopbgm)
	- [[stopfadese] 音声フェードの停止](#stopfadese)
	- [[stopse] 効果音再生の停止](#stopse)
	- [[volume] 音量設定](#volume)
	- [[wb] BGM フェードの終了待ち](#wb)
	- [[wf] 効果音フェードの終了待ち](#wf)
	- [[wl] BGM 再生の終了待ち](#wl)
	- [[ws] 効果音再生の終了待ち](#ws)
	- [[xchgbuf] 再生トラックの交換](#xchgbuf)

- 条件分岐
	- [[else] その他ifブロック開始](#else)
	- [[elsif] 別条件のifブロック開始](#elsif)
	- [[endif] ifブロックの終端](#endif)
	- [[if] ifブロックの開始](#if)

- ラベル・ジャンプ
	- [[button] ボタンを表示](#button)
	- [[call] サブルーチンコール](#call)
	- [[jump] シナリオジャンプ](#jump)
	- [[pop_stack] コールスタック破棄](#pop_stack)
	- [[return] サブルーチンから戻る](#return)

- マクロ
	- [[bracket2macro] 括弧マクロの定義](#bracket2macro)
	- [[break_macro] マクロから脱出](#break_macro)
	- [[char2macro] 一文字マクロの定義](#char2macro)
	- [[endmacro] マクロ定義の終了](#endmacro)
	- [[macro] マクロ定義の開始](#macro)

- しおり
	- [[copybookmark] しおりの複写](#copybookmark)
	- [[erasebookmark] しおりの消去](#erasebookmark)
	- [[load] しおりの読込](#load)
	- [[record_place] セーブポイント指定](#record_place)
	- [[reload_script] スクリプト再読込](#reload_script)
	- [[save] しおりの保存](#save)

- 画面揺らし
	- [[quake] 画面を揺らす](#quake)
	- [[stop_quake] 画面揺らし中断](#stop_quake)
	- [[wq] 画面揺らし終了待ち](#wq)

- システム
	- [[close] アプリの終了](#close)
	- [[loadplugin] プラグインの読み込み](#loadplugin)
	- [[navigate_to] ＵＲＬを開く](#navigate_to)
	- [[snapshot] スナップショット](#snapshot)
	- [[title] タイトル指定](#title)
	- [[toggle_full_screen] 全画面状態切替](#toggle_full_screen)
	- [[window] アプリウインドウ設定](#window)

- デバッグ・その他
	- [[clearsysvar] システム変数の全消去](#clearsysvar)
	- [[clearvar] ゲーム変数の全消去](#clearvar)
	- [[dump_val] 変数のダンプ](#dump_val)
	- [[dump_script] スクリプトのダンプ](#dump_script)
	- [[dump_stack] スタックのダンプ](#dump_stack)
	- [[log] ログ出力](#log)
	- [[dump_lay] レイヤのダンプ](#dump_lay)
	- [[stats] パフォーマンス表示](#stats)
	- [[trace] デバッグ表示へ出力](#trace)


# プラグイン
## [[notice] humane.js 通知パネル](#notice)

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
xxxxxx | **y** | | |

---
# 変数操作
## [[clearsysvar] システム変数の全消去](#clearsysvar)

引数無し。<br>
【sys:〜】系の変数を消去。<br>
削除すると言うより、初期化する

---
## [[clearvar] ゲーム変数の全消去](#clearvar)

引数無し。
【？？？:〜】系の変数を消去。<br>
削除すると言うより、初期化する

---
## [[let] 変数代入・演算](#let)
	変数に値を代入する。

変数については「[SKYNovel 組み込み変数](VAR.md)」を参照して下さい

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**name** | **y** | | String（変数名書式※） | 変数名
**text** | **y** | | String | セットする値
cast | | 出来るだけ数値変換 | （コメントを参照） | 値をセットする際の型。<br>num……数値（実数）。「01」は数値の1となる。<br>int……数値（符合付き整数）<br>uint……数値（符合なし整数）<br>bool……Boolean<br>str……文字列。「01」は「01」のまま。

[let]を使わない、より簡潔な記述文法があります。（ver 3.18以降）
※condのような条件分岐、「=aaa|0x0」のような省略記法はできません。

以下の記述は、
[let name=a text=1]
[let name="b" text=2]
[let name=ret text="&a + b"]（文字列ではなく計算の場合、右辺に&をつける）
[let name="&'ret'+ a" text="&1 + b"]（左辺で&を使える）
以下のようにも書けます。（&から改行かタブまでを[let]文と解釈します）
&a=1
&b=2
&ret = a + b（このように、右辺の&は省略します。常に&がついているイメージ）
&&'tst' + a = 1+b（左辺で&を使える。&ret1 = 1 + b と同じ）

キャストも記述できます。（両者は同じ意味）
[let name=ret text=&1+2 cast=int]（結果は3。1+2の計算結果が入る）
&ret=1+2=int（同上）

キャスト動作そのものは、以下のとおり。
&num = '0+1' = int（結果は0、文字列「0+1」を計算せず文字列のまま、数値に変換できないため）
&num = 0+1 = int（結果は1、0+1という計算結果をintで変数へ）
&txt = '0+1' = str（結果は文字列「0+1」、文字列をそのまま変数に）
&txt = 0+1 = str（結果は文字列「1」、0+1を計算してから結果1を文字列「1」として変数に）

---
## [[let_abs] 絶対値](#let_abs)
	絶対値を求める

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**name** | **y** | | String（変数名書式※） | 変数名
**text** | **y** | | Number | 絶対値を求める数
cast | | 出来るだけ数値変換 | | 値をセットする際の型。（詳細は[let]を参照）

---
## [[let_char_at] 文字列から一字取りだし](#let_char_at)
	文字列中の一文字を取り出す

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**name** | **y** | | String（変数名書式※） | 変数名
**text** | **y** | | String | 元になる文字列
pos | | 0 | 0（先頭）〜 | 何番目の文字を取り出すか
cast | | 出来るだけ数値変換 | | 値をセットする際の型。（詳細は[let]を参照）

---
## [[let_index_of] 文字列で検索](#let_index_of)
	文字列内を検索し、文字列内の start 以降で、最初に val が見つかった位置を返します。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**name** | **y** | | String（変数名書式※） | 位置を代入する変数名。-1の場合は見つからなかった
**text** | **y** | | String | 元になる文字列
**val** | **y** | | String | 探す文字列
start | | 0 | 0（先頭）〜 | 検索を開始する位置
cast | | 出来るだけ数値変換 | | 値をセットする際の型。（詳細は[let]を参照）

---
## [[let_length] 文字列の長さ](#let_length)
	文字列の長さを求める

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**name** | **y** | | String（変数名書式※） | 長さを代入する変数名
**text** | **y** | | String | 長さを求める文字列。長さをセットする
cast | | 出来るだけ数値変換 | | 値をセットする際の型。（詳細は[let]を参照）

---
## [[let_ml] インラインテキスト代入](#let_ml)

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
xxxxxx | **y** | | |

---
## [[let_replace] 正規表現で置換](#let_replace)
	文字列を正規表現で検索し、マッチする箇所を文字列で置き換える。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**name** | **y** | | String（変数名書式※） | 変数名
**text** | **y** | | String | 置換対象の文字列
**reg** | **y** | | String | 正規表現
flags | | （なし） | String | 正規表現のフラグ
**val** | **y** | | String | 置き換える文字列
cast | | 出来るだけ数値変換 | | 値をセットする際の型。（詳細は[let]を参照）

---
## [[let_round] 四捨五入](#let_round)
	四捨五入する

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**name** | **y** | | String（変数名書式※） | 変数名
**text** | **y** | | Number | 四捨五入する数
cast | | 出来るだけ数値変換 | | 値をセットする際の型。（詳細は[let]を参照）

---
## [[let_search] 正規表現で検索](#let_search)
	文字列内を正規表現で検索し、最初に val が見つかった位置を返します。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**name** | **y** | | String（変数名書式※） | 変数名
**text** | **y** | | String | 検索対象の文字列
**reg** | **y** | | String | 正規表現
flags | | （なし） | String | 正規表現のフラグ
cast | | 出来るだけ数値変換 | | 値をセットする際の型。（詳細は[let]を参照）

---
## [[let_substr] 文字列から抜きだし](#let_substr)
	文字列の一部を取り出す

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**name** | **y** | | String（変数名書式※） | 変数名
**text** | **y** | | String | 元になる文字列
pos | | 0 | 0（先頭）〜<br>または<br>〜-1（末尾） | 何番目の文字から取り出すか。<br>負の値なら「後ろから何個目か」。-1が最後の文字。<br>【pos=-3 len=all】とすると、後ろから３文字を取り出す。
len | | 1 | 文字数、または all | 何文字取り出すか。all でpos以降の全て
cast | | 出来るだけ数値変換 | | 値をセットする際の型。（詳細は[let]を参照）


---
# レイヤ共通
## [[add_lay] レイヤを追加する](#add_lay)
	レイヤを追加する。
レイヤはページの裏表があり、文字レイヤや画像レイヤなどの種類があります。
※HTMLレイヤのみ、Flash環境では使用不可です。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**layer** | **y** | | String | レイヤ名を指定する。<br>未使用のレイヤ名でなければエラー＆アプリ停止
**class** | **y** | | grp（画像レイヤ）、<br>txt（文字レイヤ）、<br>またはプラグインで追加した値 | レイヤの種類


### blendModeの解説

[lay][add_face][button]で同様ですが、blendmode属性に以下のものを使用可能です。

Photoshop<br>ブレンドモード名 | AIRNovel<br>での<br>blendmode<br>属性の値 | ActionScript<br>での<br>blendmode<br>値 | コメント
-- | -- | -- | -- | --
加算 | （使えない） | add | 表示オブジェクトの要素カラーの値を背景色に加算し、その際に上限 | 0xFF を適用します。



---
## [[clear_lay] レイヤ設定の消去](#clear_lay)
	画像や文字などレイヤ状態をクリアする。
alpha、blendMode、rotation、scaleX、scaleYを初期値にする<br>
※背景や背景画像はクリアしません（b_left、b_top、b_width、b_height、b_color、b_alpha）
　クリアしたい場合は、[lay back_clear=true]

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
layer | | 全てのレイヤ | レイヤ名（半角カンマ区切りで複数レイヤを指定可能） |
page | | fore | fore、back、both | ページの裏表（both指定で両面）
filter | | false | Boolean | true：フィルタもクリア

---
## [[finish_trans] トランス強制終了](#finish_trans)

引数無し。<br>
[trans]で開始したトランス終了を待たず、すぐ終了させる。<br>
終了次第、スクリプト処理を次へ進める

---
## [[lay] レイヤ設定(共通)](#lay)
	レイヤに各種設定を行う。
レイヤの種類ごとに使用できる属性が違う

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**layer** | **y** | | レイヤ名 | 処理対象のレイヤ
page | | fore | fore、back | ページの裏表
visible | | 現在値 | Boolean | true：表示、false：非表示
alpha | | 1.0 | 0.0〜1.0（実数） | レイヤの透過度。0（完全透明）〜0.5（半透明）〜1（不透明）
blendmode | | 何もしない | ブレンドモード名（"screen"など） | このレイヤと下のレイヤとの重なりにおいて、<br>ドット単位で色のブレンド演算を行なう。<br>詳細はblendModeの解説を参照。
pos | | c※ | c、l、r、横座標 | 主に立ち絵に使う。横と縦座標を同時に設定する。<br>横座標は指定した値（文字cの場合は画面中央、lは左寄り、rは右寄り）に設定し、画像下端を画面下端に接するように自動計算する。
left | | 0 | 画面左上を(0, 0)とする横座標※ | レイヤやボタン左端の画面左端からの距離
center | | (↑と同じ) | (↑と同じ) | レイヤやボタン中央の画面左端からの距離
right | | (↑と同じ) | (↑と同じ) | レイヤやボタン右端の画面左端からの距離
s_right | | (↑と同じ) | (↑と同じ) | レイヤやボタン右端の画面右端からの距離
top | | 0 | 画面左上を(0, 0)とする縦座標※ | レイヤやボタン上端の画面上端からの距離
middle | | (↑と同じ) | (↑と同じ) | レイヤやボタン中央の画面上端からの距離
bottom | | (↑と同じ) | (↑と同じ) | レイヤやボタン下端の画面上端からの距離
s_bottom | | (↑と同じ) | (↑と同じ) | レイヤやボタン下端の画面下端からの距離
rotation | | 0 | -180〜180 | 回転角を度単位で指定。時計回りは0～180、反時計回りは0～-180を指定。 左上を中心に回る
scale_x | | 1.0 | 正負の実数値 | 横方向を何倍に拡大／縮小するか。負の値ならレイヤを左右反転
scale_y | | (↑と同じ) | (↑と同じ) | 縦方向を何倍に拡大／縮小するか。負の値ならレイヤを上下反転
float | | 何もしない | Boolean | true：レイヤを最前面に移動する。<br>※最前面とは、Flashのstage.addChildにおける重なり順
index | | 何もしない | 0〜 | レイヤをindexで指定したインデックスに移動する。<br>※インデックスは、FlashのStage.setChildIndex()を参照。
dive | | 何もしない | レイヤ名 | レイヤをdiveで指定したレイヤのすぐ後ろに潜り込ませる。<br>「plg:プラグイン名」と記述する事でプラグインも指定できる。

---
## [[lay] レイヤ設定(文字レイヤ)](#txtlay)

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
max_col | | 現在値 | 1〜 | ページあたりの表示列数（横書き時は上から下、縦書き時は右から左へ数える）<br>改行・禁則処理に使用。実際に文字が表示されるかは、フォントサイズや表示位置との兼ね合いによる。<br>初期値は 10
max_row | | 現在値 | 1〜 | ページあたりの表示行数。初期値は 10
bura_col | | 現在値 | 0〜 | 禁則時ぶら下がり文字数。初期値は 2
chk_overrow | | 現在値 | Boolean | true：カーソルがmax_rowを超えたらエラー＆停止（初期値）<br>false：表示行数を越える直前に自動改ページ
b_left | | 現在値 | 画面左上を(0, 0)とする座標 | テキスト背後の矩形表示位置。<br>初期値はそれぞれ 16 16
b_top | | (↑と同じ)  | (↑と同じ)  | (↑と同じ)
b_width | | (↑と同じ) | 矩形表示縦横ピクセル数 | テキスト背後の矩形表示縦横サイズ。<br>初期値はそれぞれ（画面横幅 - b_left *2）（画面縦幅 - b_top *2）
b_height | | (↑と同じ)  | (↑と同じ)  | (↑と同じ)
b_color | | (↑と同じ) | 色指定。0x000000など | テキスト背後の矩形色。初期値は 0x000000（黒）
b_alpha | | (↑と同じ) | 実数：0.0（透明）〜1.0（不透過） | テキスト背後の矩形不透明度。<br>表示しない場合は0を指定。初期値は 0
b_pic | | (↑と同じ) | 画像ファイル名 | 文字レイヤ背後の枠画像を指定する。b_top、b_left、b_alphaの影響を受ける。<br>（これを指定するとb_colorは無視される）
back_clear | | 現在値 | Boolean | true：背景をクリアする
b_alpha_isfixed | | 現在値 | Boolean | true：テキスト背後の矩形不透明度を、「b_alpha属性と sys:TextLayer.Back.Alpha の掛け算とせず」、b_alpha属性値そのものにする。（これは2017/2/13以前の仕様）
draggable | | false | Boolean | true：テキスト背後の矩形をドラッグできる
drag_x | | 0 | 画面左上を(0, 0)とする座標 | ドラッグ範囲の左上始点。
drag_y | | 0 | (↑と同じ)  | (↑と同じ)
drag_w | | 画面横幅 | ドラッグ範囲縦横ピクセル数 | ドラッグ範囲縦横サイズ。
drag_h | | 画面縦幅 | (↑と同じ)  | (↑と同じ)
dragmove_fn | ... | ... | ... | ドラッグ中にサブルーチンコールする先。<br>指定方法は[jump]と同様
dragmove_label | (↑と同じ)  | (↑と同じ)  | (↑と同じ)  | (↑と同じ)
dragmove_arg | | | String | 指定した場合、ドラッグ中コール先で「&const.an.eventArg」にて値を受け取れる
h_scroll | | | ピクセル数 | 横スクロールさせる量
v_scroll | | | ピクセル数 | 縦スクロールさせる量
mouse_wheel_enabled | | | Boolean | マウスホイールでスクロール許可するか否か
layout | | 現在値 | String | 文字レイヤのレイアウトを指定する。<br>文法はFlex SDK 4のTLF (Text Layout Framework)・TextFlowのXML指定による。<br>※「TLFのXML指定」と言われても良く判らないでしょうし、こちらのサイト（Text Layout Editor Demo Application - Adobe Labs）で色々いじってみて、下の【Markup...】ボタンで出てくるXMLを参考にして下さい。<br><br>このlayoutという属性の中にTLF属性群を入れ子状に記述する。<br>例えば、blockProgressionで縦書き・横書きを指定できる。<br>設定しないTLF属性は現在値を継続する。<br>初期値は空（から）、全くの未指定。<br><br>駆使すると、「文字表示領域矩形内に自動で文字を並べる」事なども出来ます
onend | | 現在値 | （コメントで解説） | 行末禁則処理を指定する。（全文字レイヤで設定を共有）<br>warning …… 行末禁則・Warning処理<br>nop …… 何もしない<br>enter …… 行末禁則・追い込み処理<br>leave …… 行末禁則・追い出し処理（初期値）
end | | 現在値 | String | 行末禁則処理対象の文字群を指定する。（全文字レイヤで設定を共有）<br>初期値は……［（｛〈「『【〔“〝
bura | | 現在値 | String | ぶら下がり処理対象の文字群を指定する。（全文字レイヤで設定を共有）<br>「、」「。」などを連結した文字列。<br>初期値は……<br>、。，．）］｝〉」』】〕”〟ぁぃぅぇぉっゃゅょゎァィゥェォッャュョヮヵヶ！？!?‼⁉・ーゝゞヽヾ々<br>onsplit | | 現在値 | （コメントで解説） | 分割禁止処理を指定する。（全文字レイヤで設定を共有）<br>warning …… 分割禁止・Warning処理<br>nop …… 分割禁止なし（初期値）<br>enter …… 分割禁止・追い込み処理
dont_sprit | | 現在値 | String | 分割禁止処理対象の文字群を指定する。（全文字レイヤで設定を共有）<br>初期値は「─（ダーシ）」「‥（二点リーダ）」「…（三点リーダ）」
r_color | | 現在値 | 色指定。0x000000など | ルビの文字色。初期値は 0xFFFFFF
r_size | | 現在値 | 1〜 | ルビ文字サイズ。初期値は 12
r_shift | | 現在値 | 正負の整数 | ルビ文字を親文字から何ピクセル離すか。<br>値の正負と縦書き横書きの関係は、TLFのBaselineShiftに従う。初期値は 0
r_align | | 現在値 | （コメントで解説） | ルビ揃えを指定する。<br>left ……（肩付き）先頭親文字から、ルビ間は密着<br>center ……（中付き）センター合わせ、〃<br>right ……（右／下揃え）末尾親文字から、〃<br>justify ……（両端揃え）先頭から末尾親文字間に、ルビ間は均等にあける<br>121 ……（1-2-1(JIS)）ルビの前後を比率1、ルビ間を比率2であける<br>even ……（均等アキ）ルビの前後、ルビ間も均等にあける<br>1ruby ……（1ルビ文字アキ）ルビの前後をルビ一文字空け、ルビ間は均等にあける<br><br>初期値は center。<br><br>※leftやright以外において、親文字よりルビの方が長い場合は、親文字に対する「中付き」表示になる

---
## [[lay] レイヤ設定(画像レイヤ)](#grplay)
属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**fn** | **y** | 何もしない | 画像ファイル名 | 基本画像ファイルを指定する
face | | 何もしない | [add_face]で登録した差分画像（半角カンマ区切りで複数可能） | 差分画像ファイルを指定する。<br>[fg fn="a" face="b,c,d"]なら「基本a」の上に「差分b」を重ね、「差分c」を重ね、「差分d」を重ねる。<br><br>【注意】fnは同じでface属性だけを指定→指定なしにした場合、表示が変わりませんが不具合ではありません。 「face属性指定なし」は「何もしない」、つまり変化させないからです。<br>[fg layer=upd fn="a" face="b"]<br>[l]<br>[fg layer=upd fn="a"]<br>[l]<br><br>差分画像を無くしたい場合、明確に空文字（""）を指定します。<br>[fg layer=upd fn="a" face="b"]<br>[l]<br>[fg layer=upd fn="a" face=""]<br>[l]
draggable | | false | Boolean | true：テキスト背後の矩形をドラッグできる
drag_x | | 0 | 画面左上を(0, 0)とする座標 | ドラッグ範囲の左上始点。
drag_y | | 0 | (↑と同じ) | (↑と同じ)
drag_w | | 画面横幅 | ドラッグ範囲縦横ピクセル数 | ドラッグ範囲縦横サイズ。
drag_h | | 画面縦幅 | (↑と同じ) | (↑と同じ)
dragmove_fn | ... | ... | ... | ドラッグ中にサブルーチンコールする先。<br>指定方法は[jump]と同様
dragmove_label | ... | ... | ... | (↑と同じ)
dragmove_arg | | | String | 指定した場合、ドラッグ中コール先で「&const.an.eventArg」にて値を受け取れる

---
## [[trans] ページ裏表を交換](#trans)
	裏ページを表ページとクロスフェードする。
クロスフェードを開始すると、終了を待たずに次のタグへと処理を進める。<br>
終了を待ちたい場合は[wt]を使用する。<br>
<br>
クロスフェード終了後は元・裏ページから元・表ページに内容をコピーし、同じ内容になる。<br>
<br>
ルール画像は白黒かグレースケールを推奨。（見た目と動きが一致する）<br>
また[trans]～[wt]間で文字表示や[ch]は動作未定義、非推奨。<br>
[trans]終了を待たず何かをするのは避けた方がよいでしょう。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
layer | | 全てのレイヤ | 処理対象レイヤ名（カンマ区切りで複数可能） | クロスフェードするレイヤ。指定以外のレイヤは変化させない
time | | 0 | ミリ秒 | 変化にかける時間
delay | | 0 | ミリ秒 | 変化する前に待機する遅延時間
rule | | 画面全体ピクセルで同時にクロスフェードする | 画像ファイル名（swf不可） | 指定した場合はルール画像として、ピクセル単位でクロスフェードするタイミングをずらす。<br>ルール画像の黒いピクセル（と同じ位置にあるピクセル）が先に処理され、白が最後になる。
vague | | 0.04 | トランジション期間全体を1とした値 | 表レイヤと裏レイヤの境界を曖昧にぼかす度合い
light | | false | Boolean | 少々ギザギザだが処理が軽い方法でクロスフェードするか
c_plugin | | 何もしない | 処理対象プラグイン名（カンマ区切りで複数可能） | 指定したプラグインの可視状態が[trans]で変化するようになる。表示非表示が切り替わる。ただしクロスフェード中はアニメが止まる

---
## [[wt] トランス終了待ち](#wt)
	[trans]で開始したトランスの終了を待つ。
終了次第、スクリプト処理を次へ進める。<br>
<br>
また[trans]～[wt]間で文字表示や[ch]は動作未定義、非推奨。<br>
[trans]終了を待たず何かをするのは避けた方がよいでしょう<br>

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
canskip | | true | Boolean | trueでクリックキャンセル可能にする。

---
# レイヤトゥイーン
## [[pause_tsy] 一時停止](#pause_tsy)

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
xxxxxx | **y** | | |

---
## [[resume_tsy] 一時停止再開](#resume_tsy)

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
xxxxxx | **y** | | |

---
## [[stop_tsy] トゥイーン中断](#stop_tsy)

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
xxxxxx | **y** | | |

---
## [[tsy] トゥイーン開始](#tsy)

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
xxxxxx | **y** | | |

---
## [[wait_tsy] トゥイーン終了待ち](#wait_tsy)

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
xxxxxx | **y** | | |


---
# 文字・文字レイヤ
## [[autowc] 文字ごとのウェイト](#autowc)
	特定の文字の直後に自動的にウェイトを入れる。
textに指定した文字に対し、timeに指定した数値が対応する。<br>
通常の文字表示速度にtimeの数値を掛け算する。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
enabled | | 現在値 | Boolean | 自動ウェイトを有効にするか
text | 両方同時に指定、或いは省略 | 現在値 | String | ウェイトを指定する文字の集まり
time | (↑と同じ) | 現在値 | カンマ区切りの数値 | 文字表示ウェイト倍数

　以下のように指定する。<br>
[autowc enabled=true text="４５６" time="50,100,150"]<br>
[autowc enabled=true text="４５６" time="100,100,100"]<br>
[autowc enabled=false]

　以下はエラーとなる。<br>
;x	[autowc enabled=true text="４５６" time="100,100"]<br>
;x	[autowc enabled=true text="４５６" time="100,100,100,100"]<br>
;x	[autowc enabled=true text="４５６"]<br>
;x	[autowc enabled=true time="100,100,100"]<br>
;x	[autowc enabled=true]<br>
;x	[autowc enabled=true text="" time=""]<br>
;x	[autowc text="" time=""]

---
## [[ch] 文字を追加する](#ch)
	文字レイヤに文字を出力する

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
layer | | デフォルト文字レイヤ | 文字レイヤ名 | 文字を表示するレイヤ
page | | fore | fore、back | ページの裏表
**text** | **y** | | String | 表示したい文字列。ルビ文法（《》）も解析する。改行も [r] で出来る
record | | true | Boolean | 履歴に保存するか
wait | | 現在の文字表示速度 | ミリ秒 | 一時的な文字表示速度。0で瞬時。<br>何らかのキー押下やマウスクリックで全てを瞬時表示する
join | | true | Boolean | trueで読み込みを待って次のタグへ進む。

[ch]を使わない、より簡潔な記述文法があります。（ver 3.18以降）<br>
以下の記述は、<br>
[ch text=&test]<br>
[ch text=test]<br>
[ch text="&a + b"]<br>
<br>
以下のようにも書けます。&から&までを[ch]文と解釈します。<br>
&test&<br>
&'test'&<br>
&a + b&

---
## [[clear_text] 文字消去](#clear_text)
	文字のみをクリアする

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
layer | | デフォルト文字レイヤ | 文字レイヤ名 | 文字を表示するレイヤ
page | | fore | fore、back | ページの裏表

---
## [[current] デフォルト文字レイヤ設定](#current)
	デフォルト文字レイヤを設定する

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**layer** | **y** | | 文字レイヤ名 | デフォルトとするレイヤ

---
## [[endlink] ハイパーリンクの終了](#endlink)
	[link]（ハイパーリンク）で開始したリンク区間を終了する

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
layer | | デフォルト文字レイヤ | 文字レイヤ名 | 文字を表示するレイヤ
page | | fore | fore、back | ページの裏表

---
## [[er] ページ両面の文字消去](#er)
	デフォルト文字レイヤの裏と表の両方に対して[clear_lay]を行う。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
rec_page_break | | true | Boolean | 履歴を改ページするか

---
## [[graph] インライン画像表示](#graph)
	文字レイヤに画像を文字として表示する。ルビは同時に設定する。
フォントにない外字やswfアニメ画像表示に使える。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
layer | | デフォルト文字レイヤ | 文字レイヤ名 | 文字を表示するレイヤ
page | | fore | fore、back | ページの裏表
**pic** | **y** | | 画像ファイル名 | 表示する画像やswf
r | | ルビ無し | String | ルビ文字列（ただしあまりに他の文字サイズと大きく異なる場合は正しい位置に表示されない）
width | | 画像の横サイズ（※） | 1〜 | 表示する画像の横ドットサイズ。<br>元のサイズと異なる場合は拡大・縮小される。
height | | 画像の縦サイズ（※） | 1〜 | 保存する画像の縦ドットサイズ。<br>元のサイズと異なる場合は拡大・縮小される。

※省略時は画像サイズになるが、ロード完了直後に文字配置を決めるのでちらつく。それを嫌う際に指定する<br>
※特にモバイルなどでゲーム画面が自動で拡大縮小される場合、省略したらその時の本文文字サイズとして扱われる。なるべくサイズ指定を推奨。

---
## [[link] ハイパーリンク](#link)
	指定した文字レイヤの表ページに、ハイパーリンクを作成する。
[link]から[endlink]（ハイパーリンクの終了）までで囲った範囲をリンク区間と呼び、<br>
その区間の文字や縦中横がハイパーリンクになる。（リンク区間は入れ子に出来ません）<br>
※選択肢として使用する場合、ジャンプ先のラベル直後には必ず[record_place]を記述して、ジャンプ直後でセーブしても正しくセーブされるようにして下さい。<br>
ブラウザ実行時、ローカル版swfをブラウザで開いた場合はhref属性によるリンクジャンプが利きません。非ローカル版swfをサーバーに設置すれば動作します。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
layer | | デフォルト文字レイヤ | 文字レイヤ名 | 文字を表示するレイヤ名
page | | fore | fore、back | ページの裏表
href | | 何もしない | URL | クリック時にブラウザで指定URLを開く
target | | 何もしない | HTML <a>タグのtarget属性 | hrefにてブラウザを開く際のtarget属性
f_color | | 0x8888FF | 色指定。0x000000など | （リンク上にマウスがない状態）文字色
f_alpha | | 1.0（不透明） | 0.0〜1.0（実数） | （リンク上にマウスがない状態）文字の透過度
f_ul | | true | Boolean | （リンク上にマウスがない状態）trueの場合は文字に下線を引く
hf_color | | 0xFFFF00 | 色指定。0x000000など | （リンク上にマウスがある状態）文字色
hf_alpha | | 1.0（不透明） | 0.0〜1.0（実数） | （リンク上にマウスがある状態）文字の透過度
hf_ul | | false | Boolean | （リンク上にマウスがある状態）trueの場合は文字に下線を引く
af_color | | 0x8888FF | 色指定。0x000000など | （リンクをマウス押下した状態）文字色
af_alpha | | 1.0（不透明） | 0.0〜1.0（実数） | （リンクをマウス押下した状態）文字の透過度
af_ul | | true | Boolean | （リンクをマウス押下した状態）trueの場合は文字に下線を引く
b_color | | 背景色なし | 色指定。0x000000など | リンク背景色
b_alpha | | 1.0（不透明） | 0.0〜1.0（実数） | リンク背景の透過度
hint | | | String | 設定した場合のみ、マウスカーソルを載せるとヒントをチップス表示する
clickse | | 省略時は無音 | 効果音ファイル名 | 指定すると、クリック時に効果音を再生する
enterse | | 省略時は無音 | 効果音ファイル名 | 指定すると、ボタン上にマウスカーソルが載った時に効果音を再生する
leavese | | 省略時は無音 | 効果音ファイル名 | 指定すると、ボタン上からマウスカーソルが外れた時に効果音を再生する
clicksebuf | | SYS | サウンドバッファ名 | クリック時効果音を再生するサウンドバッファを指定する
entersebuf | | SYS | サウンドバッファ名 | クリック時効果音を再生するサウンドバッファを指定する
leavesebuf | | SYS | サウンドバッファ名 | クリック時効果音を再生するサウンドバッファを指定する
call | | false | Boolean | trueの場合は[call]、falseは[jump]。<br>ただしcall=trueによりサブルーチンコールした場合、[return]によって「コールする前のイベント予約状態＆待ち状態」に戻る。
fn | ... | ... | ... | クリック時にジャンプする先。<br>指定方法は[jump]と同様
label | ... | ... | ... | (↑と同じ)
onenter | | 何もしない | ラベル名 | マウス重なり（フォーカス取得）時、指定したラベルをコールする。 必ず[return]で戻ること。
onleave | | 何もしない | ラベル名 | マウス重なり外れ（フォーカス外れ）時、指定したラベルをコールする。 必ず[return]で戻ること。
global | | false | Boolean | 詳細は[event]と同様。<br>※ボタンを[trans]する場合はtrueにしておく
arg | | | String | 指定した場合、クリック時ジャンプ先で「&const.an.eventArg」にて値を受け取れる

---
## [[r] 改行](#r)
	指定した文字レイヤの表ページに、改行を出力する。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
layer | | デフォルト文字レイヤ | 文字レイヤ名 | 文字を表示するレイヤ名
page | | fore | fore、back | ページの裏表

---
## [[rec_ch] 履歴書き込み](#rec_ch)
	履歴に改行を出力する。自動で改行を付加する。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**text** | **y** | | String | 表示したい文字列。ルビ文法（《》）も解析する。
r | | true | Boolean | trueなら改行する

---
## [[rec_r] 履歴改行](#rec_r)
	履歴に改行を出力する。

引数無し。

---
## [[reset_rec] 履歴リセット](#reset_rec)
	履歴をクリアする。
応用として、履歴に加工した文字列を設定し、履歴画面に機能を追加する事も。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
text | | 全てクリア | String | 履歴に設定したい文字列

---
## [[ruby2] 文字列と複数ルビの追加](#ruby2)
	親文字列とルビ文字列のセットで文字を追加する

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
layer | | デフォルト文字レイヤ | 文字レイヤ名 | 文字を表示するレイヤ名
page | | fore | fore、back | ページの裏表
**t** | **y** | | String | 親文字列
**r** | **y** | | String | ルビ文字列

---
## [[set_focus] 未作成：フォーカス移動](#set_focus)
	[button]フォーカスを移動する。
説明に「フォーカス順」とある場合は、[button]が文字レイヤに追加された順番。<br>
先頭は最初に追加された[button]。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**to** | **y** | | （コメントで解説） | prev……フォーカス順で前の[button]に移動<br>next……フォーカス順で次の[button]に移動<br>null……どの[button]にもフォーカスがない状態にする<br>数値……数値をフォーカス順の番号（0〜）として移動

---
## [[span] インラインスタイル設定](#span)
	この指定以降の文字のレイアウト（フォントや文字色など）を指定する。
一時的に文字レイヤのlayout属性への指定を上書きするイメージ。
文字レイヤをクリア（[clear_text]、[clear_lay]）するとリセット、以降は元通り文字レイヤのlayout属性に従う

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
layer | | デフォルト文字レイヤ | 文字レイヤ名 | 文字を表示するレイヤ
page | | fore | fore、back | ページの裏表
layout | | リセット | String | 文字のレイアウトを指定する。文法は[lay]のlayout属性と同様。

---
## [[tcy] 縦中横を表示する](#tcy)
	縦中横文字を追加する。ルビは同時に設定する

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
layer | | デフォルト文字レイヤ | 文字レイヤ名 | 文字を表示するレイヤ
page | | fore | fore、back | ページの裏表
**t** | **y** | | String | 縦中横文字列、通常半角文字を指定する。
r | | ルビ無し | String | ルビ文字列

---
# 画像・画像レイヤ
## [[add_face] 差分画像の追加](#add_face)
	差分画像を登録する。
本タグだけでは差分画像を表示しない。画像レイヤの[lay]タグface属性で指定する差分名称を登録する。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**name** | **y** | | 差分名称 | [lay]タグface属性で指定する差分名称
fn | | 属性nameの値 | 画像ファイル名 | 表示する画像、swf
dx | | 0 | 基本画像左上を(0, 0)とする座標 | 差分画像の表示横位置
dy | | 0 | (↑と同じ) | 差分画像の表示縦位置
blendmode | | 何もしない | ブレンドモード名（"screen"など） | このレイヤと下のレイヤとの重なりにおいて、<br>ドット単位で色のブレンド演算を行なう。<br>詳細はblendModeの解説を参照。

例えば同じ画像で差分表示位置やブレンドモードが違う登録をしたい場合、<br>
[add_face name="a_normal" fn="画像" dx=0 dy=0]<br>
[add_face name="a_10_10" fn="画像" dx=10 dy=10]<br>
[add_face name="a_screen" fn="画像" dx=0 dy=0 blendmode="screen"]<br>
とnameを変えることで登録できます。

---
# HTMLフレーム
## [[add_frame] フレーム](#add_frame)

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
xxxxxx | **y** | | |

---
## [[let_frame] フレーム](#let_frame)

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
xxxxxx | **y** | | |

---
## [[set_frame] フレーム](#set_frame)

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
xxxxxx | **y** | | |

---
## [[frame] フレーム](#frame)

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
xxxxxx | **y** | | |

---
## [[tsy_frame] フレーム](#tsy_frame)

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
xxxxxx | **y** | | |


---
# イベント
## [[clear_event] イベントを全消去](#clear_event)
	イベント予約を全て削除する

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
global | | false | Boolean | trueを指定すると全ての大域イベントを削除する。
falseの場合は大域以外の全てのイベントを削除する

---
## [[enable_event] イベント有無の切替](#enable_event)
	文字レイヤごとのイベント発生有効無効を設定する。
無効にするとマウスイベントが無効になり、[s]待ちなどでイベントが発生しなくなるが、イベント予約は別の話であり、削除などされない。
有効にすればマウスイベントが発生するようになり、再びイベント待ちされるようになる

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
layer | | デフォルト文字レイヤ | 文字レイヤ名 | イベント有効無効を設定するレイヤ
enabled | | true | Boolean | イベントを有効にするか

---
## [[event] イベントを予約](#event)
	次の[s]などのイベント待ちに向けてイベント処理を予約する。
あるイベントが発生した際、global=falseのイベント予約は全て削除される

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**key** | **y** | | click、rightclick、middleclick、upwheel、downwheel、<br>イベントのキー名※1 | イベントを発生させるトリガーイベント<br><br>修飾キーの同時押し（あるいは修飾キーを押しといて通常キー）を任意に組み合わせられます。「半角プラスで」「ABC順に」「イベントのキー名の前に」繋げて下さい。<br>（例1）key=alt+enter<br>（例2）key=alt+ctrl+shift+enter<br>修飾キー対応表は以下になります。<br>AIRNovel表記 | Windows | Mac<br>alt | Alt キー | Option キー<br>ctrl | Ctrl キー | Ctrl または Command キー<br>shift | Shift キー | Shift キー<br>call | | false | Boolean | trueの場合は[call]、falseは[jump]。<br>ただしcall=trueによりサブルーチンコールした場合、[return]によって「コールする前のイベント予約状態＆待ち状態」に戻る。
fn | ... | ... | ... | イベント発生時にジャンプする先。指定方法は[jump]と同様。<br>callの場合、ジャンプ先から[return]で戻ると、<br>再度[s]などのイベント待ち状態に戻る。
label | ... | ... | ... | (↑と同じ)
global | | false | Boolean | trueを指定すると大域的なイベント扱いとなり、<br>イベント発生時にイベント予約が削除されない
arg | | | String | 指定した場合、クリック時ジャンプ先で「&const.an.eventArg」にて値を受け取れる
del | ... | | Boolean | trueを指定すると予約済みイベントを削除する。<br>fn/label/callとdelは同時指定できません
frame | | 10 | 1〜 | key=enter_frameの場合のみ有効。<br>フレームイベントは毎秒何度も（[window]のframerate回）発生するが、 アプリ全体が重くなるので、適度に間引いてイベントを時々発生させるため、 フレーム何回に一回イベントを発生させるかを指定する。<br>例）30フレームで動作するアプリでframe=15を指定すると、30/15=0.5秒に一回発生（タイミングにより厳密ではない）

※1 イベントのキー名は以下のキーボードキー名かActionScriptイベント名のいずれか。
key属性の値 | コメント
-- | --
alternate | optionと同値。Winで言うALTキー。MacならOptionキー
backquote |
backslash |
backspace |
caps_lock |
command | Macにある、Winで言うCTRLキーのようなもの
control |
delete |
down | 矢印キーの下
end |
enter |
equal | 「=（イコール）」キーはMacにしか無い
escape |
home |
left | 矢印キーの左
numpad_enter | テンキーのEnterキー。テンキーはキーボードによっては存在しない
option | alternateと同値。Winで言うALTキー。MacならOptionキー
orientation | （デバイス・ANBooksのみ）デバイスが回転したらイベント発生（※3）
page_down |
page_up |
right | 矢印キーの右
shift |
space |
tab |
up | 矢印キーの上
f1 |
f2 |
f3 |
f4 |
f5 |
f6 |
f7 |
f8 |
f9 |
f10 |
f11 |
f12 |
f13 | キーボードによっては存在しない
f14 | キーボードによっては存在しない
f15 | キーボードによっては存在しない
enter_frame | 毎フレーム毎にイベント発生（※2）
activate | アプリがフォーカスを取得して、アクティブ（前面）になった
deactivate | アプリがフォーカスを失って、非アクティブになった
back | （Android）戻るキー<br>（ちなみにホームキーはAndroid仕様でホームに戻る以外の機能は持たせられない）
menu | （Android）メニューキー
search | （Android）検索キー

※2 enter_frameイベントは毎秒何度も発生する。

---
## [[l] 行末クリック待ち](#l)
	シナリオファイルの順次処理を停止し、クリックやキー押下（→詳細は[waitclick]）を待つ。
「breakline」という画像やswfファイルが用意されていれば、行末クリック待ちマークとして表示する。
クリックやキー押下が発生した場合、処理を再開する。
[event]などでイベントが登録されていれば、イベント発生待ちを行う。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
visible | | true | Boolean | trueで行末クリック待ち記号を表示、falseで非表示

---
## [[p] 改ページクリック待ち](#p)
	シナリオファイルの順次処理を停止し、クリックやキー押下（→詳細は[waitclick]）を待つ。
「breakpage」という画像やswfファイルが用意されていれば、改ページクリック待ちマークとして表示する。
クリックやキー押下が発生した場合、処理を再開する。
[event]などでイベントが登録されていれば、イベント発生待ちを行う。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
visible | | true | Boolean | trueで改ページ記号を表示、falseで非表示
er | | 何もしない | Boolean | trueで改ページ待ち後に[er]処理を行なう

---
## [[s] 停止する](#s)
	引数無し。
シナリオファイルの順次処理を停止する。
[event]などでイベントが登録されていれば、イベント発生待ちを行う。

---
## [[set_cancel_skip] スキップ中断予約](#set_cancel_skip)
引数無し。
ページ末まで一気に読み進むモード、自動読みすすみモードなどの開始に備え、クリックなどで処理を中断できるような特殊イベントを予約する。
クリックやキー押下が発生した場合、処理を再開する。

※例えば自動読み進みモードだと[l][p]などで停止しないため、予約イベントが処理されない。その為のタグ。

---
## [[wait] ウェイトを入れる](#wait)
	指定時間スクリプト処理を待ち、再開する。
[event]などでイベントが登録されていても、イベント発生待ちを行わない。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**time** | **y** | | ミリ秒 | 処理を待つ時間
canskip | | true | Boolean | クリックなど（→詳細は[waitclick]）でウエイトをキャンセルできるか

---
## [[waitclick] クリックを待つ](#waitclick)
	シナリオファイルの順次処理を停止し、クリックやキー押下※を待つ。
引数無し。<br>
クリックやキー押下が発生した場合、処理を再開する。<br>
[event]などでイベントが登録されていれば、イベント発生待ちを行う。<br>
<br>
※クリックやキー押下とは、以下のイベントを差す。<br>
　　click<br>
　　downwheel（下方向へのマウスホイール）<br>
　　enter<br>
　　space<br>
　　down（矢印キーの下）

---
# ＢＧＭ・効果音
## [[fadebgm] BGMのフェード](#fadebgm)
	BGMを指定した音量に、段階的に変化させる。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**volume** | **y** | | 0.0〜1.0（実数） | 音量
**time** | **y** | | ミリ秒 | フェード時間
delay | | 0 | ミリ秒 | 変化する前に待機する遅延時間

---
## [[fadeoutbgm] BGMのフェードアウト](#fadeoutbgm)
	BGMを無音に、段階的に変化させる。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**time** | **y** | | ミリ秒 | フェード時間
stop | | true | Boolean | trueで「フェード終了時の再生停止」、falseなら行なわない。
delay | | 0 | ミリ秒 | 変化する前に待機する遅延時間

---
## [[fadeoutse] 効果音のフェードアウト](#fadeoutse)
	効果音を無音に、段階的に変化させる。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
buf | | SE | 効果音を識別するトラック名 | トラック名を変えれば同時に複数の音を操作することが出来ます。
**time** | **y** | | ミリ秒 | フェード時間
stop | | true | Boolean | trueで「フェード終了時の再生停止」、falseなら行なわない。
delay | | 0 | ミリ秒 | 変化する前に待機する遅延時間

---
## [[fadese] 効果音のフェード](#fadese)
	効果音を指定した音量に、段階的に変化させる。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
buf | | SE | 効果音を識別するトラック名 | トラック名を変えれば同時に複数の音を操作することが出来ます。
**volume** | **y** | | 0.0〜1.0（実数） | 音量
**time** | **y** | | ミリ秒 | フェード時間
delay | | 0 | ミリ秒 | 変化する前に待機する遅延時間

---
## [[playbgm] BGM の演奏](#playbgm)
BGMを再生する。
	[playse]とは違い、キー押下Skip中でも必ず再生を行なう。（canskip = false）

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**fn** | **y** | | BGM音声ファイル名 | 再生する音声ファイル名
loop | | true | Boolean | trueでBGMのようにループ再生する。
volume | | 1.0 | 0.0〜1.0（実数） | 再生音量。ただし音量を示すシステム変数（sys:const.an.sound.BGM.volume）は変更しない
ret_ms | | 0（冒頭） | ミリ秒 | ループ戻り位置指定。冒頭から再生開始するが、mp3終端に行くたびに指定したミリ秒の位置に戻る
end_ms | | 終端 | ミリ秒 | 音声ファイルの終端位置を指定する。（音声ファイルの末尾にどうしても無音が残る場合、ループ時に困るときなどに）<br>正の値は「冒頭から何ms目を終端とするか」<br>負の値は「末尾から何ms手前を終端とするか」の指定。
join | | true | Boolean | trueで読み込みを待って次のタグへ進む。

---
## [[playse] 効果音の再生](#playse)
	効果音を再生する。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**fn** | **y** | | 効果音音声ファイル名 | 再生する音声ファイル名
buf | | SE | 効果音を識別するトラック名 | トラック名を変えれば同時に複数の音を操作することが出来ます。
loop | | false | Boolean | trueでBGMのようにループ再生する。
volume | | 1.0 | 0.0〜1.0（実数） | 再生音量。ただし音量を示すシステム変数（sys:const.an.sound.【トラック名】.volume）は変更しない
ret_ms | | 0（冒頭） | ミリ秒 | ループ戻り位置指定。冒頭から再生開始するが、mp3終端に行くたびに指定したミリ秒の位置に戻る。
end_ms | | 終端 | ミリ秒 | 音声ファイルの終端位置を指定する。（音声ファイルの末尾にどうしても無音が残る場合、ループ時に困るときなどに）<br>正の値は「冒頭から何ms目を終端とするか」<br>負の値は「末尾から何ms手前を終端とするか」の指定。
join | | true | Boolean | trueで読み込みを待って次のタグへ進む。
canskip | | true | Boolean | trueでキー押下Skip中なら再生をしない
cache | | true | Boolean | trueなら今まで通り、内部的にサウンドデータをキャッシュして再度再生時に素早く再生する（mp3のみ）

---
## [[stop_allse] 全効果音再生の停止](#stop_allse)
	全てのサウンドを停止する。ぴたっと止める。

---
## [[stopbgm] BGM 演奏の停止](#stopbgm)
	BGM 演奏を停止する。ぴたっと止める。

---
## [[stopfadese] 音声フェードの停止](#stopfadese)
	音声フェードを停止する。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
buf | | SE | 効果音を識別するトラック名 | トラック名を変えれば同時に複数の音を操作することが出来ます。<br>BGMと指定するとBGMの指定。

---
## [[stopse] 効果音再生の停止](#stopse)
効果音再生を停止する。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
buf | | SE | 効果音を識別するトラック名 | トラック名を変えれば同時に複数の音を操作することが出来ます。

---
## [[volume] 音量設定](#volume)
BGMや効果音を指定した音量にする。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
buf | | SE | 効果音を識別するトラック名 | トラック名を変えれば同時に複数の音を操作することが出来ます。<br>BGMと指定するとBGMの音量設定。
volume | | 1.0 | 0.0〜1.0（実数） | 音量

---
## [[wb] BGM フェードの終了待ち](#wb)
BGM フェードの終了を待つ。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
canskip | | false | Boolean | trueでクリックキャンセル可能にする。

---
## [[wf] 効果音フェードの終了待ち](#wf)
効果音 フェードの終了を待つ。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
buf | | SE | 効果音を識別するトラック名 | トラック名を変えれば同時に複数の音を操作することが出来ます。
canskip | | false | Boolean | trueでクリックキャンセル可能にする。

---
## [[wl] BGM 再生の終了待ち](#wl)
	BGM 再生の終了を待つ。
loop=true（[playbgm]のデフォルト値）なら待たない。<br>
利用時は【音声再生[playbgm]がjoin=true(ちなみにデフォルト)であること】を必須条件とします。

---
## [[ws] 効果音再生の終了待ち](#ws)
	効果音再生の終了を待つ。
loop=trueなら待たない。
利用時は【音声再生[playse]がjoin=true(ちなみにデフォルト)であること】を必須条件とします。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
buf | | SE | 効果音を識別するトラック名 | トラック名を変えれば同時に複数の音を操作することが出来ます。
canskip | | false | Boolean | trueでクリックキャンセル可能にする。

---
## [[xchgbuf] 再生トラックの交換](#xchgbuf)
	二つのバッファを交換する。未再生でも再生中でも良いが、フェード中は避けること。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
buf | | SE | 効果音を識別するトラック名 | トラック名
buf2 | | SE | 効果音を識別するトラック名 | もう一つのトラック名


---
# 条件分岐
## [[else] その他ifブロック開始](#else)
	プログラム言語における、条件分岐のelse文。
引数無し。<br>
詳細は【開発者向け情報：式の評価と条件分岐】をご覧下さい。

---
## [[elsif] 別条件のifブロック開始](#elsif)
	プログラム言語における、条件分岐のelsif文。
詳細は【開発者向け情報：式の評価と条件分岐】をご覧下さい。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**exp** | **y** | | Boolean | trueの場合処理は直後にうつる。
falseなら次の[elsif]や[else]の評価を行なう。

---
## [[endif] ifブロックの終端](#endif)
	プログラム言語における、条件分岐のendif文。
引数無し。<br>
詳細は【開発者向け情報：式の評価と条件分岐】をご覧下さい。

---
## [[if] ifブロックの開始](#if)
	プログラム言語における、条件分岐のif文。
詳細は【開発者向け情報：式の評価と条件分岐】をご覧下さい。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**exp** | **y** | | Boolean | trueの場合処理は直後にうつる。<br>falseなら次の[elsif]や[else]の評価を行なう。


---
# ラベル・ジャンプ
## [[button] ボタンを表示](#button)
	文字レイヤにボタンを配置する。
※選択肢として使用する場合、ジャンプ先のラベル直後には必ず[record_place]を記述して、ジャンプ直後でセーブしても正しくセーブされるようにして下さい。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
layer | | デフォルト文字レイヤ | 文字レイヤ名 | ボタンを配置する文字レイヤ
page | | back | fore、back | ページの裏表
**pic** | **y** | | 画像ファイル名（swf不可） | ボタンとして配置する画像を指定する。<br>ただし画像は縦に三等分し、左から「通常時」「クリック押下時」「マウスカーソルを載せた時」の画像として表示する。
pos<br>left<br>center<br>right<br>s_right<br>top<br>middle<br>bottom<br>s_bottom | | ※ | ※ | ※詳細は[lay]を参照
hint | | | String | 設定した場合のみ、マウスカーソルを載せるとヒントをチップス表示する
clickse | | 省略時は無音 | 効果音ファイル名 | 指定すると、クリック時に効果音を再生する
enterse | | 省略時は無音 | 効果音ファイル名 | 指定すると、ボタン上にマウスカーソルが載った時に効果音を再生する
leavese | | 省略時は無音 | 効果音ファイル名 | 指定すると、ボタン上からマウスカーソルが外れた時に効果音を再生する
clicksebuf | | SYS | サウンドバッファ名 | クリック時効果音を再生するサウンドバッファを指定する
entersebuf | | SYS | サウンドバッファ名 | クリック時効果音を再生するサウンドバッファを指定する
leavesebuf | | SYS | サウンドバッファ名 | クリック時効果音を再生するサウンドバッファを指定する
call | | false | Boolean | trueの場合は[call]、falseは[jump]。<br>ただしcall=trueによりサブルーチンコールした場合、[return]によって「コールする前のイベント予約状態＆待ち状態」に戻る。
fn | ... | ... | ... | クリック時にジャンプする先。<br>指定方法は[jump]と同様
label | ... | ... | ... | (↑と同じ)
arg | | | String | 指定した場合、クリック時ジャンプ先で「&const.an.eventArg」にて値を受け取れる
r_call | | false | Boolean | 右クリック時ジャンプについての指定。<br>trueの場合は[call]、falseは[jump]。<br>ただしr_call=trueによりサブルーチンコールした場合、[return]によって「コールする前のイベント予約状態＆待ち状態」に戻る。
r_fn | ... | ... | ... | 右クリック時にジャンプする先。<br>指定方法は[jump]と同様
r_label | ... | ... | ... | (↑と同じ)
r_arg | | | String | 指定した場合、右クリック時ジャンプ先で「&const.an.eventArg」にて値を受け取れる
onenter | | 何もしない | ラベル名 | マウス重なり（フォーカス取得）時、指定したラベルをコールする。 必ず[return]で戻ること。
onleave | | 何もしない | ラベル名 | マウス重なり外れ（フォーカス外れ）時、指定したラベルをコールする。 必ず[return]で戻ること。
global | | false | Boolean | 詳細は[event]と同様。<br>※ボタンを[trans]する場合はtrueにしておく
enabled | | true | Boolean | falseだと押せないボタンとなり、クリックイベントが発生しない。<br>これにより文字レイヤの任意の位置に画像表示できる機能を提供する。<br>画像は三等分しない。イベントや効果音指定は無効だが、ヒント機能は有効。
join | | false | Boolean | trueで画像読み込みを待って次のタグへ進む。
event_at_down | | false | Boolean | true：押すだけでイベント発動（画面常駐のシステムボタンなどに）<br>false：押して離すとイベント発動
draggable | | false | Boolean | true：テキスト背後の矩形をドラッグできる。<br>event_at_down=trueだとクリックイベントが発生しなくなる。
drag_x | | 0 | 画面左上を(0, 0)とする座標 | ドラッグ範囲の左上始点。
drag_y | | 0 | (↑と同じ) | (↑と同じ)
drag_w | | 画面横幅 | ドラッグ範囲縦横ピクセル数 | ドラッグ範囲縦横サイズ。
drag_h | | 画面縦幅 | (↑と同じ) | (↑と同じ)
dragmove_fn | ... | ... | ... | ドラッグ中にサブルーチンコールする先。<br>指定方法は[jump]と同様
dragmove_label | ... | ... | ... | (↑と同じ)
dragmove_arg | | | String | 指定した場合、ドラッグ中コール先で「&const.an.eventArg」にて値を受け取れる
alpha | | 1.0 | 0.0〜1.0（実数） | 透過度。0（完全透明）〜0.5（半透明）〜1（不透明）
blendmode | | 何もしない | ブレンドモード名（"screen"など） | このボタンと下のレイヤとの重なりにおいて、<br>ドット単位で色のブレンド演算を行なう。<br>詳細はblendModeの解説を参照。
rotation | | 0 | -180〜180 | 回転角を度単位で指定。時計回りは0～180、反時計回りは0～-180を指定。 左上を中心に回る
scale_x | | 1.0 | 正負の実数値 | 横方向を何倍に拡大／縮小するか。負の値ならレイヤを左右反転
scale_y | | 1.0 | 正負の実数値 | 縦方向を何倍に拡大／縮小するか。負の値ならレイヤを上下反転

---
## [[call] サブルーチンコール](#call)
	スクリプト処理の現在位置をコールスタックに積み、ジャンプする。
ジャンプ先での[return]により本タグの次の位置に戻る事が出来る。
※あらゆるタグの中で唯一「通常、既読としない」タグですが、普通に使う分には気にしなくて良いです。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
fn | どちらか、もしくは両方を指定 | 処理中のスクリプトファイル | スクリプトファイル名 | コール先のスクリプトファイル<br>[call fn=ext_*]のようにワイルドカードをサポート。マッチするスクリプトを順不同にコールする。 （ワイルドカードは後方のみ）
label | スクリプトファイルの先頭 | ラベル名（半角アスタリスク*も含む） | コール先のスクリプトファイルにあるラベル
count | | false | Boolean | タグ位置を既読とするか
clear_local_event | | 何もしない | Boolean | trueの場合は[clear_event]を行なってからコールする。

---
## [[jump] シナリオジャンプ](#jump)
	指定位置のスクリプトにジャンプする

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
fn | どちらか、もしくは両方を指定 | 処理中のスクリプトファイル | スクリプトファイル名 | コール先のスクリプトファイル
label | スクリプトファイルの先頭 | ラベル名（半角アスタリスク*も含む） | コール先のスクリプトファイルにあるラベル
count | | true | Boolean | タグ位置を既読とするか

	ラベルは例えば以下のように使います。
	; =======================
	*aaa
		無限ループ
		[jump label=*aaa]
	; =======================

	さらにラベル名を考えるのが面倒なとき、「無名ラベル」ともいうべき機能が使えます。
	「**after」は「そのコマンド以降で最初に見つかった**ラベルに」
	「**before」は「そのコマンド以前で最初に見つかった**ラベルに」
	ジャンプ・コールする、という指定です。次のように書きます。
	; =======================
		[jump label=****after]
	***
	**
		も
		[jump label=**after]
	;**
		っ
	**
		[l]
		ぷ
		[jump label=**before]
	**
		＠[s]
	**
	****
		す
		[jump label=***before]
	; =======================
	この例では「すもぷぷぷ……」と文字が表示されます。
	「**」とか「***」とかアスタリスクは二個以上の任意の数が使え、同じ数同士が対応するラベルとなります。
	が、上記例で見るとおりあんまり複雑に使うと可読性が下がってしまう気がしますので、局所的な用途に限ったほうが良さげです。

---
## [[pop_stack] コールスタック破棄](#pop_stack)
	コールスタックを一つ破棄する
	※見通しが悪くなるため、本タグを極力使用しないコーディングを推奨します。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
clear | | false | Boolean | true：全て破棄する。空でもエラーを出さない<br>false：スタックを一つ破棄する。空の場合はエラーメッセージ＆アプリ停止

---
## [[return] サブルーチンから戻る](#return)
	コールスタックに積まれているジャンプ先にジャンプする。
	引数無し。
	最後に積んだスタックを一つ破棄する。

---
# マクロ
## [[bracket2macro] 括弧マクロの定義](#bracket2macro)
	引数textを持つマクロやタグを、任意の二つの文字を括弧とし、括弧で囲った記述で代用できるよう定義する
	例 …… [bracket2macro name=title text=｟｠]
	（訂正：「任意の二つの文字」は特定の半角文字じゃなくてもよいです）
	※適用範囲について
	　　本タグより前にロードされたスクリプトファイルには適用されません。
	　　またスクリプトファイルに本タグが記述された場合、本タグより前に出現した半角文字にも適用されません。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**text** | **y** | | 特定の文字 | 括弧にする任意の二つの文字。<br>マクロに出来るのは英文字、空白、;、[、]、*、=、&、｜、《、》以外のみ。<br>正規表現で言えば　/[\w\s;[\]*=&｜《》]/　以外。<br>一文字マクロや定義済みの括弧文字は使用できない。
**name** | **y** | | 定義済みのマクロ名 | 半角文字に割り当てるマクロ名を指定。<br>組み込みタグか、[macro]による定義済みマクロ名で無ければならない。<br>組み込みタグやマクロは引数textだけを指定しても問題なく動作し、 それを処理すること。渡される引数textは空文字の場合もある。

---
## [[break_macro] マクロから脱出](#break_macro)

	マクロ内の途中で、マクロから脱出したい際に使用する。
	引数無し。

---
## [[char2macro] 一文字マクロの定義](#char2macro)
	引数無しのマクロやタグを、半角文字の記述で代用できるよう定義する
	※適用範囲について
	　　本タグより前にロードされたスクリプトファイルには適用されません。
	　　またスクリプトファイルに本タグが記述された場合、本タグより前に出現した半角文字にも適用されません。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**char** | **y** | | 特定の半角文字 | マクロにする半角文字。<br>マクロに出来るのは英文字、空白、;、[、]、*、=、&、｜、《、》以外のみ。<br>正規表現で言えば　/[\w\s;[\]*=&｜《》]/　以外。<br>括弧文字や定義済みの一文字マクロは使用できない。
**name** | **y** | | 定義済みのマクロ名 | 半角文字に割り当てるマクロ名を指定。<br>組み込みタグか、[macro]による定義済みマクロ名で無ければならない。

---
## [[endmacro] マクロ定義の終了](#endmacro)
	[macro]と[endmacro]に囲まれた部分をマクロとして定義する。
	引数無し。

---
## [[macro] マクロ定義の開始](#macro)
	[macro]と[endmacro]に囲まれた部分をマクロとして定義する。
	定義しただけでは実行されない。

	定義したマクロは既存のタグと同様に使用できる。
	渡した引数は、マクロ側で「mp:」スコープにより参照できる。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**name** | **y** | マクロ名 | String | 既存のタグやマクロと重複しないマクロ名
exist_err | | true | Boolean | false：定義済みの際、エラーを出さず何もしない


---
# しおり
## [[copybookmark] しおりの複写](#copybookmark)
	しおりデータを複写する

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**from** | **y** | | 数値 | 複写元のしおり番号
**to** | **y** | | 数値 | 複写先のしおり番号
path | | 従来通り SharedObjectに保存 | フォルダパス | 指定した場合、複写先（to）のしおりをファイルとしてフォルダパス下に保存する。

---
## [[erasebookmark] しおりの消去](#erasebookmark)
	しおりデータを削除する

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**place** | **y** | | 数値 | 処理対象のしおり番号

---
## [[load] しおりの読込](#load)
	しおりデータを読み込み、スクリプト処理を再開する

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**place** | **y** | | 数値 | 処理対象のしおり番号
fn | ... | ... | ... | ロード後最初にしたい共通処理をコールする（処理は[return]で終わらせる）。指定方法は[jump]と同様。<br>ただし指定する際、fnとlabelは両方指定しなければならない。

---
## [[record_place] セーブポイント指定](#record_place)
	本タグの位置を、スクリプト読み込み時に再開する位置として設定する。
	本タグで「しおりを挟み」、[save]タグで実際にデータをセーブするイメージ。
	引数無し。

	※マクロやサブルーチン内に記述された場合、最初に積まれたコールスタック位置をセーブポイントとする。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
layer | | 全てのレイヤ | 保存対象レイヤ名（カンマ区切りで複数可能） | しおりに状態を保存するレイヤ。Save/Load画面レイヤや設定画面レイヤなど、保存すべきでないレイヤを除いて指定すべき
reset_sound | | true | Boolean | 全てのサウンドを停止・再度再生開始するか

---
## [[reload_script] スクリプト再読込](#reload_script)
	現在処理中のスクリプトをリロードする。
	実行位置は[record_place]によるセーブポイントまで戻って再開する。
	引数無し。
	※スクリプトを大幅に変えた後だと、正常に再開できない場合があります。

---
## [[save] しおりの保存](#save)
	しおりデータを保存する。
	読み込み時に再開するスクリプトの位置は最後に[record_place]をコールした位置。

	[record_place]がゲーム状態（レイヤ状態など）をバッファに退避し、
	[save]は指定しおりに書き出す機能。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**place** | **y** | | 数値 | 処理対象のしおり番号
path | | 従来通り SharedObjectに保存 | フォルダパス | 指定した場合、しおりをファイルとしてフォルダパス下に保存する。


---
# 画面揺らし
## [[quake] 画面を揺らす](#quake)

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
xxxxxx | **y** | | |

---
## [[stop_quake] 画面揺らし中断](#stop_quake)

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
xxxxxx | **y** | | |

---
## [[wq] 画面揺らし終了待ち](#wq)

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
xxxxxx | **y** | | |


---
# システム
## [[close] アプリの終了](#close)
	アプリケーションを終了する
	引数無し。
	※Flash 上では動作しません。タグを呼んでも何もしません。

---
## [[loadplugin] プラグインの読み込み](#loadplugin)
	プラグインとして読み込む

	《注意》立ち絵や一枚絵を表示する目的にはこの命令を推奨しません。その目的を満たすタグは[lay]です。
	プラグインには裏表ページの概念がなかったりするためです

	※動的ライブラリの作り方については「プラグインの自作」をご覧下さい。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**fn** | **y** | | ファイル名 | 読み込むプラグインのファイル名<br>[loadplugin fn=plg*]のようにワイルドカードをサポート。<br>マッチするプラグインを順不同に読み込む。読み込み済みなら無視。<br>（拡張子はswfのみ）（ワイルドカードは後方のみ）
index | | 最前面※ | 0〜 | 重なり順を指定する。<br>※最前面とは、Flashのstage.addChildにおける重なり順
join | | true | Boolean | trueで読み込みを待って次のタグへ進む。

---
## [[naviate_to] ＵＲＬを開く](#naviate_to)

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**url** | **y** | | URL文字列 | 開くURL

---
## [[snapshot] スナップショット](#snapshot)
	アプリ表示部分全体を画像として保存する

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
layer | | 全てのレイヤ | レイヤ名（半角カンマ区切りで複数レイヤを指定可能） | 「plg:プラグイン名」と記述する事でプラグインも指定できる。
page | | fore | fore、back | ページの裏表
fn | | snapshot | String | ※保存するファイル名（拡張子を除く）
format | | jpg | png、jpg | 保存する画像フォーマット
quality | | 90 | 1〜100 | jpg保存する際の画質。大きいと画質が高いが処理が遅くなる。
width | | アプリ表示部分の横サイズ | 1〜 | 保存する画像の横ドットサイズ。<br>元のサイズと異なる場合は拡大・縮小される。
height | | アプリ表示部分の縦サイズ | 1〜 | 保存する画像の縦ドットサイズ。<br>元のサイズと異なる場合は拡大・縮小される。
smoothing | | false | Boolean | 拡大・縮小保存される場合、スムージングするか
pathdlg | | false | Boolean | 保存場所をGUIで選べるダイアログを表示するか
b_color | | config.anprjで指定した背景色 | 色指定。0xFF000000（黒）など<br>16進数では透過2桁＋赤2桁＋緑2桁＋青2桁で指定 | テキスト背後の矩形色。pngで 0x0 にすると透過する。<br>透過しない黒は 0xFF000000

※fnを「app-storage:」で始まるファイル名にするとセーブデータと同じフォルダに保存します。

OS | Path
-- | --
Mac OS X | HD/Users/[user]/Library/Preferences/[id]/
Windows 7 | C:\Users\[user]\AppData\Roaming\[id]\
Linux | /home/[user]/.appdata/[id]/Local Store
　　[user]はインストールしたユーザー名、<br>
　　[id]はアプリ固有のIDです。<br>
参考：アプリケーション記憶領域ディレクトリ<br>
<br>
<br>
※fnを「ss:/」で始めると、セーブデータファイル内部（SharedObject）に保存します。（例　ss:/yyy）
　保存した画像は、画像レイヤやボタンに画像として表示出来ます。（例　fn="ss:/yyy"）

---
## [[title] タイトル指定](#title)
	アプリウインドウのタイトル文字列を設定する。

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**text** | **y** | | String | タイトル文字列

---
## [[toggle_full_screen] 全画面状態切替](#toggle_full_screen)
	呼び出す度にアプリの全画面／ウインドウモードを切り替えます。
現在の状態は文字列変数「tmp:const.flash.display.Stage.displayState」を参照（→定数一覧）

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
fn | | イベント登録せずモード切替 | イベントのキー名※1 | （Flash動作時のみ使用）イベントを発生させるトリガーイベント。<br>key属性の値は[event]を参照

---
## [[window] アプリウインドウ設定](#window)
	ゲームアプリのウインドウサイズや位置などを変更する

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
width | | 現在値 | 1〜 | アプリウインドウの横幅を指定
height | | 現在値 | 1〜 | アプリウインドウの高さを指定
framerate | | 現在値 | 1〜 | アプリ全体のフレームレートを変更
centering | | 何もしない | Boolean | trueを指定すると、アプリウインドウをデスクトップの中央に移動する
x | | 何もしない | 画面左上を(0, 0)とする座標 | デスクトップにおけるアプリウインドウの横位置を指定
y | | 何もしない | (↑と同じ) | デスクトップにおけるアプリウインドウの縦位置を指定


---
# デバッグ・その他
## [[dump_lay] レイヤのダンプ](#dump_lay)
	レイヤの内容をデバッグ表示する

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
layer	n	全てのレイヤ	レイヤ名（半角カンマ区切りで複数レイヤを指定可能）	「plg:プラグイン名」と記述する事でプラグインも指定できる。

---
## [[dump_val] 変数のダンプ](#dump_val)
	変数の内容をデバッグ表示する
	引数無し。

---
## [[dump_script] スクリプトのダンプ](#dump_script)

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
xxxxxx | **y** | | |

---
## [[dump_stack] スタックのダンプ](#dump_stack)
	[call]等によるコールスタックの内容をデバッグ表示する
	引数無し。

---
## [[log] ログ出力](#log)
	引数をデスクトップにテキスト出力する（追記ではなく上書き。追記する。出力日時・分・スクリプト名や行番号・OSやプロジェクト名も出力）

---
## [[stats] パフォーマンス表示](#stats)
	FPSやメモリ使用量をチェックするStatsを表示する。（見方）。
	指定しない場合はデバッグ表示[trace]を右にどかす

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
left | | 0 | 画面左上を(0, 0)とする座標 | 表示の横位置
top | | (↑と同じ) | (↑と同じ) | 表示の縦位置

---
## [[trace] デバッグ表示へ出力](#trace)
	引数をデバッグ表示する

属性 | 必須 | 省略時 | 値域・型 | コメント
-- | -- | -- | -- | --
**text** | **y** | | String | デバッグ表示する値
