{"version":3,"file":"Variable.js","sources":["../src/sn/Areas.ts","../src/sn/Variable.ts"],"sourcesContent":["/* ***** BEGIN LICENSE BLOCK *****\n\tCopyright (c) 2018-2025 Famibee (famibee.blog38.fc2.com)\n\n\tThis software is released under the MIT License.\n\thttp://opensource.org/licenses/mit-license.php\n** ***** END LICENSE BLOCK ***** */\n\nimport type {IAreas} from './CmnInterface';\n\nexport class Areas implements IAreas {\n\thAreas\t: {[name: string]: number}\t= Object.create(null);\n\n\tclear() {this.hAreas = {}}\n\n\tsearch(idx: number): boolean {\n\t\treturn Object.entries(this.hAreas)\n\t\t.some(([begin, v])=> (idx >= parseInt(begin) && idx <= v));\n\t}\n\n\trecord(idx: number): void {\n\t\tif (this.search(idx)) return;\n\n\t\tfor (const [begin, v] of Object.entries(this.hAreas)) {\n\t\t\t// 領域末尾+1とマッチ\n\t\t\tif (v +1 === idx) {\n\t\t\t\tif (String(idx +1) in this.hAreas) {\n\t\t\t\t\t// 二つの領域がマージできる場合\n\t\t\t\t\tthis.hAreas[begin] = this.hAreas[idx +1]!;\n\t\t\t\t\tdelete this.hAreas[idx +1]\n\t\t\t\t}\n\t\t\t\telse this.hAreas[begin] = idx;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t// 領域先頭-1とマッチ\n\t\tif (String(idx +1) in this.hAreas) {\n\t\t\tthis.hAreas[idx] = this.hAreas[idx +1]!;\n\t\t\tdelete this.hAreas[idx +1];\n\t\t\treturn;\n\t\t}\n\n\t\tthis.hAreas[idx] = idx;\n\t}\n\n\terase(idx: number): void {\n\t\tif (! this.search(idx)) return;\n\n\t\t// 領域先頭とマッチ\n\t\tif (String(idx) in this.hAreas) {\n\t\t\tif (this.hAreas[idx]! > idx) this.hAreas[idx +1] = this.hAreas[idx]!;\n\t\t\tdelete this.hAreas[idx];\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const [begin, v] of Object.entries(this.hAreas)) {\n\t\t\tif (idx < parseInt(begin) || v < idx) continue;\n\n\t\t\t// 領域末尾とマッチ\n\t\t\tif (this.hAreas[begin] === idx) {\n\t\t\t\tthis.hAreas[begin] = idx -1;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// 領域内とマッチ、二つの領域に分割\n\t\t\tthis.hAreas[idx +1] = v;\n\t\t\tthis.hAreas[begin] = idx -1;\n\t\t\treturn;\n\t\t}\n\t}\n\n\tget count(): number {return Object.keys(this.hAreas).length}\t// 4tst\n\n\ttoString(): string {\n\t\tlet ret = '';\n\n\t\tfor (const k of Object.keys(this.hAreas)\n\t\t.map(k=> parseInt(k))\n\t\t.sort((x, y)=> x-y)) {\n\t\t\tret += k === this.hAreas[k]\n\t\t\t? ','+ k\n\t\t\t: ','+ k +'~'+ this.hAreas[k];\n\t\t}\n\n\t\treturn ret;\t// 先頭に , が付いている。削除したいが、修正すると互換性に問題あり凍結\n\t}\n\n}\n","/* ***** BEGIN LICENSE BLOCK *****\n\tCopyright (c) 2018-2025 Famibee (famibee.blog38.fc2.com)\n\n\tThis software is released under the MIT License.\n\thttp://opensource.org/licenses/mit-license.php\n** ***** END LICENSE BLOCK ***** */\n\nimport {uint, int, getDateStr, argChk_Boolean, argChk_Num} from './CmnLib';\nimport type {HArg, IHTag} from './Grammar';\nimport type {IVariable, ISetVal, typeProcVal, ISysBase, IData4Vari, IMark, IFncHook, IValMp, Scope} from './CmnInterface';\nimport type {Config} from './Config';\nimport {Areas} from './Areas';\nimport {PropParser} from './PropParser';\nimport {INI_STYPAGE, playbackPage} from './ReadState';\n\nimport platform from 'platform';\n\n\nexport class Variable implements IVariable {\n\t#hScopes\t: {[name: string]: any}\t= {sys:{}, save:{}, tmp:{}, mp:{}};\n\t#hSave\t\t= this.#hScopes.save;\n\t#hTmp\t\t= this.#hScopes.tmp;\n\n\n\tconstructor(private readonly cfg: Config, hTag: IHTag) {\n\t\t//\t変数操作\n\t\thTag.let\t\t\t= o=> this.#let(o);\t\t\t// 変数代入・演算\n\t\thTag.let_abs\t\t= o=> this.#let_abs(o);\t\t// 絶対値\n\t\thTag.let_char_at\t= o=> this.#let_char_at(o);\t// 文字列から一字取りだし\n\t\thTag.let_index_of\t= o=> this.#let_index_of(o);\t// 文字列で検索\n\t\thTag.let_length\t\t= o=> this.#let_length(o);\t// 文字列の長さ\n\t\t// let_mlはScriptIteratorにて定義\t\t\t\t// インラインテキスト代入\n\t\thTag.let_replace\t= o=> this.#let_replace(o);\t// 正規表現で置換\n\t\thTag.let_round\t\t= o=> this.#let_round(o);\t// 四捨五入\n\t\thTag.let_search\t\t= o=> this.#let_search(o);\t// 正規表現で検索\n\t\thTag.let_substr\t\t= o=> this.#let_substr(o);\t// 文字列から抜きだし\n\n\t\t//\tデバッグ・その他\n\t\thTag.clearsysvar\t= ()=> this.#clearsysvar();\t// システム変数の全消去\n\t\thTag.clearvar\t\t= ()=> this.#clearvar();\t// ゲーム変数の全消去\n\t\thTag.dump_val\t\t= ()=> this.#dump_val();\t// 変数のダンプ\n\n\t\t// しおり\n\t\thTag.copybookmark\t= o=> this.#copybookmark(o);\t// しおりの複写\n\t\thTag.erasebookmark\t= o=> this.#erasebookmark(o);// しおりの消去\n\t\t//hTag.load\t\t\t// ScriptIterator.ts内で定義\t// しおりの読込\n\t\t//hTag.record_place\t// ScriptIterator.ts内で定義\t// セーブポイント指定\n\t\t//hTag.save\t\t\t// ScriptIterator.ts内で定義\t// しおりの保存\n\n\t\t// save:\n\t\tthis.#hSave['sn.userFnTail']\t= '';\n\t\tthis.defTmp('const.sn.bookmark.json', ()=> {\n\t\t\tconst a: object[] = [];\n\t\t\tfor (const k of Object.keys(this.#data.mark).sort()) {\n\t\t\t\tconst o = {...this.#data.mark[k]!.json};\n\t\t\t\to.place = k;\n\t\t\t\ta.push(o);\t// パスを searchPath() で展開してはいけない\n\t\t\t}\n\t\t\treturn JSON.stringify(a);\n\t\t});\n\n\t\t// tmp:\n\t\tthis.#hTmp['const.sn.isFirstBoot'] = true;\n\n\t\tthis.#hTmp['const.sn.last_page_text'] = '';\n\t\tthis.#hTmp['const.sn.last_page_plain_text'] = '';\n\n\t\t//this.hTmp['const.sn.mouse.middle']\t// ScriptIterator で定義\n\n\t\t//this.hTmp['const.sn.vctCallStk.length']\t// ScriptIterator で定義\n\n/*\t\tthis.hTmp['const.Stage.supportsOrientationChange']\n\t\t\t= Stage.supportsOrientationChange;\n\t\tif (this.hTmp['const.Stage.supportsOrientationChange']) {\n\t\t\tthis.hTmp['const.Stage.orientation']\n\t\t\t\t= ()=> {return stage.orientation};\n\t\t\tthis.hTmp['const.Stage.deviceOrientation']\n\t\t\t\t= ()=> {return stage.deviceOrientation};\n\n\t\t\tconst lenSO:uint = stage.supportedOrientations.length;\n\t\t\tfor (let iSO:uint=0; iSO<lenSO; ++iSO) {\n\t\t\t\tthis.hTmp['const.Stage.supportedOrientations.'\n\t\t\t\t\t+ stage.supportedOrientations[iSO]\n\t\t\t\t] = true;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t//\timport flash.display.StageOrientation;\n\t\t\tthis.hTmp['const.Stage.orientation'] =\n\t\t\tthis.hTmp['const.Stage.deviceOrientation'] =\n\t\t\t//\t\tStageOrientation.DEFAULT;\n\t\t\t\t'default';\n\t\t}\n*/\n\t\tthis.#hTmp['const.sn.displayState'] = false;\n\t\t\t// const.flash.display.Stage.displayState\n\n\t\tthis.#hTmp['const.Date.getTime'] = ()=> (new Date).getTime();\n\t\tthis.#hTmp['const.Date.getDateStr'] = ()=> getDateStr();\n\n\t\tthis.#hTmp['const.sn.platform'] = JSON.stringify(platform);\n\n\t\tthis.#clearsysvar(true);\n\t\tthis.#clearvar();\n\n\t\t// prj.json\n\t\tthis.#hTmp['const.sn.config.window.width'] = cfg.oCfg.window.width;\n\t\tthis.#hTmp['const.sn.config.window.height']= cfg.oCfg.window.height;\n\t\tthis.#hTmp['const.sn.config.book.title'] = cfg.oCfg.book.title;\n\t\tthis.#hTmp['const.sn.config.book.version'] = cfg.oCfg.book.version;\n\n\t\tthis.#hTmp['const.sn.Math.PI'] = Math.PI;\n\n\t\tthis.#hTmp['const.sn.isPaging'] = false;\n\n\n\t\tif (typeof window === 'undefined') return;\n\t\tconst win: any = window;\n\t\tconst ac = win['AudioContext'] ?? win['webkitAudioContext'];\n\t\tthis.#hTmp['const.sn.needClick2Play'] = ()=> (new ac).state === 'suspended';\n\t}\n\n\n\t#sys\t: ISysBase;\n\t#data\t: IData4Vari\t= {sys:{}, mark:{}, kidoku:{}};\n\t#hSys\t: any;\n\t#hAreaKidoku\t: {[name: string]: Areas}\t= {};\n\t#callHook\t\t: IFncHook;\n\tasync\tsetSys(sys: ISysBase) {\n\t\tthis.#sys = sys;\n\t\tawait sys.initVal(this.#data, this.#hTmp, data=> {\n\t\t\tthis.updateData(data);\n\n\t\t\tsessionStorage.clear();\n\t\t\tconst ns = this.cfg.getNs();\n\t\t\tthis.#flush = this.cfg.oCfg.debug.variable ?()=> {\n\t\t\t\tconst oSys: any = {};\n\t\t\t\tfor (const [k, v] of Object.entries(this.#hSys)) {\n\t\t\t\t\toSys['sys:'+ k] = (v instanceof Function) ?v(): v;\n\t\t\t\t}\n\t\t\t\tsessionStorage[ns +'sys'] = JSON.stringify(oSys);\n\n\t\t\t\tconst oSave: any = {};\n\t\t\t\tfor (const [k, v] of Object.entries(this.#hSave)) {\n\t\t\t\t\toSave['save:'+ k] = (v instanceof Function) ?v(): v;\n\t\t\t\t}\n\t\t\t\tsessionStorage[ns+'save'] = JSON.stringify(oSave);\n\n\t\t\t\tconst oTmp: any = {};\n\t\t\t\tfor (const [k, v] of Object.entries(this.#hTmp)) {\n\t\t\t\t\toTmp[k] = (v instanceof Function) ?v(): v;\n\t\t\t\t}\n\t\t\t\tsessionStorage[ns +'tmp'] = JSON.stringify(oTmp);\n\n\t\t\t\tconst oMp: any = {};\n\t\t\t\tfor (const [k, v] of Object.entries(this.#hScopes.mp)) {\n\t\t\t\t\toMp[k] = (v instanceof Function) ?v(): v;\n\t\t\t\t}\n\t\t\t\tsessionStorage[ns +'mp'] = JSON.stringify(oMp);\n\n\t\t\t\tconst oMark: any = {};\n\t\t\t\tfor (const [k, v] of Object.entries(this.#data.mark)) {\n\t\t\t\t\toMark[k] = (v instanceof Function) ?v(): v;\n\t\t\t\t}\n\t\t\t\tsessionStorage[ns+'mark'] = JSON.stringify(oMark);\n\n\t\t\t\tconst oKidoku: any = {};\n\t\t\t\tfor (const [k, v] of Object.entries(this.#data.kidoku)) {\n\t\t\t\t\toKidoku[k] = (v instanceof Function) ?v(): v;\n\t\t\t\t}\n\t\t\t\tsessionStorage[ns +'kidoku'] = JSON.stringify(oKidoku);\n\n\t\t\t\tsys.flush();\n\t\t\t}\n\t\t\t: ()=> sys.flush();\n\n\t\t\tthis.#callHook = (type, o)=> sys.callHook(type, o);\n\t\t//x\tthis.callHook = sys.callHook;\n\t\t\tsys.addHook((type, o)=> this.#hProcDbgRes[type]?.(type, o));\n\n\t\t\t// 初回の初期化と、v1.11.0 まで未初期化変数があった件の対策\n\t\t\tconst tm = this.getVal('sys:sn.tagCh.msecWait', -1);\n\t\t\tif (this.#hTmp['const.sn.isFirstBoot'] || tm === -1) this.#clearsysvar(true);\n\n\t\t\tthis.#tagCh_doWait = this.getVal('sys:sn.tagCh.doWait');\n\t\t\tthis.#tagCh_doWait_Kidoku = this.getVal('sys:sn.tagCh.doWait_Kidoku');\n\t\t\tthis.#tagCh_msecWait = this.getVal('sys:sn.tagCh.msecWait');\n\t\t\tthis.#tagCh_msecWait_Kidoku = this.getVal('sys:sn.tagCh.msecWait_Kidoku');\n\n\t\t\tthis.#saPageLog();\n\t\t});\n\t}\n\t#saPageLog() {playbackPage(\n\t\tthis.getVal('sys:const.sn.aPageLog') ?? '[]',\n\t\tthis.getVal('save:const.sn.styPaging') ?? INI_STYPAGE,\n\t)}\n\treadonly\t#hProcDbgRes\n\t: {[type: string]: (type: string, o: any)=> void}\t= {\n\t\tauth: (_, o)=> this.#set_data_break(o.hBreakpoint.aData),\n\t\tvar\t: (_,o)=> this.#sys.send2Dbg(o.ri, {v: this.#hScopes[o.scope] ?? {}}),\n\t\tset_var\t: (_, o)=> {\n\t\t\ttry {this.#setVal(o.nm, o.val); this.#sys.send2Dbg(o.ri, {})} catch {}\n\t\t},\n\t\tset_data_break\t: (_, o)=> {\n\t\t\tthis.#set_data_break(o.a);\n\t\t\tthis.#sys.send2Dbg(o.ri, {});\n\t\t},\n\t\tdisconnect: _=> Variable.#hSetEvent = {},\n\t}\n\t#set_data_break(a: any[]) {\t// o.a.length === 0 なら削除\n\t\tVariable.#hSetEvent = {};\n\t\tfor (const v of a) Variable.#hSetEvent[v.dataId] = 1;\n\t}\n\n\tupdateData(data: IData4Vari): void {\n\t\tthis.#data = data;\n\t\tthis.#hSys = this.#hScopes.sys = this.#data.sys;\n\n\t\tthis.#hAreaKidoku = {};\n\t\tfor (const [fn, v] of Object.entries(this.#data.kidoku)) {\n\t\t\tconst areas = new Areas;\n\t\t\tareas.hAreas = {...v};\n\t\t\tthis.#hAreaKidoku[fn] = areas;\n\t\t}\n\t}\n\t#flush\t= ()=> {};\n\tflush() {this.#flush()}\t// 先にこのメソッドへの参照を配ってしまうので、中身を入れ替える\n\n\tsetDoRecProc(fnc: (doRec: boolean)=> void) {this.#doRecProc = fnc}\n\t#doRecProc = (_doRec: boolean)=> {};\n\n\tdefTmp(name: string, fnc: typeProcVal) {this.#hTmp[name] = fnc};\n\tcloneMp() {return {...this.#hScopes.mp}}\n\tsetMp(mp: IValMp) {this.#hScopes.mp = mp}\n\tsetMark(place: number, mark: IMark) {this.#data.mark[place] = mark; this.flush()}\n\treadonly\tgetMark = (place: number)=> {\n\t\tconst mark = this.#data.mark[place];\n\t\tif (! mark) throw `place【${place}】は存在しません`;\n\t\treturn mark;\n\t}\n\tcloneSave() {return {...this.#hScopes.save}}\n\tmark2save(mark: IMark) {\n\t\tthis.#hSave = this.#hScopes.save = {...mark.hSave};\n\t\tthis.#doRecLog\t= this.#hSave['sn.doRecLog'] ?? false;\n\t}\n\n\n\t// 既読系\n\ttouchAreaKidoku(fn: string): Areas {return this.#hAreaKidoku[fn] ??= new Areas}\n\treadonly\tgetAreaKidoku = (fn: string)=> {\n\t\tconst areas = this.#hAreaKidoku[fn];\n\t\tif (! areas) throw `hAreaKidoku${fn}】は存在しません`;\n\t\treturn areas;\n\t}\n\tsaveKidoku() {\n\t\tfor (const [fn, {hAreas}] of Object.entries(this.#hAreaKidoku)) {\n\t\t\tthis.#data.kidoku[fn] = {...hAreas};\n\t\t}\n\t\tthis.flush();\n\t}\n\n\n//\t// しおり\n\t// しおりの複写\n\t#copybookmark(hArg: HArg) {\n\t\tif (! ('from' in hArg)) throw 'fromは必須です';\n\t\tif (! ('to' in hArg)) throw 'toは必須です';\n\n\t\tconst from = Number(hArg.from);\n\t\tconst to = Number(hArg.to);\n\t\tif (from === to) return false;\n\n\t\tconst f = this.#data.mark[from];\n\t\tif (! f) throw `from:${from} のセーブデータは存在しません`;\n\t\tthis.setMark(to, {...f});\n\t\tthis.#sys.copyBMFolder(from, to);\n\n\t\treturn false;\n\t}\n\n\t// しおりの消去\n\t#erasebookmark(hArg: HArg) {\n\t\tconst {place} = hArg;\n\t\tif (! place) throw 'placeは必須です';\n\n\t\tdelete this.#data.mark[place];\n\t\tthis.flush();\n\n\t\tthis.#sys.eraseBMFolder(place);\n\n\t\treturn false;\n\t}\n\n\n//\t//\t変数操作\n\t// 変数代入・演算\n\t#let(hArg: HArg) {\n\t\tif (! hArg.name) throw 'nameは必須です';\n\n\t\tlet autocast = true;\n\t\tif (hArg.cast) {\n\t\t\t//switch (trim(hArg.cast)) {\n\t\t\tswitch (hArg.cast) {\n\t\t\tcase 'num':\n\t\t\t\targChk_Num(hArg, 'text', NaN);\n\t\t\t\tbreak;\n\t\t\tcase 'int':\n\t\t\t\thArg.text = String(int(argChk_Num(hArg, 'text', NaN)));\n\t\t\t\tbreak;\n\t\t\tcase 'uint':\n\t\t\t\thArg.text = String(uint(argChk_Num(hArg, 'text', NaN)));\n\t\t\t\tbreak;\n\t\t\tcase 'bool':\n\t\t\t\targChk_Boolean(hArg, 'text', false);\n\t\t\t\tbreak;\n\t\t\tcase 'str':\n\t\t\t\tautocast = false;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow 'cast【'+ hArg.cast +'】は未定義です';\n\t\t\t}\n\t\t}\n\n\t\tthis.#setVal(hArg.name, hArg.text, autocast);\n\n\t\treturn false;\n\t}\n\n\t// 絶対値\n\t#let_abs(hArg: HArg) {\n\t\tconst n = argChk_Num(hArg, 'text', 0);\n\t\t//hArg.text = Math.abs(n);\n\t\thArg.text = String((n < 0) ?-n :n);\n\t\t\t// JavaScriptのMath.abs()で絶対値を取得しないほうが良い理由 | iwb.jp https://iwb.jp/javascript-math-abs-deprecated/\n\t\t\t// 数値以外だとほとんどがNaNを返し、booleanは0や1を返しているため使い方によってはバグの原因になることがある。\n\t\tthis.#let(hArg);\n\n\t\treturn false;\n\t}\n\n\t// 文字列から一字取りだし\n\t#let_char_at(hArg: HArg) {\n\t\thArg.text = (hArg.text ?? '').charAt(argChk_Num(hArg, 'pos', 0));\n\t\tthis.#let(hArg);\n\n\t\treturn false;\n\t}\n\n\t// 文字列で検索\n\t#let_index_of(hArg: HArg) {\n\t\tconst {val} = hArg;\n\t\tif (! val) throw 'valは必須です';\n\t\tconst start = argChk_Num(hArg, 'start', 0);\n\n\t\thArg.text = String((hArg.text ?? '').indexOf(val, start));\n\t\tthis.#let(hArg);\n\n\t\treturn false;\n\t}\n\n\t// 文字列の長さ\n\t#let_length(hArg: HArg) {\n\t\thArg.text = String((hArg.text ?? '').length);\n\t\tthis.#let(hArg);\n\n\t\treturn false;\n\t}\n\n\t// 正規表現で置換\n\t#let_replace(hArg: HArg) {\n\t\tif (! hArg.reg) throw 'regは必須です';\n\n\t\tconst {flags} = hArg;\n\t\tconst reg = (! flags)\n\t\t\t? new RegExp(hArg.reg)\n\t\t\t: new RegExp(hArg.reg, flags);\n\t\thArg.text = String(hArg.text ?? '').replace(reg, String(hArg.val));\n\t\tthis.#let(hArg);\n\n\t\treturn false;\n\t}\n\n\t// 四捨五入\n\t#let_round(hArg: HArg) {\n\t\tconst n = argChk_Num(hArg, 'text', 0);\n\t\thArg.text = String(Math.round(n));\n\t\tthis.#let(hArg);\n\n\t\treturn false;\n\t}\n\n\t// 正規表現で検索\n\t#let_search(hArg: HArg) {\n\t\tif (! hArg.reg) throw 'regは必須です';\n\n\t\tconst {flags} = hArg;\n\t\tconst reg = (! flags)\n\t\t\t? new RegExp(hArg.reg)\n\t\t\t: new RegExp(hArg.reg, flags);\n\t\thArg.text = String((hArg.text ?? '').search(reg));\n\t\tthis.#let(hArg);\n\n\t\treturn false;\n\t}\n\n\t// 文字列から抜きだし\n\t#let_substr(hArg: HArg) {\n\t\tconst i = argChk_Num(hArg, 'pos', 0);\n\t\thArg.text = (hArg.len !== 'all')\n\t\t\t? (hArg.text ?? '').slice(i, i +int(argChk_Num(hArg, 'len', 1)))\n\t\t\t: (hArg.text ?? '').slice(i);\n\t\tthis.#let(hArg);\n\n\t\treturn false;\n\t}\n\n\n//\t// デバッグ・その他\n\t// システム変数の全消去\n\t#clearsysvar(init = false) {\n\t\tconst sys = this.#hSys = this.#hScopes['sys'] = this.#data.sys = {};\n\n\t\tconst is_nw = (typeof process !== 'undefined');\n\t\tif (is_nw) {\n\t\t//\t//\tthis.setVal_Sub('sys:const.sn.window.x', stage.nativeWindow.x);\n\t\t//\t//\tthis.setVal_Sub('sys:const.sn.window.y', stage.nativeWindow.y);\n\t\t}\n\t\telse {\n\t\t\tthis.setVal_Nochk('sys', 'const.sn.window.x', 0);\n\t\t\tthis.setVal_Nochk('sys', 'const.sn.window.y', 0);\n\t\t}\n\n\t\t// 文字表示Waitをかけるか\n\t\tthis.setVal_Nochk('sys', 'sn.tagCh.doWait', true);\n\t\tthis.setVal_Nochk('sys', 'sn.tagCh.doWait_Kidoku', true);\t// 【既読】\n\t\t// 文字表示Wait時間\n\t\tthis.setVal_Nochk('sys', 'sn.tagCh.msecWait', this.cfg.oCfg.init.tagch_msecwait);\n\t\tthis.setVal_Nochk('sys', 'sn.tagCh.msecWait_Kidoku', this.cfg.oCfg.init.tagch_msecwait);\n\t\t\t// 【既読】\n\t\t// 文字表示Wait中スキップのモード\n\t\tthis.setVal_Nochk('sys', 'sn.tagCh.canskip', true);\n\n\t\t// スキップのモード\n\t\tthis.setVal_Nochk('sys', 'sn.skip.mode', 's');\t// l, p, s\n\n\t\t// 自動読みすすみモード時の改ページ時のウェイト\n\t\t//\t//\trunFirst_sys_an_auto_msecPageWait('sn.auto.msecPageWait', '');\n\t\tthis.setVal_Nochk('sys', 'sn.auto.msecPageWait', argChk_Num(sys, 'sn.auto.msecPageWait', this.cfg.oCfg.init.auto_msecpagewait ?? 3500));\n\t\tthis.setVal_Nochk('sys', 'sn.auto.msecPageWait_Kidoku', argChk_Num(sys, 'sn.auto.msecPageWait', this.cfg.oCfg.init.auto_msecpagewait ?? 3500));\n\t\t// 自動読みすすみモード時の行クリック待ち時のウェイト\n\t\tthis.setVal_Nochk('sys', 'sn.auto.msecLineWait', 500);\n\t\tthis.setVal_Nochk('sys', 'sn.auto.msecLineWait_Kidoku', 500);\t// 【既読】\n\n\t\t//\tSoundMixer.soundTransform = new SoundTransform(\n\t\t//\t\t(sys['flash.media.SoundMixer.soundTransform.volume'] = 1)\n\t\t//\t);\n\t\tthis.setVal_Nochk('sys', 'sn.sound.BGM.vol_mul_talking', 1);\n\t\tthis.setVal_Nochk('sys', 'const.sn.sound.BGM.volume', 1);\n\t\tthis.setVal_Nochk('sys', 'const.sn.sound.SE.volume', 1);\n\t\tthis.setVal_Nochk('sys', 'const.sn.sound.SYS.volume', 1);\n\t\tfor (const [fn, v] of Object.entries(this.#data.kidoku)) {\n\t\t\tv.hAreas = {};\n\t\t\tthis.#hAreaKidoku[fn]?.clear();\n\t\t}\n\n\n\t\tthis.setVal_Nochk('sys', 'TextLayer.Back.Alpha', 0.5);\n\n\n\t\tthis.#hScopes['mark'] = this.#data.mark = {};\n\t\tthis.setVal_Nochk('sys', 'const.sn.save.place', 1);\n\n\t\tthis.setVal_Nochk('sys', 'const.sn.aPageLog', '[]');\n\t\tif (! init) this.#saPageLog();\n\n\n\t\tthis.flush();\n\n\t\treturn false;\n\t}\n\n\t// ゲーム変数の全消去\n\t#clearvar() {\n\t\tconst mesLayer\t= this.#hSave['const.sn.mesLayer'] ?? '';\n\t\tconst doRecLog\t= this.#hSave['sn.doRecLog'] ?? false;\n\t\tconst sLog\t\t= this.#hSave['const.sn.sLog'] ?? '[]';\n\t\tconst styPaging\t= this.#hSave['const.sn.styPaging'] ?? INI_STYPAGE;\n\n\t\tthis.#hSave = this.#hScopes.save = {};\n\n\t\tthis.setVal_Nochk('save', 'const.sn.mesLayer', mesLayer);\n\t\tthis.setVal_Nochk('save', 'sn.doRecLog', doRecLog);\n\t\tthis.setVal_Nochk('save', 'const.sn.sLog', sLog);\n\t\tthis.setVal_Nochk('save', 'const.sn.styPaging', styPaging);\n\n\t\treturn false;\n\t}\n\n\treadonly #setVal = (arg_name: string, val: any, autocast = true)=> {\n\t\tif (! arg_name) throw '[変数に値セット] nameは必須です';\n\t\tif (val == null) throw '[変数に値セット] textは必須です（空文字はOK）';\n\n\t\tconst o = PropParser.getValName(arg_name);\n\t\tif (! o) throw '[変数参照] name('+ arg_name +')が変数名として異常です';\n\n\t\tconst hScope = this.#hScopes[o.scope!];\n\t\tif (! hScope) throw '[変数に値セット] scopeが異常【'+ o.scope +'】です';\n\n\t\tconst nm = o.name!;\n\t\tif (nm.startsWith('const.') && (nm in hScope)) {\n\t\t\tthrow '[変数に値セット] 変数【'+ nm +'】は書き換え不可です';\n\t\t}\n\n\t\tthis.setVal_Nochk(o.scope as Scope, nm, val, autocast);\n\t}\n\tsetVal_Nochk(scope: Scope, nm: string, val: any, autocast = false) {\n\t\tconst hScope = this.#hScopes[scope];\n\t\tif (autocast) val = this.#castAuto(val);\n\n\t\tconst fullnm = scope +':'+ nm;\n\t\tif (fullnm in Variable.#hSetEvent) {\n\t\t\tconst old_v = hScope[nm];\n\t\t\tconst new_v = val;\n\t\t\tif (old_v != new_v) this.#callHook('data_break', {\n\t\t\t\tdataId: fullnm,\n\t\t\t\told_v: old_v,\n\t\t\t\tnew_v: new_v,\n\t\t\t});\n\t\t}\n\n\t\thScope[nm] = val;\n\n\t\tthis.#hValTrg[fullnm]?.(nm, val);\n\n\t\t// if (scope === 'sys') this.flush()\n\t\t\t// 厳密にはここですべきだが、パフォーマンスに問題があるので\n\t\t\t// クリック待ちを期待できるwait、waitclick、s、l、pタグで\n\t\t\t// saveKidoku()をコール。（中で保存しているのでついでに）\n\n\t\t//console.log(`\\tlet s[${scope}] n[${nm}]='${val}' trg[${(trg)}]`);\n\t}\n\t// reload 再生成 Main に受け渡すため static\n\tstatic\t#hSetEvent: {[fullnm: string]: 1} = {};\n\n\treadonly getVal = (arg_name: string, def?: number | string)=> {\n\t\tif (! arg_name) throw '[変数参照] nameは必須です';\n\n\t\tconst o = PropParser.getValName(arg_name);\n\t\tif (! o) throw '[変数参照] name('+ arg_name +')が変数名として異常です';\n\n\t\tconst hScope = this.#hScopes[o.scope!];\n\t\tif (! hScope) throw '[変数参照] scopeが異常【'+ o.scope +'】です';\n\n\t\tconst val_name = o.name!;\n\t\tlet val = hScope[val_name];\n//console.log(`fn:Variable.ts line:527 ・getVal arg_name=${arg_name}= val_name=${val_name}= A:${! (val_name in hScope)} val:%o`, val);\n\t\tif (! (val_name in hScope)) {\t// 存在しない変数名の場合、刻んで調べていく\n\t\t\tval = def;\n\n\t\t\tlet nm = '';\n\t\t\tconst aNm = val_name.split('.');\n\t\t\tconst len = aNm.length;\n\t\t\tfor (let i=0; i<len; ++i, nm += '.') {\n\t\t\t\tnm += aNm[i];\n//console.log(`fn:Variable.ts line:546  nm:${nm}`);\n\t\t\t\tif (! (nm in hScope)) continue;\t// 存在しない変数名の場合、延ばす\n\n\t\t\t\tlet v = JSON.parse(hScope[nm]);\n//console.log(`fn:Variable.ts line:550   nm:${nm} type:${Object.prototype.toString.call(v)} v:%o`, v);\n\t\t\t\tif (Object.prototype.toString.call(v) !== '[object Object]') {\n//console.log(`fn:Variable.ts line:552   != o i:${i} len:${len} C:${i +1 === len}`);\n\t\t\t\t\tif (i +1 === len) {val = v; break}\t// 最下層ならそのまま返す\n\t\t\t\t\tcontinue;\n\t\t\t\t\t\t// 短い名前でヒットしたが、JSONでもなく\n\t\t\t\t\t\t// 変数名にはまだ続きがあるので探索続行\n\t\t\t\t}\n\n\t\t\t\tlet j = i;\t// JSONオブジェクトの階層を降りつつ探索\n\t\t\t\twhile (++j < len) {\n\t\t\t\t\tconst nj = aNm[j]!;\n//console.log(`fn:Variable.ts line:561   nm:${nm} j:${j} aNm[j]=${aNm[j]}= A:${! (aNm[j] in v)}`);\n\t\t\t\t\tif (! (nj in v)) {val = def; break}\n\t\t\t\t\tv = v[nj];\n//console.log(`fn:Variable.ts line:564   v:${v} J:${j +1 === len}`);\n\t\t\t\t\tif (Object.prototype.toString.call(v) !== '[object Object]'\n\t\t\t\t\t\t|| j +1 === len) {val = v; break}// 最下層ならそのまま返す\n\t\t\t\t}\n\n\t\t\t\tif (val instanceof Object) val = JSON.stringify(val);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (val instanceof Function) val = val();\n\t\t//console.log('\\tget ['+ arg_name +'] -> s['+ o['scope'] +'] a['+ o['at'] +'] n['+ name +'] ret['+ val +']('+ typeof val +')');\n\n\t\treturn (o['at'] === '@str') ?val :this.#castAuto(val);\n\t}\n\n\t#castAuto(val: Object): any {\n\t\tconst s_val = val as string;\n\t\tif (s_val === 'true') return true;\n\t\tif (s_val === 'false') return false;\n\t\tif (s_val === 'null') return null;\n\t\tif (s_val === 'undefined') return undefined;\n\t\tif (this.#REG_NUMERICLITERAL.test(s_val)) return parseFloat(s_val);\n\n\t\treturn val;\n\t}\n\t#REG_NUMERICLITERAL\t:RegExp\t= /^-?[\\d\\.]+$/;\n\n\n\t// 変数のダンプ\n\treadonly #dump_val = ()=> {\n\t\tconst val: {[nm: string]: any} = {tmp:{}, sys:{}, save:{}, mp:{}};\n\t\tfor (let scope in val) {\n\t\t\tconst hVal: {[nm: string]: any} = this.#hScopes[scope];\n\t\t\tconst hRet = val[scope];\n\t\t\tfor (let [key, v] of Object.entries(hVal)) {\n\t\t\t\thRet[key] = Object.prototype.toString.call(v) === '[object Function]' ?v() :v;\n\t\t\t}\n\t\t}\n\t\tconsole.info('🥟 [dump_val]', val);\n\n\t\treturn false;\n\t}\n\n\t#doRecLog\t= false;\n\tdoRecLog() {return this.#doRecLog}\n\n\n\t#tagCh_doWait = false;\n\tget tagCh_doWait() {return this.#tagCh_doWait;}\n\t#tagCh_doWait_Kidoku = false;\n\tget tagCh_doWait_Kidoku() {return this.#tagCh_doWait_Kidoku;}\n\t#tagCh_msecWait\t\t= 0;\n\tget tagCh_msecWait() {return this.#tagCh_msecWait;}\n\t#tagCh_msecWait_Kidoku= 0;\n\tget tagCh_msecWait_Kidoku() {return this.#tagCh_msecWait_Kidoku;}\n\n\t#hValTrg\t: {[name: string]: ISetVal}\t= {\n\t\t// sys\n\t\t'sys:sn.tagCh.doWait'\t\t\t: name=> {\n\t\t\tthis.#tagCh_doWait =\n\t\t\tthis.#runFirst_Bool_hSysVal_true(name);\n\t\t},\n\t\t'sys:sn.tagCh.doWait_Kidoku'\t: name=> {\n\t\t\tthis.#tagCh_doWait_Kidoku =\n\t\t\tthis.#runFirst_Bool_hSysVal_true(name);\n\t\t},\n\t\t'sys:sn.tagCh.msecWait'\t\t\t: name=> {\n\t\t\tthis.#tagCh_msecWait =\n\t\t\tthis.#runFirst_sys_an_tagCh_msecWait(name);\n\t\t},\n\t\t'sys:sn.tagCh.msecWait_Kidoku'\t: name=> {\n\t\t\tthis.#tagCh_msecWait_Kidoku =\n\t\t\tthis.#runFirst_sys_an_tagCh_msecWait_Kidoku(name);\n\t\t},\n\t\t'sys:sn.tagCh.canskip'\t\t\t: name=> this.#runFirst_Bool_hSysVal_true(name),\n\n\t\t'sys:sn.auto.msecPageWait'\t\t\t: name=>\n\t\t\tthis.#runFirst_sys_an_auto_msecPageWait(name),\n\t\t'sys:sn.auto.msecPageWait_Kidoku'\t: name=>\n\t\t\tthis.#runFirst_sys_an_auto_msecPageWait(name),\n\t\t'sys:sn.auto.msecLineWait'\t\t\t: name=>\n\t\t\tthis.#runFirst_sys_an_auto_msecLineWait(name),\n\t\t'sys:sn.auto.msecLineWait_Kidoku'\t: name=>\n\t\t\tthis.#runFirst_sys_an_auto_msecLineWait(name),\n\n\t\t// save\n\t\t'save:sn.doRecLog'\t\t: name=> {\n\t\t\tthis.#doRecProc(\n\t\t\t\tthis.#doRecLog = this.#runFirst_Bool_hSaveVal_true(name)\n\t\t\t);\n\t\t},\n\t\t'save:sn.userFnTail'\t: (_name, val)=> {\n\t\t\tif (val.includes('@')) throw `この変数では文字「@」は禁止です`;\n\t\t\tthis.cfg.userFnTail = val;\n\t\t},\n\n\t\t// tmp\n\t\t'tmp:flash.desktop.NativeApplication.nativeApplication.systemIdleMode'\t: (\n\t\t\t()=> {\n\t\t\t//\tNativeApplication.nativeApplication.systemIdleMode = val;\n\t\t\t}\n\t\t),\n\t};\n\tdefValTrg(name: string, fnc: ISetVal) {this.#hValTrg[name] = fnc}\n\treadonly\t#runFirst_Bool_hSysVal_true = (name: string)=> argChk_Boolean(this.#hSys, name, true);\n\treadonly\t#runFirst_sys_an_tagCh_msecWait = (name: string)=> argChk_Num(this.#hSys, name, 10);\n\treadonly\t#runFirst_sys_an_tagCh_msecWait_Kidoku = (name: string)=> argChk_Num(\n\t\tthis.#hSys, name,\n\t\t(this.cfg.oCfg.init.tagch_msecwait === undefined)\n\t\t\t? 10\n\t\t\t: this.cfg.oCfg.init.tagch_msecwait\n\t);\n\treadonly\t#runFirst_sys_an_auto_msecPageWait = (name: string)=> argChk_Num(\n\t\tthis.#hSys, name,\n\t\t(this.cfg.oCfg.init.auto_msecpagewait === undefined)\n\t\t\t? 3500\n\t\t\t: this.cfg.oCfg.init.auto_msecpagewait\n\t);\n\treadonly\t#runFirst_sys_an_auto_msecLineWait = (name: string)=> argChk_Num(this.#hSys, name, 500);\n\n\t#runFirst_Bool_hSaveVal_true(name: string) {\n\t\treturn argChk_Boolean(this.#hSave, name, true);\n\t}\n\n};\n"],"names":["Areas","idx","begin","v","ret","k","x","y","Variable","cfg","hTag","o","#let","#let_abs","#let_char_at","#let_index_of","#let_length","#let_replace","#let_round","#let_search","#let_substr","#clearsysvar","#clearvar","#dump_val","#copybookmark","#erasebookmark","#hSave","a","#data","#hTmp","getDateStr","platform","win","ac","#hScopes","#sys","#hSys","#hAreaKidoku","#callHook","sys","data","ns","#flush","oSys","oSave","oTmp","oMp","oMark","oKidoku","type","#hProcDbgRes","tm","#tagCh_doWait","#tagCh_doWait_Kidoku","#tagCh_msecWait","#tagCh_msecWait_Kidoku","#saPageLog","playbackPage","INI_STYPAGE","_","#set_data_break","#setVal","#hSetEvent","fn","areas","fnc","#doRecProc","_doRec","name","mp","place","mark","#doRecLog","hAreas","hArg","from","to","f","autocast","argChk_Num","int","uint","argChk_Boolean","n","val","start","flags","reg","i","init","mesLayer","doRecLog","sLog","styPaging","arg_name","PropParser","hScope","nm","scope","#castAuto","fullnm","old_v","new_v","#hValTrg","def","val_name","aNm","len","j","nj","s_val","#REG_NUMERICLITERAL","hVal","hRet","key","#runFirst_Bool_hSysVal_true","#runFirst_sys_an_tagCh_msecWait","#runFirst_sys_an_tagCh_msecWait_Kidoku","#runFirst_sys_an_auto_msecPageWait","#runFirst_sys_an_auto_msecLineWait","#runFirst_Bool_hSaveVal_true","_name"],"mappings":"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"}