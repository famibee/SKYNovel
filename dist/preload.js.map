{"version":3,"file":"preload.js","sources":["../src/preload.ts"],"sourcesContent":["/* ***** BEGIN LICENSE BLOCK *****\n\tCopyright (c) 2021-2025 Famibee (famibee.blog38.fc2.com)\n\n\tThis software is released under the MIT License.\n\thttp://opensource.org/licenses/mit-license.php\n** ***** END LICENSE BLOCK ***** */\n\nimport type {T_CFG} from './sn/ConfigBase';\n\nimport {contextBridge, ipcRenderer, type IpcRendererEvent, type MessageBoxOptions, type MessageBoxReturnValue} from 'electron';\n\nexport\ttype\tTAG_WINDOW\t= {\n\tc\t: boolean;\n\tx\t: number;\n\ty\t: number;\n\tw\t: number;\n\th\t: number;\n};\n\nexport\ttype\tSAVE_WIN_INF\t= {\n\tx\t: number;\n\ty\t: number;\n\tw\t: number;\n\th\t: number;\n\tscrw: number;\n\tscrh: number;\n};\n\nexport\ttype\tHPROC\t= {\n\topenDevTools\t: ()=> void;\n\n\tgetInfo\t\t: ()=> Promise<HINFO>;\n\tinited\t\t: (oCfg: T_CFG, tagW: TAG_WINDOW)=> Promise<void>;\n\n\texistsSync\t: (path: string)=> Promise<boolean>;\n\tcopySync\t: (path_from: string, path_to: string)=> void;\n\tremoveSync\t: (path: string)=> Promise<void>;\n\tensureFileSync\t: (path: string)=> Promise<void>;\n\treadFileSync: (path: string)=> Promise<string>;\n\twriteFileSync\t: (path: string, data: string | NodeJS.ArrayBufferView, o?: object)=> Promise<void>;\n\tappendFile\t\t: (path: string, data: string)=> Promise<void>;\n\toutputFile\t\t: (path: string, data: string)=> Promise<void>;\n\n\twindow\t: (centering: boolean, x: number, y: number, w: number, h: number)=> void;\n\tisSimpleFullScreen\t: ()=> Promise<boolean>;\n\tsetSimpleFullScreen\t: (b: boolean)=> Promise<void>;\n\twin_close\t\t: ()=> void;\n\twin_setTitle\t: (title: string)=> void;\n\n\tshowMessageBox\t: (o: MessageBoxOptions)=> Promise<MessageBoxReturnValue>;\n\n\tcapturePage\t: (fn: string, w: number, h: number)=> Promise<void>;\n\tnavigate_to\t: (url: string)=> void;\n\n\tStore\t: (o: object)=> Promise<void>;\n\tflush\t: (o: object)=> Promise<void>;\n\tStore_isEmpty\t: ()=> Promise<boolean>;\n\tStore_get\t\t: ()=> Promise<any>;\n\n\tzip\t\t: (inp: string, out: string)=> void;\n\tunzip\t: (inp: string, out: string)=> void;\n\n\t// メイン → レンダラー\n\ton: (channel: string, callback: Function) => void;\n};\n\n\texport\ttype\tHINFO\t= {\n\t\tgetAppPath\t: string;\n\t\tisPackaged\t: boolean;\n\t\tdownloads\t: string;\n\t\tuserData\t: string;\n\t\tgetVersion\t: string;\n\t\tenv\t\t\t: {[name: string]: any};\n\t\tplatform\t: string;\n\t\tarch\t\t: string;\n\t}\n\nconst fncE = console.error;\n\nexport const\thProc\t: HPROC = {\n\t// console.log は【アプリ】のターミナルに出る\n\tgetInfo\t\t: ()=> ipcRenderer.invoke('getInfo').catch(fncE),\n\tinited\t\t: (oCfg: T_CFG, tagW: TAG_WINDOW)=> ipcRenderer.invoke('inited', oCfg, tagW).catch(fncE),\n\n\texistsSync\t: path=> ipcRenderer.invoke('existsSync', path).catch(fncE),\n\tcopySync\t: (path_from, path_to)=>\n\t\tipcRenderer.invoke('copySync', path_from, path_to).catch(fncE),\n\tremoveSync\t: path=> ipcRenderer.invoke('removeSync', path).catch(fncE),\n\tensureFileSync\t: path=>\n\t\tipcRenderer.invoke('ensureFileSync', path).catch(fncE),\n\treadFileSync\t: path=>\n\t\tipcRenderer.invoke('readFileSync', path).catch(fncE),\n\twriteFileSync\t: (path, data, o?)=>\n\t\tipcRenderer.invoke('writeFileSync', path, data, o).catch(fncE),\n\tappendFile\t\t: (path, data)=>\n\t\tipcRenderer.invoke('appendFile', path, data).catch(fncE),\n\toutputFile\t\t: (path, data)=>\n\t\tipcRenderer.invoke('outputFile', path, data).catch(fncE),\n\n\twin_close\t: ()=> ipcRenderer.invoke('win_close').catch(fncE),\n\twin_setTitle\t: title=>\n\t\tipcRenderer.invoke('win_setTitle', title).catch(fncE),\n\n\tshowMessageBox\t: o=> ipcRenderer.invoke('showMessageBox', o).catch(fncE),\n\n\tcapturePage\t: (fn, w, h)=>\tipcRenderer.invoke('capturePage', fn, w, h).catch(fncE),\n\tnavigate_to\t: url=> ipcRenderer.invoke('navigate_to', url).catch(fncE),\n\n\topenDevTools\t: ()=> ipcRenderer.invoke('openDevTools').catch(fncE),\n\n\tStore\t: o=> ipcRenderer.invoke('Store', o).catch(fncE),\n\tflush\t: o=> ipcRenderer.invoke('flush', o).catch(fncE),\n\tStore_isEmpty\t: ()=> ipcRenderer.invoke('Store_isEmpty').catch(fncE),\n\tStore_get\t: ()=> ipcRenderer.invoke('Store_get').catch(fncE),\n\n\tzip\t\t: (inp, out)=> ipcRenderer.invoke('zip', inp, out).catch(fncE),\n\tunzip\t: (inp, out)=> ipcRenderer.invoke('unzip', inp, out).catch(fncE),\n\n\tisSimpleFullScreen\t: ()=>\n\t\tipcRenderer.invoke('isSimpleFullScreen').catch(fncE),\n\tsetSimpleFullScreen\t: b=>\n\t\tipcRenderer.invoke('setSimpleFullScreen', b).catch(fncE),\n\twindow\t: (centering, x, y, w, h)=>\n\t\tipcRenderer.invoke('window', centering, x, y, w, h).catch(fncE),\n\n\n\t// メイン → レンダラー\n\ton\t: (ch, cb)=> {switch (ch) {\n\t\tcase 'log':\n\t\t\tipcRenderer.on(ch, (e: IpcRendererEvent, arg: string)=> cb(e, arg));\tbreak;\n\t\tcase 'shutdown':\n\t\t\tipcRenderer.on(ch, (e: IpcRendererEvent)=> cb(e));\tbreak;\n\t\tcase 'save_win_inf':\n\t\t\tipcRenderer.on(ch, (e: IpcRendererEvent, swi: SAVE_WIN_INF)=> cb(e, swi));\tbreak;\n\t\tcase 'fire':\n\t\t\tipcRenderer.on(ch, (e: IpcRendererEvent, KEY: string)=> cb(e, KEY));\tbreak;\n\t\t//case 'call':\t// 実験・保留コード。セキュリティ懸念\n\t\t//\tipcRenderer.on(ch, (e, fn, label)=> cb(e, fn, label));\tbreak;\n\t}},\n\n};\ncontextBridge.exposeInMainWorld('to_app', hProc);\n"],"names":["fncE","hProc","ipcRenderer","oCfg","tagW","path","path_from","path_to","data","o","title","fn","w","h","url","inp","out","b","centering","x","y","ch","cb","e","arg","swi","KEY","contextBridge"],"mappings":"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"}