{"version":3,"file":"SoundMng.js","sources":["../src/sn/SoundMng.ts"],"sourcesContent":["/* ***** BEGIN LICENSE BLOCK *****\n\tCopyright (c) 2018-2025 Famibee (famibee.blog38.fc2.com)\n\n\tThis software is released under the MIT License.\n\thttp://opensource.org/licenses/mit-license.php\n** ***** END LICENSE BLOCK ***** */\n\nimport {type IEvtMng, argChk_Boolean, argChk_Num} from './CmnLib';\nimport type {T_HTag, TArg} from './Grammar';\nimport type {T_Variable, T_Main, T_NoticeChgVolume} from './CmnInterface';\nimport type {Config} from './Config';\nimport type {SysBase} from './SysBase';\nimport {BUF_BGM, BUF_SE, type HSndBuf, SndBuf} from './SndBuf';\n\nimport {sound, utils} from '@pixi/sound';\n\n\nexport class SoundMng {\n\t#hSndBuf\t: HSndBuf\t= {};\n\n\tconstructor(cfg: Config, hTag: T_HTag, private readonly val: T_Variable, main: T_Main, sys: SysBase) {\n\t\thTag.volume\t\t= o=> this.#volume(o);\t\t// 音量設定（独自拡張）\n\t\thTag.fadebgm\t= o=> this.#fadebgm(o);\t\t// BGMのフェード\n\t\thTag.fadeoutbgm\t= o=> this.#fadeoutbgm(o);\t// BGMのフェードアウト\n\t\thTag.fadeoutse\t= o=> this.#fadeoutse(o);\t// 効果音のフェードアウト\n\t\thTag.fadese\t\t= o=> this.#fadese(o);\t\t// 効果音のフェード\n\t\thTag.playbgm\t= o=> this.#playbgm(o);\t\t// BGM の演奏\n\t\thTag.playse\t\t= o=> this.#playse(o);\t\t// 効果音の再生\n\t\thTag.stop_allse\t= ()=> this.#stop_allse();\t// 全効果音再生の停止\n\t\thTag.stopbgm\t= o=> this.#stopbgm(o);\t\t// BGM 演奏の停止\n\t\thTag.stopse\t\t= o=> this.#stopse(o);\t\t// 効果音再生の停止\n\t\thTag.wb\t\t\t= o=> this.#wb(o);\t\t\t// BGM フェードの終了待ち\n\t\thTag.wf\t\t\t= o=> this.#wf(o);\t\t\t// 効果音フェードの終了待ち\n\t\thTag.stopfadese\t= o=> this.#stopfadese(o);\t// 音声フェードの停止\n\t\thTag.wl\t\t\t= o=> this.#wl(o);\t\t\t// BGM 再生の終了待ち\n\t\thTag.ws\t\t\t= o=> this.#ws(o);\t\t\t// 効果音再生の終了待ち\n\t\thTag.xchgbuf\t= o=> this.#xchgbuf(o);\t\t// 再生トラックの交換\n\n\t\tval.setVal_Nochk('save', 'const.sn.loopPlaying', '{}');\n\n\t\tval.setVal_Nochk('tmp', 'const.sn.sound.codecs', JSON.stringify(utils.supported));\n\n\t\tSndBuf.init(cfg, val, main, sys, this.#hSndBuf);\n\t\tsound.disableAutoPause = true;\n\t}\n\n\t#evtMng\t: IEvtMng;\n\tsetEvtMng(evtMng: IEvtMng) {this.#evtMng = evtMng; SndBuf.setEvtMng(evtMng)}\n\tsetNoticeChgVolume(setGlbVol: T_NoticeChgVolume, setMovVol: T_NoticeChgVolume) {\n\t\tthis.val.defValTrg('sys:sn.sound.global_volume', (_, val)=> setGlbVol(sound.volumeAll = Number(val)));\n\t\tthis.val.defValTrg('sys:sn.sound.movie_volume', (_, val)=> setMovVol(Number(val)));\n\n\t\t// 起動時初期値セット\n\t\tthis.val.setVal_Nochk('sys', 'sn.sound.global_volume', <number>this.val.getVal('sys:sn.sound.global_volume', 1));\n\t\tthis.val.setVal_Nochk('sys', 'sn.sound.movie_volume', <number>this.val.getVal('sys:sn.sound.movie_volume', 1));\n\t}\n\n\t//MARK: 音量設定（独自拡張）\n\t#volume(hArg: TArg) {\n\t\tconst {buf = BUF_SE} = hArg;\n\t\tconst vnV = 'const.sn.sound.'+ buf +'.volume';\n\t\tconst arg_vol = this.#getVol(hArg, 1);\n\t\tif (Number(this.val.getVal('sys:'+ vnV)) === arg_vol) return false;\n\n\t\tthis.val.setVal_Nochk('sys', vnV, arg_vol)\t// 基準音量（sys:）\n\t\tthis.val.flush();\t// fadese()内で必ずしも呼ばれないので\n\n\t\t// 再生中音声の一時的音量も変更\n\t\thArg.time = 0;\n\t\thArg.volume = Number(this.val.getVal('save:'+ vnV));\t// 目標音量（save:）\n\t\treturn this.#fadese(hArg);\n\t}\n\t#getVol(hArg: TArg, def: number) {\n\t\tconst vol = argChk_Num(hArg, 'volume', def);\n\t\tif (vol < 0) return 0;\n\t\tif (vol > 1) return 1;\n\t\treturn vol;\n\t}\n\n\t//MARK: BGM/効果音のフェードアウト（loadから使うのでマクロ化禁止）\n\t#fadeoutbgm(hArg: TArg) {hArg.volume = 0; return this.#fadebgm(hArg)}\n\t//MARK: 効果音のフェードアウト（loadから使うのでマクロ化禁止）\n\t#fadeoutse(hArg: TArg) {hArg.volume = 0; return this.#fadese(hArg)}\n\t//MARK: BGMのフェード（loadから使うのでマクロ化禁止）\n\t#fadebgm(hArg: TArg) {hArg.buf = BUF_BGM; return this.#fadese(hArg)}\n\t//MARK: 効果音のフェード\n\t#fadese(hArg: TArg) {\n\t\tconst {buf = BUF_SE} = hArg;\n\t\tthis.#stopfadese(hArg);\n\t\tthis.#hSndBuf[buf]?.fade(hArg);\n\n\t\treturn false;\n\t}\n\n\t//MARK: BGM の演奏\n\t#playbgm(hArg: TArg) {\n\t\thArg.buf = BUF_BGM;\n\t\thArg.canskip = false;\n\t\targChk_Boolean(hArg, 'loop', true);\n\t\treturn this.#playse(hArg);\n\t}\n\n\t//MARK: 効果音の再生\n\t#playse(hArg: TArg) {\n\t\tconst {buf = BUF_SE, fn} = hArg;\n\t\tthis.#stopse({buf});\n\t\tif (! fn) throw `fnは必須です buf:${buf}`;\n\n\t\t// isSkipping()は此処のみとする。タイミングによって変わる\n\t\tif (argChk_Boolean(hArg, 'canskip', true) && this.#evtMng.isSkipping) return false;\n\n\t\tconst sb = this.#hSndBuf[buf] = new SndBuf(hArg, buf, fn);\n\t\treturn sb.needLoad;\n\t}\n\n\tclearCache() {sound.removeAll()}\n\n\t//MARK: 全効果音再生の停止\n\t#stop_allse() {\n\t\tfor (const buf of Object.keys(this.#hSndBuf)) this.#stopse({buf});\n\t\tthis.#hSndBuf = {};\n\n\t\tsound.stopAll();\t// 念のため\n\n\t\treturn false;\n\t}\n\t//MARK: BGM 演奏の停止（loadから使うのでマクロ化禁止）\n\t#stopbgm(hArg: TArg) {hArg.buf = BUF_BGM; return this.#stopse(hArg)}\n\t//MARK: 効果音再生の停止\n\t#stopse(hArg: TArg) {\n\t\tconst {buf = BUF_SE} = hArg;\n\t\tthis.#hSndBuf[buf]?.stopse(hArg);\n\n\t\treturn false;\n\t}\n\n\t//MARK: BGM フェードの終了待ち\n\t#wb(hArg: TArg) {hArg.buf = BUF_BGM; return this.#wf(hArg)}\n\n\t//MARK: 効果音フェードの終了待ち\n\t#wf(hArg: TArg) {\n\t\tconst {buf = BUF_SE} = hArg;\n\t\treturn this.#hSndBuf[buf]?.wf(hArg) ?? false;\n\t}\n\n\t//MARK: 音声フェードの停止\n\t#stopfadese(hArg: TArg) {\n\t\tconst {buf = BUF_SE} = hArg;\n\t\tthis.#hSndBuf[buf]?.stopfadese(hArg);\n\n\t\treturn false;\n\t}\n\n\t//MARK: BGM 再生の終了待ち\n\t#wl(hArg: TArg) {hArg.buf = BUF_BGM; return this.#ws(hArg)}\n\t//MARK: 効果音再生の終了待ち\n\t#ws(hArg: TArg) {\n\t\tconst {buf = BUF_SE} = hArg;\n\t\treturn this.#hSndBuf[buf]?.ws(hArg) ?? false;\n\t}\n\n\t//MARK: 再生トラックの交換\n\t#xchgbuf(hArg: TArg) {\n\t\tconst {buf: buf1 = BUF_SE, buf2 = BUF_SE} = hArg;\n\t\tif (buf1 === buf2) return false;\n\n\t\tconst a = this.#hSndBuf[buf1];\t// 分割代入の変数交換だと noUncheckedIndexedAccess エラーになるので\n\t\tconst b = this.#hSndBuf[buf2];\n\t\t// eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n\t\tif (a) this.#hSndBuf[buf2] = a; else delete this.#hSndBuf[buf2];\n\t\t// eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n\t\tif (b) this.#hSndBuf[buf1] = b; else delete this.#hSndBuf[buf1];\n\n\t\tSndBuf.xchgbuf(hArg);\n\n\t\treturn false;\n\t}\n\n\t//MARK: しおりの読込（BGM状態復元）\n\tplayLoopFromSaveObj(all_stop_and_play: boolean): Promise<void>[] {\n\t\tconst lp = String(this.val.getVal('save:const.sn.loopPlaying', '{}'));\n\t\tif (lp === '{}') {this.#stop_allse(); this.clearCache(); return []}\n/*\n\t\t\t\t\t(Now)#hSndBuf\n\t\t\t\t\tstop\tplay\n\thSaveLP\tstop\t-\t\tstop\t\t--[1]\n\t(to)\tplay\tplay\tstop/play\t--[2]\n\t\t\teq play\tplay\t-\t\t\t--[2]\n*/\n\t\tconst hSaveLP = <{[buf: string]: string}>JSON.parse(lp);\n\t\tif (all_stop_and_play) {this.#stop_allse(); this.clearCache()}\n\t\telse for (const [buf, sb] of Object.entries(this.#hSndBuf)) {\n\t\t\t// [1] #hSndBuf（再生中）だが hSaveLP（再生予定） にない buf -> stop\n\t\t\tif (! (buf in hSaveLP)) sb.stopse({buf});\n\t\t}\n\n\t\t// [2] hSaveLP（再生予定）を再生。だが#hSndBuf（再生中）の状況で処理変更\n\t\treturn Object.entries(hSaveLP).map(([buf, fn])=> new Promise(re=> {\n\t\t\tconst sb = this.#hSndBuf[buf]\n\t\t\tif (! all_stop_and_play && sb) {\n\t\t\t\tif (sb.fn === fn) {re(); return}\n\t\t\t\t//sb.stopse({buf});\t// 再生中 fn !== 再生予定 fn なら stop\n\t\t\t\t\t// #playbgm()、#playse() 内で stop するので省略\n\t\t\t}\n\n\t\t\tconst vm = 'save:const.sn.sound.'+ buf +'.';\n\t\t\tconst hArg = {\n\t\t\t\tfn,\n\t\t\t\tbuf,\n\t\t\t\tjoin\t: false,\n\t\t\t\tloop\t: true,\n\t\t\t\tvolume\t: Number(this.val.getVal(vm +'volume')),\n\t\t\t\tstart_ms: Number(this.val.getVal(vm +'start_ms')),\n\t\t\t\tend_ms\t: Number(this.val.getVal(vm +'end_ms')),\n\t\t\t\tret_ms\t: Number(this.val.getVal(vm +'ret_ms')),\n\t\t\t\tfnc\t\t: re,\t// loaded\n\t\t\t};\n\t\t\tif (hArg.buf === BUF_BGM) this.#playbgm(hArg);\n\t\t\telse this.#playse(hArg);\n\t\t}));\n\t}\n\n\tdestroy() {this.#stop_allse(); this.clearCache()}\n\n}\n"],"names":["SoundMng","cfg","hTag","val","main","sys","o","#volume","#fadebgm","#fadeoutbgm","#fadeoutse","#fadese","#playbgm","#playse","#stop_allse","#stopbgm","#stopse","#wb","#wf","#stopfadese","#wl","#ws","#xchgbuf","utils","SndBuf","#hSndBuf","sound","#evtMng","evtMng","setGlbVol","setMovVol","_","hArg","buf","BUF_SE","vnV","arg_vol","#getVol","def","vol","argChk_Num","BUF_BGM","argChk_Boolean","fn","buf1","buf2","a","b","all_stop_and_play","lp","hSaveLP","sb","re","vm"],"mappings":"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"}